<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="OpenFOAM 燃烧化学求解过程解析"><meta name="keywords" content="thermophysicalModels,RTS,combustionModels"><meta name="author" content="Yan Zhang"><meta name="copyright" content="Yan Zhang"><title>OpenFOAM 燃烧化学求解过程解析 | OpenFOAM 成长之路</title><link rel="shortcut icon" href="/album/linktocat.ico"><link rel="stylesheet" href="/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?38997e7d3b8e8c254bf0ddb7d2452127";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject="ga",e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script"),ga("create","UA-119919860-1","auto"),ga("send","pageview")</script><script>var GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"找不到您查询的内容:${query}"}},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"}}</script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="OpenFOAM 成长之路" type="application/atom+xml"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#of-7"><span class="toc-number">1.</span> <span class="toc-text">OF-7</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#uml-类图"><span class="toc-number">1.1.</span> <span class="toc-text">UML 类图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rts"><span class="toc-number">1.2.</span> <span class="toc-text">RTS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#declareruntimeselectiontable"><span class="toc-number">1.2.1.</span> <span class="toc-text">declareRunTimeSelectionTable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#definetemplateruntimeselectiontable"><span class="toc-number">1.2.2.</span> <span class="toc-text">defineTemplateRunTimeSelectionTable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#创建对象"><span class="toc-number">1.2.3.</span> <span class="toc-text">创建对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#laminarsc"><span class="toc-number">1.2.4.</span> <span class="toc-text">laminars.C</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#总结"><span class="toc-number">1.2.5.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#of-8"><span class="toc-number">2.</span> <span class="toc-text">OF-8</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#uml-类图-2"><span class="toc-number">2.1.</span> <span class="toc-text">UML 类图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-阶-rk"><span class="toc-number">2.1.1.</span> <span class="toc-text">6 阶 RK</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#krr4"><span class="toc-number">2.1.2.</span> <span class="toc-text">KRR4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#seulex"><span class="toc-number">2.1.3.</span> <span class="toc-text">seulex</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#化学-ode-求解理论"><span class="toc-number">2.2.</span> <span class="toc-text">化学 ODE 求解理论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rts-2"><span class="toc-number">2.3.</span> <span class="toc-text">RTS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#declareruntimeselectiontable-2"><span class="toc-number">2.3.1.</span> <span class="toc-text">declareRunTimeSelectionTable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#definetemplateruntimeselectiontable-2"><span class="toc-number">2.3.2.</span> <span class="toc-text">defineTemplateRunTimeSelectionTable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#创建对象-2"><span class="toc-number">2.3.3.</span> <span class="toc-text">创建对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#laminarsc-2"><span class="toc-number">2.3.4.</span> <span class="toc-text">laminars.C</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#总结-2"><span class="toc-number">2.3.5.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/album/192.jpg"></div><div class="author-info__name text-center">Yan Zhang</div><div class="author-info__description text-center">OpenFOAM 成长之路</div><div class="follow-button"><a href="https://github.com/ZhangYanTJU" target="_blank" rel="external nofollow noopener noreferrer">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">39</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">30</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">9</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"><a id="site-name" href="/">OpenFOAM 成长之路</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i> <span class="pull-right menus"><a class="site-page" href="/">首页</a><a class="site-page" href="/about">关于</a><a class="site-page" href="/subscribe">订阅</a><a class="site-page" href="/en">English</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i> <span>搜索</span></a></span></div><div id="post-info"><div id="post-title">OpenFOAM 燃烧化学求解过程解析</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2018-06-08<span class="post-meta__separator">|</span><i class="fa fa-calendar-check-o" aria-hidden="true"></i> 更新于 2019-08-27</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/code/">code</a><div class="post-meta-wordcount"><span>字数总计:</span> <span class="word-count">11.7k</span><span class="post-meta__separator">|</span><span>阅读时长: 57 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>分析 OpenFOAM-dev 中的燃烧化学相关类，个人理解有限，希望帮我指正错误！</p><a id="more"></a><h1 id="of-7"><a class="markdownIt-Anchor" href="#of-7"></a> OF-7</h1><h2 id="uml-类图"><a class="markdownIt-Anchor" href="#uml-类图"></a> UML 类图</h2><p>首先给出 UML 图，右键在新标签页中打开链接，可以获得更好的阅读体验。</p><details><summary>OF-7 UML!</summary><img src="http://www.plantuml.com/plantuml/svg/rLhTRzis47_tNq6aWE4WTbjqRxONeCq7wc5PCjjxA8R1e2KgvY9BBaavCRhyxoCfKX8fwiDsqcvzI6toxdZytGVlBfdS-jXZE8uWsO7nFmC_Vem6O0afzYvMQ8qf8xkRs4TXnmiXfQwTRnt0_oqMu8x437aC-S273F8LkV76YoFAGB2zGNJL1Ml-KstC7Z7pLi3JqWnwwi4G4i3bCpWN1quYN4zm0vyKmJOEPtBt6gFG7mud4KCaWc61U55M-WQjbuY0woIIWD3i0ZWASOH0bTHkGMplL6k0VU35X73HQesVLNN2cJgXZ5JlD5qqo6pSJA8j9YpXTmtX4eKWccsGXv4c0J-3zqwoAO9IfpAXeLix35pgDF5FfxsK95K8LogyZuWICrjlnbK2pW5VzP8GCcH9EYCA7TmlBbC9RPscmWcqp9v37UN3D0wtgETmwtrOv6swrOpbgvy3vbKxXel-Tpzc1iTpf-F827aY-LIPI1mxO-s4ynKYw_YyAR6Ov5t0vF-Bjj7cPbVHQhfz5QboT8x2fpeKPWn6FYI-1SJjvTLiHnbQ2yfAgWt5vl5W_FPj1J4OMgfsxY7zd7wyM-suYhIUEoMTxpP8cSbDQLcgN-0hMWrlkTzNsc70RxuHaJ5EZxgKdYjbkBmytywSlC4_xXZvbUjiUt4NV34U4ascxpGkN8OJwzYdJgO2RLSbX7d13TyOMTXSq-UfLNNbkJolzWR5b3MTAj9rmk0oHCLa0BoQFT_psG6FOAD6CWtl-UArjO3pDMnf3_Uhf6GutyewIlkvD3GoB5b3qSr87Ez6l4Rtq9NWlRxnKCpDhvk--HfmApkleyYBfxZGv-3t3zQX2pP1zj4B-XAxBWYdA5_Ua9o2Q0h2AHgrdlJKCw_r_YyfQZ_zEXxYBI84-pYw1t39qodN70HPSE38LL-__UoEchrhgOFhg9UeeNGGJsfAg3sBeuCAetsAelqAejOsvkz-sQPMFNxrrKvtXclvI3wkU8ke2GrpHq6xf215_mszU8bXT9XSjJBxca22RY0Z-8bl1BvdWKIGy14Vi3ZlOsR2T2G3nj0gDMln0UjwMK3EyoZDFgNcphxIP7cfAcEZUarBZwmI-zRuSDNOgQ83gBJLamlJdONfpd-g5--sLolPWVzKPQ-TXLD5nPYLk9OHXywQto8QcqJdxS5_JPUmtL7Mvb5yOIwxoQwI4949hsgnXvcRXD-qq-bCd6CNBrul4ogM3TJCrOF7BUa6bxOXY5BC2y9vGfPSuyX3KZBlQ_Y2EPmHINkh2zU2pbwCWi0iYHzZueEr42HAXyKB3prQQfykr4WmCpX_mbUnarfaUvgG07h8oFYR5QwHdgBMLR3L4EPGTXMMDTa-6oIvk_HWcsgOXY_l2Nhs9RyStULRJfZxx8Nbi-vsrQ8gzwcfgrjabGE1nWHHsR2N06ZJu6iGBgf0IDdoxOwza9DINXU4QCRGfa3kMinPhcUN3HG-3eA4Dal2KO0Zp52ukuQKPIcjezz1M-so0PuLfUiSUofG6WgSvIi0Kr2QJMJI-OrhXMcwxDwjg2jkty1RvT6QlO1poQih7SR1hKEWlBFlN0mcBERzyBZ5YEqyVvCvn-Be-De_jcHSER3Ce0hX6lCygU1HtseWIOTEHK06opWM3Jn3zqGq9efroZ_lCm5fqIkqhbtCNmqScCtto-I3mU0pWanKtWXI10GKuC-7-tVhT_IdlqnP4Z3UiVbSmUUEmZmtoHsSJSkhLvSNdOfveuQy725f0qY7GwP2IzH8caRPF1jCDCV1EaK_A1bFegvxq1aZlwA0zMxv1vx7-4y4r_cSgGXlYN6AxrUjEBbUl6Xcs3DyyOocQwfz-2Fw3QwHhoz6HmQHdbg4yUCb2c0ICZ5fvGgeRwCCW6GPweCOJroqS1n9UF-PmdmX2mtDvDZAs5Jd7_deIQkasciMOsybgSqDzBI98nGnlLgGgZkJrDHpCOhKipdQ1nEgGCJqT5GRneKoC-Ae6QjEuOf23WQB2fs3S5MpIR9DAgrSD7yRom_IzWGnDNbCDVmCwOhdMAcXxSawALxowovvSEuvFnMGT2KcEjX7pe4azwDw0k5RRehqe39ONG5bJPthuY0hMlSxGXVB_I4y9SrgNCKIBljsaJojUM7DDB5Y9cAWAVv9sS5Bo0vCIrMCZG_IEfyGcL5-fFYN6BIEd6E_X-00hGhbVOLKOafz21xz_dSuvr2fqcqVVUzm2vc3e5yg1tnTDOJFlafeiY_B32TLIlY9X_II35PfM1wbtWVgS6D-YVaXbp1eb8OD5fIwkY_V-WR6J5k-clDQR_KVWeFkr-X8_WDv0U2aUXPAfFhi0YRpP1EY3oaqVSKhVeMtH0psgYMaDlVmCPwR-IZsM-34gOusm7FMDq_H5X4vb2hNghmSwriTPh43QMXTYgJWOJ5gB0p4UQAcx9sGJAcJqvTFcjyZORvyidoLSFnHeNXS67wV47oLy1EXbxMKQNzfnr-nqnH_pLBLbzRnfHtgDGp3so0m0h6HLr3fMLQPVspGzO6cqT6yLqvuhvA2jJo90hrXIGVNUeEjCF4_nVxkAWWmhu8ZKGa3vwfcgN4lwLqjCfHgRcKV9vhLtkatWbX28WELuJ3T0sSsEeMT4xLrCdfszJFn1X78Oj8xFSBNTDrkYlPV866K6wKsSQl1Ij4sx_swGMmXS6WCYtVp8o4h5E64biBA5MxEk7AAg0ySfTT7xSpgUy5lzTByE4S-oPHxJSzqMkM7-UNe_-U9-Mio9p6oqsIrDrgK-fSdPHcjt166crN9_oYbYpx_J_wWnpcZK6nFFxHAZZkoby_TcNyq1gwjckQEs3NDl5w-jxTyhqh-S-TV"></details><p>我猜测：<code>ArrheniusReactionRate</code> 也可以直接作为 <code>ReversibleReaction</code> 的模板，而不通过 <code>FallOffReactionRate</code>。</p><p><code>Reaction</code> 的模板是 <code>gasHThermoPhysics</code>，<code>Reaction</code> 的基类是 <code>Foam::species::thermo</code>，全称是 <code>Foam::species::thermo&lt; Foam::janafThermo&lt;Foam::perfectGas&lt;Foam::specie&gt;&gt;, Foam::sensibleEnthalpy&gt;</code>。</p><p><code>ReversibleReaction</code> 的模板是 <code>Reaction</code>，<code>gasHThermoPhysics</code> 和 <code>FallOffReactionRate</code>。而 <code>FallOffReactionRate</code> 的模板是 <code>ArrheniusReactionRate</code> 和 <code>TroeFallOffFunction</code>。<br><code>ReversibleReaction</code> 的基类是 <code>Reaction&lt;gasHThermoPhysics&gt;</code>。</p><p>机理文件怎么读取的？<br><code>Reaction</code> 等相关类的对象在哪里创建的？<br>在 StandardChemistryModel 中申明了反应的 list：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> PtrList&lt;Reaction&lt;ThermoType&gt;&gt;&amp; reactions_;</span><br></pre></td></tr></table></figure><p>StandardChemistryModel 的构造函数中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">reactions_</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">dynamic_cast</span>&lt;<span class="keyword">const</span> reactingMixture&lt;ThermoType&gt;&amp;&gt;(<span class="keyword">this</span>-&gt;thermo())</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>this-&gt;thermo()</code> 返回的是 <code>BasicChemistryModel</code> 中申明的 <code>ReactionThermo&amp; thermo_</code>，这里模板 <code>ReactionThermo</code> 的实例是 <code>psiReactionThermo</code>。<br>thermo_由构造函数中的thermo传入。</p><p>StandardChemistryModel 的模板 ReactionThermo<br>到底是 psiReactionThermo，还是 hePsiThermo？<br>是 psiReactionThermom 又如何，<br>是 hePsiThermo 又如何？<br>dynamic_cast&lt;const reactingMixture<thermotype>&amp;&gt;(this-&gt;thermo())<br>二者之间，哪个可以转化为 reactingMixture？答：hePsiThermo</thermotype></p><p>有这个疑问是因为 solver 中创建 thermo 的时候用的是 psiReactionThermo，但是后来实际上的对象是 hePsiThermo 类型的。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">autoPtr&lt;psiReactionThermo&gt; <span class="title">pThermo</span><span class="params">(psiReactionThermo::New(mesh))</span></span>;</span><br><span class="line">psiReactionThermo&amp; thermo = pThermo();</span><br></pre></td></tr></table></figure><p><code>const PtrList&lt;Reaction&lt;ThermoType&gt;&gt;&amp; reactions_;</code><br>为什么可以这样初始化？没有找到对应的构造函数。<br>答案：<br>下边提到了，reactingMixture 中实际上包括了从机理文件读取的反应的 list，这里的目的是把读取的 list 转移到这里的 reactions_ 中。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">reactions_</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">dynamic_cast</span>&lt;<span class="keyword">const</span> reactingMixture&lt;ThermoType&gt;&amp;&gt;(<span class="keyword">this</span>-&gt;thermo())</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>StandardChemistryModel::calculateRR 中使用了 Reaction 中的函数 omega</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Reaction&lt;ThermoType&gt;&amp; R = reactions_[ri];</span><br><span class="line"><span class="keyword">const</span> scalar omegai = R.omega(pi, Ti, c_, pf, cf, lRef, pr, cr, rRef);</span><br></pre></td></tr></table></figure><p>chemkinReader(chemistryReader 的派生类)中申明了另一个反应的 list:</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">ReactionList&lt;gasHThermoPhysics&gt; reactions_;</span><br></pre></td></tr></table></figure><p>并且定义了接口 reactions()</p><p>读取机理文件后，在 chemkinReader::addReactionType 中 append 所有的 reactions_</p><p><code>reactingMixture</code> 的构造函数</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ThermoType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:reactingMixture&lt;ThermoType&gt;::reactingMixture</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> dictionary&amp; thermoDict,</span><br><span class="line">    <span class="keyword">const</span> fvMesh&amp; mesh,</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; phaseName</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    speciesTable(),</span><br><span class="line">    autoPtr&lt;chemistryReader&lt;ThermoType&gt;&gt;</span><br><span class="line">    (</span><br><span class="line">        chemistryReader&lt;ThermoType&gt;::New(thermoDict, *<span class="keyword">this</span>)</span><br><span class="line">    ),</span><br><span class="line">    multiComponentMixture&lt;ThermoType&gt;</span><br><span class="line">    (</span><br><span class="line">        thermoDict,</span><br><span class="line">        *<span class="keyword">this</span>,</span><br><span class="line">        autoPtr&lt;chemistryReader&lt;ThermoType&gt;&gt;::<span class="keyword">operator</span>()().speciesThermo(),</span><br><span class="line">        mesh,</span><br><span class="line">        phaseName</span><br><span class="line">    ),</span><br><span class="line">    PtrList&lt;Reaction&lt;ThermoType&gt;&gt;</span><br><span class="line">    (</span><br><span class="line">        autoPtr&lt;chemistryReader&lt;ThermoType&gt;&gt;::<span class="keyword">operator</span>()().reactions()</span><br><span class="line">    ),</span><br><span class="line">    speciesComposition_</span><br><span class="line">    (</span><br><span class="line">        autoPtr&lt;chemistryReader&lt;ThermoType&gt;&gt;::<span class="keyword">operator</span>()().specieComposition()</span><br><span class="line">    )</span><br><span class="line">&#123;</span><br><span class="line">    autoPtr&lt;chemistryReader&lt;ThermoType&gt;&gt;::<span class="built_in">clear</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在 dev 版本的 reactingFoam 中，创建了哪些和燃烧化学相关的对象呢？</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">autoPtr&lt;psiReactionThermo&gt; pThermo(psiReactionThermo::New(mesh));</span><br><span class="line">psiReactionThermo&amp; thermo &#x3D; pThermo();</span><br><span class="line">basicSpecieMixture&amp; composition &#x3D; thermo.composition();</span><br><span class="line">PtrList&lt;volScalarField&gt;&amp; Y &#x3D; composition.Y();</span><br><span class="line">autoPtr&lt;CombustionModel&lt;psiReactionThermo&gt;&gt; reaction</span><br><span class="line">(</span><br><span class="line">    CombustionModel&lt;psiReactionThermo&gt;::New(thermo, turbulence())</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><code>reaction</code> 如何使用呢？在 <code>YEqn.H</code> 中</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">reaction-&gt;correct();</span><br><span class="line">Qdot = reaction-&gt;Qdot();</span><br></pre></td></tr></table></figure><p>另外组分方程的源项也通过它调用：<code>reaction-&gt;R(Yi)</code>。</p><p>结合上边的 UML 图，这里的 <code>reaction</code> 的类型实际上是 <code>laminar</code>。<br>函数 <code>correct()</code> 的关键代码是：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>-&gt;chemistryPtr_-&gt;solve(<span class="keyword">this</span>-&gt;mesh().time().deltaTValue());</span><br></pre></td></tr></table></figure><p>其中的 <code>chemistryPtr_</code> 定义于 <code>laminar</code> 的基类 <code>ChemistryCombustion</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">autoPtr&lt;BasicChemistryModel&lt;ReactionThermo&gt;&gt; chemistryPtr_;</span><br></pre></td></tr></table></figure><p><code>ChemistryCombustion</code> 构造函数：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:ChemistryCombustion&lt;ReactionThermo&gt;::ChemistryCombustion</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; modelType,</span><br><span class="line">    ReactionThermo&amp; thermo,</span><br><span class="line">    <span class="keyword">const</span> compressibleTurbulenceModel&amp; turb,</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; combustionProperties</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    CombustionModel&lt;ReactionThermo&gt;</span><br><span class="line">    (</span><br><span class="line">        modelType,</span><br><span class="line">        thermo,</span><br><span class="line">        turb,</span><br><span class="line">        combustionProperties</span><br><span class="line">    ),</span><br><span class="line">    chemistryPtr_(BasicChemistryModel&lt;ReactionThermo&gt;::New(thermo))</span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure><p>即，通过 <code>BasicChemistryModel</code> 调用其派生类 <code>StandardChemistryModel</code> 中的 <code>solve(const scalar deltaT)</code>。但是 <code>BasicChemistryModel</code> 中并没有定义这个 <code>solve</code> 函数，事实上，它是定义在基类 <code>basicChemistryModel</code> 中的纯虚函数。然后在 <code>StandardChemistryModel</code> 中，这个 <code>solve</code> 又调用了同一 <code>class</code> 中的实际干活的另一个 <code>solve(const DeltaTType&amp; deltaT)</code> 函数，在其中，调用了同一 <code>class</code> 的 5 参数的 <code>solve</code> 函数。5 参数的 <code>solve</code> 函数在 <code>EulerImplicit</code> 和 <code>ode</code> 中重新定义。所以这里的 <code>reaction-&gt;correct()</code> 就相当于在这里求解化学反应！</p><p><code>laminar</code> 中的函数 <code>Qdot()</code> 最初的纯虚函数定义于<code>combustionModel</code>，在 <code>laminar</code> 实际定义，返回值是 <code>this-&gt;chemistryPtr_-&gt;Qdot()</code>。因此跳转到了 <code>BasicChemistryModel</code> 类中，和上边的 <code>solve</code> 一样，它也是 <code>basicChemistryModel</code> 的纯虚函数，实际定义于 <code>StandardChemistryModel</code>，返回值是一个 <code>tmp&lt;Foam::volScalarField&gt;</code>，实际计算如下：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">forAll(Y_, i)</span><br><span class="line">&#123;</span><br><span class="line">    forAll(Qdot, celli)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> scalar hi = specieThermo_[i].Hc();</span><br><span class="line">        Qdot[celli] -= hi*RR_[i][celli];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中，<code>Hc()</code> 是该组分的化学焓（英文是 chemical enthalpy，又叫 formation enthalpy），公式是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Δ</mi><msubsup><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow><mn>0</mn></msubsup></mrow><annotation encoding="application/x-tex">\Delta h^0_{f,k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2333239999999999em;vertical-align:-.4192159999999999em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.4168920000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4192159999999999em"><span></span></span></span></span></span></span></span></span></span>，它的计算见 <a href="https://cpp.openfoam.org/v3/a10297_source.html" target="_blank" rel="external nofollow noopener noreferrer">janafThermoI.H</a>。另一篇博文正好给出了<a href="../hEqn/" target="_blank" style="target-new:tab">燃烧反应能量方程</a>，其中显焓输运方程的反应源项，就是这里的 <code>Qdot</code>。</p><p>函数 <code>R(volScalarField&amp; Y)</code> 的返回值是 <code>tmp&lt;Foam::fvScalarMatrix&gt;</code>，我对 <code>matrix</code> 不太熟悉，这个矩阵应该是由此组成：<code>this-&gt;chemistryPtr_-&gt;RR(specieI)</code>。又来到了 BasicChemistryModel 类中，照旧，纯虚函数定义于 <code>basicChemistryModel</code>，实际定义于 <code>StandardChemistryModel</code>（在 StandardChemistryModelI.H 中定义），返回值是 <code>RR_</code>，它的类型是 <code>PtrList&lt;volScalarField::Internal&gt;</code>，代码中的描述是 List of reaction rate per specie [kg/m3/s]。</p><p>总结起来，就是在 solver 中，定义一个燃烧的对象：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">autoPtr&lt;CombustionModel&lt;psiReactionThermo&gt;&gt; reaction</span><br><span class="line">(</span><br><span class="line">    CombustionModel&lt;psiReactionThermo&gt;::New(thermo, turbulence())</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>然后在燃烧模型 <code>ChemistryCombustion</code> 里边，有一个化学模型的指针（Protected data，只能它自己或其派生类能够访问，它的对象不能访问）</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">autoPtr&lt;BasicChemistryModel&lt;ReactionThermo&gt;&gt; chemistryPtr_</span><br></pre></td></tr></table></figure><p>所有关于化学的使用，都是通过它调用。比如求解化学反应方程，就是 <code>reaction-&gt;correct()</code>。而这个 <code>correct</code> 函数的内容是</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">this-&gt;chemistryPtr_-&gt;solve(this-&gt;mesh().time().deltaTValue());</span><br></pre></td></tr></table></figure><p>调用了化学模型里边的 <code>solve</code> 函数。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">template&lt;class ReactionThermo&gt;</span><br><span class="line">Foam::ChemistryCombustion&lt;ReactionThermo&gt;::ChemistryCombustion</span><br><span class="line">(</span><br><span class="line">    const word&amp; modelType,</span><br><span class="line">    ReactionThermo&amp; thermo,</span><br><span class="line">    const compressibleTurbulenceModel&amp; turb,</span><br><span class="line">    const word&amp; combustionProperties</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    CombustionModel&lt;ReactionThermo&gt;</span><br><span class="line">    (</span><br><span class="line">        modelType,</span><br><span class="line">        thermo,</span><br><span class="line">        turb,</span><br><span class="line">        combustionProperties</span><br><span class="line">    ),</span><br><span class="line">    chemistryPtr_(BasicChemistryModel&lt;ReactionThermo&gt;::New(thermo))</span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure><p>燃烧模型的构造函数里边，创建了化学模块的对象，传入了 <code>thermo</code>。</p><p>三个函数完整定义：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:combustionModels::laminar&lt;ReactionThermo&gt;::correct()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;active())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (integrateReactionRate_)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (fv::localEulerDdt::enabled(<span class="keyword">this</span>-&gt;mesh()))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">const</span> scalarField&amp; rDeltaT =</span><br><span class="line">                    fv::localEulerDdt::localRDeltaT(<span class="keyword">this</span>-&gt;mesh());</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;coeffs().found(<span class="string">"maxIntegrationTime"</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                    scalar maxIntegrationTime</span><br><span class="line">                    (</span><br><span class="line">                        readScalar(<span class="keyword">this</span>-&gt;coeffs().lookup(<span class="string">"maxIntegrationTime"</span>))</span><br><span class="line">                    );</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;solve</span><br><span class="line">                    (</span><br><span class="line">                        <span class="built_in">min</span>(<span class="number">1.0</span>/rDeltaT, maxIntegrationTime)()</span><br><span class="line">                    );</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;solve((<span class="number">1.0</span>/rDeltaT)());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;solve(<span class="keyword">this</span>-&gt;mesh().time().deltaTValue());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;calculate();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:tmp&lt;Foam::fvScalarMatrix&gt;</span><br><span class="line">Foam::combustionModels::laminar&lt;ReactionThermo&gt;::R(volScalarField&amp; Y) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">tmp&lt;fvScalarMatrix&gt; <span class="title">tSu</span><span class="params">(<span class="keyword">new</span> fvScalarMatrix(Y, dimMass/dimTime))</span></span>;</span><br><span class="line"></span><br><span class="line">    fvScalarMatrix&amp; Su = tSu.ref();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;active())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> label specieI =</span><br><span class="line">            <span class="keyword">this</span>-&gt;thermo().composition().species()[Y.member()];</span><br><span class="line"></span><br><span class="line">        Su += <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;RR(specieI);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> tSu;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:tmp&lt;Foam::volScalarField&gt;</span><br><span class="line">Foam::combustionModels::laminar&lt;ReactionThermo&gt;::Qdot() <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    tmp&lt;volScalarField&gt; tQdot</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">new</span> volScalarField</span><br><span class="line">        (</span><br><span class="line">            IOobject</span><br><span class="line">            (</span><br><span class="line">                <span class="keyword">this</span>-&gt;thermo().phasePropertyName(typeName + <span class="string">":Qdot"</span>),</span><br><span class="line">                <span class="keyword">this</span>-&gt;mesh().time().timeName(),</span><br><span class="line">                <span class="keyword">this</span>-&gt;mesh(),</span><br><span class="line">                IOobject::NO_READ,</span><br><span class="line">                IOobject::NO_WRITE,</span><br><span class="line">                <span class="literal">false</span></span><br><span class="line">            ),</span><br><span class="line">            <span class="keyword">this</span>-&gt;mesh(),</span><br><span class="line">            dimensionedScalar(<span class="string">"Qdot"</span>, dimEnergy/dimVolume/dimTime, <span class="number">0.0</span>)</span><br><span class="line">        )</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;active())</span><br><span class="line">    &#123;</span><br><span class="line">        tQdot.ref() = <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;Qdot();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> tQdot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="rts"><a class="markdownIt-Anchor" href="#rts"></a> RTS</h2><h3 id="declareruntimeselectiontable"><a class="markdownIt-Anchor" href="#declareruntimeselectiontable"></a> declareRunTimeSelectionTable</h3><p>首先在源代码中全局搜索发现 <code>declareRunTimeSelectionTable</code> 函数在 <code>CombustionModel.H</code> 中被调用。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">declareRunTimeSelectionTable</span><br><span class="line">(</span><br><span class="line">    autoPtr,</span><br><span class="line">    CombustionModel,</span><br><span class="line">    dictionary,</span><br><span class="line">    (</span><br><span class="line">        const word&amp; modelType,</span><br><span class="line">        ReactionThermo&amp; thermo,</span><br><span class="line">        const compressibleTurbulenceModel&amp; turb,</span><br><span class="line">        const word&amp; combustionProperties</span><br><span class="line">    ),</span><br><span class="line">    (modelType, thermo, turb, combustionProperties)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>而这个函数定义于 <code>\src\OpenFOAM\db\runTimeSelection\construction\runTimeSelectionTables.H</code> 中：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#define declareRunTimeSelectionTable(autoPtr,baseType,argNames,argList,parList)\</span><br><span class="line">    typedef autoPtr&lt;baseType&gt; (*argNames##ConstructorPtr)argList;              \</span><br><span class="line">    typedef HashTable&lt;argNames##ConstructorPtr, word, string::hash&gt;            \</span><br><span class="line">        argNames##ConstructorTable;                                            \</span><br><span class="line">    static argNames##ConstructorTable* argNames##ConstructorTablePtr_;         \</span><br><span class="line">    static void construct##argNames##ConstructorTables();                      \</span><br><span class="line">    template&lt;class baseType##Type&gt;                                             \</span><br><span class="line">    class add##argNames##ConstructorToTable                                    \</span><br><span class="line">    &#123;                                                                          \</span><br><span class="line">    public:                                                                    \</span><br><span class="line">        static autoPtr&lt;baseType&gt; New argList                                   \</span><br><span class="line">        &#123;                                                                      \</span><br><span class="line">            return autoPtr&lt;baseType&gt;(new baseType##Type parList);              \</span><br><span class="line">        &#125;                                                                      \</span><br><span class="line">                                                                               \</span><br><span class="line">        add##argNames##ConstructorToTable                                      \</span><br><span class="line">        (                                                                      \</span><br><span class="line">            const word&amp; lookup &#x3D; baseType##Type::typeName                      \</span><br><span class="line">        )                                                                      \</span><br><span class="line">        &#123;                                                                      \</span><br><span class="line">            construct##argNames##ConstructorTables();                          \</span><br><span class="line">            argNames##ConstructorTablePtr_-&gt;insert(lookup, New);               \</span><br><span class="line">        &#125;                                                                      \</span><br><span class="line">    &#125;;                                                                         \</span><br></pre></td></tr></table></figure><ul><li>定义一个函数指针，这样定义的结果是， <code>dictionaryConstructorPtr</code> 代表一个指向参数为 <code>argList</code>，返回类型为 <code>autoPtr&lt; baseType&gt;</code> 的函数指针。</li><li>将一个 key 和 value 分别为 <code>word</code> 和 <code>dictionaryConstructorPtr</code> 的 <code>HashTable</code> 重命名为 <code>argNames##ConstructorTable</code>，即 <code>dictionaryConstructorTable</code>，并创建了一个以它为类型的指针 <code>argNames##ConstructorTablePtr_</code>，即 <strong><code>dictionaryConstructorTablePtr_</code></strong>。</li><li>申明一个类：<code>add##argNames##ConstructorToTable</code>，即 <code>adddictionaryConstructorToTable</code>，它需要模板 <code>baseType##Type</code>，其中的 <code>baseType</code> 是 <code>CombustionModel</code>。</li><li>类中定义了 <code>New</code> 函数，<code>argList</code> 是其形参列表，<code>parList</code> 是返回的 <code>baseType##Type</code> 的构造函数的形参列表。注意，这里调用了<strong>基类的构造函数</strong>！！！</li><li>但是如果我们在派生类中创建这个 add 类的对象的话，它的模板则是派生类，就是说 New 函数的返回值是指向派生类对象基类指针。</li><li>在 <code>add##argNames##ConstructorToTable</code> 的构造函数中，向 <strong><code>dictionaryConstructorTablePtr_</code></strong> 中 <code>insert</code> 了一组 key and value：<br>key 是 <code>typeName</code>，vaule 是 返回 <em>基类 <code>autoPtr</code></em> 的 <code>New</code> 函数。</li></ul><h3 id="definetemplateruntimeselectiontable"><a class="markdownIt-Anchor" href="#definetemplateruntimeselectiontable"></a> defineTemplateRunTimeSelectionTable</h3><p><code>defineTemplateRunTimeSelectionTable</code> 函数被发现调用于 <code>makeCombustionTypes.H</code> 中的 <code>makeCombustion</code> 函数中。<br>而 <code>makeCombustion</code> 函数在 <code>CombustionModels.C</code> 中被调用：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">makeCombustion(psiReactionThermo);</span><br></pre></td></tr></table></figure><p>具体看看这个函数：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#define makeCombustion(Comp)                                                   \</span><br><span class="line">                                                                               \</span><br><span class="line">    typedef CombustionModel&lt;Comp&gt; CombustionModel##Comp;                       \</span><br><span class="line">                                                                               \</span><br><span class="line">    defineTemplateTypeNameAndDebugWithName                                     \</span><br><span class="line">    (                                                                          \</span><br><span class="line">        CombustionModel##Comp,                                                 \</span><br><span class="line">        (                                                                      \</span><br><span class="line">            word(CombustionModel##Comp::typeName_()) + &quot;&lt;&quot; + Comp::typeName    \</span><br><span class="line">          + &quot;&gt;&quot;                                                                \</span><br><span class="line">        ).c_str(),                                                             \</span><br><span class="line">        0                                                                      \</span><br><span class="line">    );                                                                         \</span><br><span class="line">                                                                               \</span><br><span class="line">    defineTemplateRunTimeSelectionTable                                        \</span><br><span class="line">    (                                                                          \</span><br><span class="line">        CombustionModel##Comp,                                                 \</span><br><span class="line">        dictionary                                                             \</span><br><span class="line">    );</span><br></pre></td></tr></table></figure><p>首先 <code>defineTemplateTypeNameAndDebugWithName</code> 函数创建了一个 <code>word</code> 名字是 <code>typeName</code> 值是 <code>Name</code>，即 <code>laminar&lt;psiReactionThermo&gt;</code>。</p><p>其次是调用 <code>defineTemplateRunTimeSelectionTable</code> 函数，它定义于 <code>\src\OpenFOAM\db\runTimeSelection\construction\runTimeSelectionTables.H</code> 中。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#define defineTemplateRunTimeSelectionTable(baseType,argNames)                 \</span><br><span class="line">    defineRunTimeSelectionTablePtr(baseType,argNames);                         \</span><br><span class="line">    defineRunTimeSelectionTableConstructor(baseType,argNames);                 \</span><br><span class="line">    defineRunTimeSelectionTableDestructor(baseType,argNames)</span><br></pre></td></tr></table></figure><p>这里的 <code>baseType</code> 是 <code>CombustionModel##psiReactionThermo</code>，<code>argNames</code> 是 <code>dictionary</code>。<br>包括三个宏函数，第一个函数定义了一个类型为 <code>dictionary##ConstructorTable</code> （即 HashTable 的别名）的名字为 <code>dictionary##ConstructorTablePtr_</code> 的空指针。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#define defineRunTimeSelectionTablePtr(baseType,argNames)                      \</span><br><span class="line">    baseType::argNames##ConstructorTable*                                      \</span><br><span class="line">        baseType::argNames##ConstructorTablePtr_ &#x3D; nullptr</span><br></pre></td></tr></table></figure><p>第二个函数定义了一个函数，名为 <code>constructdictionaryConstructorTables()</code>，作用是创建了一个类型为 <code>dictionaryConstructorTable</code>，名字为 <code>dictionaryConstructorTablePtr_</code> 的对象。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#define defineRunTimeSelectionTableConstructor(baseType,argNames)              \</span><br><span class="line">    void baseType::construct##argNames##ConstructorTables()                    \</span><br><span class="line">    &#123;                                                                          \</span><br><span class="line">            baseType::argNames##ConstructorTablePtr_                           \</span><br><span class="line">                &#x3D; new baseType::argNames##ConstructorTable;                    \</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>第三个函数定义了一个函数（后来在 <code>add##argNames##ConstructorToTable</code> 的析构函数中被调用），名字是 <code>destroydictionaryConstructorTables()</code>。</p><h3 id="创建对象"><a class="markdownIt-Anchor" href="#创建对象"></a> 创建对象</h3><p>我们在创建燃烧模型的对象时（<code>createFields.H</code>）是这样的：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt; &quot;Creating reaction model\n&quot; &lt;&lt; endl;</span><br><span class="line">autoPtr&lt;CombustionModel&lt;psiReactionThermo&gt;&gt; reaction</span><br><span class="line">(</span><br><span class="line">    CombustionModel&lt;psiReactionThermo&gt;::New(thermo, turbulence())</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>调用的是 <code>CombustionModel</code> 中的 <code>New</code>：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;- Selector</span><br><span class="line">static autoPtr&lt;CombustionModel&gt; New</span><br><span class="line">(</span><br><span class="line">    ReactionThermo&amp; thermo,</span><br><span class="line">    const compressibleTurbulenceModel&amp; turb,</span><br><span class="line">    const word&amp; combustionProperties&#x3D;combustionPropertiesName &#x2F;&#x2F;默认值是 combustionPropertiesName</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>定义于它的 C 文件中，返回类型是 <code>autoPtr&lt;CombustionModel&gt;</code>，<code>CombustionModel</code> 需要一个模板，我们给它的是 <code>psiReactionThermo</code>。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">template&lt;class ReactionThermo&gt;</span><br><span class="line">Foam::autoPtr&lt;Foam::CombustionModel&lt;ReactionThermo&gt;&gt;</span><br><span class="line">Foam::CombustionModel&lt;ReactionThermo&gt;::New</span><br><span class="line">(</span><br><span class="line">    ReactionThermo&amp; thermo,</span><br><span class="line">    const compressibleTurbulenceModel&amp; turb,</span><br><span class="line">    const word&amp; combustionProperties</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    return</span><br><span class="line">        combustionModel::New&lt;CombustionModel&lt;ReactionThermo&gt;&gt;</span><br><span class="line">        &#x2F;&#x2F; 这里发现这个 New 调用时需要给它模板，我们给的就是 CombustionModel&lt;psiReactionThermo&gt;</span><br><span class="line">        (</span><br><span class="line">            thermo,</span><br><span class="line">            turb,</span><br><span class="line">            combustionProperties</span><br><span class="line">        );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用了它的基类 combustionModel（但没有在 C 文件中定义）的 New 函数：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; Selectors</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;- Generic New for each of the related chemistry model</span><br><span class="line">    template&lt;class CombustionModel&gt;</span><br><span class="line">    static autoPtr&lt;CombustionModel&gt; New</span><br><span class="line">    (</span><br><span class="line">        typename CombustionModel::reactionThermo&amp; thermo,</span><br><span class="line">        const compressibleTurbulenceModel&amp; turb,</span><br><span class="line">        const word&amp; combustionProperties</span><br><span class="line">    );</span><br></pre></td></tr></table></figure><p>上边这个 New 函数发现是在 <code>combustionModelTemplates.C</code> 中定义的。<br>这里的 <code>CombustionModel</code> 就是 <code>CombustionModel</code>，<code>reactionThermo</code> 是它的模板 <code>ReactionThermo</code>，我们在这里指定它为 <code>psiReactionThermo</code>。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">template&lt;class CombustionModel&gt;</span><br><span class="line">Foam::autoPtr&lt;CombustionModel&gt; Foam::combustionModel::New</span><br><span class="line">(</span><br><span class="line">    typename CombustionModel::reactionThermo&amp; thermo,</span><br><span class="line">    const compressibleTurbulenceModel&amp; turb,</span><br><span class="line">    const word&amp; combustionProperties</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    word combModelName(&quot;none&quot;);</span><br><span class="line">    IOdictionary(combIO).lookup(&quot;combustionModel&quot;) &gt;&gt; combModelName;</span><br><span class="line">    Info&lt;&lt; &quot;Selecting combustion model &quot; &lt;&lt; combModelName &lt;&lt; endl;</span><br><span class="line">    &#x2F;&#x2F; 字典 combustionProperties 里写的那个名字，如 laminar</span><br><span class="line"></span><br><span class="line">    typedef typename CombustionModel::dictionaryConstructorTable cstrTableType;</span><br><span class="line">&#x2F;&#x2F;这是在 declareRunTimeSelectionTable 中的那个 HashTable</span><br><span class="line">    cstrTableType* cstrTable &#x3D; CombustionModel::dictionaryConstructorTablePtr_;</span><br><span class="line">&#x2F;&#x2F;dictionaryConstructorTablePtr_ 在 declareRunTimeSelectionTable 申明过</span><br><span class="line">&#x2F;&#x2F; 并且在 constructdictionaryConstructorTables() 这个函数中分派了实际指向的对象。</span><br><span class="line">&#x2F;&#x2F;这个函数申明于 declareRunTimeSelectionTable，定义于 defineTemplateRunTimeSelectionTable</span><br><span class="line">&#x2F;&#x2F;而这个函数又在 adddictionaryConstructorToTable 的构造函数中被调用</span><br><span class="line">&#x2F;&#x2F;adddictionaryConstructorToTable，即 add##argNames##ConstructorToTable 在 declareRunTimeSelectionTable 中定义</span><br><span class="line"></span><br><span class="line">    const word compCombModelName &#x3D;</span><br><span class="line">        combModelName + &#39;&lt;&#39; + CombustionModel::reactionThermo::typeName + &#39;&gt;&#39;;</span><br><span class="line"></span><br><span class="line">    const word thermoCombModelName &#x3D;</span><br><span class="line">        combModelName + &#39;&lt;&#39; + CombustionModel::reactionThermo::typeName + &#39;,&#39;</span><br><span class="line">      + thermo.thermoName() + &#39;&gt;&#39;;</span><br><span class="line"></span><br><span class="line">    typename cstrTableType::iterator compCstrIter &#x3D;</span><br><span class="line">        cstrTable-&gt;find(compCombModelName);</span><br><span class="line">&#x2F;&#x2F;在哈希表中查询，key 是 laminar&lt;psiReactionThermo&gt; ，返回值是  返回指向基类autoPtr的New函数</span><br><span class="line">    typename cstrTableType::iterator thermoCstrIter &#x3D;</span><br><span class="line">        cstrTable-&gt;find(thermoCombModelName);</span><br><span class="line"></span><br><span class="line">    return autoPtr&lt;CombustionModel&gt;</span><br><span class="line">    (</span><br><span class="line">        thermoCstrIter !&#x3D; cstrTable-&gt;end()</span><br><span class="line">      ? thermoCstrIter()(combModelName, thermo, turb, combustionProperties)</span><br><span class="line">      : compCstrIter()(combModelName, thermo, turb, combustionProperties)</span><br><span class="line">      &#x2F;&#x2F;modeltype 从这里由 combModelName 传入！！！如 laminar</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>里边用到了一个类：<code>CombustionModel::dictionaryConstructorTable</code>，它是在 <code>declareRunTimeSelectionTable</code> 中定义的，就是那个哈希表的别名。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">typedef HashTable&lt;argNames##ConstructorPtr, word, string::hash&gt;</span><br><span class="line">    argNames##ConstructorTable; &#x2F;&#x2F;argNames 是 dictionary</span><br></pre></td></tr></table></figure><p>因为是在 <code>CombustionModel.H</code> 中调用的 <code>declareRunTimeSelectionTable</code>，于是 <code>CombustionModel::dictionaryConstructorTable</code> 就被定义好了。</p><h3 id="laminarsc"><a class="markdownIt-Anchor" href="#laminarsc"></a> laminars.C</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">makeCombustionTypes(laminar, psiReactionThermo);</span><br></pre></td></tr></table></figure><p>而这个函数定义于 makeCombustionTypes.H：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#define makeCombustionTypes(CombModel, Comp)                                   \</span><br><span class="line">                                                                               \</span><br><span class="line">    typedef combustionModels::CombModel&lt;Comp&gt; CombModel##Comp;                 \</span><br><span class="line">                                                                               \</span><br><span class="line">    defineTemplateTypeNameAndDebugWithName                                     \</span><br><span class="line">    (                                                                          \</span><br><span class="line">        CombModel##Comp,                                                       \</span><br><span class="line">        (                                                                      \</span><br><span class="line">            word(CombModel##Comp::typeName_()) + &quot;&lt;&quot; + Comp::typeName + &quot;&gt;&quot;    \</span><br><span class="line">        ).c_str(),                                                             \</span><br><span class="line">        0                                                                      \</span><br><span class="line">    );                                                                         \</span><br><span class="line">                                                                               \</span><br><span class="line">    CombustionModel&lt;Comp&gt;::                                                    \</span><br><span class="line">        add##dictionary##ConstructorToTable&lt;CombModel##Comp&gt;                   \</span><br><span class="line">        add##CombModel##Comp##dictionary##ConstructorTo##CombustionModel##Comp\</span><br><span class="line">##Table_;</span><br><span class="line">&#x2F;&#x2F;这句话的作用和 addToRunTimeSelectionTable 一致，都是创建一个 add 类的对象，创建它的同时，将返回 指向派生类对象的基类指针 的 New 函数插进了 HashTable，即 dictionaryConstructorTable。后续就是在这个里边 find 我们在字典文件中指定的派生类。</span><br></pre></td></tr></table></figure><p>CombModel 是 laminar，Comp 是 psiReactionThermo<br>将 <code>combustionModels::laminar&lt;psiReactionThermo&gt;</code> 重命名为 <code>laminar##psiReactionThermo</code>。<br>在 <code>CombustionModel&lt;psiReactionThermo&gt;</code> 的命名空间下，<br>创建了类型为 <code>adddictionaryConstructorToTable&lt;laminar##psiReactionThermo&gt;</code> 的对象。于是在这里调用了 <code>adddictionaryConstructorToTable</code> 的构造函数！！！倒退至前边所述，这个构造函数中调用了 <code>constructdictionaryConstructorTables()</code>，作用是给 <code>dictionaryConstructorTablePtr_</code> new 一个对象，类型是 <code>dictionaryConstructorTable</code> ，即 <code>HashTable</code>。并且构造函数中还向该<code>dictionaryConstructorTablePtr_</code> insert 了 New 函数：<br>这个函数 <code>new</code> 了一个对象，并将其绑定至基类的指针，该对象的类型是 <code>baseType##Type</code>，即 <code>add</code> 这个类的模板的类型，而我们在这里给它的模板是 laminar##psiReactionThermo。就是说，我们在派生类中创建add这个类的对象时，同时向哈希表中插入了一组key and value，即派生类的typeName和返回指向派生类对象的基类指针的New函数！</p><h3 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h3><p><code>declareRunTimeSelectionTable</code> 创建了一个哈希表的指针 <code>argNames##ConstructorTablePtr_</code>，但是没有给它分配对象。只有当创建第一个 <code>add##argNames##ConstructorToTable&lt;baseType##Type&gt;</code> 对象时，才会 <code>new</code> 一个<code>baseType::argNames##ConstructorTable</code> 对象给它指向。这是这个函数的功能：<code>construct##argNames##ConstructorTables</code>（申明于 <code>declareRunTimeSelectionTable(autoPtr,baseType,argNames,argList,parList)</code>，定义于<code>defineRunTimeSelectionTableConstructor(baseType,argNames)</code>）。<br>此外，创建每个 <code>add##argNames##ConstructorToTable&lt;baseType##Type&gt;</code> 对象时，都会调用它的构造函数，该构造函数数向 <code>argNames##ConstructorTablePtr_</code> 插入一组 key and value：<code>baseType##Type::typeName</code> 和 <code>New</code> 函数。<br>说起这个 <code>New</code> 函数，那就大有来头，它返回基类指针，但是指向的对象类型是 <code>baseType##Type</code>，即<code>add##argNames##ConstructorToTable&lt;baseType##Type&gt;</code> 这个类的模板。<br>我们经常在派生类中创建一个 <code>add</code> 的对象，如：<code>laminars.C</code> 中的 <code>makeCombustionTypes</code> 中的：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CombustionModel&lt;Comp&gt;::add##dictionary##ConstructorToTable&lt;CombModel##Comp&gt;</span><br><span class="line">        add##CombModel##Comp##dictionary##ConstructorTo##CombustionModel##Comp##Table_;</span><br></pre></td></tr></table></figure><p>模板是 <code>laminar##psiReactionThermo</code>，即往哈希表中插入的 <code>New</code> 函数，返回值是基类指针，指向的是 <code>laminar##psiReactionThermo</code> 的对象</p><h1 id="of-8"><a class="markdownIt-Anchor" href="#of-8"></a> OF-8</h1><h2 id="uml-类图-2"><a class="markdownIt-Anchor" href="#uml-类图-2"></a> UML 类图</h2><p>首先给出 UML 图，右键在新标签页中打开链接，可以获得更好的阅读体验。</p><details><summary>OF-8 UML!</summary><img src="http://www.plantuml.com/plantuml/svg/rLhTR-Eu4NzU_nL43Z0SnDuxND_YDC1jFh0fBhUfxJuSYiAW9Ifc8qi-ad9YRFE_bwGeYQH8MLASNBiFMOSSpWn_yy6PSG00Tzz2732S9f3imSL_9c7wd4p02b8SNAtH1bD6zlTfYE8102288QMkpUzYL_nRBi43IHaA60f121daAyNU3q6QK0QYtJsYwo7Oy9_LtlmPis0DWeAjVOe6C8O4S5aCBeJmkmGVfBc7BnNDBetdak0MepWyFxzB6289Z3NwfVCQzsYpGWJSPea4YkfNmacC4mHyl8SQyz6ffWeEGP0ImWLKorneWwWp9QeEukWqNxGfRKXhT3jCMCO1YE4AnI2PRr60KK45_Wf-yb7E49JwEMaDFTi1uz7h48lPR9IJv6hX9isxS76TPvljXO_79U2hGHP3XYncPqGXXSVwCfL87z1Nk4Z1TkHMIZayJUCT6ZbYeECfUQrXuzaw39U01Oq-uphozp1bzg7NWVZfI2vLMlhYI4jRYWjtNAmHsQJWulDd5oKu1oPXbT4Sr1ScxMMx36SU6W8c_rzsYt0taofFc17cewvYAWVsInEmSmQJ49AmdlA_NT_CzvIXZI1k8do4z6kkmyDwpqLHQGStFJT5JhhORr5b1ZUnPOcnTjIo2jxnK6b2UCBliHNnT94Bl9QUBZcvegBQBeEYbHSyCF8hrz_s-Y7utNwnYgj9SkrUeCWRT3crZXJCDUgXIYWBqzj-CF9wRRcGNMqe21PI-A7hwEblDgkeDnc3gnZfAGK4pTjX4BBUJ-z1xMI6x_N85gmBf7JCETlIHhu7kAN1lE-VOkDydWyGso-qhPfXwcQYOKdbVgJI3Ng4hdSa61jFqiByTJis7ntk0xwhgHEw89T9k4N6lTKOWcrKVWoYiSHn2E8PgfQtfA8W1GNX56qKlnkf-g9G_NzCLxlWq08ctI52S8YJHm1NF2zp_K5KHWzEN8_svw_UiEfSqBsbc3jI8LV4-br37TUzFEjRcdKiopgNP5ripmi4fwsjbk7c3qUUD7mlHF81npj4JR2OEr9Qfm_9_TymI5SO9lrOgvNv7naaw1uoWb_uHXG6TS084kuJ0fPMdTTSs9C8a3wPMkM6BcEs3Dd5s9aMSYnZNDBb_b3-IhFLjIhU7QLrNlEK1TttbazYWo7zdOlNc2yknFSMullmvQ04jq5RiO_25vz1zqxaF5LiMJvRXZxtJKuikWkJxhAhHJxMXSGjB8UMBK6INfdBNigRB4RaZbVWEC3CIyMX60m6EM3ySnsaJrgnVwrAxqyJROmLf2YAw3KMHUodIL5nmeobl1Qx404WnLqAzlb7dSueN1VRfPJdCiV7nlA0kwB0p3sm2zBDAgDYsNOvS-FjWxfyZxFT4aGfveWjChBYbaq294Nm5fGlr2PxultSQLr8pLwsYEUKX60ZE8hgRlbUKxAMzyaNcfcOJoeljzQfxu1uWMb68XWWunNUhd6pZ1pDeOApcRQ2UAWmRdw1oucaTuuJxN9jyup96x-HVUVVZpSAibotSlQhkhExfq0MOSC4oA9iclwqoSpUeOmBbJPp71EPAnyo-U5gMn3RQnKrvLLTZEOCRSqJhlNgrEty-Z1HYACeewtuuIJ22MOetjz2oifiFz1g5liAJlEyLlGkWVOOoJL5EgiM0QRraPObXYDnYAj6NKBIuOm7cyCS6hsav6EQNKL2VRFVBBHuRriCLo-hIe2VM1ufs7e5cWPV7OWAmXXkC4-i5MngeHcgl6QnW9giqbICRnXw9ABnL0nc_7FteLYxHh1BVLdxcghdWz3vCPXC9byHPAAXGf0Y8C01_tnw_77p8_tBlshi98gyJGzpJMKGAQDKPdk0yvbpu-RwQk2VOXSsSJuW-H20dfypzV288hOWgnoad5Yr2gPDRfx8PMDfbc8WCMVaLnInqJV-WMSz_XF1JJMRjC2ldPtXntNRmrn1tWWn7DWUV4RpPTKX_YFv3MvGMDoJJcswOheLfy_NA89PpCHGdskYVflga6Ihk938U8AZfboI1KnPu4fMEDfHnwv-M4s8aX2zQ1gg0GnBSR2MPsfxw6MR9YXXseOceMX7SwTOY8wYcFRICRYZ2c9CJwSjKeDM2ISSKtl3AQKYacDdNRbB4A-Rzuc-JwLNwExIqbCcUKE4c1fmvzf-XNJDqxlKrew28WsBVcx5extNl5xWD9H05JbawfjxSzSxI2CyqakKIwmZE1GGDvVbhaDaJGzy3UuwzTZpc4l51e-gYv0Z7f6hhVbqm_JQCropyHN_9Fle6EoZclayNrdqqhsQETQIn1ib76F2F_LDbv-Y7effVOYVCJ4PFqNFuVXZHBs1iVJbvp3eRorpYlWtx_XugBu9Ad-L09M_h4gqL2qJPW4gbcGSIoFp00v-fcx7vlTOzBc7GQEKF61AgQxx_gqlOOp2v4kyEEIyuLFKwufjd2fy8aU0JsfeOKKQnMlWBB9jZ7xECHghu-AxvXLYSDJ89BT_WD_YoANBuh0TO9pm6CPurPlz6TeX8WTnzPAP5u1Zg_VL-wLMxPP-03mjfoqh3I5RrBMZ4r8gU7BwBadsWnBikoJNzmhSFp5etnom7nQixnMeqxAZBZlXl2ss8rLlaDMVTlawwgQZPMzz2-FuMnGP8NlmkA3IXdHr5XS6wRWKKyHzZpJoKvL7h9sx9DBsB4dWLjjZQqp2BsculuaYpElkHDJUmBcgdMhmGkc4hHESQivbioawxT7fTu9OHX83hVFpV0-SsQXfEoTgwsJwwcckqYqYaALaTFe6hopw1PDrU9mqKs_PseHw0LcEVEtsxnxt5XHzmxwQWlv2o1ebEAEr67J5fYy8dLpQH9bIynVDuTMIwTl5wk8O_dvIgllE3kmpsv_fmTF_Lv-rdwe5IP6TRlr-Qr5gtptLsNHmN1XlroutfPGkn_m_-OCUmsU5djtTrQfv7aXNrtmm_-OIt5frrGEnwwh5GH51Pn51WuZNmNy1"></details><p>我猜测：<code>ArrheniusReactionRate</code> 也可以直接作为 <code>ReversibleReaction</code> 的模板，而不通过 <code>FallOffReactionRate</code>。</p><p><code>Reaction</code> 的模板是 <code>gasHThermoPhysics</code>，<code>Reaction</code> 的基类是 <code>Foam::species::thermo</code>，全称是 <code>Foam::species::thermo&lt; Foam::janafThermo&lt;Foam::perfectGas&lt;Foam::specie&gt;&gt;, Foam::sensibleEnthalpy&gt;</code>。</p><p><code>ReversibleReaction</code> 的模板是 <code>Reaction</code>，<code>gasHThermoPhysics</code> 和 <code>FallOffReactionRate</code>。而 <code>FallOffReactionRate</code> 的模板是 <code>ArrheniusReactionRate</code> 和 <code>TroeFallOffFunction</code>。<br><code>ReversibleReaction</code> 的基类是 <code>Reaction&lt;gasHThermoPhysics&gt;</code>。</p><p>疑问：</p><ul><li>机理文件怎么读取的？</li><li><code>Reaction</code> 等相关类的对象在哪里创建的？</li></ul><p>尝试解答：<br>在 <code>StandardChemistryModel</code> 中申明了反应的 list：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> ReactionList&lt;ThermoType&gt; reactions_;</span><br></pre></td></tr></table></figure><p><code>StandardChemistryModel</code> 的构造函数中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">reactions_</span><br><span class="line">(</span><br><span class="line">	<span class="keyword">dynamic_cast</span>&lt;<span class="keyword">const</span> multiComponentMixture&lt;ThermoType&gt;&amp;&gt;(<span class="keyword">this</span>-&gt;thermo()).species(),</span><br><span class="line">	specieThermo_,</span><br><span class="line">	<span class="keyword">this</span>-&gt;mesh(),</span><br><span class="line">	*<span class="keyword">this</span></span><br><span class="line">),</span><br></pre></td></tr></table></figure><p>调用的是 ReactionList 的构造函数</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ThermoType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:ReactionList&lt;ThermoType&gt;::ReactionList</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> speciesTable&amp; species,</span><br><span class="line">    <span class="keyword">const</span> PtrList&lt;ThermoType&gt;&amp; speciesThermo,</span><br><span class="line">    <span class="keyword">const</span> objectRegistry&amp; ob,</span><br><span class="line">    <span class="keyword">const</span> dictionary&amp; dict</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Set general temperature limits from the dictionary</span></span><br><span class="line">    Reaction&lt;ThermoType&gt;::TlowDefault =</span><br><span class="line">        dict.lookupOrDefault&lt;scalar&gt;(<span class="string">"Tlow"</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    Reaction&lt;ThermoType&gt;::ThighDefault =</span><br><span class="line">        dict.lookupOrDefault&lt;scalar&gt;(<span class="string">"Thigh"</span>, great);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">const</span> dictionary&amp; <span class="title">reactions</span><span class="params">(dict.subDict(<span class="string">"reactions"</span>))</span></span>;</span><br><span class="line"></span><br><span class="line">    HashPtrTable&lt;ThermoType&gt; thermoDatabase;</span><br><span class="line">    forAll(speciesThermo, i)</span><br><span class="line">    &#123;</span><br><span class="line">        thermoDatabase.insert</span><br><span class="line">        (</span><br><span class="line">            speciesThermo[i].name(),</span><br><span class="line">            speciesThermo[i].clone().ptr()</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>-&gt;setSize(reactions.<span class="built_in">size</span>());</span><br><span class="line">    label i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    forAllConstIter(dictionary, reactions, iter)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;<span class="built_in">set</span></span><br><span class="line">        (</span><br><span class="line">            i++,</span><br><span class="line">            Reaction&lt;ThermoType&gt;::New</span><br><span class="line">            (</span><br><span class="line">                species,</span><br><span class="line">                thermoDatabase,</span><br><span class="line">                ob,</span><br><span class="line">                reactions.subDict(iter().keyword())</span><br><span class="line">            ).ptr()</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>this-&gt;thermo()</code> 返回的是 <code>BasicChemistryModel</code> 中申明的 <code>ReactionThermo&amp; thermo_</code>，这里模板 <code>ReactionThermo</code> 的实例是 <code>psiReactionThermo</code>。<br><code>thermo_</code> 由构造函数中的 <code>thermo</code> 传入。</p><p>有这个疑问是因为 solver 中创建 <code>thermo</code> 的时候用的是 <code>psiReactionThermo</code>，但是后来实际上的对象是 <code>hePsiThermo</code> 类型的。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">autoPtr&lt;psiReactionThermo&gt; <span class="title">pThermo</span><span class="params">(psiReactionThermo::New(mesh))</span></span>;</span><br><span class="line">psiReactionThermo&amp; thermo = pThermo();</span><br></pre></td></tr></table></figure><p>在代码还没运行的时候，我们不知道 thermo 是 <code>hePsiThermo</code> 类型，那代码中为什么可以这样转换类型呢？</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">dynamic_cast</span>&lt;<span class="keyword">const</span> multiComponentMixture&lt;ThermoType&gt;&amp;&gt;(<span class="keyword">this</span>-&gt;thermo())</span><br></pre></td></tr></table></figure><p>StandardChemistryModel::calculateRR 中使用了 Reaction 中的函数 omega</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Reaction&lt;ThermoType&gt;&amp; R = reactions_[ri];</span><br><span class="line"><span class="keyword">const</span> scalar omegai = R.omega(pi, Ti, c_, pf, cf, lRef, pr, cr, rRef);</span><br></pre></td></tr></table></figure><p>在 dev 版本的 reactingFoam 中，创建了哪些和燃烧化学相关的对象呢？</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">autoPtr&lt;psiReactionThermo&gt; pThermo(psiReactionThermo::New(mesh));</span><br><span class="line">psiReactionThermo&amp; thermo &#x3D; pThermo();</span><br><span class="line">basicSpecieMixture&amp; composition &#x3D; thermo.composition();</span><br><span class="line">PtrList&lt;volScalarField&gt;&amp; Y &#x3D; composition.Y();</span><br><span class="line">autoPtr&lt;CombustionModel&lt;psiReactionThermo&gt;&gt; reaction</span><br><span class="line">(</span><br><span class="line">    CombustionModel&lt;psiReactionThermo&gt;::New(thermo, turbulence())</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><code>reaction</code> 如何使用呢？在 <code>YEqn.H</code> 中</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">reaction-&gt;correct();</span><br><span class="line">Qdot = reaction-&gt;Qdot();</span><br></pre></td></tr></table></figure><p>另外组分方程的源项也通过它调用：<code>reaction-&gt;R(Yi)</code>。</p><p>结合上边的 UML 图，这里的 <code>reaction</code> 的类型实际上是 <code>laminar</code>。<br>函数 <code>correct()</code> 的关键代码是：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>-&gt;chemistryPtr_-&gt;solve(<span class="keyword">this</span>-&gt;mesh().time().deltaTValue());</span><br></pre></td></tr></table></figure><p>其中的 <code>chemistryPtr_</code> 定义于 <code>laminar</code> 的基类 <code>ChemistryCombustion</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">autoPtr&lt;BasicChemistryModel&lt;ReactionThermo&gt;&gt; chemistryPtr_;</span><br></pre></td></tr></table></figure><p>BasicChemistryModel 中没有solve函数，为什么可以这样用呢：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>-&gt;chemistryPtr_-&gt;solve(<span class="keyword">this</span>-&gt;mesh().time().deltaTValue());</span><br></pre></td></tr></table></figure><p>原因在此：<br><code>ChemistryCombustion</code> 的构造函数中，初始化了 <code>chemistryPtr_(BasicChemistryModel&lt;ReactionThermo&gt;::New(thermo))</code>。<br>而这个 New 函数返回的又是 <code>basicChemistryModel::New</code>，这个 <code>basicChemistryModel::New</code> 函数才是真正的用于 RTS 的 Selector。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:autoPtr&lt;Foam::BasicChemistryModel&lt;ReactionThermo&gt;&gt;</span><br><span class="line">Foam::BasicChemistryModel&lt;ReactionThermo&gt;::New(ReactionThermo&amp; thermo)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> basicChemistryModel::New&lt;BasicChemistryModel&lt;ReactionThermo&gt;&gt;</span><br><span class="line">    (</span><br><span class="line">        thermo</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>也就是说，<code>chemistryPtr_</code> 实际上是指向最底层的 <code>basicChemistryModel</code> 的指针，而 <code>basicChemistryModel</code> 中定义了 <code>solve</code> 等纯虚函数，这样就能解释的通了。</p><p><code>basicChemistryModel::New</code></p><p>template<class chemistrymodel=""><br>Foam::autoPtr<chemistrymodel>Foam::basicChemistryModel::New<br>(<br>typename ChemistryModel::reactionThermo&amp; thermo<br>)<br>{<br>IOdictionary chemistryDict<br>(<br>IOobject<br>(<br>thermo.phasePropertyName(“chemistryProperties”),<br>thermo.db().time().constant(),<br>thermo.db(),<br>IOobject::MUST_READ,<br>IOobject::NO_WRITE,<br>false<br>)<br>);</chemistrymodel></class></p><pre><code>if (!chemistryDict.isDict(&quot;chemistryType&quot;))
{
    FatalErrorInFunction
        &lt;&lt; &quot;Template parameter based chemistry solver selection is no &quot;
        &lt;&lt; &quot;longer supported. Please create a chemistryType dictionary&quot;
        &lt;&lt; &quot;instead.&quot; &lt;&lt; endl &lt;&lt; endl &lt;&lt; &quot;For example, the entry:&quot; &lt;&lt; endl
        &lt;&lt; &quot;    chemistrySolver ode&lt;StandardChemistryModel&lt;&quot;
        &lt;&lt; &quot;rhoChemistryModel,sutherlandspecie&lt;janaf&lt;perfectGas&gt;,&quot;
        &lt;&lt; &quot;sensibleInternalEnergy&gt;&gt;&quot; &lt;&lt; endl &lt;&lt; endl &lt;&lt; &quot;becomes:&quot; &lt;&lt; endl
        &lt;&lt; &quot;    chemistryType&quot; &lt;&lt; endl &lt;&lt; &quot;    {&quot; &lt;&lt; endl
        &lt;&lt; &quot;        solver ode;&quot; &lt;&lt; endl &lt;&lt; &quot;        method standard;&quot;
        &lt;&lt; endl &lt;&lt; &quot;    }&quot; &lt;&lt; exit(FatalError);
}

const dictionary&amp; chemistryTypeDict =
    chemistryDict.subDict(&quot;chemistryType&quot;);

const word&amp; solverName
(
    chemistryTypeDict.found(&quot;solver&quot;)
  ? chemistryTypeDict.lookup(&quot;solver&quot;)
  : chemistryTypeDict.found(&quot;chemistrySolver&quot;)
  ? chemistryTypeDict.lookup(&quot;chemistrySolver&quot;)
  : chemistryTypeDict.lookup(&quot;solver&quot;) // error if neither entry is found
);

const word&amp; methodName
(
    chemistryTypeDict.lookupOrDefault&lt;word&gt;
    (
        &quot;method&quot;,
        chemistryTypeDict.lookupOrDefault&lt;bool&gt;(&quot;TDAC&quot;, false)
      ? &quot;TDAC&quot;
      : &quot;standard&quot;
    )
);

dictionary chemistryTypeDictNew;
chemistryTypeDictNew.add(&quot;solver&quot;, solverName);
chemistryTypeDictNew.add(&quot;method&quot;, methodName);

Info&lt;&lt; &quot;Selecting chemistry solver &quot; &lt;&lt; chemistryTypeDictNew &lt;&lt; endl;

typedef typename ChemistryModel::thermoConstructorTable cstrTableType;
cstrTableType* cstrTable = ChemistryModel::thermoConstructorTablePtr_;

const word chemSolverCompThermoName =
    solverName + '&lt;' + methodName + '&lt;'
  + ChemistryModel::reactionThermo::typeName + ','
  + thermo.thermoName() + &quot;&gt;&gt;&quot;;

typename cstrTableType::iterator cstrIter =
    cstrTable-&gt;find(chemSolverCompThermoName);

if (cstrIter == cstrTable-&gt;end())
{
    FatalErrorInFunction
        &lt;&lt; &quot;Unknown &quot; &lt;&lt; typeName_() &lt;&lt; &quot; type &quot; &lt;&lt; solverName &lt;&lt; endl
        &lt;&lt; endl;

    const wordList names(cstrTable-&gt;toc());

    wordList thisCmpts;
    thisCmpts.append(word::null);
    thisCmpts.append(word::null);
    thisCmpts.append(ChemistryModel::reactionThermo::typeName);
    thisCmpts.append(basicThermo::splitThermoName(thermo.thermoName(), 5));

    List&lt;wordList&gt; validNames;
    validNames.append(wordList(2, word::null));
    validNames[0][0] = &quot;solver&quot;;
    validNames[0][1] = &quot;method&quot;;
    forAll(names, i)
    {
        const wordList cmpts(basicThermo::splitThermoName(names[i], 8));

        bool isValid = true;
        for (label i = 2; i &lt; cmpts.size() &amp;&amp; isValid; ++ i)
        {
            isValid = isValid &amp;&amp; cmpts[i] == thisCmpts[i];
        }

        if (isValid)
        {
            validNames.append(SubList&lt;word&gt;(cmpts, 2));
        }
    }

    FatalErrorInFunction
        &lt;&lt; &quot;All &quot; &lt;&lt; validNames[0][0] &lt;&lt; '/' &lt;&lt; validNames[0][1]
        &lt;&lt; &quot; combinations for this thermodynamic model are:&quot;
        &lt;&lt; endl &lt;&lt; endl;
    printTable(validNames, FatalErrorInFunction);

    FatalErrorInFunction &lt;&lt; endl;

    List&lt;wordList&gt; validCmpts;
    validCmpts.append(wordList(8, word::null));
    validCmpts[0][0] = &quot;solver&quot;;
    validCmpts[0][1] = &quot;method&quot;;
    validCmpts[0][2] = &quot;reactionThermo&quot;;
    validCmpts[0][3] = &quot;transport&quot;;
    validCmpts[0][4] = &quot;thermo&quot;;
    validCmpts[0][5] = &quot;equationOfState&quot;;
    validCmpts[0][6] = &quot;specie&quot;;
    validCmpts[0][7] = &quot;energy&quot;;
    forAll(names, i)
    {
        validCmpts.append(basicThermo::splitThermoName(names[i], 8));
    }

    FatalErrorInFunction
        &lt;&lt; &quot;All &quot; &lt;&lt; validCmpts[0][0] &lt;&lt; '/' &lt;&lt; validCmpts[0][1] &lt;&lt; '/'
        &lt;&lt; validCmpts[0][2] &lt;&lt; &quot;/thermoPhysics combinations are:&quot;
        &lt;&lt; endl &lt;&lt; endl;
    printTable(validCmpts, FatalErrorInFunction);

    FatalErrorInFunction &lt;&lt; exit(FatalError);
}

return autoPtr&lt;ChemistryModel&gt;(cstrIter()(thermo));
</code></pre><p>}</p><p>因此，实际调用的是派生类 <code>StandardChemistryModel::solve(const scalarField&amp; deltaT)</code>。它返回的是实际干活的 solve 函数。</p><p>实际干活的 solve 函数：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>, <span class="title">class</span> <span class="title">ThermoType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">template</span>&lt;class DeltaTType&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:scalar Foam::StandardChemistryModel&lt;ReactionThermo, ThermoType&gt;::solve</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> DeltaTType&amp; deltaT</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    BasicChemistryModel&lt;ReactionThermo&gt;::correct();</span><br><span class="line"></span><br><span class="line">    scalar deltaTMin = great;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>-&gt;chemistry_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> deltaTMin;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">tmp&lt;volScalarField&gt; <span class="title">trho</span><span class="params">(<span class="keyword">this</span>-&gt;thermo().rho())</span></span>;</span><br><span class="line">    <span class="keyword">const</span> scalarField&amp; rho = trho();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalarField&amp; T = <span class="keyword">this</span>-&gt;thermo().T();</span><br><span class="line">    <span class="keyword">const</span> scalarField&amp; p = <span class="keyword">this</span>-&gt;thermo().p();</span><br><span class="line"></span><br><span class="line">    <span class="function">scalarField <span class="title">c0</span><span class="params">(nSpecie_)</span></span>;</span><br><span class="line"></span><br><span class="line">    forAll(rho, celli)</span><br><span class="line">    &#123;</span><br><span class="line">        scalar Ti = T[celli];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (Ti &gt; Treact_)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">const</span> scalar rhoi = rho[celli];</span><br><span class="line">            scalar pi = p[celli];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (label i=<span class="number">0</span>; i&lt;nSpecie_; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                c_[i] = rhoi*Y_[i][celli]/specieThermo_[i].W();</span><br><span class="line">                c0[i] = c_[i];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Initialise time progress</span></span><br><span class="line">            scalar timeLeft = deltaT[celli];</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Calculate the chemical source terms</span></span><br><span class="line">            <span class="keyword">while</span> (timeLeft &gt; small)</span><br><span class="line">            <span class="comment">//这里应该体现了 time split 算法，不对啊，这里只循环了一次啊。因为dt进入solve之后并没有修改！</span></span><br><span class="line">            <span class="comment">//这样的话，运行一次之后，timeLeft就等于0了！</span></span><br><span class="line">            <span class="comment">//上述表述适用于ode求解器，但是选用EulerImplicit的话，确实是在这里time split</span></span><br><span class="line">            <span class="comment">//因为EulerImplicit中会更新dt，这样的话，这个while循环就会不止执行一次</span></span><br><span class="line">            <span class="comment">//ode的time split体现在别处</span></span><br><span class="line">            &#123;</span><br><span class="line">                scalar dt = timeLeft;</span><br><span class="line">                <span class="keyword">this</span>-&gt;solve(pi, Ti, c_, celli, dt, <span class="keyword">this</span>-&gt;deltaTChem_[celli]);</span><br><span class="line">                timeLeft -= dt;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            deltaTMin = <span class="built_in">min</span>(<span class="keyword">this</span>-&gt;deltaTChem_[celli], deltaTMin);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">this</span>-&gt;deltaTChem_[celli] =</span><br><span class="line">                <span class="built_in">min</span>(<span class="keyword">this</span>-&gt;deltaTChem_[celli], <span class="keyword">this</span>-&gt;deltaTChemMax_);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (label i=<span class="number">0</span>; i&lt;nSpecie_; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                RR_[i][celli] =</span><br><span class="line">                    (c_[i] - c0[i])*specieThermo_[i].W()/deltaT[celli];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (label i=<span class="number">0</span>; i&lt;nSpecie_; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                RR_[i][celli] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> deltaTMin;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在其中，调用了 6 参数的 <code>solve</code> 函数。6 参数的 <code>solve</code> 函数在继承自 <code>StandardChemistryModel</code> 的 <code>chemistrySolver</code> 中被申明为纯虚函数，实际上在 <code>EulerImplicit</code> 和 <code>ode</code> 中重新定义。所以这里的 <code>reaction-&gt;correct()</code> 就相当于在这里求解化学反应！</p><p>但是化学反应怎么求解的，本文还没有涉及到。<br>下面以 <code>ode</code> 为例分析一下：<br><code>ode::solve</code> 传进来的数据有 压力、温度、摩尔浓度、celli、dt、deltaTChem_。</p><p><code>ode::solve</code></p><p>在这个函数中，只有一个 const 参数，其余的传进来的数，都被该函数修改了！不对啊，<code>deltaT</code> 没有被修改啊！<code>deltaT</code> 传进了 5 参数的 <code>ODESolver::solve</code> 的第二个参数，但这个参数是 <code>const</code> 啊。<br><code>subDeltaT</code> 被修改了。<br>p T c 肯定是被修改了的。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ChemistryModel</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:ode&lt;ChemistryModel&gt;::solve</span><br><span class="line">(</span><br><span class="line">    scalar&amp; p,</span><br><span class="line">    scalar&amp; T,</span><br><span class="line">    scalarField&amp; c,</span><br><span class="line">    <span class="keyword">const</span> label li,</span><br><span class="line">    scalar&amp; deltaT,</span><br><span class="line">    scalar&amp; subDeltaT</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Reset the size of the ODE system to the simplified size when mechanism</span></span><br><span class="line">    <span class="comment">// reduction is active</span></span><br><span class="line">    <span class="keyword">if</span> (odeSolver_-&gt;resize())</span><br><span class="line">    &#123;</span><br><span class="line">        odeSolver_-&gt;resizeField(cTp_);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> label nSpecie = <span class="keyword">this</span>-&gt;nSpecie();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Copy the concentration, T and P to the total solve-vector</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;nSpecie; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cTp_[i] = c[i];</span><br><span class="line">    &#125;</span><br><span class="line">    cTp_[nSpecie] = T;</span><br><span class="line">    cTp_[nSpecie+<span class="number">1</span>] = p;</span><br><span class="line"></span><br><span class="line">    odeSolver_-&gt;solve(<span class="number">0</span>, deltaT, cTp_, li, subDeltaT);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;nSpecie; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        c[i] = <span class="built_in">max</span>(<span class="number">0.0</span>, cTp_[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    T = cTp_[nSpecie];</span><br><span class="line">    p = cTp_[nSpecie+<span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ode::solve</code> 中又调用了 <code>ODESolver::solve</code></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ode 的 time split 体现在这里！！！</span><br><span class="line"></span><br><span class="line">void Foam::ODESolver::solve</span><br><span class="line">(</span><br><span class="line">    const scalar xStart,</span><br><span class="line">    const scalar xEnd,</span><br><span class="line">    scalarField&amp; y,</span><br><span class="line">    const label li,</span><br><span class="line">    scalar&amp; dxTry</span><br><span class="line">) const</span><br><span class="line">&#123;</span><br><span class="line">    stepState step(dxTry);</span><br><span class="line">    scalar x &#x3D; xStart;</span><br><span class="line"></span><br><span class="line">    for (label nStep&#x3D;0; nStep&lt;maxSteps_; nStep++)</span><br><span class="line">    &#x2F;&#x2F; 这里是最大循环次数，但是中间可能退出循环</span><br><span class="line">    &#x2F;&#x2F; maxSteps_(dict.lookupOrDefault&lt;scalar&gt;(&quot;maxSteps&quot;, 10000))</span><br><span class="line">    &#x2F;&#x2F; 设置于chemistryProperties&#x2F;odeCoeffs中，与relTol相同的位置</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F; Store previous iteration dxTry</span><br><span class="line">        scalar dxTry0 &#x3D; step.dxTry;</span><br><span class="line"></span><br><span class="line">        step.reject &#x3D; false;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; Check if this is a truncated step and set dxTry to integrate to xEnd</span><br><span class="line">        if ((x + step.dxTry - xEnd)*(x + step.dxTry - xStart) &gt; 0)</span><br><span class="line">        &#123;</span><br><span class="line">            step.last &#x3D; true;</span><br><span class="line">            step.dxTry &#x3D; xEnd - x;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; Integrate as far as possible up to step.dxTry</span><br><span class="line">        solve(x, y, li, step);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; Check if reached xEnd</span><br><span class="line">        if ((x - xEnd)*(xEnd - xStart) &gt;&#x3D; 0)</span><br><span class="line">        &#123;</span><br><span class="line">            if (nStep &gt; 0 &amp;&amp; step.last)</span><br><span class="line">            &#123;</span><br><span class="line">                step.dxTry &#x3D; dxTry0;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            dxTry &#x3D; step.dxTry;</span><br><span class="line"></span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        step.first &#x3D; false;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; If the step.dxTry was reject set step.prevReject</span><br><span class="line">        if (step.reject)</span><br><span class="line">        &#123;</span><br><span class="line">            step.prevReject &#x3D; true;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    FatalErrorInFunction</span><br><span class="line">        &lt;&lt; &quot;Integration steps greater than maximum &quot; &lt;&lt; maxSteps_ &lt;&lt; nl</span><br><span class="line">        &lt;&lt; &quot;    xStart &#x3D; &quot; &lt;&lt; xStart &lt;&lt; &quot;, xEnd &#x3D; &quot; &lt;&lt; xEnd</span><br><span class="line">        &lt;&lt; &quot;, x &#x3D; &quot; &lt;&lt; x &lt;&lt; &quot;, dxDid &#x3D; &quot; &lt;&lt; step.dxDid &lt;&lt; nl</span><br><span class="line">        &lt;&lt; &quot;    y &#x3D; &quot; &lt;&lt; y</span><br><span class="line">        &lt;&lt; exit(FatalError);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中又调用了 <code>solve(scalar&amp; x,scalarField&amp; y,const label li,stepState&amp; step)</code>，这个函数在 <code>ODESolver</code>和它的派生类 <code>seulex</code> 中都定义了，那么这里应该是调用的是派生类的。不信的话，用 debug 模式验证一下。我验证过了，确实调用的 <code>seulex::solve</code>。</p><p><code>seulex::solve</code></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> Foam::seulex::solve</span><br><span class="line">(</span><br><span class="line">    scalar&amp; x,</span><br><span class="line">    scalarField&amp; y,</span><br><span class="line">    <span class="keyword">const</span> label li,</span><br><span class="line">    stepState&amp; <span class="built_in">step</span></span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    temp_[<span class="number">0</span>] = great;</span><br><span class="line">    scalar dx = <span class="built_in">step</span>.dxTry;</span><br><span class="line">    y0_ = y;</span><br><span class="line">    dxOpt_[<span class="number">0</span>] = mag(<span class="number">0.1</span>*dx);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">step</span>.first || <span class="built_in">step</span>.prevReject)</span><br><span class="line">    &#123;</span><br><span class="line">        theta_ = <span class="number">2</span>*jacRedo_;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">step</span>.first)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">NOTE:</span> the first element of relTol_ and absTol_ are used here.</span></span><br><span class="line">        scalar logTol = -<span class="built_in">log10</span>(relTol_[<span class="number">0</span>] + absTol_[<span class="number">0</span>])*<span class="number">0.6</span> + <span class="number">0.5</span>;</span><br><span class="line">        kTarg_ = <span class="built_in">max</span>(<span class="number">1</span>, <span class="built_in">min</span>(kMaxx_ - <span class="number">1</span>, <span class="keyword">int</span>(logTol)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    forAll(scale_, i)</span><br><span class="line">    &#123;</span><br><span class="line">        scale_[i] = absTol_[i] + relTol_[i]*mag(y[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> jacUpdated = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (theta_ &gt; jacRedo_)</span><br><span class="line">    &#123;</span><br><span class="line">        odes_.jacobian(x, y, li, dfdx_, dfdy_);</span><br><span class="line">        jacUpdated = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> k;</span><br><span class="line">    scalar dxNew = mag(dx);</span><br><span class="line">    <span class="keyword">bool</span> firstk = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (firstk || <span class="built_in">step</span>.reject)</span><br><span class="line">    &#123;</span><br><span class="line">        dx = <span class="built_in">step</span>.forward ? dxNew : -dxNew;</span><br><span class="line">        firstk = <span class="literal">false</span>;</span><br><span class="line">        <span class="built_in">step</span>.reject = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (mag(dx) &lt;= mag(x)*sqr(small))</span><br><span class="line">        &#123;</span><br><span class="line">             WarningInFunction</span><br><span class="line">                 &lt;&lt; <span class="string">"step size underflow :"</span>  &lt;&lt; dx &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        scalar errOld = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (k=<span class="number">0</span>; k&lt;=kTarg_+<span class="number">1</span>; k++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">bool</span> success = seul(x, y0_, li, dx, k, ySequence_, scale_);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!success)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">step</span>.reject = <span class="literal">true</span>;</span><br><span class="line">                dxNew = mag(dx)*stepFactor5_;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (k == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                 y = ySequence_;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                forAll(ySequence_, i)</span><br><span class="line">                &#123;</span><br><span class="line">                    table_[k<span class="number">-1</span>][i] = ySequence_[i];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (k != <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                extrapolate(k, table_, y);</span><br><span class="line">                scalar err = <span class="number">0</span>;</span><br><span class="line">                forAll(scale_, i)</span><br><span class="line">                &#123;</span><br><span class="line">                    scale_[i] = absTol_[i] + relTol_[i]*mag(y0_[i]);</span><br><span class="line">                    err += sqr((y[i] - table_(<span class="number">0</span>, i))/scale_[i]);</span><br><span class="line">                &#125;</span><br><span class="line">                err = <span class="built_in">sqrt</span>(err/n_);</span><br><span class="line">                <span class="keyword">if</span> (err &gt; <span class="number">1</span>/small || (k &gt; <span class="number">1</span> &amp;&amp; err &gt;= errOld))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">step</span>.reject = <span class="literal">true</span>;</span><br><span class="line">                    dxNew = mag(dx)*stepFactor5_;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                errOld = <span class="built_in">min</span>(<span class="number">4</span>*err, <span class="number">1</span>);</span><br><span class="line">                scalar expo = <span class="number">1.0</span>/(k + <span class="number">1</span>);</span><br><span class="line">                scalar facmin = <span class="built_in">pow</span>(stepFactor3_, expo);</span><br><span class="line">                scalar fac;</span><br><span class="line">                <span class="keyword">if</span> (err == <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    fac = <span class="number">1</span>/facmin;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    fac = stepFactor2_/<span class="built_in">pow</span>(err/stepFactor1_, expo);</span><br><span class="line">                    fac = <span class="built_in">max</span>(facmin/stepFactor4_, <span class="built_in">min</span>(<span class="number">1</span>/facmin, fac));</span><br><span class="line">                &#125;</span><br><span class="line">                dxOpt_[k] = mag(dx*fac);</span><br><span class="line">                temp_[k] = cpu_[k]/dxOpt_[k];</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> ((<span class="built_in">step</span>.first || <span class="built_in">step</span>.last) &amp;&amp; err &lt;= <span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span></span><br><span class="line">                (</span><br><span class="line">                    k == kTarg_ - <span class="number">1</span></span><br><span class="line">                 &amp;&amp; !<span class="built_in">step</span>.prevReject</span><br><span class="line">                 &amp;&amp; !<span class="built_in">step</span>.first &amp;&amp; !<span class="built_in">step</span>.last</span><br><span class="line">                )</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (err &lt;= <span class="number">1</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (err &gt; nSeq_[kTarg_]*nSeq_[kTarg_ + <span class="number">1</span>]*<span class="number">4</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="built_in">step</span>.reject = <span class="literal">true</span>;</span><br><span class="line">                        kTarg_ = k;</span><br><span class="line">                        <span class="keyword">if</span> (kTarg_&gt;<span class="number">1</span> &amp;&amp; temp_[k<span class="number">-1</span>] &lt; kFactor1_*temp_[k])</span><br><span class="line">                        &#123;</span><br><span class="line">                            kTarg_--;</span><br><span class="line">                        &#125;</span><br><span class="line">                        dxNew = dxOpt_[kTarg_];</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (k == kTarg_)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (err &lt;= <span class="number">1</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (err &gt; nSeq_[k + <span class="number">1</span>]*<span class="number">2</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="built_in">step</span>.reject = <span class="literal">true</span>;</span><br><span class="line">                        <span class="keyword">if</span> (kTarg_&gt;<span class="number">1</span> &amp;&amp; temp_[k<span class="number">-1</span>] &lt; kFactor1_*temp_[k])</span><br><span class="line">                        &#123;</span><br><span class="line">                            kTarg_--;</span><br><span class="line">                        &#125;</span><br><span class="line">                        dxNew = dxOpt_[kTarg_];</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (k == kTarg_+<span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (err &gt; <span class="number">1</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="built_in">step</span>.reject = <span class="literal">true</span>;</span><br><span class="line">                        <span class="keyword">if</span></span><br><span class="line">                        (</span><br><span class="line">                            kTarg_ &gt; <span class="number">1</span></span><br><span class="line">                         &amp;&amp; temp_[kTarg_<span class="number">-1</span>] &lt; kFactor1_*temp_[kTarg_]</span><br><span class="line">                        )</span><br><span class="line">                        &#123;</span><br><span class="line">                            kTarg_--;</span><br><span class="line">                        &#125;</span><br><span class="line">                        dxNew = dxOpt_[kTarg_];</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">step</span>.reject)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">step</span>.prevReject = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (!jacUpdated)</span><br><span class="line">            &#123;</span><br><span class="line">                theta_ = <span class="number">2</span>*jacRedo_;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (theta_ &gt; jacRedo_ &amp;&amp; !jacUpdated)</span><br><span class="line">                &#123;</span><br><span class="line">                    odes_.jacobian(x, y, li, dfdx_, dfdy_);</span><br><span class="line">                    jacUpdated = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    jacUpdated = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">step</span>.dxDid = dx;</span><br><span class="line">    x += dx;</span><br><span class="line"></span><br><span class="line">    label kopt;</span><br><span class="line">    <span class="keyword">if</span> (k == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        kopt = <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (k &lt;= kTarg_)</span><br><span class="line">    &#123;</span><br><span class="line">        kopt=k;</span><br><span class="line">        <span class="keyword">if</span> (temp_[k<span class="number">-1</span>] &lt; kFactor1_*temp_[k])</span><br><span class="line">        &#123;</span><br><span class="line">            kopt = k - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (temp_[k] &lt; kFactor2_*temp_[k - <span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            kopt = <span class="built_in">min</span>(k + <span class="number">1</span>, kMaxx_ - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        kopt = k - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (k &gt; <span class="number">2</span> &amp;&amp; temp_[k<span class="number">-2</span>] &lt; kFactor1_*temp_[k - <span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            kopt = k - <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (temp_[k] &lt; kFactor2_*temp_[kopt])</span><br><span class="line">        &#123;</span><br><span class="line">            kopt = <span class="built_in">min</span>(k, kMaxx_ - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">step</span>.prevReject)</span><br><span class="line">    &#123;</span><br><span class="line">        kTarg_ = <span class="built_in">min</span>(kopt, k);</span><br><span class="line">        dxNew = <span class="built_in">min</span>(mag(dx), dxOpt_[kTarg_]);</span><br><span class="line">        <span class="built_in">step</span>.prevReject = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (kopt &lt;= k)</span><br><span class="line">        &#123;</span><br><span class="line">            dxNew = dxOpt_[kopt];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (k &lt; kTarg_ &amp;&amp; temp_[k] &lt; kFactor2_*temp_[k - <span class="number">1</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                dxNew = dxOpt_[k]*cpu_[kopt + <span class="number">1</span>]/cpu_[k];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                dxNew = dxOpt_[k]*cpu_[kopt]/cpu_[k];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        kTarg_ = kopt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">step</span>.dxTry = <span class="built_in">step</span>.forward ? dxNew : -dxNew;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中调用了 <code>ODESystem::jacobian(x, y, li, dfdx_, dfdy_)</code> 和 <code>seulex::seul</code>，还调用了 <code>seulex::extrapolate</code>。</p><p><code>seulex::seul</code> 中调用了 <code>ODESystem::derivatives(xnew, y0, li, dy_)</code>。</p><p>但是 <code>ODESystem</code> 中只定义了三个纯虚函数 <code>nEqns</code>， <code>derivatives</code>， <code>jacobian</code>。<code>nEqns</code> 定义于 <code>ODESolver</code>，因为在 <code>ODESolver</code> 中，申明了 <code>friend class ODESystem;</code>。另外两个函数都定义在 <code>StandardChemistryModel</code> 中，因为 <code>ODESystem</code> 是 <code>StandardChemistryModel</code> 的基类之一。</p><p><code>celli</code> 传给了 <code>li</code> 这个参数，最终哪里用到了？<br>可能出现在<br>ODE/ 排除<br>thermophysicalModels/ 没找到。。。</p><p><a href="https://github.com/OpenFOAM/OpenFOAM-8/commit/2d0f459ea5a33eafa6fe423d5ff6395c20a38635" target="_blank" rel="external nofollow noopener noreferrer">官方说明</a><br>chemistryModel, reactions, ODESolver: Added “li” argument to all functions which evaluate the reaction rate</p><p>In chemistryModel “li” is set to the current cell index but for other reacting<br>systems it should be set to the current index of the element for which the<br>reaction system is being evaluated.</p><p>In the ODESolver “li” is the current index of the element for which the ODE<br>system is being solved if there is a list of related systems being solved,<br>otherwise it can be set to 0.</p><p>这两个函数很重要，代码如下：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>, <span class="title">class</span> <span class="title">ThermoType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:StandardChemistryModel&lt;ReactionThermo, ThermoType&gt;::derivatives</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar time,</span><br><span class="line">    <span class="keyword">const</span> scalarField&amp; c,</span><br><span class="line">    <span class="keyword">const</span> label li,</span><br><span class="line">    scalarField&amp; dcdt</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> scalar T = c[nSpecie_];</span><br><span class="line">    <span class="keyword">const</span> scalar p = c[nSpecie_ + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    forAll(c_, i)</span><br><span class="line">    &#123;</span><br><span class="line">        c_[i] = <span class="built_in">max</span>(c[i], <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    omega(p, T, c_, li, dcdt);</span><br><span class="line">    <span class="comment">//dcdt在这里计算，事实上，还是调用的Reaction::omega</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Constant pressure</span></span><br><span class="line">    <span class="comment">// dT/dt = ...</span></span><br><span class="line">    scalar rho = <span class="number">0</span>;</span><br><span class="line">    scalar cSum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (label i = <span class="number">0</span>; i &lt; nSpecie_; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> scalar W = specieThermo_[i].W();</span><br><span class="line">        cSum += c_[i];</span><br><span class="line">        rho += W*c_[i];</span><br><span class="line">    &#125;</span><br><span class="line">    scalar cp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (label i=<span class="number">0</span>; i&lt;nSpecie_; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cp += c_[i]*specieThermo_[i].cp(p, T);</span><br><span class="line">    &#125;</span><br><span class="line">    cp /= rho;</span><br><span class="line"></span><br><span class="line">    scalar dT = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (label i = <span class="number">0</span>; i &lt; nSpecie_; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> scalar hi = specieThermo_[i].ha(p, T);</span><br><span class="line">        dT += hi*dcdt[i];</span><br><span class="line">    &#125;</span><br><span class="line">    dT /= rho*cp;</span><br><span class="line"></span><br><span class="line">    dcdt[nSpecie_] = -dT;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// dp/dt = ...</span></span><br><span class="line">    dcdt[nSpecie_ + <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>, <span class="title">class</span> <span class="title">ThermoType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:StandardChemistryModel&lt;ReactionThermo, ThermoType&gt;::jacobian</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar t,</span><br><span class="line">    <span class="keyword">const</span> scalarField&amp; c,</span><br><span class="line">    <span class="keyword">const</span> label li,</span><br><span class="line">    scalarField&amp; dcdt,</span><br><span class="line">    scalarSquareMatrix&amp; J</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> scalar T = c[nSpecie_];</span><br><span class="line">    <span class="keyword">const</span> scalar p = c[nSpecie_ + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    forAll(c_, i)</span><br><span class="line">    &#123;</span><br><span class="line">        c_[i] = <span class="built_in">max</span>(c[i], <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    J = Zero;</span><br><span class="line">    dcdt = Zero;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// To compute the species derivatives of the temperature term,</span></span><br><span class="line">    <span class="comment">// the enthalpies of the individual species is needed</span></span><br><span class="line">    <span class="function">scalarField <span class="title">hi</span><span class="params">(nSpecie_)</span></span>;</span><br><span class="line">    <span class="function">scalarField <span class="title">cpi</span><span class="params">(nSpecie_)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (label i = <span class="number">0</span>; i &lt; nSpecie_; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        hi[i] = specieThermo_[i].ha(p, T);</span><br><span class="line">        cpi[i] = specieThermo_[i].cp(p, T);</span><br><span class="line">    &#125;</span><br><span class="line">    scalar omegaI = <span class="number">0</span>;</span><br><span class="line">    List&lt;label&gt; dummy;</span><br><span class="line">    forAll(reactions_, ri)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> Reaction&lt;ThermoType&gt;&amp; R = reactions_[ri];</span><br><span class="line">        scalar kfwd, kbwd;</span><br><span class="line">        R.dwdc(p, T, c_, li, J, dcdt, omegaI, kfwd, kbwd, <span class="literal">false</span>, dummy);</span><br><span class="line">        <span class="comment">//原来真正的Jacobian-J和derivative-dcdt计算在src/thermophysicalModels/specie/reaction/Reactions/Reaction/Reaction.C里边！</span></span><br><span class="line">        <span class="comment">//这里dcdt其实和derivatives中计算的是一样的。不确定，需要验证一下。</span></span><br><span class="line">        R.dwdT(p, T, c_, li, omegaI, kfwd, kbwd, J, <span class="literal">false</span>, dummy, nSpecie_);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// The species derivatives of the temperature term are partially computed</span></span><br><span class="line">    <span class="comment">// while computing dwdc, they are completed hereunder:</span></span><br><span class="line">    scalar cpMean = <span class="number">0</span>;</span><br><span class="line">    scalar dcpdTMean = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (label i=<span class="number">0</span>; i&lt;nSpecie_; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cpMean += c_[i]*cpi[i]; <span class="comment">// J/(m^3 K)</span></span><br><span class="line">        dcpdTMean += c_[i]*specieThermo_[i].dcpdT(p, T);</span><br><span class="line">    &#125;</span><br><span class="line">    scalar dTdt = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">for</span> (label i=<span class="number">0</span>; i&lt;nSpecie_; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        dTdt += hi[i]*dcdt[i]; <span class="comment">// J/(m^3 s)</span></span><br><span class="line">    &#125;</span><br><span class="line">    dTdt /= -cpMean; <span class="comment">// K/s</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (label i = <span class="number">0</span>; i &lt; nSpecie_; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        J(nSpecie_, i) = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (label j = <span class="number">0</span>; j &lt; nSpecie_; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            J(nSpecie_, i) += hi[j]*J(j, i);</span><br><span class="line">        &#125;</span><br><span class="line">        J(nSpecie_, i) += cpi[i]*dTdt; <span class="comment">// J/(mol s)</span></span><br><span class="line">        J(nSpecie_, i) /= -cpMean;    <span class="comment">// K/s/(mol/m3)</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ddT of dTdt</span></span><br><span class="line">    J(nSpecie_, nSpecie_) = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (label i = <span class="number">0</span>; i &lt; nSpecie_; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        J(nSpecie_, nSpecie_) += cpi[i]*dcdt[i] + hi[i]*J(i, nSpecie_);</span><br><span class="line">    &#125;</span><br><span class="line">    J(nSpecie_, nSpecie_) += dTdt*dcpdTMean;</span><br><span class="line">    J(nSpecie_, nSpecie_) /= -cpMean;</span><br><span class="line">    J(nSpecie_, nSpecie_) += dTdt/T;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>OF 里的 ODE 是为了得到 deltaT 之后新的浓度 c，在给定当前的 c T p 的前提下。然后据此求解组分方程的源项：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (label i=<span class="number">0</span>; i&lt;nSpecie_; i++)</span><br><span class="line">&#123;</span><br><span class="line">    RR_[i][celli] =</span><br><span class="line">        (c_[i] - c0[i])*specieThermo_[i].W()/deltaT[celli];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>把 c T P 设为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Φ</mi></mrow><annotation encoding="application/x-tex">\Phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord">Φ</span></span></span></span>，现在是已知<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\Phi_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>，要求<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\Phi_{n+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.891661em;vertical-align:-.208331em"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span></span></span></span>。<br>我们可以根据化学反应来得到 dcdt 和 dTdt，即现在已知<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="normal">Φ</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="normal">Φ</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac></mstyle><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="normal">Φ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Phi&#x27;=\dfrac{\partial \Phi}{\partial t}=f(\Phi)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.751892em;vertical-align:0"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord">Φ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord">Φ</span><span class="mclose">)</span></span></span></span>，然后寻找合适的算法来求解<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\Phi_{n+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.891661em;vertical-align:-.208331em"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span></span></span></span>。<br>最简单的方法就是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi mathvariant="normal">Φ</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="normal">Φ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Phi_{n+1}=\Phi_n + hf(\Phi)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.891661em;vertical-align:-.208331em"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord">Φ</span><span class="mclose">)</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="normal">Φ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(\Phi)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord">Φ</span><span class="mclose">)</span></span></span></span> 是斜率，h 是时间间隔。<br>那么现有先进的求解方法，应该也是基于这个思想。<br>比如 RK 方法，就是把时间间隔 h 分为若干小段。</p><h3 id="6-阶-rk"><a class="markdownIt-Anchor" href="#6-阶-rk"></a> 6 阶 RK</h3><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><msub><mi>c</mi><mn>2</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo>+</mo><msub><mi>c</mi><mn>3</mn></msub><msub><mi>k</mi><mn>3</mn></msub><mo>+</mo><msub><mi>c</mi><mn>4</mn></msub><msub><mi>k</mi><mn>4</mn></msub><mo>+</mo><msub><mi>c</mi><mn>5</mn></msub><msub><mi>k</mi><mn>5</mn></msub><mo>+</mo><msub><mi>c</mi><mn>6</mn></msub><msub><mi>k</mi><mn>6</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y_{n+1}=y_n+h(c_1k_1+c_2k_2+c_3k_3+c_4k_4+c_5k_5+c_6k_6)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.638891em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>d</mi><mi>y</mi><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">k_1=f(t_n,y_n)=dydt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>2</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><mi>h</mi><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>21</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k_2=f(t_n+a_2h,y_n+hb_{21}k_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">h</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>3</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo>+</mo><msub><mi>a</mi><mn>3</mn></msub><mi>h</mi><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>31</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>32</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k_3=f(t_n+a_3h,y_n+hb_{31}k_1+hb_{32}k_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">h</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>4</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo>+</mo><msub><mi>a</mi><mn>4</mn></msub><mi>h</mi><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>41</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>42</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>43</mn></msub><msub><mi>k</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k_4=f(t_n+a_4h,y_n+hb_{41}k_1+hb_{42}k_2+hb_{43}k_3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">h</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>5</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo>+</mo><msub><mi>a</mi><mn>5</mn></msub><mi>h</mi><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>51</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>52</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>53</mn></msub><msub><mi>k</mi><mn>3</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>54</mn></msub><msub><mi>k</mi><mn>4</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k_5=f(t_n+a_5h,y_n+hb_{51}k_1+hb_{52}k_2+hb_{53}k_3+hb_{54}k_4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">h</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>6</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo>+</mo><msub><mi>a</mi><mn>6</mn></msub><mi>h</mi><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>6</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>62</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>63</mn></msub><msub><mi>k</mi><mn>3</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>64</mn></msub><msub><mi>k</mi><mn>4</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>65</mn></msub><msub><mi>k</mi><mn>5</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k_6=f(t_n+a_6h,y_n+hb_{6}k_1+hb_{62}k_2+hb_{63}k_3+hb_{64}k_4+hb_{65}k_5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">h</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><a href="https://github.com/OpenFOAM/OpenFOAM-2.0.x/blob/master/src/ODE/ODESolvers/RK/RK.C" target="_blank" rel="external nofollow noopener noreferrer">OF-2.0.x</a> 的代码，对应公式中的量：</p><table><thead><tr><th>代码中的变量</th><th>公式中的变量</th></tr></thead><tbody><tr><td><code>ak2_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">k_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>ak3_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">k_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>ak4_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">k_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>ak5_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">k_5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>ak6_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>6</mn></msub></mrow><annotation encoding="application/x-tex">k_6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>y</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">y_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>yout</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">y_{n+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.638891em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>dydx</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">k_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>第一个 <code>yTemp_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>21</mn></msub><msub><mi>k</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">y_n+hb_{21}k_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>第二个 <code>yTemp_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>31</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>32</mn></msub><msub><mi>k</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">y_n+hb_{31}k_1+hb_{32}k_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>第三个 <code>yTemp_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>41</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>42</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>43</mn></msub><msub><mi>k</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">y_n+hb_{41}k_1+hb_{42}k_2+hb_{43}k_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>第四个 <code>yTemp_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>51</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>52</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>53</mn></msub><msub><mi>k</mi><mn>3</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>54</mn></msub><msub><mi>k</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">y_n+hb_{51}k_1+hb_{52}k_2+hb_{53}k_3+hb_{54}k_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>第五个 <code>yTemp_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>61</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>62</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>63</mn></msub><msub><mi>k</mi><mn>3</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>64</mn></msub><msub><mi>k</mi><mn>4</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>65</mn></msub><msub><mi>k</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">y_n+hb_{61}k_1+hb_{62}k_2+hb_{63}k_3+hb_{64}k_4+hb_{65}k_5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr></tbody></table><p>代码中返回的是：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><msub><mi>c</mi><mn>3</mn></msub><msub><mi>k</mi><mn>3</mn></msub><mo>+</mo><msub><mi>c</mi><mn>4</mn></msub><msub><mi>k</mi><mn>4</mn></msub><mo>+</mo><msub><mi>c</mi><mn>6</mn></msub><msub><mi>k</mi><mn>6</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y_{n+1}=y_n+h(c_1k_1+c_3k_3+c_4k_4+c_6k_6)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.638891em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，只需要保证<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>∑</mo><msub><mi>c</mi><mi>k</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum c_k =1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-.25001em"></span><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span> 就行了。代码中刚好是相加为 1：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">RK::c1 = <span class="number">37.0</span>/<span class="number">378.0</span>, RK::c3 = <span class="number">250.0</span>/<span class="number">621.0</span>,</span><br><span class="line">RK::c4 = <span class="number">125.0</span>/<span class="number">594.0</span>, RK::c6 = <span class="number">512.0</span>/<span class="number">1771.0</span>,</span><br></pre></td></tr></table></figure><p>其中的 <code>dydx</code> 即 derivatives，但是没有用到 Jacobian？这个RK确实没有用到 Jacobian，但是其他的 ODE 求解器用到了。</p><h3 id="krr4"><a class="markdownIt-Anchor" href="#krr4"></a> KRR4</h3><p>已知<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>y</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y&#x27;=f(y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.946332em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="mclose">)</span></span></span></span>，我们这样得到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mrow><mi>n</mi><mo>+</mo></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y_{n+1}=y_n+hf(y_{n+})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.638891em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.25833100000000003em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mtight">+</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle><msub><mi mathvariant="normal">∣</mi><msub><mi>y</mi><mi>n</mi></msub></msub><mo stretchy="false">(</mo><msub><mi>y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">y_{n+1}=y_n+h[f(y_n)+\dfrac{\partial f}{\partial y}|_{y_n}(y_{n+1}-y_n)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.638891em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.25188em;vertical-align:-.8804400000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.10764em">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285719em"><span style="top:-2.357em;margin-left:-.03588em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>y</mi><mi>h</mi></msub><mo>+</mo><mi>h</mi><mo stretchy="false">[</mo><mn>1</mn><mo>−</mo><mi>h</mi><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle><msup><mo stretchy="false">]</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>⋅</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y_{n+1}=y_h+h[1-h\dfrac{\partial f}{\partial y}]^{-1} \cdot f(y_n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.638891em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.25188em;vertical-align:-.8804400000000001em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.10764em">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>+</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>y</mi><mn>0</mn></msub><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>s</mi></msubsup><msub><mi>b</mi><mi>i</mi></msub><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y(x_0+h)=y_0+\sum_{i=1}^s b_ik_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-.29971000000000003em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.804292em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>γ</mi><mi>h</mi><mi>f</mi><mo stretchy="false">)</mo><msub><mi>k</mi><mi>i</mi></msub><mo>=</mo><mi>h</mi><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>α</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>k</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mi>h</mi><msup><mi>f</mi><mo mathvariant="normal">′</mo></msup><mo>⋅</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>k</mi><mi>j</mi></msub><mo separator="true">,</mo><mspace width="1em"><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><mi>s</mi></mspace></mrow><annotation encoding="application/x-tex">(1-\gamma h f) k_i = h f(y_0+\sum_{j=1}^{i-1}\alpha_{ij}k_j)+h f&#x27; \cdot \sum_{j=1}^{i-1}\gamma_{ij}k_j, \quad i=1,\cdots,s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.05556em">γ</span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.400382em;vertical-align:-.43581800000000004em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.964564em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.43581800000000004em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.0037em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.946332em;vertical-align:-.19444em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.400382em;vertical-align:-.43581800000000004em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.964564em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.43581800000000004em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05556em">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05556em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8388800000000001em;vertical-align:-.19444em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault">s</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>k</mi><mi>j</mi></msub><mo>+</mo><mi>γ</mi><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">g_i=\sum_{j=1}^{i-1}\gamma_{ij}k_j+\gamma k_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.400382em;vertical-align:-.43581800000000004em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.964564em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.43581800000000004em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05556em">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05556em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.05556em">γ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>γ</mi><mi>h</mi><mo>−</mo><msup><mi>f</mi><mo mathvariant="normal">′</mo></msup><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>g</mi><mn>1</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1/\gamma h -f&#x27;)\cdot g_1=f(y_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:.05556em">γ</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>γ</mi><mi>h</mi><mo>−</mo><msup><mi>f</mi><mo mathvariant="normal">′</mo></msup><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>g</mi><mn>2</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo>+</mo><msub><mi>a</mi><mn>21</mn></msub><msub><mi>g</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>c</mi><mn>21</mn></msub><msub><mi>g</mi><mn>1</mn></msub><mi mathvariant="normal">/</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">(1/\gamma h -f&#x27;)\cdot g_2=f(y_0+a_{21}g_1)+c_{21}g_1/h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:.05556em">γ</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathdefault">h</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>γ</mi><mi>h</mi><mo>−</mo><msup><mi>f</mi><mo mathvariant="normal">′</mo></msup><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>g</mi><mn>3</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo>+</mo><msub><mi>a</mi><mn>31</mn></msub><msub><mi>g</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>32</mn></msub><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><msub><mi>c</mi><mn>31</mn></msub><msub><mi>g</mi><mn>1</mn></msub><mo>+</mo><msub><mi>c</mi><mn>32</mn></msub><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">(1/\gamma h -f&#x27;)\cdot g_3=f(y_0+a_{31}g_1+a_{32}g_2)+(c_{31}g_1+c_{32}g_2)/h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:.05556em">γ</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathdefault">h</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>γ</mi><mi>h</mi><mo>−</mo><msup><mi>f</mi><mo mathvariant="normal">′</mo></msup><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>g</mi><mn>4</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo>+</mo><msub><mi>a</mi><mn>41</mn></msub><msub><mi>g</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>42</mn></msub><msub><mi>g</mi><mn>2</mn></msub><mo>+</mo><msub><mi>a</mi><mn>43</mn></msub><msub><mi>g</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><msub><mi>c</mi><mn>41</mn></msub><msub><mi>g</mi><mn>1</mn></msub><mo>+</mo><msub><mi>c</mi><mn>42</mn></msub><msub><mi>g</mi><mn>2</mn></msub><mo>+</mo><msub><mi>c</mi><mn>43</mn></msub><msub><mi>g</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">(1/\gamma h -f&#x27;)\cdot g_4=f(y_0+a_{41}g_1+a_{42}g_2+a_{43}g_3)+(c_{41}g_1+c_{42}g_2+c_{43}g_3)/h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:.05556em">γ</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathdefault">h</span></span></span></span></p><p><a href="https://github.com/OpenFOAM/OpenFOAM-2.0.x/blob/master/src/ODE/ODESolvers/KRR4/KRR4.C" target="_blank" rel="external nofollow noopener noreferrer">OF-2.0.x</a> 的代码，对应公式中的量：</p><table><thead><tr><th>代码中的变量</th><th>公式中的变量</th></tr></thead><tbody><tr><td><code>dfdy_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>f</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">f&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.946332em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>dfdx_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\dfrac{\partial f}{\partial x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.10764em">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></td></tr><tr><td><code>g1_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>g</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">g_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>g2_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>g</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">g_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>g3_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>g</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">g_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>g4_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>g</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">g_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>c21</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>21</mn></msub></mrow><annotation encoding="application/x-tex">c_{21}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>c31</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>31</mn></msub></mrow><annotation encoding="application/x-tex">c_{31}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>c32</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>32</mn></msub></mrow><annotation encoding="application/x-tex">c_{32}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>c41</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>41</mn></msub></mrow><annotation encoding="application/x-tex">c_{41}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>c42</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>42</mn></msub></mrow><annotation encoding="application/x-tex">c_{42}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>c43</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>43</mn></msub></mrow><annotation encoding="application/x-tex">c_{43}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>a21</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>21</mn></msub></mrow><annotation encoding="application/x-tex">a_{21}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>a31</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>31</mn></msub></mrow><annotation encoding="application/x-tex">a_{31}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>a32</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>32</mn></msub></mrow><annotation encoding="application/x-tex">a_{32}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>b1</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">b1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">b</span><span class="mord">1</span></span></span></span></td></tr><tr><td><code>b2</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">b2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">b</span><span class="mord">2</span></span></span></span></td></tr><tr><td><code>b3</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">b3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">b</span><span class="mord">3</span></span></span></span></td></tr><tr><td><code>b4</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">b4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">b</span><span class="mord">4</span></span></span></span></td></tr></tbody></table><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">KRR4::b1 = <span class="number">19.0</span>/<span class="number">9.0</span>, KRR4::b2 = <span class="number">1.0</span>/<span class="number">2.0</span>, KRR4::b3 = <span class="number">25.0</span>/<span class="number">108.0</span>,</span><br><span class="line">KRR4::b4 = <span class="number">125.0</span>/<span class="number">108.0</span>,</span><br></pre></td></tr></table></figure><p>b1+b2+b3+b4=4</p><h3 id="seulex"><a class="markdownIt-Anchor" href="#seulex"></a> seulex</h3><p><a href="https://github.com/OpenFOAM/OpenFOAM-dev/blob/master/src/ODE/ODESolvers/seulex/seulex.C" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM-dev</a></p><h2 id="化学-ode-求解理论"><a class="markdownIt-Anchor" href="#化学-ode-求解理论"></a> 化学 ODE 求解理论</h2><p>上边是代码追踪，下面来看一下化学 ODE 求解的理论知识。<br>待求解的量有：</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Φ</mi><mo>=</mo><msup><mrow><mo fence="true">{</mo><mi>T</mi><mo separator="true">,</mo><msub><mi>Y</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>Y</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>Y</mi><mrow><msub><mi>N</mi><mtext>sp</mtext></msub><mo>−</mo><mn>1</mn></mrow></msub><mo fence="true">}</mo></mrow><mtext>T</mtext></msup></mrow><annotation encoding="application/x-tex">\Phi = \left \lbrace T, Y_1, Y_2, \dotsc, Y_{N_{\text{sp}} - 1} \right \rbrace^{\text{T}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord">Φ</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.4312409999999998em;vertical-align:-.35001em"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">{</span></span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">…</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833100000000004em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.34731999999999996em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">}</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0812309999999998em"><span style="top:-3.3029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">T</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Y</mi><msub><mi>N</mi><mtext>sp</mtext></msub></msub><mo>=</mo><mn>1</mn><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><msub><mi>N</mi><mtext>sp</mtext></msub><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>Y</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">Y_{N_{\text{sp}}} = 1 - \sum_{k=1}^{N_{\text{sp}} - 1} Y_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.03065em;vertical-align:-.34731999999999996em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833100000000004em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.34731999999999996em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.321759em;vertical-align:-.30130799999999996em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.020451em"><span style="top:-2.398692em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.24212em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.30130799999999996em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></p><p>derivatives 即：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>=</mo><msubsup><mi mathvariant="normal">Φ</mi><mi>i</mi><mo mathvariant="normal">′</mo></msubsup><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="normal">Φ</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><msup><mrow><mo fence="true">{</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>T</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo separator="true">,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>Y</mi><mn>1</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo separator="true">,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>Y</mi><mn>2</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>Y</mi><mrow><msub><mi>N</mi><mtext>sp</mtext></msub><mo>−</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo fence="true">}</mo></mrow><mtext>T</mtext></msup></mrow><annotation encoding="application/x-tex">f = {\Phi_i&#x27;}=\frac{\partial \Phi}{\partial t} = \left \lbrace \frac{\partial T}{\partial t}, \frac{\partial Y_1}{\partial t}, \frac{\partial Y_2}{\partial t}, \dotsc, \frac{\partial Y_{N_{\text{sp}} - 1}}{\partial t} \right \rbrace^{\text{T}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-.247em"></span><span class="mord"><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8018919999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord">Φ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.631261em;vertical-align:-.95003em"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">{</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">…</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4317600000000001em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.73732em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833100000000004em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.34731999999999996em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">}</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.681231em"><span style="top:-3.9029000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">T</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>T</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mo>−</mo><mn>1</mn></mrow><mrow><mi>ρ</mi><msub><mi>c</mi><mi>p</mi></msub></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mtext>sp</mtext></msub></munderover><msub><mi>h</mi><mi>k</mi></msub><msub><mi>W</mi><mi>k</mi></msub><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\frac{\partial T}{\partial t} = \frac{-1}{\rho c_p} \sum_{k=1}^{N_{\text{sp}}} h_k W_k \dot{\omega}_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.2387690000000005em;vertical-align:-1.302113em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">−</span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.9366560000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.4083250000000005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>Y</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mi>ρ</mi></mfrac><msub><mi>W</mi><mi>k</mi></msub><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub><mspace width="1em"><mi>k</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>N</mi><mtext>sp</mtext></msub><mo>−</mo><mn>1</mn></mspace></mrow><annotation encoding="application/x-tex">\frac{\partial Y_k}{\partial t} = \frac{1}{\rho} W_k \dot{\omega}_k \quad k = 1, \dotsc, N_{\text{sp}} - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.20188em;vertical-align:-.8804400000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">…</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></span></p><p>Jacobian 矩阵：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="script">J</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>f</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi mathvariant="normal">Φ</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><msub><mi mathvariant="normal">Φ</mi><mi>i</mi></msub><mo>˙</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi mathvariant="normal">Φ</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\mathcal{J}_{i,j} = \frac{\partial f_i}{\partial \Phi_j} = \frac{\partial \dot{\Phi_i}}{\partial \Phi_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:.18472em">J</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.3435479999999997em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.10764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.569298em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5971899999999999em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9201900000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>展开为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup></mrow><mrow><mi mathvariant="normal">∂</mi><mi>T</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>Y</mi><mn>1</mn></msub></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>Y</mi><mrow><msub><mi>N</mi><mtext>sp</mtext></msub><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>Y</mi><mn>1</mn><mo mathvariant="normal">′</mo></msubsup></mrow><mrow><mi mathvariant="normal">∂</mi><mi>T</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>Y</mi><mn>1</mn><mo mathvariant="normal">′</mo></msubsup></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>Y</mi><mn>1</mn></msub></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>Y</mi><mn>1</mn><mo mathvariant="normal">′</mo></msubsup></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>Y</mi><mrow><msub><mi>N</mi><mtext>sp</mtext></msub><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>Y</mi><mrow><msub><mi>N</mi><mtext>sp</mtext></msub><mo>−</mo><mn>1</mn></mrow><mo mathvariant="normal">′</mo></msubsup></mrow><mrow><mi mathvariant="normal">∂</mi><mi>T</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>Y</mi><mrow><msub><mi>N</mi><mtext>sp</mtext></msub><mo>−</mo><mn>1</mn></mrow><mo mathvariant="normal">′</mo></msubsup></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>Y</mi><mn>1</mn></msub></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>Y</mi><mrow><msub><mi>N</mi><mtext>sp</mtext></msub><mo>−</mo><mn>1</mn></mrow><mo mathvariant="normal">′</mo></msubsup></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>Y</mi><mrow><msub><mi>N</mi><mtext>sp</mtext></msub><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac></mstyle></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\left[ \begin{array}{cccc} \dfrac{\partial {T&#x27;}}{\partial T} &amp; \dfrac{\partial {T&#x27;}}{\partial Y_1} &amp; \ldots &amp; \dfrac{\partial {T&#x27;}}{\partial Y_{N_{\text{sp}} - 1}} \\ \dfrac{\partial {Y_1&#x27;}}{\partial T} &amp; \dfrac{\partial {Y_1&#x27;}}{\partial Y_1} &amp; \ldots &amp; \dfrac{\partial {Y_1&#x27;}}{\partial Y_{N_{\text{sp}} - 1}} \\ \vdots &amp; &amp; \ddots &amp; \vdots \\ \dfrac{\partial {Y}&#x27;_{N_{\text{sp}} - 1}}{\partial T} &amp; \dfrac{\partial {Y}&#x27;_{N_{\text{sp}} - 1}}{\partial Y_1} &amp; \ldots &amp; \dfrac{\partial {Y}&#x27;_{N_{\text{sp}} - 1}}{\partial Y_{N_{\text{sp}} - 1}} \end{array} \right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9.432287em;vertical-align:-4.4661435em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.758975em"><span style="top:.45004499999999903em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-.7049550000000009em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-1.3059550000000009em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-1.9069550000000008em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-2.507955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.108955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.709955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.310955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.911955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-5.512955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-6.758975em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.250064999999999em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.9661435em"><span style="top:-7.2247515em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.428892em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-4.7625395em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.428892em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-2.4518920000000004em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.24810799999999997em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.2292194999999997em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0;border-top-width:1.5em;bottom:0"></span></span></span></span><span style="top:-.25467649999999975em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6145429999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.862651em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-2.424669em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.472651em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.4661435em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.9661435em"><span style="top:-7.151794499999999em"><span class="pstrut" style="height:3.614543em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.428892em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-4.6895825em"><span class="pstrut" style="height:3.614543em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.428892em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-2.4518920000000004em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.24810799999999997em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.1562624999999995em"><span class="pstrut" style="height:3.614543em"></span><span class="mord"></span></span><span style="top:-.1817194999999996em"><span class="pstrut" style="height:3.614543em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6145429999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.862651em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-2.424669em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.472651em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.4661435em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.9661435em"><span style="top:-7.151794499999999em"><span class="pstrut" style="height:3.614543em"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:-4.6895825em"><span class="pstrut" style="height:3.614543em"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:-2.1562624999999995em"><span class="pstrut" style="height:3.614543em"></span><span class="mord"><span class="minner">⋱</span></span></span><span style="top:-.1817194999999996em"><span class="pstrut" style="height:3.614543em"></span><span class="mord"><span class="minner">…</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.4661435em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.9661435em"><span style="top:-7.2247515em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.428892em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833100000000004em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.34731999999999996em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.03332em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-4.7625395em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.428892em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833100000000004em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.34731999999999996em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-2.4518920000000004em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.24810799999999997em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.03332em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.2292194999999997em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0;border-top-width:1.5em;bottom:0"></span></span></span></span><span style="top:-.25467649999999975em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6145429999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833100000000004em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.34731999999999996em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.862651em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-2.424669em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.472651em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.03332em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.4661435em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.758975em"><span style="top:.45004499999999903em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-.7049550000000009em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-1.3059550000000009em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-1.9069550000000008em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-2.507955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.108955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.709955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.310955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.911955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-5.512955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-6.758975em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.250064999999999em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p><code>laminar</code> 中的函数 <code>Qdot()</code> 最初的纯虚函数定义于<code>combustionModel</code>，在 <code>laminar</code> 实际定义，返回值是 <code>this-&gt;chemistryPtr_-&gt;Qdot()</code>。因此跳转到了 <code>BasicChemistryModel</code> 类中，和上边的 <code>solve</code> 一样，它也是 <code>basicChemistryModel</code> 的纯虚函数，实际定义于 <code>StandardChemistryModel</code>，返回值是一个 <code>tmp&lt;Foam::volScalarField&gt;</code>，实际计算如下：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">forAll(Y_, i)</span><br><span class="line">&#123;</span><br><span class="line">    forAll(Qdot, celli)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> scalar hi = specieThermo_[i].Hc();</span><br><span class="line">        Qdot[celli] -= hi*RR_[i][celli];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中，<code>Hc()</code> 是该组分的化学焓（英文是 chemical enthalpy，又叫 formation enthalpy），公式是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Δ</mi><msubsup><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow><mn>0</mn></msubsup></mrow><annotation encoding="application/x-tex">\Delta h^0_{f,k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2333239999999999em;vertical-align:-.4192159999999999em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.4168920000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4192159999999999em"><span></span></span></span></span></span></span></span></span></span>，它的计算见 <a href="https://cpp.openfoam.org/v3/a10297_source.html" target="_blank" rel="external nofollow noopener noreferrer">janafThermoI.H</a>。另一篇博文正好给出了<a href="../hEqn/" target="_blank" style="target-new:tab">燃烧反应能量方程</a>，其中显焓输运方程的反应源项，就是这里的 <code>Qdot</code>。</p><p>函数 <code>R(volScalarField&amp; Y)</code> 的返回值是 <code>tmp&lt;Foam::fvScalarMatrix&gt;</code>，我对 <code>matrix</code> 不太熟悉，这个矩阵应该是由此组成：<code>this-&gt;chemistryPtr_-&gt;RR(specieI)</code>。又来到了 BasicChemistryModel 类中，照旧，纯虚函数定义于 <code>basicChemistryModel</code>，实际定义于 <code>StandardChemistryModel</code>（在 StandardChemistryModelI.H 中定义），返回值是 <code>RR_</code>，它的类型是 <code>PtrList&lt;volScalarField::Internal&gt;</code>，代码中的描述是 List of reaction rate per specie [kg/m3/s]。</p><p>总结起来，就是在 solver 中，定义一个燃烧的对象：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">autoPtr&lt;CombustionModel&lt;psiReactionThermo&gt;&gt; reaction</span><br><span class="line">(</span><br><span class="line">    CombustionModel&lt;psiReactionThermo&gt;::New(thermo, turbulence())</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>然后在燃烧模型 <code>ChemistryCombustion</code> 里边，有一个化学模型的指针（Protected data，只能它自己或其派生类能够访问，它的对象不能访问）</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">autoPtr&lt;BasicChemistryModel&lt;ReactionThermo&gt;&gt; chemistryPtr_</span><br></pre></td></tr></table></figure><p>所有关于化学的使用，都是通过它调用。比如求解化学反应方程，就是 <code>reaction-&gt;correct()</code>。而这个 <code>correct</code> 函数的关键内容是</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>-&gt;chemistryPtr_-&gt;solve(<span class="keyword">this</span>-&gt;mesh().time().deltaTValue());</span><br></pre></td></tr></table></figure><p>调用了化学模型里边的 <code>solve</code> 函数。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:ChemistryCombustion&lt;ReactionThermo&gt;::ChemistryCombustion</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; modelType,</span><br><span class="line">    ReactionThermo&amp; thermo,</span><br><span class="line">    <span class="keyword">const</span> compressibleTurbulenceModel&amp; turb,</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; combustionProperties</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    CombustionModel&lt;ReactionThermo&gt;</span><br><span class="line">    (</span><br><span class="line">        modelType,</span><br><span class="line">        thermo,</span><br><span class="line">        turb,</span><br><span class="line">        combustionProperties</span><br><span class="line">    ),</span><br><span class="line">    chemistryPtr_(BasicChemistryModel&lt;ReactionThermo&gt;::New(thermo))</span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure><p>燃烧模型的构造函数里边，创建了化学模块的对象，传入了 <code>thermo</code>。</p><p>三个函数完整定义</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:combustionModels::laminar&lt;ReactionThermo&gt;::correct()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;active())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (integrateReactionRate_)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (fv::localEulerDdt::enabled(<span class="keyword">this</span>-&gt;mesh()))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">const</span> scalarField&amp; rDeltaT =</span><br><span class="line">                    fv::localEulerDdt::localRDeltaT(<span class="keyword">this</span>-&gt;mesh());</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;coeffs().found(<span class="string">"maxIntegrationTime"</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                    scalar maxIntegrationTime</span><br><span class="line">                    (</span><br><span class="line">                        readScalar(<span class="keyword">this</span>-&gt;coeffs().lookup(<span class="string">"maxIntegrationTime"</span>))</span><br><span class="line">                    );</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;solve</span><br><span class="line">                    (</span><br><span class="line">                        <span class="built_in">min</span>(<span class="number">1.0</span>/rDeltaT, maxIntegrationTime)()</span><br><span class="line">                    );</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;solve((<span class="number">1.0</span>/rDeltaT)());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;solve(<span class="keyword">this</span>-&gt;mesh().time().deltaTValue());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;calculate();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:tmp&lt;Foam::fvScalarMatrix&gt;</span><br><span class="line">Foam::combustionModels::laminar&lt;ReactionThermo&gt;::R(volScalarField&amp; Y) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">tmp&lt;fvScalarMatrix&gt; <span class="title">tSu</span><span class="params">(<span class="keyword">new</span> fvScalarMatrix(Y, dimMass/dimTime))</span></span>;</span><br><span class="line"></span><br><span class="line">    fvScalarMatrix&amp; Su = tSu.ref();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;active())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> label specieI =</span><br><span class="line">            <span class="keyword">this</span>-&gt;thermo().composition().species()[Y.member()];</span><br><span class="line"></span><br><span class="line">        Su += <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;RR(specieI);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> tSu;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:tmp&lt;Foam::volScalarField&gt;</span><br><span class="line">Foam::combustionModels::laminar&lt;ReactionThermo&gt;::Qdot() <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    tmp&lt;volScalarField&gt; tQdot</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">new</span> volScalarField</span><br><span class="line">        (</span><br><span class="line">            IOobject</span><br><span class="line">            (</span><br><span class="line">                <span class="keyword">this</span>-&gt;thermo().phasePropertyName(typeName + <span class="string">":Qdot"</span>),</span><br><span class="line">                <span class="keyword">this</span>-&gt;mesh().time().timeName(),</span><br><span class="line">                <span class="keyword">this</span>-&gt;mesh(),</span><br><span class="line">                IOobject::NO_READ,</span><br><span class="line">                IOobject::NO_WRITE,</span><br><span class="line">                <span class="literal">false</span></span><br><span class="line">            ),</span><br><span class="line">            <span class="keyword">this</span>-&gt;mesh(),</span><br><span class="line">            dimensionedScalar(<span class="string">"Qdot"</span>, dimEnergy/dimVolume/dimTime, <span class="number">0.0</span>)</span><br><span class="line">        )</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;active())</span><br><span class="line">    &#123;</span><br><span class="line">        tQdot.ref() = <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;Qdot();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> tQdot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="rts-2"><a class="markdownIt-Anchor" href="#rts-2"></a> RTS</h2><h3 id="declareruntimeselectiontable-2"><a class="markdownIt-Anchor" href="#declareruntimeselectiontable-2"></a> declareRunTimeSelectionTable</h3><p>首先在源代码中全局搜索发现 <code>declareRunTimeSelectionTable</code> 函数在 <code>CombustionModel.H</code> 中被调用。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">declareRunTimeSelectionTable</span><br><span class="line">(</span><br><span class="line">    autoPtr,</span><br><span class="line">    CombustionModel,</span><br><span class="line">    dictionary,</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">word</span>&amp; modelType,</span><br><span class="line">        ReactionThermo&amp; thermo,</span><br><span class="line">        <span class="keyword">const</span> compressibleTurbulenceModel&amp; turb,</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">word</span>&amp; combustionProperties</span><br><span class="line">    ),</span><br><span class="line">    (modelType, thermo, turb, combustionProperties)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>而这个函数定义于 <code>\src\OpenFOAM\db\runTimeSelection\construction\runTimeSelectionTables.H</code> 中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> declareRunTimeSelectionTable(autoPtr,baseType,argNames,argList,parList)\</span></span><br><span class="line">    <span class="keyword">typedef</span> autoPtr&lt;baseType&gt; (*argNames##ConstructorPtr)argList;              \</span><br><span class="line">    <span class="keyword">typedef</span> HashTable&lt;argNames##ConstructorPtr, <span class="keyword">word</span>, <span class="built_in">string</span>::hash&gt;            \</span><br><span class="line">        argNames##ConstructorTable;                                            \</span><br><span class="line">    <span class="keyword">static</span> argNames##ConstructorTable* argNames##ConstructorTablePtr_;         \</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> construct##argNames##ConstructorTables();                      \</span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">baseType</span>##<span class="title">Type</span>&gt;                                             \</span></span><br><span class="line"><span class="class">    <span class="title">class</span> <span class="title">add</span>##<span class="title">argNames</span>##<span class="title">ConstructorToTable</span>                                    \</span></span><br><span class="line"><span class="class">    &#123;</span>                                                                          \</span><br><span class="line">    <span class="keyword">public</span>:                                                                    \</span><br><span class="line">        <span class="keyword">static</span> autoPtr&lt;baseType&gt; New argList                                   \</span><br><span class="line">        &#123;                                                                      \</span><br><span class="line">            <span class="keyword">return</span> autoPtr&lt;baseType&gt;(<span class="keyword">new</span> baseType##Type parList);              \</span><br><span class="line">        &#125;                                                                      \</span><br><span class="line">                                                                               \</span><br><span class="line">        add##argNames##ConstructorToTable                                      \</span><br><span class="line">        (                                                                      \</span><br><span class="line">            <span class="keyword">const</span> <span class="keyword">word</span>&amp; lookup = baseType##Type::typeName                      \</span><br><span class="line">        )                                                                      \</span><br><span class="line">        &#123;                                                                      \</span><br><span class="line">            construct##argNames##ConstructorTables();                          \</span><br><span class="line">            argNames##ConstructorTablePtr_-&gt;insert(lookup, New);               \</span><br><span class="line">        &#125;                                                                      \</span><br><span class="line">    &#125;;                                                                         \</span><br></pre></td></tr></table></figure><ul><li>定义一个函数指针，这样定义的结果是， <code>dictionaryConstructorPtr</code> 代表一个指向参数为 <code>argList</code>，返回类型为 <code>autoPtr&lt; baseType&gt;</code> 的函数指针。</li><li>将一个 key 和 value 分别为 <code>word</code> 和 <code>dictionaryConstructorPtr</code> 的 <code>HashTable</code> 重命名为 <code>argNames##ConstructorTable</code>，即 <code>dictionaryConstructorTable</code>，并创建了一个以它为类型的指针 <code>argNames##ConstructorTablePtr_</code>，即 <strong><code>dictionaryConstructorTablePtr_</code></strong>。</li><li>申明一个类：<code>add##argNames##ConstructorToTable</code>，即 <code>adddictionaryConstructorToTable</code>，它需要模板 <code>baseType##Type</code>，其中的 <code>baseType</code> 是 <code>CombustionModel</code>。</li><li>类中定义了 <code>New</code> 函数，<code>argList</code> 是其形参列表，<code>parList</code> 是返回的 <code>baseType##Type</code> 的构造函数的形参列表。注意，这里调用了<strong>基类的构造函数</strong>！！！</li><li>但是如果我们在派生类中创建这个 add 类的对象的话，它的模板则是派生类，就是说 New 函数的返回值是指向派生类对象基类指针。</li><li>在 <code>add##argNames##ConstructorToTable</code> 的构造函数中，向 <strong><code>dictionaryConstructorTablePtr_</code></strong> 中 <code>insert</code> 了一组 key and value：<br>key 是 <code>typeName</code>，vaule 是 返回 <em>基类 <code>autoPtr</code></em> 的 <code>New</code> 函数。</li></ul><h3 id="definetemplateruntimeselectiontable-2"><a class="markdownIt-Anchor" href="#definetemplateruntimeselectiontable-2"></a> defineTemplateRunTimeSelectionTable</h3><p><code>defineTemplateRunTimeSelectionTable</code> 函数被发现调用于 <code>makeCombustionTypes.H</code> 中的 <code>makeCombustion</code> 函数中。<br>而 <code>makeCombustion</code> 函数在 <code>CombustionModels.C</code> 中被调用：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">makeCombustion(psiReactionThermo);</span><br></pre></td></tr></table></figure><p>具体看看这个函数：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> makeCombustion(Comp)                                                   \</span></span><br><span class="line">                                                                               \</span><br><span class="line">    <span class="keyword">typedef</span> CombustionModel&lt;Comp&gt; CombustionModel##Comp;                       \</span><br><span class="line">                                                                               \</span><br><span class="line">    defineTemplateTypeNameAndDebugWithName                                     \</span><br><span class="line">    (                                                                          \</span><br><span class="line">        CombustionModel##Comp,                                                 \</span><br><span class="line">        (                                                                      \</span><br><span class="line">            <span class="keyword">word</span>(CombustionModel##Comp::typeName_()) + <span class="string">"&lt;"</span> + Comp::typeName    \</span><br><span class="line">          + <span class="string">"&gt;"</span>                                                                \</span><br><span class="line">        ).c_str(),                                                             \</span><br><span class="line">        <span class="number">0</span>                                                                      \</span><br><span class="line">    );                                                                         \</span><br><span class="line">                                                                               \</span><br><span class="line">    defineTemplateRunTimeSelectionTable                                        \</span><br><span class="line">    (                                                                          \</span><br><span class="line">        CombustionModel##Comp,                                                 \</span><br><span class="line">        dictionary                                                             \</span><br><span class="line">    );</span><br></pre></td></tr></table></figure><p>首先 <code>defineTemplateTypeNameAndDebugWithName</code> 函数创建了一个 <code>word</code> 名字是 <code>typeName</code> 值是 <code>Name</code>，即 <code>laminar&lt;psiReactionThermo&gt;</code>。</p><p>其次是调用 <code>defineTemplateRunTimeSelectionTable</code> 函数，它定义于 <code>\src\OpenFOAM\db\runTimeSelection\construction\runTimeSelectionTables.H</code> 中。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> defineTemplateRunTimeSelectionTable(baseType,argNames)                 \</span></span><br><span class="line">    defineRunTimeSelectionTablePtr(baseType,argNames);                         \</span><br><span class="line">    defineRunTimeSelectionTableConstructor(baseType,argNames);                 \</span><br><span class="line">    defineRunTimeSelectionTableDestructor(baseType,argNames)</span><br></pre></td></tr></table></figure><p>这里的 <code>baseType</code> 是 <code>CombustionModel##psiReactionThermo</code>，<code>argNames</code> 是 <code>dictionary</code>。<br>包括三个宏函数，第一个函数定义了一个类型为 <code>dictionary##ConstructorTable</code> （即 HashTable 的别名）的名字为 <code>dictionary##ConstructorTablePtr_</code> 的空指针。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> defineRunTimeSelectionTablePtr(baseType,argNames)                      \</span></span><br><span class="line">    baseType::argNames##ConstructorTable*                                      \</span><br><span class="line">        baseType::argNames##ConstructorTablePtr_ = <span class="literal">nullptr</span></span><br></pre></td></tr></table></figure><p>第二个函数定义了一个函数，名为 <code>constructdictionaryConstructorTables()</code>，作用是创建了一个类型为 <code>dictionaryConstructorTable</code>，名字为 <code>dictionaryConstructorTablePtr_</code> 的对象。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> defineRunTimeSelectionTableConstructor(baseType,argNames)              \</span></span><br><span class="line">    <span class="keyword">void</span> baseType::construct##argNames##ConstructorTables()                    \</span><br><span class="line">    &#123;                                                                          \</span><br><span class="line">            baseType::argNames##ConstructorTablePtr_                           \</span><br><span class="line">                = <span class="keyword">new</span> baseType::argNames##ConstructorTable;                    \</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>第三个函数定义了一个函数（后来在 <code>add##argNames##ConstructorToTable</code> 的析构函数中被调用），名字是 <code>destroydictionaryConstructorTables()</code>。</p><h3 id="创建对象-2"><a class="markdownIt-Anchor" href="#创建对象-2"></a> 创建对象</h3><p>我们在创建燃烧模型的对象时（<code>createFields.H</code>）是这样的：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt; <span class="string">"Creating reaction model\n"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">autoPtr&lt;CombustionModel&lt;psiReactionThermo&gt;&gt; reaction</span><br><span class="line">(</span><br><span class="line">    CombustionModel&lt;psiReactionThermo&gt;::New(thermo, turbulence())</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>调用的是 <code>CombustionModel</code> 中的 <code>New</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//- Selector</span></span><br><span class="line"><span class="keyword">static</span> autoPtr&lt;CombustionModel&gt; New</span><br><span class="line">(</span><br><span class="line">    ReactionThermo&amp; thermo,</span><br><span class="line">    <span class="keyword">const</span> compressibleTurbulenceModel&amp; turb,</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; combustionProperties=combustionPropertiesName <span class="comment">//默认值是 combustionPropertiesName</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>定义于它的 C 文件中，返回类型是 <code>autoPtr&lt;CombustionModel&gt;</code>，<code>CombustionModel</code> 需要一个模板，我们给它的是 <code>psiReactionThermo</code>。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:autoPtr&lt;Foam::CombustionModel&lt;ReactionThermo&gt;&gt;</span><br><span class="line">Foam::CombustionModel&lt;ReactionThermo&gt;::New</span><br><span class="line">(</span><br><span class="line">    ReactionThermo&amp; thermo,</span><br><span class="line">    <span class="keyword">const</span> compressibleTurbulenceModel&amp; turb,</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; combustionProperties</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">        combustionModel::New&lt;CombustionModel&lt;ReactionThermo&gt;&gt;</span><br><span class="line">        <span class="comment">// 这里发现这个 New 调用时需要给它模板，我们给的就是 CombustionModel&lt;psiReactionThermo&gt;</span></span><br><span class="line">        (</span><br><span class="line">            thermo,</span><br><span class="line">            turb,</span><br><span class="line">            combustionProperties</span><br><span class="line">        );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用了它的基类 combustionModel（但没有在 C 文件中定义）的 New 函数：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Selectors</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//- Generic New for each of the related chemistry model</span></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CombustionModel</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="title">static</span> <span class="title">autoPtr</span>&lt;CombustionModel&gt; <span class="title">New</span></span></span><br><span class="line"><span class="class">    (</span></span><br><span class="line"><span class="class">        <span class="title">typename</span> <span class="title">CombustionModel</span>:</span>:reactionThermo&amp; thermo,</span><br><span class="line">        <span class="keyword">const</span> compressibleTurbulenceModel&amp; turb,</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">word</span>&amp; combustionProperties</span><br><span class="line">    );</span><br></pre></td></tr></table></figure><p>上边这个 New 函数发现是在 <code>combustionModelTemplates.C</code> 中定义的。<br>这里的 <code>CombustionModel</code> 就是 <code>CombustionModel</code>，<code>reactionThermo</code> 是它的模板 <code>ReactionThermo</code>，我们在这里指定它为 <code>psiReactionThermo</code>。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CombustionModel</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:autoPtr&lt;CombustionModel&gt; Foam::combustionModel::New</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">typename</span> CombustionModel::reactionThermo&amp; thermo,</span><br><span class="line">    <span class="keyword">const</span> compressibleTurbulenceModel&amp; turb,</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; combustionProperties</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">word</span> <span class="title">combModelName</span><span class="params">(<span class="string">"none"</span>)</span></span>;</span><br><span class="line">    IOdictionary(combIO).lookup(<span class="string">"combustionModel"</span>) &gt;&gt; combModelName;</span><br><span class="line">    Info&lt;&lt; <span class="string">"Selecting combustion model "</span> &lt;&lt; combModelName &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// 字典 combustionProperties 里写的那个名字，如 laminar</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">typename</span> CombustionModel::dictionaryConstructorTable cstrTableType;</span><br><span class="line"><span class="comment">//这是在 declareRunTimeSelectionTable 中的那个 HashTable</span></span><br><span class="line">    cstrTableType* cstrTable = CombustionModel::dictionaryConstructorTablePtr_;</span><br><span class="line"><span class="comment">//dictionaryConstructorTablePtr_ 在 declareRunTimeSelectionTable 申明过</span></span><br><span class="line"><span class="comment">// 并且在 constructdictionaryConstructorTables() 这个函数中分派了实际指向的对象。</span></span><br><span class="line"><span class="comment">//这个函数申明于 declareRunTimeSelectionTable，定义于 defineTemplateRunTimeSelectionTable</span></span><br><span class="line"><span class="comment">//而这个函数又在 adddictionaryConstructorToTable 的构造函数中被调用</span></span><br><span class="line"><span class="comment">//adddictionaryConstructorToTable，即 add##argNames##ConstructorToTable 在 declareRunTimeSelectionTable 中定义</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span> compCombModelName =</span><br><span class="line">        combModelName + <span class="string">'&lt;'</span> + CombustionModel::reactionThermo::typeName + <span class="string">'&gt;'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span> thermoCombModelName =</span><br><span class="line">        combModelName + <span class="string">'&lt;'</span> + CombustionModel::reactionThermo::typeName + <span class="string">','</span></span><br><span class="line">      + thermo.thermoName() + <span class="string">'&gt;'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">typename</span> cstrTableType::iterator compCstrIter =</span><br><span class="line">        cstrTable-&gt;<span class="built_in">find</span>(compCombModelName);</span><br><span class="line"><span class="comment">//在哈希表中查询，key 是 laminar&lt;psiReactionThermo&gt; ，返回值是  返回指向基类autoPtr的New函数</span></span><br><span class="line">    <span class="keyword">typename</span> cstrTableType::iterator thermoCstrIter =</span><br><span class="line">        cstrTable-&gt;<span class="built_in">find</span>(thermoCombModelName);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> autoPtr&lt;CombustionModel&gt;</span><br><span class="line">    (</span><br><span class="line">        thermoCstrIter != cstrTable-&gt;<span class="built_in">end</span>()</span><br><span class="line">      ? thermoCstrIter()(combModelName, thermo, turb, combustionProperties)</span><br><span class="line">      : compCstrIter()(combModelName, thermo, turb, combustionProperties)</span><br><span class="line">      <span class="comment">//modeltype 从这里由 combModelName 传入！！！如 laminar</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>里边用到了一个类：<code>CombustionModel::dictionaryConstructorTable</code>，它是在 <code>declareRunTimeSelectionTable</code> 中定义的，就是那个哈希表的别名。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> HashTable&lt;argNames##ConstructorPtr, <span class="keyword">word</span>, <span class="built_in">string</span>::hash&gt;</span><br><span class="line">    argNames##ConstructorTable; <span class="comment">//argNames 是 dictionary</span></span><br></pre></td></tr></table></figure><p>因为是在 <code>CombustionModel.H</code> 中调用的 <code>declareRunTimeSelectionTable</code>，于是 <code>CombustionModel::dictionaryConstructorTable</code> 就被定义好了。</p><h3 id="laminarsc-2"><a class="markdownIt-Anchor" href="#laminarsc-2"></a> laminars.C</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">makeCombustionTypes(laminar, psiReactionThermo);</span><br></pre></td></tr></table></figure><p>而这个函数定义于 makeCombustionTypes.H：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> makeCombustionTypes(CombModel, Comp)                                   \</span></span><br><span class="line">                                                                               \</span><br><span class="line">    <span class="keyword">typedef</span> combustionModels::CombModel&lt;Comp&gt; CombModel##Comp;                 \</span><br><span class="line">                                                                               \</span><br><span class="line">    defineTemplateTypeNameAndDebugWithName                                     \</span><br><span class="line">    (                                                                          \</span><br><span class="line">        CombModel##Comp,                                                       \</span><br><span class="line">        (                                                                      \</span><br><span class="line">            <span class="keyword">word</span>(CombModel##Comp::typeName_()) + <span class="string">"&lt;"</span> + Comp::typeName + <span class="string">"&gt;"</span>    \</span><br><span class="line">        ).c_str(),                                                             \</span><br><span class="line">        <span class="number">0</span>                                                                      \</span><br><span class="line">    );                                                                         \</span><br><span class="line">                                                                               \</span><br><span class="line">    CombustionModel&lt;Comp&gt;::                                                    \</span><br><span class="line">        add#<span class="meta">#dictionary##ConstructorToTable<span class="meta-string">&lt;CombModel##Comp&gt;                   \</span></span></span><br><span class="line">        add##CombModel##Comp#<span class="meta">#dictionary##ConstructorTo##CombustionModel##Comp\</span></span><br><span class="line">##Table_;</span><br><span class="line"><span class="comment">//这句话的作用和 addToRunTimeSelectionTable 一致，都是创建一个 add 类的对象，创建它的同时，将返回 指向派生类对象的基类指针 的 New 函数插进了 HashTable，即 dictionaryConstructorTable。后续就是在这个里边 find 我们在字典文件中指定的派生类。</span></span><br></pre></td></tr></table></figure><p>CombModel 是 laminar，Comp 是 psiReactionThermo<br>将 <code>combustionModels::laminar&lt;psiReactionThermo&gt;</code> 重命名为 <code>laminar##psiReactionThermo</code>。<br>在 <code>CombustionModel&lt;psiReactionThermo&gt;</code> 的命名空间下，<br>创建了类型为 <code>adddictionaryConstructorToTable&lt;laminar##psiReactionThermo&gt;</code> 的对象。于是在这里调用了 <code>adddictionaryConstructorToTable</code> 的构造函数！！！倒退至前边所述，这个构造函数中调用了 <code>constructdictionaryConstructorTables()</code>，作用是给 <code>dictionaryConstructorTablePtr_</code> new 一个对象，类型是 <code>dictionaryConstructorTable</code> ，即 <code>HashTable</code>。并且构造函数中还向该<code>dictionaryConstructorTablePtr_</code> insert 了 New 函数：<br>这个函数 <code>new</code> 了一个对象，并将其绑定至基类的指针，该对象的类型是 <code>baseType##Type</code>，即 <code>add</code> 这个类的模板的类型，而我们在这里给它的模板是 laminar##psiReactionThermo。就是说，我们在派生类中创建add这个类的对象时，同时向哈希表中插入了一组key and value，即派生类的typeName和返回指向派生类对象的基类指针的New函数！</p><h3 id="总结-2"><a class="markdownIt-Anchor" href="#总结-2"></a> 总结</h3><p><code>declareRunTimeSelectionTable</code> 创建了一个哈希表的指针 <code>argNames##ConstructorTablePtr_</code>，但是没有给它分配对象。只有当创建第一个 <code>add##argNames##ConstructorToTable&lt;baseType##Type&gt;</code> 对象时，才会 <code>new</code> 一个<code>baseType::argNames##ConstructorTable</code> 对象给它指向。这是这个函数的功能：<code>construct##argNames##ConstructorTables</code>（申明于 <code>declareRunTimeSelectionTable(autoPtr,baseType,argNames,argList,parList)</code>，定义于<code>defineRunTimeSelectionTableConstructor(baseType,argNames)</code>）。<br>此外，创建每个 <code>add##argNames##ConstructorToTable&lt;baseType##Type&gt;</code> 对象时，都会调用它的构造函数，该构造函数数向 <code>argNames##ConstructorTablePtr_</code> 插入一组 key and value：<code>baseType##Type::typeName</code> 和 <code>New</code> 函数。<br>说起这个 <code>New</code> 函数，那就大有来头，它返回基类指针，但是指向的对象类型是 <code>baseType##Type</code>，即<code>add##argNames##ConstructorToTable&lt;baseType##Type&gt;</code> 这个类的模板。<br>我们经常在派生类中创建一个 <code>add</code> 的对象，如：<code>laminars.C</code> 中的 <code>makeCombustionTypes</code> 中的：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CombustionModel&lt;Comp&gt;::add##dictionary##ConstructorToTable&lt;CombModel##Comp&gt;</span><br><span class="line">        add##CombModel##Comp##dictionary##ConstructorTo##CombustionModel##Comp##Table_;</span><br></pre></td></tr></table></figure><p>模板是 <code>laminar##psiReactionThermo</code>，即往哈希表中插入的 <code>New</code> 函数，返回值是基类指针，指向的是 <code>laminar##psiReactionThermo</code> 的对象</p></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="mailto:undefined" rel="external nofollow noopener noreferrer" target="_blank">Yan Zhang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="https://openfoam.top/chemistry/">https://openfoam.top/chemistry/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="external nofollow noopener noreferrer">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://openfoam.top">OpenFOAM 成长之路</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/thermophysicalModels/">thermophysicalModels</a><a class="post-meta__tags" href="/tags/RTS/">RTS</a><a class="post-meta__tags" href="/tags/combustionModels/">combustionModels</a></div><div class="post-qr-code"><div class="post-qr-code-item"><img class="post-qr-code__img" src="/album/wechatPay.jpg"><div class="post-qr-code__desc">您的肯定会给我更大动力~</div></div></div><div class="social-share pull-right" data-disabled="tencent,douban,qzone,diandian,facebook,twitter,google"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/programmingNote/"><i class="fa fa-chevron-left"></i><span>OpenFOAM 编程笔记</span></a></div><div class="next-post pull-right"><a href="/compile/"><span>编译报错总结</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitalk-container"></div><script>var gitalk=new Gitalk({clientID:"9dfad189aeefc4c2dde2",clientSecret:"69b4d95e0c4be2508135adae20b05bf6f298f386",repo:"zhangyantju.github.io",owner:"ZhangYanTJU",admin:"ZhangYanTJU",id:md5(decodeURI(location.pathname)),language:"zh-CN"});gitalk.render("gitalk-container")</script></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2020 By Yan Zhang</div><div class="framework-info"><span>驱动 -</span> <a href="http://hexo.io" target="_blank" rel="external nofollow noopener noreferrer"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 -</span> <a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="external nofollow noopener noreferrer"><span>Melody</span></a></div><div class="footer_custom_text">Hosted by <a target="_blank" rel="external nofollow noopener noreferrer" href="https://pages.coding.me"><b>Coding Pages</b></a></div></div><script id="maid-script" src="https://unpkg.com/mermaid@8.5.1/dist/mermaid.min.js?v=undefined"></script><script>if(window.mermaid){var options=JSON.parse(document.getElementById("maid-script").getAttribute("mermaidoptioins"));mermaid.initialize(options)}</script></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.7.0"></script><script src="/js/fancybox.js?version=1.7.0"></script><script src="/js/sidebar.js?version=1.7.0"></script><script src="/js/copy.js?version=1.7.0"></script><script src="/js/fireworks.js?version=1.7.0"></script><script src="/js/transition.js?version=1.7.0"></script><script src="/js/scroll.js?version=1.7.0"></script><script src="/js/head.js?version=1.7.0"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script src="/js/katex.js"></script><script src="/js/search/local-search.js"></script><script>/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)&&($("#nav").addClass("is-mobile"),$("footer").addClass("is-mobile"),$("#top-container").addClass("is-mobile"))</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="external nofollow noopener noreferrer" style="color:#49b1f5">hexo-generator-search</a> <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>