<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="Linux 命令收藏"><meta name="keywords" content="Linux,shell"><meta name="author" content="Yan Zhang"><meta name="copyright" content="Yan Zhang"><title>Linux 命令收藏 | OpenFOAM 成长之路</title><link rel="shortcut icon" href="/album/192.jpg"><link rel="stylesheet" href="/css/index.css?version=1.9.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?38997e7d3b8e8c254bf0ddb7d2452127";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject="ga",e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script"),ga("create","UA-119919860-1","auto"),ga("send","pageview")</script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"找不到您查询的内容:${query}"}},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},hexoVersion:"6.3.0"}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="OpenFOAM 成长之路" type="application/atom+xml"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B9%B6%E8%A1%8C"><span class="toc-number">1.</span> <span class="toc-text">并行</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#grep"><span class="toc-number">2.</span> <span class="toc-text">grep</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="toc-number">2.1.</span> <span class="toc-text">基本用法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#find"><span class="toc-number">3.</span> <span class="toc-text">find</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95-2"><span class="toc-number">3.1.</span> <span class="toc-text">基本用法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#find-rename"><span class="toc-number">3.2.</span> <span class="toc-text">find &amp; rename</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#find-grep"><span class="toc-number">3.3.</span> <span class="toc-text">find &amp; grep</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#find-rm"><span class="toc-number">3.4.</span> <span class="toc-text">find &amp; rm</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#find-sed"><span class="toc-number">3.5.</span> <span class="toc-text">find &amp; sed</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95"><span class="toc-number">3.6.</span> <span class="toc-text">高级用法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sed"><span class="toc-number">4.</span> <span class="toc-text">sed</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8-option"><span class="toc-number">4.1.</span> <span class="toc-text">常用 OPTION</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">4.2.</span> <span class="toc-text">文件操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%AE%9E%E4%BE%8B"><span class="toc-number">4.3.</span> <span class="toc-text">操作实例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%A1%8C"><span class="toc-number">4.3.1.</span> <span class="toc-text">删除行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%BF%E6%8D%A2%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">4.3.2.</span> <span class="toc-text">替换字符串</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E7%94%A8%E6%B3%95"><span class="toc-number">4.4.</span> <span class="toc-text">扩展用法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%BD%AF%E9%93%BE%E6%8E%A5%E5%AF%B9%E5%BA%94%E7%9A%84%E7%9C%9F%E5%AE%9E%E6%96%87%E4%BB%B6"><span class="toc-number">4.4.1.</span> <span class="toc-text">修改软链接对应的真实文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E5%85%B3%E9%94%AE%E5%AD%97%E7%84%B6%E5%90%8E%E6%9B%BF%E6%8D%A2%E4%B8%8B%E4%B8%80%E8%A1%8C%E7%9A%84%E6%9F%90%E4%B8%AA%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">4.4.2.</span> <span class="toc-text">匹配关键字，然后替换下一行的某个关键字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E5%85%B3%E9%94%AE%E5%AD%97%E7%84%B6%E5%90%8E%E6%9B%BF%E6%8D%A2%E6%8E%89%E6%95%B4%E4%B8%AA%E4%B8%8B%E4%B8%80%E8%A1%8C"><span class="toc-number">4.4.3.</span> <span class="toc-text">匹配关键字，然后替换掉整个下一行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%BF%E6%8D%A2%E5%A4%9A%E8%A1%8C"><span class="toc-number">4.4.4.</span> <span class="toc-text">替换多行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E4%B8%AD%E5%8C%85%E5%90%AB%E6%9F%90%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E9%82%A3%E4%B8%80%E8%A1%8C"><span class="toc-number">4.4.5.</span> <span class="toc-text">修改文件中包含某个字符串的那一行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%BF%E6%8D%A2%E6%9F%90%E5%88%97"><span class="toc-number">4.4.6.</span> <span class="toc-text">替换某列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8C%E6%97%B6%E6%9B%BF%E6%8D%A2%E5%A4%9A%E4%B8%AA"><span class="toc-number">4.4.7.</span> <span class="toc-text">同时替换多个</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">4.4.8.</span> <span class="toc-text">注意事项</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#awk"><span class="toc-number">5.</span> <span class="toc-text">awk</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F"><span class="toc-number">6.</span> <span class="toc-text">排序</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF-%E8%87%AA%E5%A2%9E%E6%93%8D%E4%BD%9C"><span class="toc-number">7.</span> <span class="toc-text">循环、自增操作</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%88%A4%E6%96%AD"><span class="toc-number">8.</span> <span class="toc-text">字符串判断</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E5%A4%A7%E5%B0%8F"><span class="toc-number">9.</span> <span class="toc-text">判断大小</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B4%E6%95%B0%E9%97%B4%E7%9A%84%E5%88%A4%E6%96%AD"><span class="toc-number">9.1.</span> <span class="toc-text">整数间的判断</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E6%95%B0%E9%97%B4%E7%9A%84%E5%88%A4%E6%96%AD"><span class="toc-number">9.2.</span> <span class="toc-text">实数间的判断</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6except-some-file"><span class="toc-number">10.</span> <span class="toc-text">删除所有文件，except some file</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E7%BB%84"><span class="toc-number">11.</span> <span class="toc-text">数组</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%A5%E8%87%AA%E5%88%AB%E7%9A%84%E7%A8%8B%E5%BA%8F%E8%BE%93%E5%87%BA%E7%9A%84%E6%95%B0%E7%BB%84"><span class="toc-number">11.1.</span> <span class="toc-text">来自别的程序输出的数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E6%95%B0%E7%BB%84%E5%B9%B6%E9%81%8D%E5%8E%86"><span class="toc-number">11.2.</span> <span class="toc-text">指定数组并遍历</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8E%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E4%B8%80%E4%B8%AA%E6%95%B0%E7%BB%84"><span class="toc-number">11.3.</span> <span class="toc-text">从文件读取一个数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E6%9C%80%E5%A4%A7%E5%80%BC"><span class="toc-number">11.4.</span> <span class="toc-text">计算最大值</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%9E%E6%95%B0%E8%BF%90%E7%AE%97"><span class="toc-number">12.</span> <span class="toc-text">实数运算</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B4%E6%95%B0%E7%9A%84%E5%8A%A0%E5%87%8F%E4%B9%98%E9%99%A4"><span class="toc-number">12.1.</span> <span class="toc-text">整数的加减乘除：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E6%95%B0%E7%82%B9%E4%BD%8D%E6%95%B0"><span class="toc-number">12.2.</span> <span class="toc-text">小数点位数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%AE%E7%82%B9%E6%95%B0%E7%9A%84%E5%8A%A0%E5%87%8F%E4%B9%98%E9%99%A4"><span class="toc-number">12.3.</span> <span class="toc-text">浮点数的加减乘除：</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E5%90%8D"><span class="toc-number">13.</span> <span class="toc-text">修改文件名</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%88%E6%9D%A5%E7%82%B9%E7%AE%80%E5%8D%95%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="toc-number">13.1.</span> <span class="toc-text">先来点简单的操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%8D%E6%9D%A5%E7%82%B9%E9%AB%98%E7%BA%A7%E7%9A%84"><span class="toc-number">13.2.</span> <span class="toc-text">再来点高级的</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/album/192.jpg"></div><div class="author-info__name text-center">Yan Zhang</div><div class="author-info__description text-center">OpenFOAM 成长之路</div><div class="follow-button"><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/ZhangYanTJU">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">43</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">35</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">8</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">友情链接</div><a class="author-info-links__name text-center" target="_blank" rel="external nofollow noopener noreferrer" href="https://zmeng.tech/">Zmeng Blogs</a></div></div></div><div id="content-outer"><div class="plain" id="top-container"><div id="page-header"><span class="pull-left"><a id="site-name" href="/">OpenFOAM 成长之路</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i> <span class="pull-right menus"><a class="site-page" href="/">首页</a><a class="site-page" href="/about">关于</a><a class="site-page" href="/release">Timeline</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i> <span>搜索</span></a></span></div></div><div class="layout" id="content-inner"><article id="post"><div class="plain" id="post-title">Linux 命令收藏</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-02-01</time><span class="post-meta__separator">|</span><i class="fa fa-inbox" aria-hidden="true"></i> <a class="post-meta__categories" href="/categories/Linux/">Linux</a><span class="post-meta__separator">|</span><span class="post-meta-wordcount"><span>字数总计:</span> <span class="word-count">3.4k</span><span class="post-meta__separator">|</span><span>阅读时长: 14 分钟</span></span></div><div class="article-container" id="post-content"><p>一些很有用的 Linux 命令</p><span id="more"></span><h1 id="并行"><a class="markdownIt-Anchor" href="#并行"></a> 并行</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">耗时 5 分半</span></span><br><span class="line">ls *.kg| xargs sed -i 1d</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">耗时 40 秒</span></span><br><span class="line">ls *.kg| xargs -P 28 sed -i 1d</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-P 0 表示使用所有拥有的核来并行</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">耗时 40 秒</span></span><br><span class="line">ls *.kg| xargs -P 0 sed -i 1d</span><br></pre></td></tr></table></figure><h1 id="grep"><a class="markdownIt-Anchor" href="#grep"></a> grep</h1><h2 id="基本用法"><a class="markdownIt-Anchor" href="#基本用法"></a> 基本用法</h2><p>Usage: grep [OPTION]… PATTERN [FILE]…<br>Example: grep -i ‘hello world’ menu.h main.c</p><p>字段</p><p>-r 遍历某个文件夹，而不是只搜索某个文件<br>-n 显示行号</p><p>搜索整个 OpenFOAM solvers 文件夹，找到所有文件内容包含 LES 的文件</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">grep -rn LES $FOAM_SOLVERS</span><br></pre></td></tr></table></figure><h1 id="find"><a class="markdownIt-Anchor" href="#find"></a> find</h1><h2 id="基本用法-2"><a class="markdownIt-Anchor" href="#基本用法-2"></a> 基本用法</h2><p>查找目录：find （查找范围） -name ‘查找关键字’ -type d<br>查找文件：find （查找范围） -name 查找关键字</p><p>搜索默认将在当前目录中开始</p><p>查找当前目录下 abort 开头的文件</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find ./ -name &#x27;abort*&#x27;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">or</span></span><br><span class="line">find ./ -name abort*</span><br></pre></td></tr></table></figure><p>但是上边这个命令会输出子文件夹里边的 abort* 文件。<br>我只想输出当前目录下的呢？</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find . -maxdepth 1 -name abort*</span><br></pre></td></tr></table></figure><p>查找 OpenFOAM solvers 文件夹，找到所有文件名包含 fvPatch 的文件</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find $FOAM_SOLVERS -name “*fvPatch*”</span><br></pre></td></tr></table></figure><h2 id="find-rename"><a class="markdownIt-Anchor" href="#find-rename"></a> find &amp; rename</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find . -type f -name sourcePV -execdir mv sourcePV SourcePV \;</span><br></pre></td></tr></table></figure><h2 id="find-grep"><a class="markdownIt-Anchor" href="#find-grep"></a> find &amp; grep</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find -name &quot;fvSolution&quot; | xargs grep PBiCGStab</span><br></pre></td></tr></table></figure><h2 id="find-rm"><a class="markdownIt-Anchor" href="#find-rm"></a> find &amp; rm</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find . -name &#x27;C7H16*&#x27; | xargs rm</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这个比较高效</span></span><br><span class="line">find . -name &#x27;C7H16*&#x27; -print0 | xargs -0 rm</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">删除除了 `C12` 开头以外的其它文件</span></span><br><span class="line">find . -name &#x27;[^C][^1][^2]*&#x27; -print0 | xargs -0 rm -rf</span><br></pre></td></tr></table></figure><h2 id="find-sed"><a class="markdownIt-Anchor" href="#find-sed"></a> find &amp; sed</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">找到所有的 *.C *.H 文件，删除行尾空格和 tab</span></span><br><span class="line">find . -name *.[C\|H] -exec sed -i &quot;s/[ \t]*$//g&quot; &#123;&#125; +</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">找到所有的 *.C *.H 文件，将所有 tab 替换成 4 个空格</span></span><br><span class="line">find . -name *.[C\|H] -exec sed -i &quot;s/\t/    /g&quot; &#123;&#125; +</span><br></pre></td></tr></table></figure><h2 id="高级用法"><a class="markdownIt-Anchor" href="#高级用法"></a> 高级用法</h2><p>在 Linux 库中搜索文件时，有时会提示没有权限，可以将这些提示重定向到 / dev/null</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find -name libgcc.so 2&gt;/dev/null</span><br></pre></td></tr></table></figure><p>对于文件夹</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find -name &#x27;C7H16*&#x27; | xargs rm -r</span><br></pre></td></tr></table></figure><h1 id="sed"><a class="markdownIt-Anchor" href="#sed"></a> sed</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Usage: sed [OPTION]... &#123;script-only-if-no-other-script&#125; [input-file]</span><br></pre></td></tr></table></figure><h2 id="常用-option"><a class="markdownIt-Anchor" href="#常用-option"></a> 常用 OPTION</h2><ul><li><code>-i</code> 直接修改文件</li><li><code>-r</code> use extended regular expressions in the script</li></ul><h2 id="文件操作"><a class="markdownIt-Anchor" href="#文件操作"></a> 文件操作</h2><ul><li>d 删除</li><li>a 在下一行新增</li><li>i 在上一行插入</li><li>c 以行为单位的取代</li><li>s 替换</li></ul><h2 id="操作实例"><a class="markdownIt-Anchor" href="#操作实例"></a> 操作实例</h2><h3 id="删除行"><a class="markdownIt-Anchor" href="#删除行"></a> 删除行</h3><p>删除第一行</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sed -i &#x27;1d&#x27; &lt;filename&gt;</span><br></pre></td></tr></table></figure><p>删除最后一行</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sed -i &#x27;$d&#x27; &lt;filename&gt;</span><br></pre></td></tr></table></figure><p>删除第 N 行<br>sed -i ‘Nd’<filename></filename></p><p>删除 1 到 20 行，Linux 下标是从 1 开始的</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sed -i &#x27;1,20d&#x27; &lt;filename&gt;</span><br></pre></td></tr></table></figure><p>从第 1 行开始, 每隔 2 行删除，即删除 1··3··5··7·· 行。</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sed -i 1~2d &lt;filename&gt;</span><br></pre></td></tr></table></figure><p>删除空行</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sed &#x27;/^\s*$/d&#x27; fileName</span><br></pre></td></tr></table></figure><p>删除重复行</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">awk &#x27;!a[$0]++&#x27; fileName</span><br></pre></td></tr></table></figure><p>删除文件中含特定字符串（如 abc）的行</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">这个操作好像不能使用 -i ，只能把结果重定向到一个新的文件</span></span><br><span class="line">sed -e &#x27;/abc/d&#x27; fileName &gt;fileName_NEW</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">这样是不对的，生成的 fileName 是一个空文件</span></span><br><span class="line">sed -e &#x27;/abc/d&#x27; fileName &gt;fileName</span><br></pre></td></tr></table></figure><p>删除文件中包含某个关键字开头的所有行</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sed -i &#x27;/^abc/d&#x27; &lt;fileName&gt;</span><br></pre></td></tr></table></figure><p>删除 m 字符结尾的所有行</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sed &#x27;/m$/d&#x27; &lt;fileName&gt;</span><br></pre></td></tr></table></figure><p>删除 x 或者 m 字符结尾的所有行</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sed &#x27;/[xm]$/d&#x27; &lt;fileName&gt;</span><br></pre></td></tr></table></figure><h3 id="替换字符串"><a class="markdownIt-Anchor" href="#替换字符串"></a> 替换字符串</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sed -r -i &#x27;s/被替换字符/替换后的字符/g&#x27; &lt;filename&gt;</span><br></pre></td></tr></table></figure><p>如果被替换的字符串中有变量，把最外层的单引号改成双引号</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">var=300</span><br><span class="line">sed -r &quot;s/200/$var/g&quot; &lt;filename&gt;</span><br></pre></td></tr></table></figure><p>删除某些字符串，即把它替换成空</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sed -r -i &#x27;s/欲删除字符串//g&#x27; &lt;filename&gt;</span><br></pre></td></tr></table></figure><p>删除行尾空格</p><p>删除行尾 tab</p><p>最对某行进行操作</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">只对第一行进行操作</span></span><br><span class="line">sed -i &#x27;1s / 被替换字符串 / 新字符串 / g&#x27;</span><br></pre></td></tr></table></figure><p>我定义的函数，用于清理 OpenFOAM 代码</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ofFormat () &#123;</span><br><span class="line">    # 删除行尾空格和 tab</span><br><span class="line">    find . -name *.[C\|H] -exec sed -i &quot;s/[ \t]*$//g&quot; &#123;&#125; +</span><br><span class="line">    # 将所有 tab 替换成 4 个空格</span><br><span class="line">    find . -name *.[C\|H] -exec sed -i &quot;s/\t/    /g&quot; &#123;&#125; +</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="扩展用法"><a class="markdownIt-Anchor" href="#扩展用法"></a> 扩展用法</h2><h3 id="修改软链接对应的真实文件"><a class="markdownIt-Anchor" href="#修改软链接对应的真实文件"></a> 修改软链接对应的真实文件</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sed -i --follow-symlinks &quot;操作&quot; settings.csf</span><br></pre></td></tr></table></figure><h3 id="匹配关键字然后替换下一行的某个关键字"><a class="markdownIt-Anchor" href="#匹配关键字然后替换下一行的某个关键字"></a> 匹配关键字，然后替换下一行的某个关键字</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">找到 BOUNDARY_INLETTEMPERATURE 的下一行，将 900 替换为 <span class="variable">$&#123;temperature&#125;</span> 这个变量的值</span></span><br><span class="line">sed -i --follow-symlinks &quot;/BOUNDARY_INLETTEMPERATURE/&#123;n;s/900/$&#123;temperature&#125;/;&#125;&quot; $case/settings.csf</span><br></pre></td></tr></table></figure><h3 id="匹配关键字然后替换掉整个下一行"><a class="markdownIt-Anchor" href="#匹配关键字然后替换掉整个下一行"></a> 匹配关键字，然后替换掉整个下一行</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将 BOUNDARY_INLETTEMPERATURE 的下一行，修改为 985</span></span><br><span class="line">sed -i --follow-symlinks &#x27;/BOUNDARY_INLETTEMPERATURE/!b;n;c985&#x27; $case/settings.csf</span><br></pre></td></tr></table></figure><p>但是将下一行改为变量，还有问题</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sed -i --follow-symlinks &#x27;/BOUNDARY_INLETTEMPERATURE/!b;n;c$&#123;pressure&#125;&#x27; $case/settings.csf</span><br></pre></td></tr></table></figure><p>这个只会将下一行改为 <code>$&#123;temperature&#125;</code> 这个字符串，而不是这个变量的值。</p><h3 id="替换多行"><a class="markdownIt-Anchor" href="#替换多行"></a> 替换多行</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">## 生成 C list</span></span></span><br><span class="line">python&lt;&lt;EOF</span><br><span class="line">import numpy as np</span><br><span class="line">x=np.linspace(0,1,51)</span><br><span class="line">y=x*x</span><br><span class="line">f = open(&quot;Clist&quot;, &#x27;w+&#x27;)</span><br><span class="line">for y in y:</span><br><span class="line">    print&gt;&gt;f,y</span><br><span class="line">EOF</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将换行符替换成 <span class="comment">#，将 abc 缩为一行。</span></span></span><br><span class="line">abc=`awk &#x27;&#123;print $1&#125;&#x27; Clist|tr &quot;\n&quot; &quot;#&quot;`</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将 C_list 下面的括号中的所有行，替换成 abc。</span></span><br><span class="line">sed -i -e &#x27;&#123;:begin;  /)/! &#123; $! &#123; N; b begin &#125;; &#125;; s/C_list\n(.*)/C_list\n(\n&#x27;$&#123;abc&#125;&#x27;)/; &#125;;&#x27; ./file</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将 <span class="comment"># 替换成换行符，就是将 abc 还原成了一个多行数据。</span></span></span><br><span class="line">sed -i &#x27;s/#/\n/g&#x27; ./fileName</span><br></pre></td></tr></table></figure><p>这里用 python 先生成一个数组，然后输出到文件，然后读取这个文件，读取出来是一列数据，我打算将这一列数据替换掉某个文件中的一列其它数据。</p><h3 id="修改文件中包含某个字符串的那一行"><a class="markdownIt-Anchor" href="#修改文件中包含某个字符串的那一行"></a> 修改文件中包含某个字符串的那一行</h3><p>适合在脚本中修改 OpenFOAM 的参数设置，不过现在 OpenFOAM 有了自带的脚本来干这件事：<code>foamDictionary</code>。</p><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://blog.csdn.net/u010312436/article/details/48376725">参考</a></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">PBS -N caseName</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">PBS -l nodes=2:ppn=10</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">PBS -j oe</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">PBS -l walltime=150:30:00</span></span><br><span class="line"></span><br><span class="line">cd $PBS_O_WORKDIR</span><br><span class="line">NP=`cat $PBS_NODEFILE|wc -l`</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">取得行号</span></span><br><span class="line">n=`grep -n &quot;numberOfSubdomains&quot; system/decomposeParDict | awk -F&#x27;:&#x27; &#x27;&#123;print $1&#125;&#x27;`</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这里表示修改第 n 行，c 表示修改某一行</span></span><br><span class="line">sed -i &quot;$[n]c numberOfSubdomains $NP;&quot; system/decomposeParDict</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">blockMesh</span><br><span class="line">decomposePar -force</span><br><span class="line">mpirun -np $NP -hostfile $PBS_NODEFILE reactingFoam -parallel 2&gt;&amp;1 | tee run.log</span><br></pre></td></tr></table></figure><p>这里的 NP 就是所使用的核心数，这里等于 20，对应脚本中的 <code>nodes=2:ppn=10</code>。</p><h3 id="替换某列"><a class="markdownIt-Anchor" href="#替换某列"></a> 替换某列</h3><p>把第 79 列替换成空格，这里的 点 表示任意单个字符</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sed -i &#x27;s/./ /79&#x27; &lt;filename&gt;</span><br></pre></td></tr></table></figure><h3 id="同时替换多个"><a class="markdownIt-Anchor" href="#同时替换多个"></a> 同时替换多个</h3><p>用法</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ls *.kg | xargs sed -i &#x27;s / 被替串 1 / 新串 1/g;s / 被替串 2 / 新串 2/;s / 被替串 3 / 新串 3/;s / 被替串 4 / 新串 4/&#x27;</span><br></pre></td></tr></table></figure><p>举例<br>但是它不适合替换多个相同的字符，只会替换第一个，因为没有加 <code>g</code> 吗？</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">匹配所有 .kg 为后缀的文件</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将 temperature [K] 替换为 T</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将 ProdRateProgVar [kg/m^3s] 替换为 ProdRateProgVar</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将 density [kg/m^3] 替换为 rho</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将 SumMH [J/m^3s] 替换为 HeatRelease</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将 massfraction- 替换为空</span></span><br><span class="line">ls *.kg | xargs sed -i &#x27;1s/temperature \[K\]/T/g;1s/ProdRateProgVar [kg/m^3s]/ProdRateProgVar/;1s/density [kg/m^3]/rho/;1s/SumMH [J/m^3s]/HeatRelease/&#x27;</span><br></pre></td></tr></table></figure><h3 id="注意事项"><a class="markdownIt-Anchor" href="#注意事项"></a> 注意事项</h3><p>遇到特殊字符，在前边加反斜杠 <code>\</code>。<br>空格不算特殊字符，前边不需要反斜杠。</p><p>sed ‘s///g’ 与 sed ‘s///’ 的区别</p><ul><li>加 g，匹配每一行有行首到行尾的所有字符</li><li>不加 g，匹配每一行的行首开始匹配，匹配到第一个符合的字段，就会结束，跳到下一行</li></ul><h1 id="awk"><a class="markdownIt-Anchor" href="#awk"></a> awk</h1><p>基本用法：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">awk -F &quot;用于分隔的符号或者字符串&quot; &#x27;&#123;print $ 分隔后你需要的列号&#125;&#x27;</span><br></pre></td></tr></table></figure><p>awk 提取某一列字符, 如：</p><pre> stp<font size="4" color="red"><b>=</b></font>1    dt<font size="4" color="red"><b>=</b></font>1.00e-09 s    ord<font size="4" color="red"><b>=</b></font> 1    time<font size="4" color="red"><b>=</b></font><font size="4" color="green"><b>1e-06 ms	T_max</b></font><font size="4" color="red"><b>=</b></font>  897.7 K	T_st<font size="4" color="red"><b>=</b></font> 875.1 K</pre><p>有一个 log 文件，格式的每一行如上所示，现在需要提取 time 到一个新的文件，代码如下：</p><pre>grep stp log |awk -F "<font size="4" color="red"><b>=</b></font>"'{print $5}'|awk -F"<font size="4" color="red"><b>ms</b></font>"'{print $1}' >time</pre><p>解释，grep 是获取 log 文件中含有 stp 的所有行。<br>awk 的主要功能是对列操作，这里按 “等于” 号将每一行分隔为若干列。<br>然后取第 5 列，获得字符串 <code>1e-06 ms T_max</code>。<br>最后将 <code>1e-06 ms T_max</code> 按 ms 分为两列，取第 1 列，即我们需要的 “时间”。</p><p>列数为变量时如何使用：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">awk -v N=274 &#x27;&#123;print $N&#125;&#x27; &lt;fileName&gt;</span><br></pre></td></tr></table></figure><p>获取第 274 列数据。</p><h1 id="排序"><a class="markdownIt-Anchor" href="#排序"></a> 排序</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sort [OPTION]... [FILE]</span><br></pre></td></tr></table></figure><p><code>-g</code> 可以对科学计数法进行从小到大排序<br><code>-r</code> 逆序</p><h1 id="循环-自增操作"><a class="markdownIt-Anchor" href="#循环-自增操作"></a> 循环、自增操作</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">for i in `seq 1 100`</span><br><span class="line">do</span><br><span class="line">    echo $i</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">for i in 1 2 4 8; do</span><br><span class="line">    echo $i</span><br><span class="line">done</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">files=`ls Pre*`</span><br><span class="line">for file in $files</span><br><span class="line">do</span><br><span class="line">    echo $file</span><br><span class="line">done</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">x=0</span><br><span class="line">for i in `seq 1 100`</span><br><span class="line">    x=`expr $x + 1`</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p><code>break</code> 跳出循环。<br><code>continue</code> 命令与 <code>break</code> 命令类似，只有一点差别，它不会跳出所有循环，仅仅跳出当前循环。</p><h1 id="字符串判断"><a class="markdownIt-Anchor" href="#字符串判断"></a> 字符串判断</h1><p>参考：<a target="_blank" rel="external nofollow noopener noreferrer" href="https://blog.csdn.net/Mr_LeeHY/article/details/76383091">https://blog.csdn.net/Mr_LeeHY/article/details/76383091</a></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">字符串相同</span></span><br><span class="line">if [ &quot;$A&quot; = &quot;$B&quot; ];then</span><br><span class="line">    echo =</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">字符串不相同</span></span><br><span class="line">if [ &quot;$A&quot; != &quot;$B&quot; ];then</span><br><span class="line">echo !=</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">模式匹配</span></span><br><span class="line">if [[ &quot;$A&quot; == a* ]];then</span><br><span class="line">echo &quot;[[ ==a* ]]&quot; # 如果$A 是a开头的字符串，则匹配成功，注意一定要使用上边的双括号[[]]</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">字符串不为空，长度不为0</span></span><br><span class="line">if [ -n &quot;$A&quot; ];then</span><br><span class="line">echo &quot;[ -n ]&quot;</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">字符串为空.就是长度为0.</span></span><br><span class="line">if [ -z &quot;$A&quot; ];then</span><br><span class="line">echo &quot;[ -z ]&quot;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><h1 id="判断大小"><a class="markdownIt-Anchor" href="#判断大小"></a> 判断大小</h1><h2 id="整数间的判断"><a class="markdownIt-Anchor" href="#整数间的判断"></a> 整数间的判断</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">T=999</span><br><span class="line">T_ext=1200</span><br><span class="line"></span><br><span class="line">if [ $T -lt $T_ext ]; then</span><br><span class="line">echo &quot;T &lt; T_ext&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">if [ `expr $T \&lt; $T_ext` -eq 1 ]; then # 需要转义&lt;，否则认为是一个重定向符号</span><br><span class="line">echo &quot;T &lt; T_ext&quot;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><h2 id="实数间的判断"><a class="markdownIt-Anchor" href="#实数间的判断"></a> 实数间的判断</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">T=9999.0</span><br><span class="line">T_ext=1200.0</span><br><span class="line">if [ $(echo &quot;$T&gt; $T_ext&quot; | bc) -eq 1 ]; then</span><br><span class="line">echo &quot;T &gt; T_ext&quot;</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">不支持科学计数法，默认 <span class="keyword">if</span> 不成立，即跳过科学计数</span></span><br></pre></td></tr></table></figure><p>PS：科学计数法转十进制：<br>方法 1： <code>printf &quot;%f\n&quot; 3.1188622400e+06</code><br>方法 2： <code>echo 3.1188622400e+06 | awk '&#123;printf(&quot;%f\n&quot;,$0)&#125;'</code></p><h1 id="删除所有文件except-some-file"><a class="markdownIt-Anchor" href="#删除所有文件except-some-file"></a> 删除所有文件，except some file</h1><p><code>find ./ -name '[^C][^1][^2]*' | xargs rm -rf</code> # 删除除了 <code>C12</code> 开头以外的其它文件</p><h1 id="数组"><a class="markdownIt-Anchor" href="#数组"></a> 数组</h1><p><code>index</code>，bash 从 0 开始，zsh 从 1 开始。<br><code>$&#123;abc[i]&#125;</code> 表示数组 <code>abc</code> 的第 <code>i</code> 个分量</p><h2 id="来自别的程序输出的数组"><a class="markdownIt-Anchor" href="#来自别的程序输出的数组"></a> 来自别的程序输出的数组</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">timelist=`foamListTimes`</span><br><span class="line">for time in $timelist; do</span><br><span class="line">echo time=$time</span><br><span class="line">done</span><br></pre></td></tr></table></figure><h2 id="指定数组并遍历"><a class="markdownIt-Anchor" href="#指定数组并遍历"></a> <a target="_blank" rel="external nofollow noopener noreferrer" href="https://opensource.com/article/18/5/you-dont-know-bash-intro-bash-arrays">指定数组并遍历</a></h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">allThreads=(1 2 4 8 16 32 64 128)</span><br><span class="line"></span><br><span class="line">for t in $&#123;allThreads[@]&#125;; do</span><br><span class="line">  echo t= $t</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">for i in $&#123;!allThreads[@]&#125;; do</span><br><span class="line">  echo allThreads[i]=  $&#123;allThreads[$i]&#125;</span><br><span class="line">done</span><br></pre></td></tr></table></figure><h2 id="从文件读取一个数组"><a class="markdownIt-Anchor" href="#从文件读取一个数组"></a> 从文件读取一个数组</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mapfile -t List &lt; List_file</span><br><span class="line">echo List = $&#123;List[@]&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="计算最大值"><a class="markdownIt-Anchor" href="#计算最大值"></a> 计算最大值</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">max=`printf &#x27;%s\n&#x27; &quot;$&#123;List[@]&#125;&quot; | awk &#x27;$1 &gt; m || NR == 1 &#123; m = $1 &#125; END &#123; print m &#125;&#x27;`</span><br></pre></td></tr></table></figure><h1 id="实数运算"><a class="markdownIt-Anchor" href="#实数运算"></a> 实数运算</h1><h2 id="整数的加减乘除"><a class="markdownIt-Anchor" href="#整数的加减乘除"></a> 整数的加减乘除：</h2><p>方法一：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">b=$((5*5+5-6/2))</span><br><span class="line">echo $b</span><br><span class="line">输出：27</span><br></pre></td></tr></table></figure><p>方法二：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">i=5</span><br><span class="line">c=`expr $i / 2`</span><br><span class="line">echo $c</span><br><span class="line">输出：2，可以看出，这里不支持小数</span><br><span class="line">PS: 操作符号两边要有空格，这里的 “/” 也可以是“+”“－”“*”，* 不行！</span><br></pre></td></tr></table></figure><h2 id="小数点位数"><a class="markdownIt-Anchor" href="#小数点位数"></a> 小数点位数</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">time=0.00015</span><br><span class="line">time=$(printf &quot;%.4f&quot; `echo &quot;$time + 0.0001&quot;|bc`)</span><br><span class="line">echo $time</span><br></pre></td></tr></table></figure><p>输出：0.0002<br>保留 4 位小数，后边直接截断，不进行四舍五入。</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">time=0.00015</span><br><span class="line">time=$(echo $time 0.0001 | awk &#x27;&#123; printf&quot;%0.4f\n&quot;,$1+$2&#125;&#x27;)#time+0.0001</span><br><span class="line">echo $time</span><br></pre></td></tr></table></figure><p>输出：0.0003<br>四舍五入，保留 4 位小数。</p><h2 id="浮点数的加减乘除"><a class="markdownIt-Anchor" href="#浮点数的加减乘除"></a> 浮点数的加减乘除：</h2><p>方法一：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">c=$(echo &quot;5.01-4*2.0&quot;|bc)</span><br><span class="line">echo $c</span><br><span class="line">输出：-2.99</span><br></pre></td></tr></table></figure><p>例外：<code>c=$(echo &quot;1/1000&quot;|bc)</code> 输出为 0，因为它是小于 1 的小数。如何才能正确输出小数呢？</p><p>方法二：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c=$(awk &#x27;BEGIN&#123;print 7.01*5-4.01&#125;&#x27;)</span><br><span class="line">echo $c</span><br><span class="line">输出：31.04</span><br><span class="line">c=$(awk &#x27;BEGIN&#123;print 1/1000&#125;&#x27;)</span><br><span class="line">echo $c</span><br><span class="line">输出：0.001</span><br></pre></td></tr></table></figure><p>例外：我想输出从 0 到 1 之间的等间距小数</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">for i in `seq 0 10`</span><br><span class="line">do</span><br><span class="line">c=$(awk &#x27;BEGIN&#123;print $i/10&#125;&#x27;)</span><br><span class="line">echo $c</span><br><span class="line">done</span><br><span class="line">输出 11 个 0</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">for i in `seq 1 10`</span><br><span class="line">do</span><br><span class="line">    c=$(printf &quot;%.4f&quot; `echo &quot;$i / 10&quot;|bc`)</span><br><span class="line">    echo $c</span><br><span class="line">done</span><br><span class="line">依然输出一堆 0.0000，只有最后一个是 1.0000</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">for i in `seq 1 10`</span><br><span class="line">do</span><br><span class="line">    c=$(echo $i 10 | awk &#x27;&#123; printf&quot;%0.4f\n&quot;,$1/$2&#125;&#x27;)</span><br><span class="line">    echo $c</span><br><span class="line">done</span><br><span class="line">这个才是正常输出的。</span><br></pre></td></tr></table></figure><h1 id="修改文件名"><a class="markdownIt-Anchor" href="#修改文件名"></a> 修改文件名</h1><h2 id="先来点简单的操作"><a class="markdownIt-Anchor" href="#先来点简单的操作"></a> 先来点简单的操作</h2><p>增加后缀</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find  . -type f -exec mv &#x27;&#123;&#125;&#x27; &#x27;&#123;&#125;&#x27;.old \;</span><br></pre></td></tr></table></figure><p>增加前缀</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">for files in $(ls *.png)</span><br><span class="line">    do mv $files &quot;pic.&quot;$files</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>去除前缀<br>？？？<br>去除后缀<br>？？？<br><a target="_blank" rel="external nofollow noopener noreferrer" href="http://www.tracholar.top/2018/06/10/remove-a-fixed-prefix-suffix-from-a-string-in-bash/">网址</a></p><h2 id="再来点高级的"><a class="markdownIt-Anchor" href="#再来点高级的"></a> 再来点高级的</h2><p>将文件名拆分，然后重组，如：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ls fileName | sed -r -n &#x27;s/(.*) 分隔字符 (.*)/mv &amp; 替换后的字符 \ 1\2/e&#x27;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这里表示将原文件名按‘分隔字符’拆分为两部分，分别由 (.*) 对应，也对应 \1 和 \2。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">后边的部分即为新文件名，可以添加任意字符在 \ 1 \2 的任何位置，也可以不要 \2，即删去 “分隔字符” 及其后边的部分。</span></span><br></pre></td></tr></table></figure><p>举例：</p><pre>
ls chi* | sed -r -n 's/.*tf(.*)/mv & \1/e'
# 分隔为 tf 之后部分，全部保留，即保留 tf 后边的字符串
# 原文件名：chi23.0769tf<font size="4" color="red">0363to0900Tst2227.kg</font>
# 操作后：0363to0900Tst2227.kg

#  .* 加不加括号的区别在于，加括号后，才计入分隔的部分中;
# 如果不加括号，仅仅表示中间还有若干字符，但是不计入分隔后的部分。

ls chi* | sed -r -n 's/(.*)tf.*/mv & \1/e'
# 分隔为 tf 之前部分，全部保留，即删去 tf 以及后边的所有字符串。
# 原文件名：<font size="4" color="red">chi23.0769</font>tf0363to0900Tst2227.kg
# 操作后：chi23.0769

ls chi* | sed -r -n 's/(.*)tf.*.kg(.*)/mv & \1\2/e'
# 分隔为 tf 之前，和 .kg 之后
# 这里分隔后，\1 表示 chi23.0769，即前边那个 (.*) 对应的部分，\2 表示'AAA'，即后边那个 (.*) 对应的部分。
# 原文件名：<font size="4" color="red">chi23.0769</font>tf0363to0900Tst2227.kg<font size="4" color="red">AAA</font>
# 操作后：chi23.0769AAA


ls chi* | sed -r -n 's/(.*)tf(.*).kg(.*)/mv & \1\2\3/e'
# tf 和 .kg 把原文件名分隔为三部分，全部保留。
# 原文件名：<font size="4" color="red">chi23.0769</font>tf<font size="4" color="red">0363to0900Tst2227</font>.kg<font size="4" color="red">BBB</font>
# 操作后：chi23.07690363to0900Tst2227BBB
</pre><p>字符串模糊匹配与精确匹配</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">if [[&quot;$HOSTNAME&quot; = tetralith*]];then</span><br><span class="line">    echo tet</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">if [&quot;$HOSTNAME&quot; = &quot;b-an01.hpc2n.umu.se&quot;];then</span><br><span class="line">    echo keb</span><br><span class="line">fi</span><br></pre></td></tr></table></figure></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="mailto:undefined" rel="external nofollow noopener noreferrer" target="_blank">Yan Zhang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="https://openfoam.top/linuxLearning/">https://openfoam.top/linuxLearning/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://openfoam.top">OpenFOAM 成长之路</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux/">Linux</a><a class="post-meta__tags" href="/tags/shell/">shell</a></div><div class="post-qr-code"><div class="post-qr-code-item"><img class="post-qr-code__img" src="/album/wechatPay.jpg"><div class="post-qr-code__desc">您的肯定会给我更大动力~</div></div></div><div class="social-share pull-right" data-disabled="tencent,douban,qzone,diandian,facebook,twitter,google"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/CppPrimer/"><i class="fa fa-chevron-left"></i><span>C++ primer 阅读笔记</span></a></div><div class="next-post pull-right"><a href="/chemkin/"><span>OpenFOAM 中使用 chemkin 机理注意事项</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitalk-container"></div><script>var gitalk=new Gitalk({clientID:"9dfad189aeefc4c2dde2",clientSecret:"69b4d95e0c4be2508135adae20b05bf6f298f386",repo:"zhangyantju.github.io",owner:"ZhangYanTJU",admin:"ZhangYanTJU",id:md5(decodeURI(location.pathname)),language:"zh-CN"});gitalk.render("gitalk-container")</script></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2024 By Yan Zhang</div><div class="framework-info"><span>驱动 -</span> <a target="_blank" rel="external nofollow noopener noreferrer" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 -</span> <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.1"></script><script src="/js/fancybox.js?version=1.9.1"></script><script src="/js/sidebar.js?version=1.9.1"></script><script src="/js/copy.js?version=1.9.1"></script><script src="/js/fireworks.js?version=1.9.1"></script><script src="/js/transition.js?version=1.9.1"></script><script src="/js/scroll.js?version=1.9.1"></script><script src="/js/head.js?version=1.9.1"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script src="/js/katex.js"></script><script src="/js/search/local-search.js"></script><script>/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)&&($("#nav").addClass("is-mobile"),$("footer").addClass("is-mobile"),$("#top-container").addClass("is-mobile"))</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/wzpan/hexo-generator-search" style="color:#49b1f5">hexo-generator-search</a> <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>