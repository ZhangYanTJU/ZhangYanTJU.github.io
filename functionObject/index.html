<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="OpenFOAM 中使用 functionObject"><meta name="keywords" content="functionObject"><meta name="author" content="Yan Zhang"><meta name="copyright" content="Yan Zhang"><title>OpenFOAM 中使用 functionObject | OpenFOAM 成长之路</title><link rel="shortcut icon" href="/album/linktocat.ico"><link rel="stylesheet" href="/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?38997e7d3b8e8c254bf0ddb7d2452127";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject="ga",e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script"),ga("create","UA-119919860-1","auto"),ga("send","pageview")</script><script>var GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"找不到您查询的内容:${query}"}},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"}}</script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="OpenFOAM 成长之路" type="application/atom+xml"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#使用方法"><span class="toc-number">1.</span> <span class="toc-text">使用方法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#大概是-of-40-以前的版本"><span class="toc-number">1.1.</span> <span class="toc-text">大概是 OF-4.0 以前的版本</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#of-40-以后的版本"><span class="toc-number">2.</span> <span class="toc-text">OF-4.0 以后的版本</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#libfieldfunctionobjects"><span class="toc-number">3.</span> <span class="toc-text">libfieldFunctionObjects</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#vol-场操作"><span class="toc-number">3.1.</span> <span class="toc-text">vol 场操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#surface-场操作"><span class="toc-number">3.2.</span> <span class="toc-text">Surface 场操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#operation"><span class="toc-number">3.2.1.</span> <span class="toc-text">operation：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#surface-场操作举例1"><span class="toc-number">3.2.2.</span> <span class="toc-text">Surface 场操作举例1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#surface-场操作举例2"><span class="toc-number">3.2.3.</span> <span class="toc-text">Surface 场操作举例2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#surfaceinterpolate"><span class="toc-number">3.3.</span> <span class="toc-text">surfaceInterpolate</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#时间平均"><span class="toc-number">3.4.</span> <span class="toc-text">时间平均</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#极值"><span class="toc-number">3.5.</span> <span class="toc-text">极值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shearstress"><span class="toc-number">3.6.</span> <span class="toc-text">shearStress</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#streamline"><span class="toc-number">3.7.</span> <span class="toc-text">streamLine</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#machno"><span class="toc-number">3.8.</span> <span class="toc-text">MachNo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#probes"><span class="toc-number">3.9.</span> <span class="toc-text">probes</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#libutilityfunctionobjects"><span class="toc-number">4.</span> <span class="toc-text">libutilityFunctionObjects</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#所有可选-type"><span class="toc-number">4.1.</span> <span class="toc-text">所有可选 type</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#writeobjects"><span class="toc-number">4.2.</span> <span class="toc-text">writeObjects</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#settimestep"><span class="toc-number">4.3.</span> <span class="toc-text">setTimeStep</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#timeactivatedfileupdate"><span class="toc-number">4.4.</span> <span class="toc-text">timeActivatedFileUpdate</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#coded"><span class="toc-number">4.5.</span> <span class="toc-text">coded</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#misc"><span class="toc-number">5.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#probes-前面有另一种实现方法"><span class="toc-number">5.1.</span> <span class="toc-text">probes 前面有另一种实现方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#等值面"><span class="toc-number">5.2.</span> <span class="toc-text">等值面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#forces"><span class="toc-number">5.3.</span> <span class="toc-text">forces</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#输出控制"><span class="toc-number">6.</span> <span class="toc-text">输出控制</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#简便用法"><span class="toc-number">7.</span> <span class="toc-text">简便用法</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/album/192.jpg"></div><div class="author-info__name text-center">Yan Zhang</div><div class="author-info__description text-center">OpenFOAM 成长之路</div><div class="follow-button"><a href="https://github.com/ZhangYanTJU" target="_blank" rel="external nofollow noopener noreferrer">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">39</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">30</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">9</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"><a id="site-name" href="/">OpenFOAM 成长之路</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i> <span class="pull-right menus"><a class="site-page" href="/">首页</a><a class="site-page" href="/about">关于</a><a class="site-page" href="/subscribe">订阅</a><a class="site-page" href="/en">English</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i> <span>搜索</span></a></span></div><div id="post-info"><div id="post-title">OpenFOAM 中使用 functionObject</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2018-01-25<span class="post-meta__separator">|</span><i class="fa fa-calendar-check-o" aria-hidden="true"></i> 更新于 2020-04-04</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/using/">using</a><div class="post-meta-wordcount"><span>字数总计:</span> <span class="word-count">2.5k</span><span class="post-meta__separator">|</span><span>阅读时长: 12 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>使用 functionObject 进行后处理</p><a id="more"></a><p>In OpenFOAM, functionObjects are code snippets that can be loaded into any solver during run-time. This enables each solver to be coupled with some additional functionality, that is independent from the flow model. All functionObjects have to be included in system/controlDict like the following:</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    &lt;name&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        type &lt;type&gt;;</span><br><span class="line">        functionObjectLibs (<span class="string">"&lt;lib&gt;"</span>);</span><br><span class="line">        writeControl timeStep;</span><br><span class="line">        outputInterval <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// Specific parameters for the functionObject</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="使用方法"><a class="markdownIt-Anchor" href="#使用方法"></a> 使用方法</h1><h2 id="大概是-of-40-以前的版本"><a class="markdownIt-Anchor" href="#大概是-of-40-以前的版本"></a> 大概是 OF-4.0 以前的版本</h2><ul><li>运行时：<br>先在 <code>controlDict</code> 中添加 <code>functions</code>，然后直接运行算例即可。支持并行算例。</li><li>运行后：<br>先在 <code>controlDict</code> 中添加 <code>functions</code>，然后执行这个命令 <code>execFlowFunctionObjects -noFlow</code><br>支持并行，使用命令 <code>mpirun -np 2 execFlowFunctionObjects -noFlow -parallel</code></li></ul><h1 id="of-40-以后的版本"><a class="markdownIt-Anchor" href="#of-40-以后的版本"></a> OF-4.0 以后的版本</h1><ul><li><p>在 <code>controlDict</code> 中添加 <code>functions</code> 之后，直接运行求解器即可。支持并行算例。</p></li><li><p>运行后，在 controlDict 文件中添加 functions之后，运行 <code>postProcess -fields '(T p U)'</code>。<br><code>-fields</code> 一定要加，因为这相当于输入的场信息，和 <code>functions</code> 里 <code>fields</code> 的不一样，那个是操作的场。输入的场要包含操作的场才行。</p></li><li><p>运行后，还可以通过求解器来调用，这样可以载入更多的信息（如拉格朗日粒子）：<code>sprayFoam -postProcess -func writeCloudOldStyle</code>。<br>这个 <a href="https://github.com/blueCFD/lagrangianExtraFunctionObjects" target="_blank" rel="external nofollow noopener noreferrer">writeCloudOldStyle</a> 是将 positions 转换成 paraview 可以读取的格式。</p></li><li><p>特殊控制：运行后，可以只对某个（些）时间进行处理，如：<code>postProcess -fields '(T p)' -time '1.75e-05'</code>。<br>或者：<code>postProcess -fields '(T p)' -time ':1.75e-05'</code>，冒号表示从最开始到 1.75e-05 所有的时间。<br>另外还可以处理不连续的时间，如 <code>postProcess -fields '(T p)' -time '1.25e-05,1.75e-05'</code>，用逗号隔开即可。</p></li><li><p>支持并行，使用命令 <code>mpirun -np 2 postProcess -fields '(T p U)' -parallel</code></p></li></ul><blockquote><p><code>functionObjects</code> 分为两大类 <code>libfieldFunctionObjects</code> 和 <code>libutilityFunctionObjects</code></p><p>所有可选的 <code>type</code> 可以通过这个命令获取：<code>postProcess -list</code>。</p></blockquote><p>目前运行 <code>postProcess -list</code> 会获得下列功能，官方配置文件在这个位置：<a href="https://github.com/OpenFOAM/OpenFOAM-dev/tree/master/etc/caseDicts/postProcessing/fields" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/OpenFOAM/OpenFOAM-dev/tree/master/etc/caseDicts/postProcessing/fields</a><br>Available configured functionObjects:</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">67</span><br><span class="line">(</span><br><span class="line">CourantNo</span><br><span class="line">Lambda2</span><br><span class="line">MachNo</span><br><span class="line">PecletNo</span><br><span class="line">Q</span><br><span class="line">Qdot</span><br><span class="line">R</span><br><span class="line">XiReactionRate</span><br><span class="line">add</span><br><span class="line">age</span><br><span class="line">boundaryProbes</span><br><span class="line">cellMax</span><br><span class="line">cellMin</span><br><span class="line">components</span><br><span class="line">ddt</span><br><span class="line">div</span><br><span class="line">dsmcFields</span><br><span class="line">enstrophy</span><br><span class="line">faceMax</span><br><span class="line">faceMin</span><br><span class="line">flowRateFaceZone</span><br><span class="line">flowRatePatch</span><br><span class="line">flowType</span><br><span class="line">forceCoeffsCompressible</span><br><span class="line">forceCoeffsIncompressible</span><br><span class="line">forcesCompressible</span><br><span class="line">forcesIncompressible</span><br><span class="line">grad</span><br><span class="line">icoUncoupledKinematicCloud</span><br><span class="line">interfaceHeight</span><br><span class="line">internalProbes</span><br><span class="line">log</span><br><span class="line">mag</span><br><span class="line">magSqr</span><br><span class="line">minMaxComponents</span><br><span class="line">minMaxMagnitude</span><br><span class="line">patchAverage</span><br><span class="line">patchIntegrate</span><br><span class="line">phaseScalarTransport</span><br><span class="line">pressureDifferencePatch</span><br><span class="line">pressureDifferenceSurface</span><br><span class="line">probes</span><br><span class="line">randomise</span><br><span class="line">residuals</span><br><span class="line">scalarTransport</span><br><span class="line">scale</span><br><span class="line">singleGraph</span><br><span class="line">staticPressure</span><br><span class="line">streamFunction</span><br><span class="line">streamlines</span><br><span class="line">subtract</span><br><span class="line">surfaces</span><br><span class="line">time</span><br><span class="line">totalPressureCompressible</span><br><span class="line">totalPressureIncompressible</span><br><span class="line">turbulenceFields</span><br><span class="line">turbulenceIntensity</span><br><span class="line">volFlowRateSurface</span><br><span class="line">vorticity</span><br><span class="line">wallHeatFlux</span><br><span class="line">wallHeatTransferCoeff</span><br><span class="line">wallShearStress</span><br><span class="line">writeCellCentres</span><br><span class="line">writeCellVolumes</span><br><span class="line">writeObjects</span><br><span class="line">writeVTK</span><br><span class="line">yPlus</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>直接运行即可，比如：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">postProcess -func CourantNo</span><br></pre></td></tr></table></figure><h1 id="libfieldfunctionobjects"><a class="markdownIt-Anchor" href="#libfieldfunctionobjects"></a> libfieldFunctionObjects</h1><p>常用操作举例：</p><h2 id="vol-场操作"><a class="markdownIt-Anchor" href="#vol-场操作"></a> vol 场操作</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">   volFieldValue1</span><br><span class="line">   &#123;</span><br><span class="line">       type            volFieldValue;</span><br><span class="line">       libs            (<span class="string">"libfieldFunctionObjects.so"</span>);</span><br><span class="line"></span><br><span class="line">       <span class="built_in">log</span>             <span class="literal">true</span>;</span><br><span class="line">       writeControl    writeTime;</span><br><span class="line">       writeFields     <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">       regionType      cellZone;</span><br><span class="line">       name            c0;</span><br><span class="line">       operation       volAverage;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//A single weight field can be specified as before:</span></span><br><span class="line">       weightField     alpha1;</span><br><span class="line">       <span class="comment">//or a list specified by:</span></span><br><span class="line">       <span class="comment">//weightFields (alpha.water rho.water);</span></span><br><span class="line"></span><br><span class="line">       fields</span><br><span class="line">       (</span><br><span class="line">           p</span><br><span class="line">           U</span><br><span class="line">       );</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>operation 有：</p><table><thead><tr><th>operation</th><th>说明</th><th>代码</th></tr></thead><tbody><tr><td>CoV</td><td>Coefficient of variation: standard deviation/mean</td><td>略</td></tr><tr><td>average</td><td>Ensemble average</td><td><code>gSum(values)/nCells()</code></td></tr><tr><td>max</td><td>Maximum</td><td><code>gMax(values)</code></td></tr><tr><td>min</td><td>Minimum</td><td><code>gMin(values)</code></td></tr><tr><td>none</td><td>No operation</td><td></td></tr><tr><td>sum</td><td>Sum</td><td><code>gSum(values)</code></td></tr><tr><td>sumMag</td><td>Sum of component magnitudes</td><td><code>gSum(cmptMag(values))</code></td></tr><tr><td>volAverage</td><td>Volume weighted average</td><td><code>gSum(V*values)/V_total</code></td></tr><tr><td>volIntegrate</td><td>Volume integral</td><td><code>gSum(V*values)</code></td></tr><tr><td>weightedAverage</td><td>Weighted average</td><td><code>gSum(weightField*values)/gSum(weightField)</code></td></tr><tr><td>weightedSum</td><td>Weighted sum</td><td><code>gSum(weightField*values)</code></td></tr><tr><td>weightedVolAverage</td><td>Weighted volume average</td><td><code>gSum(weightField*V*values)/gSum(weightField*V)</code></td></tr><tr><td>weightedVolIntegrate</td><td>Weighted volume integral</td><td><code>gSum(weightField*V*values)</code></td></tr></tbody></table><h2 id="surface-场操作"><a class="markdownIt-Anchor" href="#surface-场操作"></a> Surface 场操作</h2><h3 id="operation"><a class="markdownIt-Anchor" href="#operation"></a> operation：</h3><table><thead><tr><th>operation</th><th>说明</th><th>代码</th></tr></thead><tbody><tr><td>CoV</td><td>Coefficient of variation: standard deviation/mean</td><td>略</td></tr><tr><td>average</td><td>ensemble average</td><td><code>sum(values)/values.size()</code></td></tr><tr><td>max</td><td>maximum</td><td><code>max(values)</code></td></tr><tr><td>min</td><td>minimum</td><td><code>min(values)</code></td></tr><tr><td>none</td><td>no operation</td><td></td></tr><tr><td>sum</td><td>sum</td><td><code>sum(values)</code></td></tr><tr><td>sumMag</td><td>sum of component magnitudes</td><td><code>sum(cmptMag(values))</code></td></tr><tr><td>areaAverage</td><td>area weighted average</td><td><code>sum(magSf*values)/sum(magSf)</code></td></tr><tr><td>areaIntegrate</td><td>area integral</td><td><code>sum(magSf*values)</code></td></tr><tr><td>areaNormalAverage</td><td>area weighted average in face normal direction</td><td><code>vector( sum(values &amp; Sf)/sum(mag(Sf)), 0.0, 0.0 )</code></td></tr><tr><td>areaNormalIntegrate</td><td>area weighted integral in face normal directon</td><td><code>vector( sum(values &amp; Sf), 0.0, 0.0 )</code></td></tr><tr><td>weightedAreaAverage</td><td>weighted area average</td><td><code>sum(weightField*magSf*values)/sum(magSf*weightField)</code></td></tr><tr><td>weightedAreaIntegrate</td><td>weighted area integral</td><td><code>sum(weightField*magSf*values)</code></td></tr><tr><td>weightedAverage</td><td>weighted average</td><td><code>sum(weightField*values)/sum(weightField)</code></td></tr><tr><td>weightedSum</td><td>weighted sum</td><td><code>sum(weightField*values)</code></td></tr><tr><td>sumDirection</td><td>sum values which are positive in given direction</td><td>略</td></tr><tr><td>sumDirectionBalance</td><td>sum of balance of values in given direction</td><td>略</td></tr></tbody></table><h3 id="surface-场操作举例1"><a class="markdownIt-Anchor" href="#surface-场操作举例1"></a> Surface 场操作举例1</h3><p>面平均，计算 <code>f0</code> 这个 <code>faceZone</code> 上 <code>zeta</code> 的平均值</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    poolHeight</span><br><span class="line">    &#123;</span><br><span class="line">        type            surfaceFieldValue;</span><br><span class="line">        libs            (<span class="string">"libfieldFunctionObjects.so"</span>);</span><br><span class="line">        writeControl    timeStep;</span><br><span class="line">        writeInterval   <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">log</span>             yes;</span><br><span class="line">        writeTotalArea  no;</span><br><span class="line">        writeFields     no;</span><br><span class="line">        regionType      faceZone;</span><br><span class="line">        name            f0;</span><br><span class="line">        operation       areaAverage;</span><br><span class="line">        fields</span><br><span class="line">        (</span><br><span class="line">            zeta</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="surface-场操作举例2"><a class="markdownIt-Anchor" href="#surface-场操作举例2"></a> Surface 场操作举例2</h3><p>面求和，计算 <code>inlet</code> 这个 <code>patch</code> 上 <code>rhoPhi</code> 的和</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    inletFlux</span><br><span class="line">    &#123;</span><br><span class="line">        type            surfaceFieldValue;</span><br><span class="line">        libs            (<span class="string">"libfieldFunctionObjects.so"</span>);</span><br><span class="line">        writeControl   timeStep;</span><br><span class="line">        <span class="built_in">log</span>             <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">// Output field values as well</span></span><br><span class="line">        writeFields     <span class="literal">false</span>;</span><br><span class="line">        regionType      patch;</span><br><span class="line">        name            inlet;</span><br><span class="line">        operation       sum;</span><br><span class="line">        fields</span><br><span class="line">        (</span><br><span class="line">            rhoPhi</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    outletFlux</span><br><span class="line">    &#123;</span><br><span class="line">        $inletFlux;</span><br><span class="line">        name            outlet;</span><br><span class="line">    &#125;</span><br><span class="line">    atmosphereFlux</span><br><span class="line">    &#123;</span><br><span class="line">        $inletFlux;</span><br><span class="line">        name            atmosphere;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="surfaceinterpolate"><a class="markdownIt-Anchor" href="#surfaceinterpolate"></a> surfaceInterpolate</h2><p>Description<br>Linearly interpolates volume fields to generate surface fields.<br>Fields are stored<br>- every time step the field is updated with new values<br>- at output it writes the fields<br>This functionObject can either be used<br>- to calculate a new field as a post-processing step or<br>- since the fields are registered, used in another functionObject<br>Example of function object specification:<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">surfaceInterpolate1</span><br><span class="line">&#123;</span><br><span class="line">    type        surfaceInterpolate;</span><br><span class="line">    libs        (&quot;libfieldFunctionObjects.so&quot;);</span><br><span class="line">    ...</span><br><span class="line">    fields      ((p pInterp)(U UInterp));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Usage<br>\table<p></p><table><thead><tr><th>Property</th><th>Description</th><th>Required</th><th>Default value</th></tr></thead><tbody><tr><td>type</td><td>type name: surfaceInterpolate</td><td>yes</td><td></td></tr><tr><td>fields</td><td>list of fields with corresponding output field names</td><td>yes</td><td></td></tr></tbody></table><p><a href="https://github.com/OpenFOAM/OpenFOAM-8/commit/84a12667063d919ab74d79fcac4c9b6d5f817997" target="_blank" rel="external nofollow noopener noreferrer">简便用法</a></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">e.g. given a vol pressure field p</span><br><span class="line"></span><br><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F; Interpolate the pressure field to the faces</span><br><span class="line">    surfacep</span><br><span class="line">    &#123;</span><br><span class="line">        type        surfaceInterpolate;</span><br><span class="line">        libs        (&quot;libfieldFunctionObjects.so&quot;);</span><br><span class="line">        fields      ((p surfacep));</span><br><span class="line">        writeControl none;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Average the surface pressure field over the centre faceZone</span><br><span class="line">    #includeFunc faceZoneAverage(name&#x3D;centre, surfacep)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="时间平均"><a class="markdownIt-Anchor" href="#时间平均"></a> 时间平均</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    field_average</span><br><span class="line">    &#123;</span><br><span class="line">        type fieldAverage;  <span class="comment">// fieldAverage 是时间平均</span></span><br><span class="line">        functionObjectLibs (<span class="string">"libfieldFunctionObjects.so"</span>);</span><br><span class="line">        enabled <span class="literal">true</span>;</span><br><span class="line">        writeControl outputTime;</span><br><span class="line">        fields</span><br><span class="line">        (</span><br><span class="line">            U</span><br><span class="line">            &#123;</span><br><span class="line">                mean on;</span><br><span class="line">                prime2Mean on;</span><br><span class="line">                base time;</span><br><span class="line">            &#125;</span><br><span class="line">            k</span><br><span class="line">            &#123;</span><br><span class="line">                mean on;</span><br><span class="line">                prime2Mean off;</span><br><span class="line">                base time;</span><br><span class="line">            &#125;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://github.com/OpenFOAM/OpenFOAM-dev/commit/0177c7dd59b3a0be669d520d8652a3d60435a370" target="_blank" rel="external nofollow noopener noreferrer">简便用法</a></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#includeFunc fieldAverage(U, p, prime2Mean &#x3D; yes)</span><br><span class="line">#includeFunc fieldAverage(U, p)</span><br></pre></td></tr></table></figure><p><a href="http://xiaopingqiu.github.io/2015/04/12/fieldAverage/" target="_blank" rel="external nofollow noopener noreferrer">更多关于时间平均的细节请看这里</a></p><h2 id="极值"><a class="markdownIt-Anchor" href="#极值"></a> 极值</h2><p>这个好像前边的场操作 <code>volFieldValue</code> 也能实现。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    minMax</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Type of functionObject</span></span><br><span class="line">        type            fieldMinMax;</span><br><span class="line">        <span class="comment">// Where to load it from (if not already in solver)</span></span><br><span class="line">        functionObjectLibs (<span class="string">"libfieldFunctionObjects.so"</span>);</span><br><span class="line">        <span class="comment">// Function object enabled flag</span></span><br><span class="line">        enabled         <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">// Log to output (default: false)</span></span><br><span class="line">        <span class="built_in">log</span>             <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">// Write information to file (default: true)</span></span><br><span class="line">        <span class="built_in">write</span>           <span class="literal">true</span>;</span><br><span class="line">        location        no;</span><br><span class="line">        <span class="comment">// Fields to be monitored - runTime modifiable</span></span><br><span class="line">        fields (U p T);</span><br><span class="line">        <span class="comment">//fields (T);</span></span><br><span class="line">        writeControl    timeStep;</span><br><span class="line">        writeInterval   <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="shearstress"><a class="markdownIt-Anchor" href="#shearstress"></a> <a href="https://github.com/OpenFOAM/OpenFOAM-dev/blob/master/etc/caseDicts/postProcessing/fields/shearStress" target="_blank" rel="external nofollow noopener noreferrer">shearStress</a></h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    shearStress</span><br><span class="line">    &#123;</span><br><span class="line">        type            shearStress;</span><br><span class="line">        libs            (<span class="string">"libfieldFunctionObjects.so"</span>);</span><br><span class="line"></span><br><span class="line">        executeControl  writeTime;</span><br><span class="line">        writeControl    writeTime;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="streamline"><a class="markdownIt-Anchor" href="#streamline"></a> streamLine</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    streamLines</span><br><span class="line">    &#123;</span><br><span class="line">        type            streamLine;</span><br><span class="line">        <span class="comment">// Where to load it from (if not already in solver)</span></span><br><span class="line">        libs            (<span class="string">"libfieldFunctionObjects.so"</span>);</span><br><span class="line">        <span class="comment">// Output every</span></span><br><span class="line">        writeControl    writeTime;</span><br><span class="line">        <span class="comment">// writeInterval 10;</span></span><br><span class="line">        setFormat       vtk; <span class="comment">//gnuplot;//xmgr;//raw;//jplot;//csv;//ensight;</span></span><br><span class="line">        <span class="comment">// Tracked forwards (+U) or backwards (-U)</span></span><br><span class="line">        trackForward    <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">// Names of fields to sample. Should contain above velocity field!</span></span><br><span class="line">        fields (p k U);</span><br><span class="line">        <span class="comment">// Steps particles can travel before being removed</span></span><br><span class="line">        lifeTime        <span class="number">10000</span>;</span><br><span class="line">        <span class="comment">// Number of steps per cell (estimate). Set to 1 to disable subcycling.</span></span><br><span class="line">        nSubCycle <span class="number">5</span>;</span><br><span class="line">        <span class="comment">// Cloud name to use</span></span><br><span class="line">        cloudName       particleTracks;</span><br><span class="line">        <span class="comment">// Seeding method.</span></span><br><span class="line">        seedSampleSet</span><br><span class="line">        &#123;</span><br><span class="line">            type        uniform;</span><br><span class="line">            axis        x;  <span class="comment">//distance;</span></span><br><span class="line">            start       (<span class="number">-0.0205</span> <span class="number">0.001</span>  <span class="number">0.00001</span>);</span><br><span class="line">            <span class="built_in">end</span>         (<span class="number">-0.0205</span> <span class="number">0.0251</span> <span class="number">0.00001</span>);</span><br><span class="line">            nPoints     <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="machno"><a class="markdownIt-Anchor" href="#machno"></a> MachNo</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    libs            (<span class="string">"libfieldFunctionObjects.so"</span>);</span><br><span class="line">    Ma</span><br><span class="line">    &#123;</span><br><span class="line">        type            MachNo;</span><br><span class="line">        executeControl  writeTime;</span><br><span class="line">        writeControl    writeTime;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="probes"><a class="markdownIt-Anchor" href="#probes"></a> probes</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    my_name</span><br><span class="line">    &#123;</span><br><span class="line">        type    probes;</span><br><span class="line">        probeLocations</span><br><span class="line">        (</span><br><span class="line">            (<span class="number">0.0</span> <span class="number">0.05</span> <span class="number">0.0</span>)</span><br><span class="line">        );</span><br><span class="line">        functionObjectLibs    (<span class="string">"libfieldFunctionObjects.so"</span>);</span><br><span class="line">	fields (T);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="libutilityfunctionobjects"><a class="markdownIt-Anchor" href="#libutilityfunctionobjects"></a> libutilityFunctionObjects</h1><h2 id="所有可选-type"><a class="markdownIt-Anchor" href="#所有可选-type"></a> 所有可选 type</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">abort</span></span><br><span class="line">coded<span class="comment">//使用代码</span></span><br><span class="line">patchProbes</span><br><span class="line">probes<span class="comment">//检测某些点的某些物理量,需要指定 probeLocations fields,和上边重复了。。。</span></span><br><span class="line">psiReactionThermoMoleFractions</span><br><span class="line">removeRegisteredObject</span><br><span class="line">residuals</span><br><span class="line">rhoReactionThermoMoleFractions</span><br><span class="line">setTimeStep<span class="comment">//设置时间步长，如：从表格中读取，sine函数等。</span></span><br><span class="line">sets</span><br><span class="line">surfaces</span><br><span class="line">systemCall</span><br><span class="line">time</span><br><span class="line">timeActivatedFileUpdate<span class="comment">//可以设置多套controlDict，运行到某一时刻自动切换</span></span><br><span class="line">writeDictionary</span><br><span class="line">writeObjects<span class="comment">//write一些计算过程中的对象，可以多输出一些信息</span></span><br></pre></td></tr></table></figure><h2 id="writeobjects"><a class="markdownIt-Anchor" href="#writeobjects"></a> writeObjects</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    writeFields <span class="comment">// name of the function object</span></span><br><span class="line">    &#123;</span><br><span class="line">        type writeObjects;</span><br><span class="line">        libs ( <span class="string">"libutilityFunctionObjects.so"</span> );</span><br><span class="line"></span><br><span class="line">        objects</span><br><span class="line">        (</span><br><span class="line">	    T U rho <span class="comment">// list of fields/variables to be written</span></span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// E.g. write every 1e-5 seconds of simulation time only the specified fields</span></span><br><span class="line">        writeControl runTime;</span><br><span class="line">        writeInterval <span class="number">1e-5</span>; <span class="comment">// write every 1e-5 seconds</span></span><br><span class="line">        </span><br><span class="line">        writeOption autoWrite;<span class="comment">// noWrite anyWrite  </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>You can also define multiple function objects in order to write different subsets of fields at different times. You can also use wildcards in the list of fields- for example, in order to write out all fields starting with “RR_” you can add</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;RR_.*&quot;</span><br></pre></td></tr></table></figure><p>可以输出每个组分的反应速率？放热率呢？如何输出？Qdot[1 -1 -3 0 0 0 0] 是dQ[1 2 -3 0 0 0 0]除以体积，dQ的单位是J/s。那么我们需要对Qdot进行volumeIntegrate 操作。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">定义：fvc::volumeIntegrate(df)=df.mesh().V()*df.field()<span class="comment">//df是被操作的场</span></span><br><span class="line">使用：volScalarField dQ = fvc::volumeIntegrate(Qdot);<span class="comment">//dQ的量纲是多少？</span></span><br></pre></td></tr></table></figure><h2 id="settimestep"><a class="markdownIt-Anchor" href="#settimestep"></a> setTimeStep</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">	timeStepping</span><br><span class="line">    &#123;</span><br><span class="line">        type            setTimeStep;</span><br><span class="line">        functionObjectLibs (<span class="string">"libutilityFunctionObjects.so"</span>);</span><br><span class="line">        enabled         yes;</span><br><span class="line">        deltaT          tableFile;</span><br><span class="line">        file            <span class="string">"system/deltaTvalues"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="timeactivatedfileupdate"><a class="markdownIt-Anchor" href="#timeactivatedfileupdate"></a> timeActivatedFileUpdate</h2><p>运行时更改某些文件</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Performs a file copy/replacement once a specified time has been reached.</span><br><span class="line"></span><br><span class="line">Example usage to update the fvSolution dictionary at various times throughout the calculation:</span><br><span class="line"></span><br><span class="line">\verbatim</span><br><span class="line">fileUpdate1</span><br><span class="line">&#123;</span><br><span class="line">    type              timeActivatedFileUpdate;</span><br><span class="line">    libs              (<span class="string">"libutilityFunctionObjects.so"</span>);</span><br><span class="line">    writeControl      timeStep;</span><br><span class="line">    writeInterval     <span class="number">1</span>;</span><br><span class="line">    fileToUpdate      <span class="string">"$FOAM_CASE/system/fvSolution"</span>;</span><br><span class="line">    timeVsFile</span><br><span class="line">    (</span><br><span class="line">        (<span class="number">-1</span> <span class="string">"$FOAM_CASE/system/fvSolution.0"</span>)</span><br><span class="line">        (<span class="number">0.10</span> <span class="string">"$FOAM_CASE/system/fvSolution.10"</span>)</span><br><span class="line">        (<span class="number">0.20</span> <span class="string">"$FOAM_CASE/system/fvSolution.20"</span>)</span><br><span class="line">        (<span class="number">0.35</span> <span class="string">"$FOAM_CASE/system/fvSolution.35"</span>)</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line">\endverbatim</span><br></pre></td></tr></table></figure><h2 id="coded"><a class="markdownIt-Anchor" href="#coded"></a> coded</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    timeStep</span><br><span class="line">    &#123;</span><br><span class="line">        type coded;</span><br><span class="line">        libs            (<span class="string">"libutilityFunctionObjects.so"</span>);</span><br><span class="line">        name setDeltaT;</span><br><span class="line">        code</span><br><span class="line">        #&#123;</span><br><span class="line">        #&#125;;</span><br><span class="line">        codeExecute</span><br><span class="line">        #&#123;</span><br><span class="line">            <span class="keyword">const</span> Time&amp; runTime = mesh().time();</span><br><span class="line">            <span class="keyword">if</span> (runTime.timeToUserTime(runTime.value()) &gt;= <span class="number">-15.0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">const_cast</span>&lt;Time&amp;&gt;(runTime).setDeltaT</span><br><span class="line">                (</span><br><span class="line">                    runTime.userTimeToTime(<span class="number">0.025</span>)</span><br><span class="line">                );</span><br><span class="line">            &#125;</span><br><span class="line">        #&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    error</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Load the library containing the 'coded' functionObject</span></span><br><span class="line">        libs            (<span class="string">"libutilityFunctionObjects.so"</span>);</span><br><span class="line">        type coded;</span><br><span class="line">        <span class="comment">// Name of on-the-fly generated functionObject</span></span><br><span class="line">        name error;</span><br><span class="line">        codeEnd</span><br><span class="line">        #&#123;</span><br><span class="line">            <span class="comment">// Lookup U</span></span><br><span class="line">            Info&lt;&lt; <span class="string">"Looking up field U\n"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">const</span> volVectorField&amp; U = mesh().lookupObject&lt;volVectorField&gt;(<span class="string">"U"</span>);</span><br><span class="line">            Info&lt;&lt; <span class="string">"Reading inlet velocity uInfX\n"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            scalar ULeft = <span class="number">0.0</span>;</span><br><span class="line">            label leftI = mesh().boundaryMesh().findPatchID(<span class="string">"left"</span>);</span><br><span class="line">            <span class="keyword">const</span> fvPatchVectorField&amp; fvp = U.boundaryField()[leftI];</span><br><span class="line">            <span class="keyword">if</span> (fvp.<span class="built_in">size</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                ULeft = fvp[<span class="number">0</span>].x();</span><br><span class="line">            &#125;</span><br><span class="line">            reduce(ULeft, maxOp&lt;scalar&gt;());</span><br><span class="line">            dimensionedScalar uInfX</span><br><span class="line">            (</span><br><span class="line">                <span class="string">"uInfx"</span>,</span><br><span class="line">                dimensionSet(<span class="number">0</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>),</span><br><span class="line">                ULeft</span><br><span class="line">            );</span><br><span class="line">            Info &lt;&lt; <span class="string">"U at inlet = "</span> &lt;&lt; uInfX.value() &lt;&lt; <span class="string">" m/s"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            scalar magCylinder = <span class="number">0.0</span>;</span><br><span class="line">            label cylI = mesh().boundaryMesh().findPatchID(<span class="string">"cylinder"</span>);</span><br><span class="line">            <span class="keyword">const</span> fvPatchVectorField&amp; cylFvp = mesh().C().boundaryField()[cylI];</span><br><span class="line">            <span class="keyword">if</span> (cylFvp.<span class="built_in">size</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                magCylinder = mag(cylFvp[<span class="number">0</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            reduce(magCylinder, maxOp&lt;scalar&gt;());</span><br><span class="line">            dimensionedScalar radius</span><br><span class="line">            (</span><br><span class="line">                <span class="string">"radius"</span>,</span><br><span class="line">                dimensionSet(<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>),</span><br><span class="line">                magCylinder</span><br><span class="line">            );</span><br><span class="line">            Info &lt;&lt; <span class="string">"Cylinder radius = "</span> &lt;&lt; radius.value() &lt;&lt; <span class="string">" m"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            volVectorField UA</span><br><span class="line">            (</span><br><span class="line">                IOobject</span><br><span class="line">                (</span><br><span class="line">                    <span class="string">"UA"</span>,</span><br><span class="line">                    mesh().time().timeName(),</span><br><span class="line">                    U.mesh(),</span><br><span class="line">                    IOobject::NO_READ,</span><br><span class="line">                    IOobject::AUTO_WRITE</span><br><span class="line">                ),</span><br><span class="line">                U</span><br><span class="line">            );</span><br><span class="line">            Info&lt;&lt; <span class="string">"\nEvaluating analytical solution"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">const</span> volVectorField&amp; centres = UA.mesh().C();</span><br><span class="line">            <span class="function">volScalarField <span class="title">magCentres</span><span class="params">(mag(centres))</span></span>;</span><br><span class="line">            <span class="function">volScalarField <span class="title">theta</span><span class="params">(<span class="built_in">acos</span>((centres &amp; <span class="built_in">vector</span>(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>))/magCentres))</span></span>;</span><br><span class="line">            volVectorField cs2theta</span><br><span class="line">            (</span><br><span class="line">                <span class="built_in">cos</span>(<span class="number">2</span>*theta)*<span class="built_in">vector</span>(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">              + <span class="built_in">sin</span>(<span class="number">2</span>*theta)*<span class="built_in">vector</span>(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>)</span><br><span class="line">            );</span><br><span class="line">            UA = uInfX*(dimensionedVector(<span class="built_in">vector</span>(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">              - <span class="built_in">pow</span>((radius/magCentres),<span class="number">2</span>)*cs2theta);</span><br><span class="line">            <span class="comment">// Force writing of UA (since time has not changed)</span></span><br><span class="line">            UA.<span class="built_in">write</span>();</span><br><span class="line">            <span class="function">volScalarField <span class="title">error</span><span class="params">(<span class="string">"error"</span>, mag(U-UA)/mag(UA))</span></span>;</span><br><span class="line">            Info&lt;&lt;<span class="string">"Writing relative error in U to "</span> &lt;&lt; error.objectPath()</span><br><span class="line">                &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            error.<span class="built_in">write</span>();</span><br><span class="line">        #&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h1><h2 id="probes-前面有另一种实现方法"><a class="markdownIt-Anchor" href="#probes-前面有另一种实现方法"></a> probes 前面有另一种实现方法</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    probes</span><br><span class="line">    &#123;</span><br><span class="line">        type            probes;</span><br><span class="line">        libs            (<span class="string">"libsampling.so"</span>);</span><br><span class="line">        writeControl   timeStep;</span><br><span class="line">        writeInterval  <span class="number">1</span>;</span><br><span class="line">        probeLocations</span><br><span class="line">        (</span><br><span class="line">            (<span class="number">0</span> <span class="number">9.95</span> <span class="number">19.77</span>)</span><br><span class="line">            (<span class="number">0</span> <span class="number">-9.95</span> <span class="number">19.77</span>)</span><br><span class="line">        );</span><br><span class="line">        fixedLocations  <span class="literal">false</span>;</span><br><span class="line">        fields</span><br><span class="line">        (</span><br><span class="line">            p</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="等值面"><a class="markdownIt-Anchor" href="#等值面"></a> 等值面</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    surfaces</span><br><span class="line">    &#123;</span><br><span class="line">        type            surfaces;</span><br><span class="line">        libs            (<span class="string">"libsampling.so"</span>);</span><br><span class="line">        writeControl    adjustableRunTime;</span><br><span class="line">        writeInterval   <span class="number">0.01</span>;</span><br><span class="line">        timeStart       <span class="number">10</span>;</span><br><span class="line">        surfaceFormat   vtk;</span><br><span class="line">        fields          (p_rgh U);</span><br><span class="line">        interpolationScheme cellPoint;</span><br><span class="line">        surfaces</span><br><span class="line">        (</span><br><span class="line">            interface</span><br><span class="line">            &#123;</span><br><span class="line">                type            isoSurface;</span><br><span class="line">                isoField        alpha.water;</span><br><span class="line">                isoValue        <span class="number">0.5</span>;</span><br><span class="line">                interpolate     <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="forces"><a class="markdownIt-Anchor" href="#forces"></a> forces</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    forces</span><br><span class="line">    &#123;</span><br><span class="line">        type            forces;</span><br><span class="line">        libs            (<span class="string">"libforces.so"</span>);</span><br><span class="line">        writeControl    writeTime;</span><br><span class="line">        patches         (floatingObject);</span><br><span class="line">        rho             rhoInf;</span><br><span class="line">        <span class="built_in">log</span>             yes;</span><br><span class="line">        rhoInf          <span class="number">1000</span>;</span><br><span class="line">        CofR            (<span class="number">0</span> <span class="number">0</span> <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1 id="输出控制"><a class="markdownIt-Anchor" href="#输出控制"></a> 输出控制</h1><p>这里分两种情况，分别是 solver 运行时和运行后。</p><ul><li>运行后，一定需要记住的是必须使用参数 <code>-fields</code> 指定此次后处理过程中涉及的所有场（作为输入信息）。可以使用前面提到的 <code>-time</code> 参数来控制需要处理的时间段。</li><li>运行时<br>在 solver 运行时可以手动控制输出时间间隔，通过这两个选项： writeControl writeInterval。<br><code>writeControl</code> 常用的可选项：</li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">outputTime<span class="comment">//同主程序输出间隔相同。</span></span><br><span class="line">writeTime<span class="comment">//每 writeInterval个输出步长写一次。这里的输出步长指主程序的write步长。即，如果主程序每秒write一次，这里的function就是每3秒写一次。</span></span><br><span class="line">adjustableRunTime<span class="comment">//每 writeInterval 秒物理时间写一次，但是对于可调节步长的话，会自动调节最后一次的时间步长，以便准确时间输出。</span></span><br></pre></td></tr></table></figure><p><code>writeControl</code> 所有的可选项：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">outputTime<span class="comment">//同主程序输出间隔相同。</span></span><br><span class="line">runTime<span class="comment">//每 writeInterval 秒物理时间写一次。</span></span><br><span class="line">adjustableRunTime<span class="comment">//每 writeInterval 秒物理时间写一次，但是对于可调节步长的话，会自动调节最后一次的时间步长，以便准确时间输出。</span></span><br><span class="line">clockTime<span class="comment">//每 writeInterval 秒实际时间写一次。</span></span><br><span class="line">cpuTime<span class="comment">//每 writeInteral 秒 cpu 时间写一次。</span></span><br><span class="line">none<span class="comment">//不输出。</span></span><br><span class="line">writeTime<span class="comment">//每 writeInterval个输出步长写一次。这里的输出步长指主程序的write步长。即，如果主程序每秒write一次，这里的function就是每3秒写一次。</span></span><br><span class="line">timeStep<span class="comment">//每 writeInterval 个时间步长写一次。</span></span><br></pre></td></tr></table></figure><h1 id="简便用法"><a class="markdownIt-Anchor" href="#简便用法"></a> 简便用法</h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    #includeFunc Qdot</span><br><span class="line">    #<span class="function">includeFunc <span class="title">writeObjects</span><span class="params">(RR.C7H16)</span></span></span><br><span class="line">    #includeFunc writeObjects(h)</span><br><span class="line">    #<span class="function">includeFunc <span class="title">fieldAverage</span><span class="params">(U, p)</span></span></span><br><span class="line">    #includeFunc fieldAverage(U, p, prime2Mean = yes)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="mailto:undefined" rel="external nofollow noopener noreferrer" target="_blank">Yan Zhang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="https://openfoam.top/functionObject/">https://openfoam.top/functionObject/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="external nofollow noopener noreferrer">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://openfoam.top">OpenFOAM 成长之路</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/functionObject/">functionObject</a></div><div class="post-qr-code"><div class="post-qr-code-item"><img class="post-qr-code__img" src="/album/wechatPay.jpg"><div class="post-qr-code__desc">您的肯定会给我更大动力~</div></div></div><div class="social-share pull-right" data-disabled="tencent,douban,qzone,diandian,facebook,twitter,google"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/markdownLearning/"><i class="fa fa-chevron-left"></i><span>markdown 学习笔记</span></a></div></nav><div id="gitalk-container"></div><script>var gitalk=new Gitalk({clientID:"9dfad189aeefc4c2dde2",clientSecret:"69b4d95e0c4be2508135adae20b05bf6f298f386",repo:"zhangyantju.github.io",owner:"ZhangYanTJU",admin:"ZhangYanTJU",id:md5(decodeURI(location.pathname)),language:"zh-CN"});gitalk.render("gitalk-container")</script></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2020 By Yan Zhang</div><div class="framework-info"><span>驱动 -</span> <a href="http://hexo.io" target="_blank" rel="external nofollow noopener noreferrer"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 -</span> <a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="external nofollow noopener noreferrer"><span>Melody</span></a></div><div class="footer_custom_text">Hosted by <a target="_blank" rel="external nofollow noopener noreferrer" href="https://pages.coding.me"><b>Coding Pages</b></a></div></div><script id="maid-script" src="https://unpkg.com/mermaid@8.5.1/dist/mermaid.min.js?v=undefined"></script><script>if(window.mermaid){var options=JSON.parse(document.getElementById("maid-script").getAttribute("mermaidoptioins"));mermaid.initialize(options)}</script></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.7.0"></script><script src="/js/fancybox.js?version=1.7.0"></script><script src="/js/sidebar.js?version=1.7.0"></script><script src="/js/copy.js?version=1.7.0"></script><script src="/js/fireworks.js?version=1.7.0"></script><script src="/js/transition.js?version=1.7.0"></script><script src="/js/scroll.js?version=1.7.0"></script><script src="/js/head.js?version=1.7.0"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script src="/js/katex.js"></script><script src="/js/search/local-search.js"></script><script>/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)&&($("#nav").addClass("is-mobile"),$("footer").addClass("is-mobile"),$("#top-container").addClass("is-mobile"))</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="external nofollow noopener noreferrer" style="color:#49b1f5">hexo-generator-search</a> <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>