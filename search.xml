<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>OpenFOAM 并行 reconstructPar</title>
      <link href="/parallellyReconstructPar/"/>
      <url>/parallellyReconstructPar/</url>
      
        <content type="html"><![CDATA[<p>使用特殊技巧并行化 reconstructPar OpenFOAM 结果</p><a id="more"></a><p>通过参悟 OpenFOAM 中的并行编译方法：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wmake -j 8</span><br></pre></td></tr></table></figure><p>我们实现了并行化的 <code>reconstructPar</code>：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">timeList&#x3D;&#96;foamListTimes -processor&#96;</span><br><span class="line">for time in $timeList; do</span><br><span class="line">    nCores&#x3D;6</span><br><span class="line">    joblist&#x3D;($(jobs -p))</span><br><span class="line">    while (( $&#123;#joblist[*]&#125; &gt;&#x3D; &quot;$nCores&quot; ))</span><br><span class="line">    do</span><br><span class="line">        # When the job limit is reached wait for a job to finish</span><br><span class="line">        wait -n</span><br><span class="line">        joblist&#x3D;($(jobs -p))</span><br><span class="line">    done</span><br><span class="line">    reconstructPar -time $time &gt;log.$time&amp;</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>上述代码即可实现 6 个核同时 <code>reconstructPar</code>！</p><p>如果你使用了 <code>collated fileHandler</code>，那么你就得使用我编写的工具，才能获知并行计算的 time list。<br>我把它放在了 GitHub 上：<a href="https://github.com/ZhangYanTJU/ZYfoamListTimes" target="_blank" rel="external nofollow noopener noreferrer">ZYfoamListTimes</a>，可以自行下载编译，也欢迎点赞关注加收藏。<br>然后将上段代码中的 <code>foamListTimes -processor</code> 替换成 <code>ZYfoamListTimes -processors 21</code> 即可，其中 21 是你的算例使用的核数。</p>]]></content>
      
      
      <categories>
          
          <category> using </category>
          
      </categories>
      
      
        <tags>
            
            <tag> reconstructPar </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>paraview 网格显示美化</title>
      <link href="/paraviewMesh/"/>
      <url>/paraviewMesh/</url>
      
        <content type="html"><![CDATA[<p>paraview 的网格可以显示得很美观，只需要掌握以下技巧。</p><a id="more"></a><p>首先，使用 slice 可以获得更加好看的切片（相比于 clip）。</p><p>最开始，网格是这样：<br><img src="/album/paraviewMesh1.png" width="70%" height="70%"></p><p>一键美化：取消勾选 Triangulate the slice</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><img src="/album/paraviewMesh2.png"></td><td><img src="/album/paraviewMesh3.png"></td></tr></tbody></table><p>上边的网格，只需要一个按钮就可以变得更好看。</p><table><thead><tr><th>如果使用 paraview 打开的，点击 0412.foam，然后取消勾选 Decompose polyhedra</th><th>如果使用 paraFoam 打开的，点击 0412.foam，然后勾选 Use VTK Polyhedron</th></tr></thead><tbody><tr><td><img src="/album/paraviewMesh4.png"></td><td><img src="/album/paraviewMesh5.png"></td></tr></tbody></table><p>最后，还需要把 slice 的 X 方向（我这个截面的法向是 X 方向）偏移一下：1e-7</p><p>最终效果（左图是完整的网格，右图是局部放大）：<br><img src="/album/paraviewMesh6.png" width="100%" height="100%"></p><p>最终效果来自<a href="https://www.tandfonline.com/doi/full/10.1080/13647830.2019.1600722" target="_blank" rel="external nofollow noopener noreferrer">本人论文</a>，感兴趣的读者可以去看看。</p>]]></content>
      
      
      <categories>
          
          <category> using </category>
          
      </categories>
      
      
        <tags>
            
            <tag> paraview </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM with boost</title>
      <link href="/boost/"/>
      <url>/boost/</url>
      
        <content type="html"><![CDATA[<p>using boost in OpenFOAM</p><a id="more"></a><p>服务器上已经安装了 boost，在 /usr/include/boost</p><p>在 OpenFOAM 中，不需要修改 options ，直接</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;boost/lambda/lambda.hpp&gt;</span></span></span><br></pre></td></tr></table></figure><p>就可以用了：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt;<span class="string">"beta in boost ="</span>&lt;&lt;boost::math::beta(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)&lt;&lt;<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure><h1 id="boost-中的函数"><a class="markdownIt-Anchor" href="#boost-中的函数"></a> boost 中的函数</h1><p>beta(a,b)<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msup><mi>t</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mrow><mi>b</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>d</mi><mi>t</mi><mo>=</mo><mfrac><mrow><mi mathvariant="normal">Γ</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Γ</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">Γ</mi><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">=\int_0^1t^{a-1}(1-t)^{b-1}dt=\frac{\Gamma(a)\Gamma(b)}{\Gamma(a+b)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.3648280000000002em;vertical-align:-.35582em"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:.19445em;position:relative;top:-.0005599999999999772em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0090080000000001em"><span style="top:-2.34418em;margin-left:-.19445em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.2579000000000002em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35582em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.0991079999999998em;vertical-align:-.25em"></span><span class="mord mathdefault">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8491079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Γ</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">a</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">b</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Γ</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">a</span><span class="mclose mtight">)</span><span class="mord mtight">Γ</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">b</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><p>beta(a,b,x)<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mi>x</mi></msubsup><msup><mi>t</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mrow><mi>b</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">=\int_0^xt^{a-1}(1-t)^{b-1}dt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.215112em;vertical-align:-.35582em"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:.19445em;position:relative;top:-.0005599999999999772em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8592920000000001em"><span style="top:-2.34418em;margin-left:-.19445em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.2579000000000002em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35582em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.0991079999999998em;vertical-align:-.25em"></span><span class="mord mathdefault">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8491079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span></span></p><p>ibeta(a,b,x)<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><mfrac><mrow><msubsup><mo>∫</mo><mn>0</mn><mi>x</mi></msubsup><msup><mi>t</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mrow><mi>b</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>d</mi><mi>t</mi></mrow><mrow><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msup><mi>t</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mrow><mi>b</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">=\frac{\int_0^xt^{a-1}(1-t)^{b-1}dt}{\int_0^1t^{a-1}(1-t)^{b-1}dt}=\frac{beta(a,b,x)}{beta(a,b)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.936208em;vertical-align:-.713004em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.223204em"><span style="top:-2.55128em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="margin-right:.19445em;position:relative;top:-.0005599999999999772em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9124571428571429em"><span style="top:-2.1224514285714284em;margin-left:-.19445em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span><span style="top:-2.9521428571428574em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.37754857142857146em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7463142857142857em"><span style="top:-2.786em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">t</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7820285714285714em"><span style="top:-2.786em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.574284em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="margin-right:.19445em;position:relative;top:-.0005599999999999772em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7596857142857143em"><span style="top:-2.1224514285714284em;margin-left:-.19445em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span><span style="top:-2.9521428571428574em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.37754857142857146em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913142857142857em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">t</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9270285714285714em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.713004em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">a</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">b</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">a</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">b</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><h1 id="gsl-中的函数"><a class="markdownIt-Anchor" href="#gsl-中的函数"></a> GSL 中的函数</h1><p>gsl_sf_beta(a,b) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msup><mi>t</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mrow><mi>b</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>d</mi><mi>t</mi><mo>=</mo><mfrac><mrow><mi mathvariant="normal">Γ</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Γ</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">Γ</mi><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">=\int_0^1t^{a-1}(1-t)^{b-1}dt=\frac{\Gamma(a)\Gamma(b)}{\Gamma(a+b)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.3648280000000002em;vertical-align:-.35582em"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:.19445em;position:relative;top:-.0005599999999999772em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0090080000000001em"><span style="top:-2.34418em;margin-left:-.19445em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.2579000000000002em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35582em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.0991079999999998em;vertical-align:-.25em"></span><span class="mord mathdefault">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8491079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Γ</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">a</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">b</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Γ</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">a</span><span class="mclose mtight">)</span><span class="mord mtight">Γ</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">b</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><p>gsl_sf_beta_inc(a,b,x)<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><mfrac><mrow><msubsup><mo>∫</mo><mn>0</mn><mi>x</mi></msubsup><msup><mi>t</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mrow><mi>b</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>d</mi><mi>t</mi></mrow><mrow><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msup><mi>t</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mrow><mi>b</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>d</mi><mi>t</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">=\frac{\int_0^xt^{a-1}(1-t)^{b-1}dt}{\int_0^1t^{a-1}(1-t)^{b-1}dt}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.936208em;vertical-align:-.713004em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.223204em"><span style="top:-2.55128em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="margin-right:.19445em;position:relative;top:-.0005599999999999772em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9124571428571429em"><span style="top:-2.1224514285714284em;margin-left:-.19445em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span><span style="top:-2.9521428571428574em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.37754857142857146em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7463142857142857em"><span style="top:-2.786em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">t</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7820285714285714em"><span style="top:-2.786em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.574284em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="margin-right:.19445em;position:relative;top:-.0005599999999999772em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7596857142857143em"><span style="top:-2.1224514285714284em;margin-left:-.19445em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span><span style="top:-2.9521428571428574em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.37754857142857146em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913142857142857em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">t</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9270285714285714em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.713004em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> boost </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM with GSL</title>
      <link href="/gsl/"/>
      <url>/gsl/</url>
      
        <content type="html"><![CDATA[<p>using GSL (GNU Scientific Library) in OpenFOAM</p><a id="more"></a><h1 id="编译安装"><a class="markdownIt-Anchor" href="#编译安装"></a> 编译安装</h1><p>在源码目录下，执行下列命令：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./configure --prefix=/THL6/home/yzg/OpenFOAM/gsl-2.4/build 2&gt;&amp;1 | tee c.txt</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h1 id="系统环境变量"><a class="markdownIt-Anchor" href="#系统环境变量"></a> 系统环境变量</h1><p>在 <code>~/.bashrc</code> 文件中添加：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> GSL</span></span><br><span class="line">export LD_LIBRARY_PATH=/THL6/home/yzg/OpenFOAM/gsl-2.4/build/lib:$LD_LIBRARY_PATH</span><br></pre></td></tr></table></figure><h1 id="在-of-solver-中使用-gsl"><a class="markdownIt-Anchor" href="#在-of-solver-中使用-gsl"></a> 在 OF solver 中使用 GSL</h1><p>在 <code>options</code> 文件中添加：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">EXE_INC = \</span><br><span class="line">...</span><br><span class="line">-I/THL6/<span class="built_in">home</span>/yzg/OpenFOAM/gsl<span class="number">-2.4</span>/build/include \</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">EXE_LIBS = \</span><br><span class="line">...</span><br><span class="line">    -L/THL6/<span class="built_in">home</span>/yzg/OpenFOAM/gsl<span class="number">-2.4</span>/build/lib \</span><br><span class="line">    -lgsl \</span><br><span class="line">    -lgslcblas \</span><br></pre></td></tr></table></figure><p>然后按照需要包含其头文件：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gsl/gsl_spline2d.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gsl/gsl_spline.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gsl/gsl_interp2d.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gsl/gsl_interp.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gsl/gsl_sf_gamma.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gsl/gsl_matrix.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gsl/gsl_linalg.h&gt;</span></span></span><br></pre></td></tr></table></figure><h1 id="使用举例"><a class="markdownIt-Anchor" href="#使用举例"></a> 使用举例</h1><h2 id="一维数组插值"><a class="markdownIt-Anchor" href="#一维数组插值"></a> 一维数组插值</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">gsl_interp_accel *acc = gsl_interp_accel_alloc();</span><br><span class="line"><span class="keyword">const</span> gsl_interp_type *t = gsl_interp_linear;</span><br><span class="line">gsl_spline *ZY_spline</span><br><span class="line">    = gsl_spline_alloc (t, index_old.<span class="built_in">size</span>());</span><br><span class="line">gsl_spline_init</span><br><span class="line">    (ZY_spline, index_old, data_old, index_old.<span class="built_in">size</span>());</span><br><span class="line">forAll(index_new, i)</span><br><span class="line">&#123;</span><br><span class="line">    scalar getValue =</span><br><span class="line">        gsl_spline_eval (ZY_spline, index_new[i], acc);</span><br><span class="line">    data_new[i] = getValue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="beta-积分"><a class="markdownIt-Anchor" href="#beta-积分"></a> beta 积分</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">scalar beta_ab_gsl = gsl_sf_beta(a,b);</span><br><span class="line">scalar beta_inc_abz_gsl = gsl_sf_beta_inc(a,b,z)</span><br></pre></td></tr></table></figure><h2 id="矩阵求逆"><a class="markdownIt-Anchor" href="#矩阵求逆"></a> 矩阵求逆</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">gsl_matrix* Foam::ZYclass::GetInverse(gsl_matrix *A)</span><br><span class="line">&#123;</span><br><span class="line">label n = A-&gt;size1;label sign = <span class="number">0</span>;</span><br><span class="line">gsl_matrix *inverse;</span><br><span class="line"></span><br><span class="line">gsl_matrix *tmpA = gsl_matrix_alloc(n, n);</span><br><span class="line">gsl_matrix_memcpy(tmpA, A);</span><br><span class="line">gsl_permutation *p = gsl_permutation_alloc(n);</span><br><span class="line"></span><br><span class="line">gsl_linalg_LU_decomp(tmpA, p, &amp;sign);</span><br><span class="line">inverse = gsl_matrix_alloc(n, n);</span><br><span class="line">gsl_linalg_LU_invert(tmpA, p, inverse);</span><br><span class="line">gsl_permutation_free(p);</span><br><span class="line">gsl_matrix_free(tmpA);</span><br><span class="line"><span class="keyword">return</span> inverse;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="矩阵相乘"><a class="markdownIt-Anchor" href="#矩阵相乘"></a> 矩阵相乘</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">gsl_matrix* Foam::ZYclass::gsl_matrix_mul(gsl_matrix *a,gsl_matrix *b)</span><br><span class="line">&#123;</span><br><span class="line">    gsl_matrix *c=gsl_matrix_alloc(a-&gt;size1, b-&gt;size2);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;a-&gt;size1;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">size_t</span> j=<span class="number">0</span>;j&lt;b-&gt;size2;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">double</span> sum=<span class="number">0.0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">size_t</span> k=<span class="number">0</span>;k&lt;b-&gt;size1;k++)</span><br><span class="line">            &#123;</span><br><span class="line">                sum+=gsl_matrix_get(a,i,k)*gsl_matrix_get(b,k,j);</span><br><span class="line">            &#125;</span><br><span class="line">            gsl_matrix_set(c,i,j,sum);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GSL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM with OpenMP</title>
      <link href="/openmp/"/>
      <url>/openmp/</url>
      
        <content type="html"><![CDATA[<p>using OpenMP in OpenFOAM</p><a id="more"></a><p>有时候在 OpenFOAM 编写一些算法，用不到自带的 mpi 库。<br>此时可以使用 OpenMP 来对基于 OpenFOAM 编写的代码进行加速。<br>用法很简单，首先加入头文件：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;omp.h&gt;</span></span></span><br></pre></td></tr></table></figure><p>验证 OpenMP 并行是否生效，我们输出一下所使用的的核数：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> omp single</span></span><br><span class="line">&#123;</span><br><span class="line">    Info &lt;&lt; <span class="string">"Hello, omp_get_max_threads = "</span> &lt;&lt; omp_get_max_threads() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后就可以加入 OpenMP 的魔法了，例如对 for 循环进行加速：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> omp parallel for</span></span><br><span class="line"><span class="keyword">for</span> (label i=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++) <span class="comment">// 也支持 OpenFOAM 里的 forAll</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">do</span> something</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后在 Make/options 中，<code>EXE_INC = \</code> 的下面一行，插入：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">-fopenmp \</span><br></pre></td></tr></table></figure><p>使用前可以指定核数（否则使用机器的所有核）：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export OMP_NUM_THREADS=20</span><br></pre></td></tr></table></figure><p>或者在超算 slurm 脚本中指定：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export OMP_NUM_THREADS=$SLURM_NTASKS</span><br></pre></td></tr></table></figure><p>看完应该能够打造你自己的 OpenMP 并行应用了吧。</p>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OpenMP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM中圆柱体的二维画法</title>
      <link href="/axialMesh/"/>
      <url>/axialMesh/</url>
      
        <content type="html"><![CDATA[<p>本文移植自博主以前的新浪博客，<a href="http://blog.sina.com.cn/s/blog_a2a8de490102vbvh.html" target="_blank" rel="external nofollow noopener noreferrer">原文</a>发表于 (2014-12-25 10:22:36)。</p><a id="more"></a><h1 id="简介"><a class="markdownIt-Anchor" href="#简介"></a> 简介</h1><p>使用的方法是 makeAxialMesh，最初来自于 <a href="http://openfoamwiki.net/index.php/Contrib_MakeAxialMesh" target="_blank" rel="external nofollow noopener noreferrer">openfoamwiki</a>。<br>我将其移植到了最新的 OpenFOAM-7：<a href="https://github.com/ZhangYanTJU/makeAxialMesh" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/ZhangYanTJU/makeAxialMesh</a> ，并且附有算例。</p><p>首先来张 UserGuide 上的插图<img src="https://cdn.cfd.direct/docs/user-guide-v6/img/user357x.png" alt="">。<br>在OpenFOAM（其他平台不知道）中，圆柱体的二维表现为一个夹角不超过5度的楔形。那么怎样把这个楔形画出来呢？</p><h1 id="操作步骤"><a class="markdownIt-Anchor" href="#操作步骤"></a> 操作步骤</h1><p>在 system 文件夹下，需要两个文件：rotationDict 和 collapseDict</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; ************************rotationDict************************************** &#x2F;&#x2F;</span><br><span class="line">&#x2F;&#x2F; Use the same parameters as from the command line</span><br><span class="line">&#x2F;&#x2F; makeAxialOldMode 1;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; used in old and in new mode</span><br><span class="line">makeAxialAxisPatch center;</span><br><span class="line">makeAxialWedgePatch frontAndBack;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; used only in old mode</span><br><span class="line">makeAxialOffset 0.01;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; used only in new mode</span><br><span class="line">rotationVector (0 1 0);</span><br><span class="line">originVector (0 0 0); &#x2F;&#x2F;offset</span><br><span class="line">&#x2F;&#x2F; originVector (0 0 0); &#x2F;&#x2F; origin</span><br><span class="line"></span><br><span class="line">wedgeAngle 5;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; revolve option</span><br><span class="line">&#x2F;&#x2F; 0 &#x3D; old and default mode, points are projected on wedges</span><br><span class="line">&#x2F;&#x2F; 1 &#x3D; points are revolved</span><br><span class="line">revolve 0;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ************************************************************************* &#x2F;&#x2F;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; * * * * * * * * * * * * *collapseDict* * * * * * * * * * * * * * * * * * &#x2F;&#x2F;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; If on, after collapsing check the quality of the mesh. If bad faces are</span><br><span class="line">&#x2F;&#x2F; generated then redo the collapsing with stricter filtering.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">collapseEdgesCoeffs</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F; Edges shorter than this absolute value will be merged</span><br><span class="line">    minimumEdgeLength   1e-6;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; The maximum angle between two edges that share a point attached to</span><br><span class="line">    &#x2F;&#x2F; no other edges</span><br><span class="line">    maximumMergeAngle   179;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ************************************************************************* &#x2F;&#x2F;</span><br></pre></td></tr></table></figure><p>在blockMeshDict文件中，网格照常定义。只是需要注意一下几点：</p><ul><li>把需要坍塌的那个面（此面合并成一条线，即圆柱体的轴线），定义为center ， type symmetryPlane（定义边界条件是也用此type）。</li><li>需要frontAndBack。</li><li>生成楔形网格后，frontAndBack会变成两个 frontAndBack_pos， frontAndBack_neg。定义边界条件时，用wedge类型。</li></ul><p><span id="Allrun"></span><br>然后，按如下指令操作：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">blockMesh</span><br><span class="line">makeAxialMesh -overwrite</span><br><span class="line">collapseEdges -overwrite</span><br><span class="line">checkMesh</span><br></pre></td></tr></table></figure><h1 id="注意事项"><a class="markdownIt-Anchor" href="#注意事项"></a> 注意事项</h1><ul><li><p>只有一个网格的那个维度，需要与 0 对称分布：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(0 0 -0.05)</span><br><span class="line">(1 0 -0.05)</span><br><span class="line">(1 1 -0.05)</span><br><span class="line">(0 1 -0.05)</span><br><span class="line">(0 0 0.05)</span><br><span class="line">(1 0 0.05)</span><br><span class="line">(1 1 0.05)</span><br><span class="line">(0 1 0.05)</span><br></pre></td></tr></table></figure></li><li><p>如果在执行 <code>collapseEdges -overwrite</code> 的时候遇到以下问题：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">--&gt; FOAM Warning :</span><br><span class="line">    From function void Foam::wedgePolyPatch::calcGeometry(Foam::PstreamBuffers &amp;)</span><br><span class="line">    in file meshes&#x2F;polyMesh&#x2F;polyPatches&#x2F;constraint&#x2F;wedge&#x2F;wedgePolyPatch.C at line 70</span><br><span class="line">    Wedge patch &#39;frontAndBack_neg&#39; is not planar.</span><br><span class="line">At local face at (0.0975 0.0925 -0.00250811) the normal (0 0.0435766 -0.99905) differs from the average normal (-4.23114e-19 0.043578 -0.99905) by 1.95256e-12</span><br><span class="line">Either correct the patch or split it into planar parts</span><br></pre></td></tr></table></figure><p>可以执行以下代码，然后 goto <a href="#Allrun">这里</a>重新操作一遍！</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">foamDictionary -entry writeFormat -set binary system&#x2F;controlDict</span><br></pre></td></tr></table></figure></li><li><p>如果使用 OF-2.1.x，需要使用： <code>collapseEdges -overwrite 1e-6 179</code></p></li></ul><h1 id="相关链接"><a class="markdownIt-Anchor" href="#相关链接"></a> 相关链接</h1><p><a href="https://www.cfd-online.com/Forums/openfoam-meshing/61473-converting-2dmesh-axisymmetric-11.html" target="_blank" rel="external nofollow noopener noreferrer">cfd-online</a></p>]]></content>
      
      
      <categories>
          
          <category> using </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wedge </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM中refineMesh的用法</title>
      <link href="/refineMesh/"/>
      <url>/refineMesh/</url>
      
        <content type="html"><![CDATA[<p>本文移植自博主以前的新浪博客，<a href="http://blog.sina.com.cn/s/blog_a2a8de490102vbve.html" target="_blank" rel="external nofollow noopener noreferrer">原文</a>发表于 (2014-12-25 09:58:12)。</p><a id="more"></a><p>想要实现 refineMesh, system 文件夹下需要两个文件，topoSetDict 和 refineMeshDict。<br>如下：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;*--------------------------------*- C++ -*----------------------------------*\</span><br><span class="line">  &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;                 |</span><br><span class="line">  \\      &#x2F;  F ield         | OpenFOAM: The Open Source CFD Toolbox</span><br><span class="line">   \\    &#x2F;   O peration     | Website:  https:&#x2F;&#x2F;openfoam.org</span><br><span class="line">    \\  &#x2F;    A nd           | Version:  7</span><br><span class="line">     \\&#x2F;     M anipulation  |</span><br><span class="line">\*---------------------------------------------------------------------------*&#x2F;</span><br><span class="line">FoamFile</span><br><span class="line">&#123;</span><br><span class="line">    version     2.0;</span><br><span class="line">    format      ascii;</span><br><span class="line">    class       dictionary;</span><br><span class="line">    object      topoSetDict;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * &#x2F;&#x2F;</span><br><span class="line"></span><br><span class="line">actions</span><br><span class="line">(</span><br><span class="line">    &#123;</span><br><span class="line">        name    c0;</span><br><span class="line">        type    cellSet;</span><br><span class="line">        action  new;</span><br><span class="line">        source  boxToCell;</span><br><span class="line">        sourceInfo</span><br><span class="line">        &#123;</span><br><span class="line">            box (-1 -1 -1) (1 1 1); &#x2F;&#x2F; Edit box bounds as required</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ************************************************************************* &#x2F;&#x2F;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;*--------------------------------*- C++ -*----------------------------------*\</span><br><span class="line">  &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;                 |</span><br><span class="line">  \\      &#x2F;  F ield         | OpenFOAM: The Open Source CFD Toolbox</span><br><span class="line">   \\    &#x2F;   O peration     | Website:  https:&#x2F;&#x2F;openfoam.org</span><br><span class="line">    \\  &#x2F;    A nd           | Version:  7</span><br><span class="line">     \\&#x2F;     M anipulation  |</span><br><span class="line">\*---------------------------------------------------------------------------*&#x2F;</span><br><span class="line">FoamFile</span><br><span class="line">&#123;</span><br><span class="line">    version     2.0;</span><br><span class="line">    format      ascii;</span><br><span class="line">    class       dictionary;</span><br><span class="line">    object      refineMeshDict;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * &#x2F;&#x2F;</span><br><span class="line"></span><br><span class="line">set             c0;</span><br><span class="line"></span><br><span class="line">coordinateSystem global;</span><br><span class="line"></span><br><span class="line">globalCoeffs</span><br><span class="line">&#123;</span><br><span class="line">    tan1            (1 0 0);</span><br><span class="line">    tan2            (0 1 0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">directions &#x2F;&#x2F; comment out as required</span><br><span class="line">(</span><br><span class="line">    tan1</span><br><span class="line">    tan2</span><br><span class="line">    normal</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">useHexTopology  no;</span><br><span class="line"></span><br><span class="line">geometricCut    yes;</span><br><span class="line"></span><br><span class="line">writeMesh       no;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ************************************************************************* &#x2F;&#x2F;</span><br></pre></td></tr></table></figure><p>按如下指令操作：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">blockMesh</span><br><span class="line">topoSet</span><br><span class="line">refineMesh -dict .&#x2F;system&#x2F;refineMeshDict -overwrite</span><br><span class="line">checkMesh</span><br></pre></td></tr></table></figure><p>如果需要再次细化：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">topoSet</span><br><span class="line">refineMesh -dict .&#x2F;system&#x2F;refineMeshDict -overwrite</span><br><span class="line">checkMesh</span><br></pre></td></tr></table></figure><p>当年对 OF 了解不够，现在才发现 OF 早已提供了相关配置文件：<br><a href="https://github.com/OpenFOAM/OpenFOAM-dev/tree/master/etc/caseDicts/mesh/manipulation/refineRegion" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/OpenFOAM/OpenFOAM-dev/tree/master/etc/caseDicts/mesh/manipulation/refineRegion</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM 中的喷雾子模型</title>
      <link href="/spraySubModels/"/>
      <url>/spraySubModels/</url>
      
        <content type="html"><![CDATA[<p>从数学公式到 C++ 代码</p><a id="more"></a><p>本文下标 p 表示 parcel，g 表示 gas。</p><h1 id="dispersion"><a class="markdownIt-Anchor" href="#dispersion"></a> dispersion</h1><h2 id="传统-rans-框架下的公式"><a class="markdownIt-Anchor" href="#传统-rans-框架下的公式"></a> 传统 RANS 框架下的公式</h2><p>粒子速度方程：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">p</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="bold">u</mi><mi mathvariant="bold">p</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><msub><mi mathvariant="bold">u</mi><mi mathvariant="bold">p</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><msub><mi>C</mi><mi>D</mi></msub><msub><mi>τ</mi><mi>p</mi></msub></mfrac><mfrac><mrow><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub></mrow><mn>24</mn></mfrac><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">u</mi><mi mathvariant="bold">g</mi></msub><mo>−</mo><msub><mi mathvariant="bold">u</mi><mi mathvariant="bold">p</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><msub><mi>C</mi><mi>D</mi></msub><msub><mi>τ</mi><mi>p</mi></msub></mfrac><mfrac><mrow><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub></mrow><mn>24</mn></mfrac><msub><mi mathvariant="bold">v</mi><mrow><mi mathvariant="bold">r</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">l</mi></mrow></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} \frac{d}{dt} \mathbf{x}_{\mathbf{p}} &amp;=\mathbf{u}_{\mathbf{p}} \\ \frac{d}{d t} \mathbf{u}_{\mathbf{p}} &amp;=\frac{C_{D}}{\tau_{p}} \frac{R e_{p}}{24}\left(\mathbf{u}_{\mathbf{g}}-\mathbf{u}_{\mathbf{p}}\right)=\frac{C_{D}}{\tau_{p}} \frac{R e_{p}}{24} \mathbf{v}_{\mathbf{r e l}} \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.0009879999999995em;vertical-align:-2.2504939999999993em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.750494em"><span style="top:-4.750494em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16110799999999997em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">p</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-2.3930540000000002em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16110799999999997em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">p</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.2504939999999993em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.750494em"><span style="top:-4.750494em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16110799999999997em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">p</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-2.3930540000000002em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span><span class="mord">4</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16110799999999997em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:.01597em">g</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16110799999999997em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">p</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">)</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span><span class="mord">4</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:.01597em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">r</span><span class="mord mathbf mtight">e</span><span class="mord mathbf mtight">l</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.2504939999999993em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>其中的未知量 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">C_D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">v</mi><mrow><mi mathvariant="bold">r</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbf{v}_{\mathbf{r e l}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.59444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:.01597em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">r</span><span class="mord mathbf mtight">e</span><span class="mord mathbf mtight">l</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>τ</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\tau_{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 计算如下：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>C</mi><mi>D</mi></msub><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>24</mn><mrow><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub></mrow></mfrac></mstyle><mrow><mo fence="true">(</mo><mn>1</mn><mo>+</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn><mn>6</mn></mfrac></mstyle><mi>R</mi><msubsup><mi>e</mi><mi>p</mi><mrow><mn>2</mn><mi mathvariant="normal">/</mi><mn>3</mn></mrow></msubsup><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub><mo>&lt;</mo><mn>1000</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>C</mi><mi>D</mi></msub><mo>=</mo><mn>0.424</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub><mo>⩾</mo><mn>1000</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{ll} C_D=\dfrac{24}{Re_p}\left(1+\dfrac{1}{6} Re_p^{2/3}\right) &amp; R e_{p}&lt;1000 \\ C_D=0.424 &amp; Re_p \geqslant 1000 \end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.6221079999999994em;vertical-align:-1.561054em"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0610539999999995em"><span style="top:-4.061054em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">6</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.5834080000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style="top:-3.2198em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">/</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2526999999999999em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:-2.248946em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span><span class="mord">2</span><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.561054em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0610539999999995em"><span style="top:-4.061054em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span><span style="top:-2.248946em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel amsrm">⩾</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.561054em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub><mo>=</mo><msub><mi>ρ</mi><mi>g</mi></msub><mrow><mo fence="true">∣</mo><msub><mi mathvariant="bold">v</mi><mrow><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow></msub><mo fence="true">∣</mo></mrow><msub><mi>d</mi><mi>p</mi></msub><mi mathvariant="normal">/</mi><msub><mi>μ</mi><mi>g</mi></msub></mrow><annotation encoding="application/x-tex">R e_{p}=\rho_{g}\left|\mathbf{v}_{\mathrm{rel}}\right| d_{p} / \mu_{g}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:.01597em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">r</span><span class="mord mathrm mtight">e</span><span class="mord mathrm mtight">l</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">∣</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">v</mi><mrow><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow></msub><mo>=</mo><mover accent="true"><mi mathvariant="bold">u</mi><mo>~</mo></mover><mo>+</mo><msup><mi mathvariant="bold">u</mi><mo mathvariant="normal">′</mo></msup><mo>−</mo><msub><mi mathvariant="bold">u</mi><mi mathvariant="normal">p</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{v}_{\mathrm{rel}}=\tilde{\mathbf{u}}+\mathbf{u}^{\prime}-\mathbf{u}_{\mathrm{p}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.59444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:.01597em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">r</span><span class="mord mathrm mtight">e</span><span class="mord mathrm mtight">l</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7646299999999999em;vertical-align:-.08333em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6812999999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span></span></span><span style="top:-3.36344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8852220000000001em;vertical-align:-.08333em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.730548em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">p</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>τ</mi><mi>p</mi></msub><mo>=</mo><msub><mi>ρ</mi><mi>l</mi></msub><msubsup><mi>d</mi><mi>p</mi><mn>2</mn></msubsup><mi mathvariant="normal">/</mi><mn>18</mn><msub><mi>ρ</mi><mi>g</mi></msub><msub><mi>v</mi><mi>g</mi></msub></mrow><annotation encoding="application/x-tex">\tau_{p}=\rho_{l} d_{p}^{2} / 18 \rho_{g} v_{g}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.2472159999999999em;vertical-align:-.383108em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.01968em">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.864108em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord">1</span><span class="mord">8</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi mathvariant="bold">u</mi><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{\mathbf{u}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6812999999999999em;vertical-align:0"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6812999999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span></span></span><span style="top:-3.36344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span></span></span></span> 是气相速度，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="bold">u</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">\mathbf{u}^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.751892em;vertical-align:0"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> is stochastic velocity vector accounting for turbulence dispersion of parcels via interaction with surrounding gases.<br><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="bold">u</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">\mathbf{u}^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.751892em;vertical-align:0"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 是高斯分布，均值等于 0，方差等于 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo>=</mo><mn>2</mn><mi>k</mi><mi mathvariant="normal">/</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">\sigma^2=2 k / 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mord">/</span><span class="mord">3</span></span></span></span>。</p><blockquote><p>若随机变量X服从一个数学期望为 μ、方差为 σ^2 的正态分布，记为 N(μ，σ^2)。<img src="https://gss3.bdstatic.com/7Po3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D205/sign=2abf505a42166d223c77129473220945/342ac65c1038534384b650b09213b07eca808822.jpg" alt=""></p></blockquote><p>In this way each component of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="bold">u</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">\mathbf{u}^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.751892em;vertical-align:0"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> is chosen randomly from the Gaussian distribution</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mrow><mo fence="true">(</mo><msubsup><mi mathvariant="bold">u</mi><mrow><mi mathvariant="bold">p</mi><mo separator="true">,</mo><mi mathvariant="bold">i</mi></mrow><mo mathvariant="normal">′</mo></msubsup><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mi>σ</mi><msqrt><mrow><mn>2</mn><mi>π</mi></mrow></msqrt></mrow></mfrac><mi>exp</mi><mo>⁡</mo><msup><mrow><mo fence="true">(</mo><mo>−</mo><mfrac><msubsup><mi mathvariant="bold">u</mi><mrow><mi mathvariant="bold">p</mi><mo separator="true">,</mo><mi mathvariant="bold">i</mi></mrow><mo mathvariant="normal">′</mo></msubsup><mrow><mn>2</mn><mi>σ</mi></mrow></mfrac><mo fence="true">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">G\left(\mathbf{u}_{\mathbf{p}, \mathbf{i}}^{\prime}\right)=\frac{1}{\sigma \sqrt{2 \pi}} \exp \left(-\frac{\mathbf{u}_{\mathbf{p}, \mathbf{i}}^{\prime}}{2 \sigma}\right)^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.233108em;vertical-align:-.383108em"></span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-2.4530000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">p</span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathbf mtight">i</span></span></span></span></span><span style="top:-3.1130000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.715146em;vertical-align:-.95003em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.2027799999999997em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.90722em"><span class="svg-align" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord" style="padding-left:.833em"><span class="mord">2</span><span class="mord mathdefault" style="margin-right:.03588em">π</span></span></span><span style="top:-2.86722em"><span class="pstrut" style="height:3em"></span><span class="hide-tail" style="min-width:.853em;height:1.08em"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z M834 80H400000v40H845z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.13278em"><span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.93em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop">exp</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.561108em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.809216em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-2.4168920000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">p</span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathbf mtight">i</span></span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4192159999999999em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.765116em"><span style="top:-4.0140080000000005em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>t</mi><mrow><mi>t</mi><mi>u</mi><mi>r</mi><mi>b</mi></mrow></msub><mo>=</mo><mi>min</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mfrac><mi>k</mi><mi>ε</mi></mfrac><mo separator="true">,</mo><msub><mi>C</mi><mrow><mi>p</mi><mi>s</mi></mrow></msub><mfrac><msup><mi>k</mi><mrow><mn>3</mn><mi mathvariant="normal">/</mi><mn>2</mn></mrow></msup><mi>ε</mi></mfrac><mfrac><mn>1</mn><mrow><mo fence="true">∣</mo><mover accent="true"><mi mathvariant="bold">u</mi><mo>~</mo></mover><mo>+</mo><msup><mi mathvariant="bold">u</mi><mo mathvariant="normal">′</mo></msup><mo>−</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo fence="true">∣</mo></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">t_{t u r b}=\min \left(\frac{k}{\varepsilon}, C_{p s} \frac{k^{3 / 2}}{\varepsilon} \frac{1}{\left|\tilde{\mathbf{u}}+\mathbf{u}^{\prime}-\mathbf{u}_{p}\right|}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.76508em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight" style="margin-right:.02778em">r</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.537108em;vertical-align:-.972108em"></span><span class="mop">min</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ε</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.565em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ε</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8879999999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6812999999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span></span></span><span style="top:-3.36344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6778919999999999em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">∣</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>p</mi><mi>s</mi></mrow></msub><mo>=</mo><mn>0.16432</mn></mrow><annotation encoding="application/x-tex">C_{ps}=0.16432</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">6</span><span class="mord">4</span><span class="mord">3</span><span class="mord">2</span></span></span></span></p><p>OF 中的 stochstic turbulence dispersion 模型代码</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:<span class="built_in">vector</span> Foam::StochasticDispersionRAS&lt;CloudType&gt;::update</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar dt,</span><br><span class="line">    <span class="keyword">const</span> label celli,</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">vector</span>&amp; U,</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">vector</span>&amp; Uc,</span><br><span class="line">    <span class="built_in">vector</span>&amp; UTurb,</span><br><span class="line">    scalar&amp; tTurb</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    Random&amp; rnd = <span class="keyword">this</span>-&gt;owner().rndGen();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar cps = <span class="number">0.16432</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar k = <span class="keyword">this</span>-&gt;kPtr_-&gt;primitiveField()[celli];</span><br><span class="line">    <span class="keyword">const</span> scalar epsilon =</span><br><span class="line">        <span class="keyword">this</span>-&gt;epsilonPtr_-&gt;primitiveField()[celli] + rootVSmall;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar UrelMag = mag(U - Uc - UTurb);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar tTurbLoc =</span><br><span class="line">        <span class="built_in">min</span>(k/epsilon, cps*<span class="built_in">pow</span>(k, <span class="number">1.5</span>)/epsilon/(UrelMag + small));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Parcel is perturbed by the turbulence</span></span><br><span class="line">    <span class="keyword">if</span> (dt &lt; tTurbLoc)</span><br><span class="line">    &#123;</span><br><span class="line">        tTurb += dt;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (tTurb &gt; tTurbLoc)</span><br><span class="line">        &#123;</span><br><span class="line">            tTurb = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> scalar sigma = <span class="built_in">sqrt</span>(<span class="number">2</span>*k/<span class="number">3.0</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Calculate a random direction dir distributed uniformly</span></span><br><span class="line">            <span class="comment">// in spherical coordinates</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> scalar theta = rnd.scalar01()*twoPi;</span><br><span class="line">            <span class="keyword">const</span> scalar u = <span class="number">2</span>*rnd.scalar01() - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> scalar a = <span class="built_in">sqrt</span>(<span class="number">1</span> - sqr(u));</span><br><span class="line">            <span class="function"><span class="keyword">const</span> <span class="built_in">vector</span> <span class="title">dir</span><span class="params">(a*<span class="built_in">cos</span>(theta), a*<span class="built_in">sin</span>(theta), u)</span></span>;</span><br><span class="line"></span><br><span class="line">            UTurb = sigma*mag(rnd.scalarNormal())*dir;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        tTurb = great;</span><br><span class="line">        UTurb = Zero;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Uc + UTurb;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个函数在哪里被调用？答：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ParcelType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">template</span>&lt;class TrackCloudType&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:KinematicParcel&lt;ParcelType&gt;::calcDispersion</span><br><span class="line">(</span><br><span class="line">    TrackCloudType&amp; cloud,</span><br><span class="line">    trackingData&amp; td,</span><br><span class="line">    <span class="keyword">const</span> scalar dt</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    td.Uc() = cloud.dispersion().update</span><br><span class="line">    (</span><br><span class="line">        dt,</span><br><span class="line">        <span class="keyword">this</span>-&gt;cell(),</span><br><span class="line">        U_,</span><br><span class="line">        td.Uc(),</span><br><span class="line">        UTurb_,</span><br><span class="line">        tTurb_</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个 <code>calcDispersion</code> 函数，把 <code>dispersion</code> 模型中计算出来的 <code>Uc + UTurb</code>，即 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi mathvariant="bold">u</mi><mo>~</mo></mover><mo>+</mo><msup><mi mathvariant="bold">u</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">\tilde{\mathbf{u}}+\mathbf{u}^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7646299999999999em;vertical-align:-.08333em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6812999999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span></span></span><span style="top:-3.36344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.751892em;vertical-align:0"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 赋值给了 <code>td.Uc()</code>，即当前 <code>parcel</code> 所在网格的气相速度，但是并没有真正的修改气相速度。<br>这里修改了传进去 <code>UTurb_</code>，但是在其它代码中并没有用到。<br>此函数最关键的用处就是更新了 <code>td.Uc()</code>，用于后续的 <code>KinematicParcel::calcVelocity</code>，见<a href="../sprayVelocity">这篇本站博文</a>。</p><p><code>KinematicParcel::move</code> 中调用了 <code>p.calcDispersion(cloud, ttd, dt);</code>。</p><p>另外还有 <code>SprayParcel::calcBreakup</code>， breakup 之后，<code>child-&gt;calcDispersion(cloud, td, dt);</code>。</p><p>其中的 <code>UTurb</code> 就是上边公式中的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="bold">u</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">\mathbf{u}^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.751892em;vertical-align:0"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，<code>Uc</code> 是公式中的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi mathvariant="bold">u</mi><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{\mathbf{u}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6812999999999999em;vertical-align:0"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6812999999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span></span></span><span style="top:-3.36344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span></span></span></span>，<code>U</code> 是公式中的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>u</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">u_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>。</p><hr><h2 id="针对-les-的-dispersion-模型"><a class="markdownIt-Anchor" href="#针对-les-的-dispersion-模型"></a> 针对 LES 的 dispersion 模型</h2><blockquote><p>Tsang C-W, Kuo C-W, Trujillo M, et al. Evaluation and validation of large-eddy simulation sub-grid spray dispersion models using high-fidelity volume-of-fluid simulation data and engine combustion network experimental data[J]. International Journal of Engine Research, 2019, 20(6):583–605.</p></blockquote><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>t</mi><mrow><mi>t</mi><mi>u</mi><mi>r</mi><mi>b</mi></mrow></msub><mo>=</mo><msub><mi>C</mi><mrow><mi>t</mi><mi>u</mi><mi>r</mi><mi>b</mi></mrow></msub><mfrac><mrow><mn>2</mn><mi mathvariant="normal">Δ</mi></mrow><mrow><mo fence="true">∣</mo><msub><mi mathvariant="bold">u</mi><mrow><mi>S</mi><mi>g</mi><mi>S</mi></mrow></msub><mo>−</mo><msub><mi mathvariant="bold">u</mi><mi>d</mi></msub><mo fence="true">∣</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">t_{turb}=C_{turb} \frac{2 \Delta}{\left|\mathbf{u}_{S g S}-\mathbf{u}_{d}\right|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.76508em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight" style="margin-right:.02778em">r</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-.972108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight" style="margin-right:.02778em">r</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.328331em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05764em">S</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span><span class="mord mathdefault mtight" style="margin-right:.05764em">S</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">∣</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span><span class="mord">Δ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="bold">u</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><msub><mi mathvariant="bold">u</mi><mrow><mi>s</mi><mi>g</mi><mi>s</mi></mrow></msub><mo>+</mo><msub><mi mathvariant="bold">u</mi><mrow><mi>s</mi><mi>t</mi><mi>o</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbf{u}^{\prime}=\mathbf{u}_{sgs}+\mathbf{u}_{s t o}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.801892em;vertical-align:0"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8694379999999999em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.59444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">o</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">u</mi><mrow><mi>s</mi><mi>g</mi><mi>s</mi></mrow></msub><mo>=</mo><msub><mi>C</mi><mrow><mi>s</mi><mi>g</mi><mi>s</mi></mrow></msub><mo stretchy="false">(</mo><mn>2</mn><mover accent="true"><mi mathvariant="bold">u</mi><mo>~</mo></mover><mo>−</mo><mn>3</mn><mover accent="true"><mover accent="true"><mi mathvariant="bold">u</mi><mo>~</mo></mover><mo stretchy="true">~</mo></mover><mo>+</mo><mover accent="true"><mover accent="true"><mi mathvariant="bold">u</mi><mo>~</mo></mover><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{u}_{s g s}=C_{s g s}(2 \tilde{\mathbf{u}}-3 \widetilde{\tilde{\mathbf{u}}}+\widetilde{\tilde{\mathbf{u}}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.730548em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">2</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6812999999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span></span></span><span style="top:-3.36344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.02463em;vertical-align:-.08333em"></span><span class="mord">3</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9412999999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6812999999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span></span></span><span style="top:-3.36344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6813em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1913em;vertical-align:-.25em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9412999999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6812999999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span></span></span><span style="top:-3.36344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6813em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">u</mi><mrow><mi>s</mi><mi>t</mi><mi>o</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbf{u}_{sto}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.59444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">o</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 是高斯分布，均值是0，方差是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>σ</mi><mrow><mi>s</mi><mi>g</mi><mi>s</mi></mrow><mn>2</mn></msubsup><mo>=</mo><msub><mi>C</mi><mrow><mi>s</mi><mi>i</mi><mi>g</mi></mrow></msub><mfrac><mn>2</mn><mn>3</mn></mfrac><msub><mi>k</mi><mrow><mi>s</mi><mi>g</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\sigma_{s g s}^{2}=C_{sig} \frac{2}{3} k_{s g s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.197216em;vertical-align:-.383108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.4530000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span><span class="mord mathdefault mtight">s</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-.345em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>s</mi><mi>i</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{sig}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 是模型参数。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">u</mi><mrow><mi>s</mi><mi>t</mi><mi>o</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><msqrt><mrow><mn>2</mn><msubsup><mi>σ</mi><mrow><mi>s</mi><mi>g</mi><mi>s</mi></mrow><mn>2</mn></msubsup><mi>π</mi></mrow></msqrt></mfrac><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mo>−</mo><mfrac><msubsup><mi mathvariant="bold">u</mi><mrow><mi>s</mi><mi>t</mi><mi>o</mi><mo separator="true">,</mo><mi>i</mi></mrow><mn>2</mn></msubsup><mrow><mn>2</mn><msubsup><mi>σ</mi><mrow><mi>s</mi><mi>g</mi><mi>s</mi></mrow><mn>2</mn></msubsup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">G\left(\mathbf{u}_{sto, i}\right)=\frac{1}{\sqrt{2 \sigma_{s g s}^{2} \pi}} \exp \left(-\frac{\mathbf{u}_{sto, i}^{2}}{2 \sigma_{s g s}^{2}}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">o</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">)</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.48em;vertical-align:-1.73em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.11em"><span class="pstrut" style="height:3.1635em"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1635000000000002em"><span class="svg-align" style="top:-3.8em"><span class="pstrut" style="height:3.8em"></span><span class="mord" style="padding-left:1em"><span class="mord">2</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7401079999999999em"><span style="top:-2.4530000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span><span class="mord mathdefault mtight">s</span></span></span></span><span style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.03588em">π</span></span></span><span style="top:-3.1235em"><span class="pstrut" style="height:3.8em"></span><span class="hide-tail" style="min-width:1.02em;height:1.8800000000000001em"><svg width="400em" height="1.8800000000000001em" viewbox="0 0 400000 1944" preserveaspectratio="xMinYMin slice"><path d="M1001,80H400000v40H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5c53.7,-170.3,84.5,-266.8,92.5,-289.5c4,-6.7,10,-10,18,-10zM1001 80H400000v40H1013z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.6764999999999999em"><span></span></span></span></span></span></span></span><span style="top:-3.3935em"><span class="pstrut" style="height:3.1635em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.8405em"><span class="pstrut" style="height:3.1635em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.73em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop">exp</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size4">(</span></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5988799999999999em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7401079999999999em"><span style="top:-2.4530000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span><span class="mord mathdefault mtight">s</span></span></span></span><span style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.7847720000000002em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.441336em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">o</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.394772em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.069108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size4">)</span></span></span></span></span></span></span></p><hr><h1 id="drag"><a class="markdownIt-Anchor" href="#drag"></a> drag</h1><p>CdRe：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:scalar Foam::SphereDragForce&lt;CloudType&gt;::CdRe(<span class="keyword">const</span> scalar Re)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (Re &gt; <span class="number">1000.0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0.424</span>*Re;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">24.0</span>*(<span class="number">1.0</span> + <span class="number">1.0</span>/<span class="number">6.0</span>*<span class="built_in">pow</span>(Re, <span class="number">2.0</span>/<span class="number">3.0</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>calcCoupled：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:forceSuSp Foam::SphereDragForce&lt;CloudType&gt;::calcCoupled</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">typename</span> CloudType::parcelType&amp; p,</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">typename</span> CloudType::parcelType::trackingData&amp; td,</span><br><span class="line">    <span class="keyword">const</span> scalar dt,</span><br><span class="line">    <span class="keyword">const</span> scalar mass,</span><br><span class="line">    <span class="keyword">const</span> scalar Re,</span><br><span class="line">    <span class="keyword">const</span> scalar muc</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> forceSuSp(Zero, mass*<span class="number">0.75</span>*muc*CdRe(Re)/(p.rho()*sqr(p.d())));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SphereDragForce::calcCoupled</code> 的返回值翻译成公式就是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mn>3</mn><msub><mi>m</mi><mi>p</mi></msub><msub><mi>μ</mi><mi>g</mi></msub><msub><mi>C</mi><mi>D</mi></msub><mi>R</mi><mi>e</mi></mrow><mrow><mn>4</mn><msub><mi>ρ</mi><mi>p</mi></msub><msup><mi>D</mi><mn>2</mn></msup></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\dfrac{3m_p\mu_g C_DRe}{4\rho_p D^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.740108em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord mathdefault">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>。<br>我们有：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mi>p</mi></msub><mo>=</mo><msub><mi>m</mi><mi>p</mi></msub><mfrac><mrow><mi>d</mi><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>3</mn><msub><mi>m</mi><mi>p</mi></msub><msub><mi>μ</mi><mi>g</mi></msub><msub><mi>C</mi><mi>D</mi></msub><mi>R</mi><mi>e</mi></mrow><mrow><mn>4</mn><msub><mi>ρ</mi><mi>p</mi></msub><msup><mi>D</mi><mn>2</mn></msup></mrow></mfrac><mo stretchy="false">(</mo><mi mathvariant="bold">u</mi><mo>−</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_p = m_p \dfrac{d \mathbf{u}_p}{d t} =\dfrac{3m_p\mu_gC_DRe}{4\rho_p D^2}(\mathbf{u}-\mathbf{u}_{p})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.740108em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord mathdefault">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">u</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><code>SphereDragForce::calcCoupled</code> 返回值即 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi mathvariant="bold">u</mi><mo>−</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\mathbf{u}-\mathbf{u}_{p})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">u</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 前边的部分。<br>该返回值用于 <code>KinematicParcel::calcVelocity</code> 计算新的粒子速度，详细过程见<a href="../sprayVelocity">这篇本站博文</a>。</p>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Lagrangian </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 Python 科学绘图</title>
      <link href="/matplotlib/"/>
      <url>/matplotlib/</url>
      
        <content type="html"><![CDATA[<p>使用 matplotlib 绘图</p><a id="more"></a><h1 id="读取数据"><a class="markdownIt-Anchor" href="#读取数据"></a> 读取数据</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = pd.read_csv(<span class="string">"fileName"</span>, sep=<span class="string">'\t'</span>, skiprows=<span class="number">2</span>, names=[<span class="string">'x'</span>,<span class="string">'y'</span>,<span class="string">'z'</span>,<span class="string">'T'</span>])</span><br></pre></td></tr></table></figure><p>默认逗号为分隔符，也可以设为 <code>\t</code>等。<br>默认自动将第一行作为 index，可以这样调用：<code>data['x']</code>。<br>也可以手动设置 index：<code>names=['x','y','z','T']</code>。<br>通过 skiprows 设置需要忽略的行：</p><ul><li>数字指定：<code>skiprows = 2</code> 表示忽略前 2 行。</li><li>列表指定：<code>skiprows = [0]</code> 表示忽略第 0 行。</li><li>列表指定：<code>skiprows = range(1, 10))</code> 表示忽略第 1 到 9 行，保留第 0 行，和第 10 行及以后的行。</li></ul><h1 id="图型"><a class="markdownIt-Anchor" href="#图型"></a> 图型</h1><h2 id="点线图-plot"><a class="markdownIt-Anchor" href="#点线图-plot"></a> 点线图 plot</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plot(Z, Y, color=<span class="string">'green'</span>, linestyle=<span class="string">'dashed'</span>, linewidth=<span class="number">2</span>, marker=<span class="string">'o'</span>, markersize=<span class="number">12</span>)</span><br></pre></td></tr></table></figure><p>官方链接：<br><a href="https://matplotlib.org/gallery/color/named_colors.html#sphx-glr-gallery-color-named-colors-py" target="_blank" rel="external nofollow noopener noreferrer">colors</a><br><a href="https://matplotlib.org/api/markers_api.html?highlight=marker#module-matplotlib.markers" target="_blank" rel="external nofollow noopener noreferrer">markers</a><br><a href="https://matplotlib.org/gallery/lines_bars_and_markers/linestyles.html?highlight=linestyle" target="_blank" rel="external nofollow noopener noreferrer">Linestyles</a><br><a href="https://matplotlib.org/gallery/color/colormap_reference.html#sphx-glr-gallery-color-colormap-reference-py" target="_blank" rel="external nofollow noopener noreferrer">colormaps</a></p><p>Base Colors<br><img src="https://matplotlib.org/_images/sphx_glr_named_colors_001.png" alt=""></p><p>常见 linestyle<br><img src="https://matplotlib.org/_images/sphx_glr_linestyles_001.png" alt=""></p><p>unfilled markers<br><img src="https://matplotlib.org/_images/sphx_glr_marker_reference_001.png" alt="unfilled-markers"><br>filled markers<br><img src="https://matplotlib.org/_images/sphx_glr_marker_reference_002.png" alt=""><br>空心 markers</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">plt.plot(X, Y, &#39;o&#39;, markerfacecolor&#x3D;&#39;none&#39;)</span><br></pre></td></tr></table></figure><p>可以将 <code>plot</code> 中的线宽设为 0，这样只剩下 symbol：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plot(X, Y, marker=<span class="string">'.'</span>, linewidth=<span class="number">0</span>)</span><br></pre></td></tr></table></figure><h3 id="竖直线和水平线"><a class="markdownIt-Anchor" href="#竖直线和水平线"></a> 竖直线和水平线</h3><p><a href="https://matplotlib.org/3.1.0/api/_as_gen/matplotlib.axes.Axes.axhline.html" target="_blank" rel="external nofollow noopener noreferrer">水平线</a></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ax.axhline(y=<span class="number">0</span>, xmin=<span class="number">0</span>, xmax=<span class="number">1</span>, color=<span class="string">'black'</span>, linewidth=<span class="number">2</span>)</span><br><span class="line">ax.axhline(<span class="number">0</span>, color=<span class="string">'black'</span>, linewidth=<span class="number">2</span>) <span class="comment"># y=0</span></span><br></pre></td></tr></table></figure><p><a href="https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.axes.Axes.axvline.html" target="_blank" rel="external nofollow noopener noreferrer">竖直线</a></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ax.axvline(x=<span class="number">0</span>, ymin=<span class="number">0</span>, ymax=<span class="number">1</span>, color=<span class="string">"r"</span>)</span><br><span class="line">ax.axvline(<span class="number">0</span>, color=<span class="string">"r"</span>) <span class="comment"># x=0</span></span><br></pre></td></tr></table></figure><h2 id="散点图-scatter"><a class="markdownIt-Anchor" href="#散点图-scatter"></a> 散点图 scatter</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.scatter(X, Y, c=Z, s=<span class="number">1</span>, marker=<span class="string">'s'</span>, cmap=plt.cm.hot)</span><br></pre></td></tr></table></figure><p>散点用 X Y 表示，用 Z 着色，色带是 plt.cm.hot，size是 1。<br><a href="https://blog.csdn.net/u013634684/article/details/49646311" target="_blank" rel="external nofollow noopener noreferrer">更多设置参考网址</a></p><p>如果要对散点着色的话，建议先将所有点按照 Z 排序：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">idx &#x3D; Z.argsort()</span><br><span class="line">X, Y, Z &#x3D; X[idx], Y[idx], Z[idx]</span><br></pre></td></tr></table></figure><h3 id="绘制界限分明的-colorbar"><a class="markdownIt-Anchor" href="#绘制界限分明的-colorbar"></a> 绘制界限分明的 colorbar</h3><p><a href="https://matplotlib.org/3.2.0/api/_as_gen/matplotlib.colors.TwoSlopeNorm.html?highlight=twoslopenorm#matplotlib.colors.TwoSlopeNorm" target="_blank" rel="external nofollow noopener noreferrer">官方链接</a></p><p>记得选用 diverging 色条，比如官方的 <a href="https://matplotlib.org/examples/color/colormaps_reference.html" target="_blank" rel="external nofollow noopener noreferrer">seismic</a>。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">divnorm &#x3D; colors.TwoSlopeNorm(vcenter&#x3D;0)</span><br><span class="line">plt.scatter(X, Y, c&#x3D;Z, norm&#x3D;divnorm,cmap&#x3D;matplotlib.cm.seismic)</span><br></pre></td></tr></table></figure><h2 id="云图-contourf"><a class="markdownIt-Anchor" href="#云图-contourf"></a> 云图 contourf</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = pd.read_csv(<span class="string">"fileName"</span>, sep=<span class="string">'\t'</span>)</span><br><span class="line">X = data[<span class="string">'X'</span>]</span><br><span class="line">Y = data[<span class="string">'Y'</span>]</span><br><span class="line">Z = data[<span class="string">'Z'</span>]</span><br><span class="line"></span><br><span class="line">xi=np.linspace(min(X),max(X),<span class="number">1000</span>)</span><br><span class="line">yi=np.linspace(min(Y),max(Y),<span class="number">1000</span>)</span><br><span class="line">[XX,YY]=np.meshgrid(xi,yi)</span><br><span class="line">ZZ=griddata((X,Y), Z, (XX,YY), method=<span class="string">'cubic'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plt.contourf(XX, YY, ZZ, <span class="number">20</span>, cmap=plt.cm.hot) <span class="comment"># 20 表示 20 个 levels</span></span><br><span class="line">cbar = plt.colorbar()</span><br></pre></td></tr></table></figure><p>还有一种更简便的方法：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.tricontourf(X, Y, Z, <span class="number">20</span>, cmap=plt.cm.hot, extend=<span class="string">'both'</span>)</span><br></pre></td></tr></table></figure><p>越界时指定颜色，其中，<code>extend : {'neither', 'both', 'min', 'max'}</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">levels=np.arange(<span class="number">-10</span>,<span class="number">4200000</span>,<span class="number">1000</span>)</span><br><span class="line">cp=plt.contourf(XX, YY, ZZ, levels=levels, cmap=plt.cm.hot, extend=<span class="string">'both'</span>)</span><br><span class="line">cp.cmap.set_under(<span class="string">'yellow'</span>)</span><br><span class="line">cp.cmap.set_over(<span class="string">'cyan'</span>) <span class="comment">#注意顺序，此行须在 plt.colorbar 之前</span></span><br><span class="line">cbar = plt.colorbar(cp)</span><br><span class="line">cbar.ax.set_title(<span class="string">'T'</span>)</span><br></pre></td></tr></table></figure><p>小于某个数时颜色全部为空白：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">levels=np.arange(<span class="number">0.0015</span>,<span class="number">0.7515</span>,<span class="number">0.0015</span>)</span><br><span class="line">plt.contourf(XX, YY, ZZ,levels=levels)<span class="comment">#这里不能使用extend，如果使用的话，那么小于下限时，颜色直接是 min 的颜色。</span></span><br></pre></td></tr></table></figure><p>设置图中的数值上下限：</p><p>设置colorbar中的上下限：</p><h2 id="等值线"><a class="markdownIt-Anchor" href="#等值线"></a> 等值线</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.contourf(XX, YY, ZZ, <span class="number">20</span>, cmap=plt.cm.hot) <span class="comment">#这是云图，20 表示分为 20 道等值线</span></span><br><span class="line">plt.contour(XX, YY, ZZ, <span class="number">1</span>, levels=[<span class="number">1000</span>], linewidths=<span class="number">2</span>, colors=<span class="string">'y'</span>) <span class="comment">#这是等值线，1表示一条等值线，levels里边是这个值</span></span><br></pre></td></tr></table></figure><h1 id="配件"><a class="markdownIt-Anchor" href="#配件"></a> 配件</h1><h2 id="图片颜色"><a class="markdownIt-Anchor" href="#图片颜色"></a> 图片颜色</h2><h3 id="自带"><a class="markdownIt-Anchor" href="#自带"></a> <a href="https://matplotlib.org/examples/color/colormaps_reference.html" target="_blank" rel="external nofollow noopener noreferrer">自带</a> 调色</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">colorMap = plt.cm.get_cmap(<span class="string">'winter'</span>)</span><br><span class="line">colorMap=plt.get_cmap(<span class="string">"YlOrRd"</span>)</span><br><span class="line">colorMap=pyplot.cm.jet</span><br></pre></td></tr></table></figure><h3 id="palettable"><a class="markdownIt-Anchor" href="#palettable"></a> <a href="https://jiffyclub.github.io/palettable" target="_blank" rel="external nofollow noopener noreferrer">palettable</a> 调色</h3><p>源码：<a href="https://github.com/jiffyclub/palettable" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/jiffyclub/palettable</a></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> palettable.mycarta <span class="keyword">import</span> Cube1_20</span><br><span class="line"><span class="keyword">from</span> palettable.colorbrewer.sequential <span class="keyword">import</span> Greys_9</span><br><span class="line">colorMap=Cube1_20.mpl_colormap</span><br><span class="line">colorMap=Greys_9.mpl_colormap</span><br></pre></td></tr></table></figure><h3 id="colorcet"><a class="markdownIt-Anchor" href="#colorcet"></a> <a href="http://colorcet.pyviz.org" target="_blank" rel="external nofollow noopener noreferrer">colorcet</a> 调色</h3><p>源码：<a href="https://github.com/pyviz/colorcet" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/pyviz/colorcet</a></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> colorcet <span class="keyword">as</span> cc</span><br><span class="line">colorMap=cc.cm[<span class="string">"blues"</span>]</span><br><span class="line">colorMap=cc.cm[<span class="string">"fire"</span>]</span><br></pre></td></tr></table></figure><h3 id="cmasher"><a class="markdownIt-Anchor" href="#cmasher"></a> <a href="https://github.com/1313e/CMasher" target="_blank" rel="external nofollow noopener noreferrer">CMasher</a> 调色</h3><h3 id="反转颜色"><a class="markdownIt-Anchor" href="#反转颜色"></a> 反转颜色</h3><p>自带的反转就是在后边加一个 <code>_r</code>，比如：<code>colorMap=plt.cm.hot_r</code>。</p><p>反转非自带的颜色：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reverse_colourmap</span><span class="params">(cmap, name = <span class="string">'my_cmap_r'</span>)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    In:</span></span><br><span class="line"><span class="string">    cmap, name</span></span><br><span class="line"><span class="string">    Out:</span></span><br><span class="line"><span class="string">    my_cmap_r</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Explanation:</span></span><br><span class="line"><span class="string">    t[0] goes from 0 to 1</span></span><br><span class="line"><span class="string">    row i:   x  y0  y1 -&gt; t[0] t[1] t[2]</span></span><br><span class="line"><span class="string">                   /</span></span><br><span class="line"><span class="string">                  /</span></span><br><span class="line"><span class="string">    row i+1: x  y0  y1 -&gt; t[n] t[1] t[2]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    so the inverse should do the same:</span></span><br><span class="line"><span class="string">    row i+1: x  y1  y0 -&gt; 1-t[0] t[2] t[1]</span></span><br><span class="line"><span class="string">                   /</span></span><br><span class="line"><span class="string">                  /</span></span><br><span class="line"><span class="string">    row i:   x  y1  y0 -&gt; 1-t[n] t[2] t[1]</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    reverse = []</span><br><span class="line">    k = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> cmap._segmentdata:</span><br><span class="line">        k.append(key)</span><br><span class="line">        channel = cmap._segmentdata[key]</span><br><span class="line">        data = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> channel:</span><br><span class="line">            data.append((<span class="number">1</span>-t[<span class="number">0</span>],t[<span class="number">2</span>],t[<span class="number">1</span>]))</span><br><span class="line">        reverse.append(sorted(data))</span><br><span class="line"></span><br><span class="line">    LinearL = dict(zip(k,reverse))</span><br><span class="line">    my_cmap_r = mpl.colors.LinearSegmentedColormap(name, LinearL)</span><br><span class="line">    <span class="keyword">return</span> my_cmap_r</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cmap=cc.cm[<span class="string">"fire"</span>]</span><br><span class="line">cmap_r = reverse_colourmap(cmap)</span><br></pre></td></tr></table></figure><h2 id="colorbar"><a class="markdownIt-Anchor" href="#colorbar"></a> colorbar</h2><h3 id="官方-api"><a class="markdownIt-Anchor" href="#官方-api"></a> 官方 API</h3><p><a href="https://matplotlib.org/api/colorbar_api.html" target="_blank" rel="external nofollow noopener noreferrer">API</a><br><a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.colorbar.html" target="_blank" rel="external nofollow noopener noreferrer">API2</a></p><h3 id="简单使用"><a class="markdownIt-Anchor" href="#简单使用"></a> 简单使用</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sc = plt.scatter(X, Y, c=Z, s=<span class="number">1</span>, cmap=pyplot.cm.jet)</span><br><span class="line">plt.colorbar(sc)</span><br></pre></td></tr></table></figure><h3 id="位置"><a class="markdownIt-Anchor" href="#位置"></a> 位置</h3><p>偏移使用 pad，尺寸缩小使用 shrink</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.colorbar(sc, pad = <span class="number">0.07</span>, shrink=<span class="number">0.8</span>)</span><br></pre></td></tr></table></figure><h3 id="坐标控制的位置"><a class="markdownIt-Anchor" href="#坐标控制的位置"></a> 坐标控制的位置</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cbar_ax = fig.add_axes([<span class="number">0.19</span>, <span class="number">0.06</span>, <span class="number">0.7</span>, <span class="number">0.015</span>]) <span class="comment">#left,bottom,left_length,bottom_length</span></span><br><span class="line">cbar=plt.colorbar(sc, cax=cbar_ax, orientation=<span class="string">'horizontal'</span>)</span><br></pre></td></tr></table></figure><h3 id="set_ticks"><a class="markdownIt-Anchor" href="#set_ticks"></a> set_ticks</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cbar_ticks = np.linspace(<span class="number">0.</span>, <span class="number">5e-3</span>, num=<span class="number">3</span>, endpoint=<span class="literal">True</span>)</span><br><span class="line">cbar.set_ticks(cbar_ticks)</span><br></pre></td></tr></table></figure><h3 id="怎么才能在坐标上显示-max-min"><a class="markdownIt-Anchor" href="#怎么才能在坐标上显示-max-min"></a> 怎么才能在坐标上显示 max min？</h3><h3 id="科学计数法"><a class="markdownIt-Anchor" href="#科学计数法"></a> 科学计数法</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cbar.formatter.set_powerlimits((<span class="number">-1</span>, <span class="number">1</span>))</span><br><span class="line">cbar.update_ticks()</span><br></pre></td></tr></table></figure><p>这样小于 10^(-1)，或者大于 10^(1) 的值就会用科学计数法。</p><h3 id="ticks-朝向"><a class="markdownIt-Anchor" href="#ticks-朝向"></a> ticks 朝向</h3><p>如果 colorbar 竖直，ticks 默认是朝右的，如果 colorbar 水平，ticks 默认朝下的。</p><p>可以这样更改：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cbar.ax.xaxis.set_ticks_position(<span class="string">'top'</span>)<span class="comment">#colorbar水平，horizontal</span></span><br><span class="line">cbar.ax.yaxis.set_ticks_position(<span class="string">'left'</span>)<span class="comment">#colorbar竖直，vertical</span></span><br></pre></td></tr></table></figure><p>也可以这样：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cbar.ax.yaxis.tick_left()</span><br></pre></td></tr></table></figure><h3 id="添加变量名-set_title"><a class="markdownIt-Anchor" href="#添加变量名-set_title"></a> 添加变量名 set_title</h3><p><a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.set_title.html" target="_blank" rel="external nofollow noopener noreferrer">set_title</a><br><code>set_title</code> 默认在最上方，不管 colorbar 是水平还是竖直。<br>有个参数 pad 表示向上偏移距离，但是 pad 等于负数时无效。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cbar.ax.set_title(<span class="string">'$\Omega\ [-]$'</span>, pad=<span class="number">10</span>)</span><br></pre></td></tr></table></figure><h3 id="添加变量名-set_label"><a class="markdownIt-Anchor" href="#添加变量名-set_label"></a> 添加变量名 set_label</h3><p>推荐使用 <a href="https://stackoverflow.com/questions/17475619/how-do-i-adjust-offset-colorbar-title-in-matplotlib" target="_blank" rel="external nofollow noopener noreferrer">set_label</a></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cbar.set_label(<span class="string">'$\Omega\ [-]$'</span>)</span><br><span class="line">cbar.set_label(<span class="string">r"$\Delta$"</span>+varName, va=<span class="string">'bottom'</span>, ha=<span class="string">'right'</span>, labelpad=<span class="number">10</span>)</span><br></pre></td></tr></table></figure><h3 id="变量名改变位置"><a class="markdownIt-Anchor" href="#变量名改变位置"></a> 变量名改变位置</h3><p>colorbar 是水平的，这里的 bottom 表示变量名放在水平 colorbar 的下边，labelpad 是向下的偏移距离。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cbar.set_label(<span class="string">'T'</span>,verticalalignment=<span class="string">'bottom'</span>, labelpad=<span class="number">-10</span>)</span><br></pre></td></tr></table></figure><p>Vertical alignment must be one of (‘top’, ‘bottom’, ‘center’, ‘baseline’)<br>Horizontal alignment must be one of (‘center’, ‘right’, ‘left’)</p><p>对于水平 colorbar，<code>horizontalalignment</code> 不管用？</p><h2 id="图例-legend"><a class="markdownIt-Anchor" href="#图例-legend"></a> 图例 legend</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.plot(X, Y, label=<span class="string">"sim"</span>) <span class="comment"># 这里的 label 即图例</span></span><br><span class="line">plt.legend(loc=<span class="string">'upper left'</span>) <span class="comment"># 图例位置</span></span><br><span class="line">plt.legend(loc=<span class="string">'best'</span>) <span class="comment"># 自动选择最合适的位置</span></span><br><span class="line">plt.plot(legend=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><p>上下左右：<code>upper lower left right</code></p><p>在循环里边画很多条线时，只想保留一个 legend，循环结束后：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">from collections import OrderedDict</span><br><span class="line">handles, labels &#x3D; plt.gca().get_legend_handles_labels()</span><br><span class="line">by_label &#x3D; OrderedDict(zip(labels, handles))</span><br><span class="line">plt.legend(by_label.values(), by_label.keys())</span><br></pre></td></tr></table></figure><p>缩放图例中的 marker 大小: markerscale<br>Default is None, which will take the value from rcParams[“legend.markerscale”] = 1.0.</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">plt.legend(loc&#x3D;&#39;upper right&#39;,markerscale&#x3D;3,fancybox&#x3D;True, framealpha&#x3D;0.1)</span><br></pre></td></tr></table></figure><p>缩放图例中的线宽</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">leg &#x3D; ax.legend()</span><br><span class="line"></span><br><span class="line">for line in leg.get_lines():</span><br><span class="line">    line.set_linewidth(4.0)</span><br></pre></td></tr></table></figure><p>关于位置的高级用法：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ax1.legend(loc=<span class="string">'upper right'</span>, bbox_to_anchor=(<span class="number">1.05</span>, <span class="number">4.3</span>), ncol=<span class="number">3</span>, fontsize=<span class="number">10</span>)</span><br></pre></td></tr></table></figure><p><code>bbox_to_anchor</code> 表示 right 和 upper 的位置。<br>upper right 和 loc 里的一致，不过顺序颠倒了，这里表示图例的 right 位于主图的 1.05，图例的 upper 位于主图的 4.3。<br>这个位置是0-1，超过1表示坐标轴以外。<br><code>ncol=3</code> 表示三栏</p><p>保存为图片后，如果图例超出了整个图片的范围，则可以这样操作：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">lgd =plt.legend(loc=<span class="string">'center left'</span>, bbox_to_anchor=(<span class="number">1</span>, <span class="number">0.5</span>))</span><br><span class="line">plt.savefig(<span class="string">"fig.png"</span>, bbox_extra_artists=(lgd,), bbox_inches=<span class="string">'tight'</span>)</span><br></pre></td></tr></table></figure><p>如果图例分了多列，<code>columnspacing=2.0</code> 控制列之间的间隔。<br><code>handletextpad=0.8</code> 可以控制 marker 和 label 之间的间隔。<br><a href="https://stackoverflow.com/questions/4700614/how-to-put-the-legend-out-of-the-plot" target="_blank" rel="external nofollow noopener noreferrer">参考资料</a><br><img src="https://i.stack.imgur.com/OIMyM.png" alt="参考图片"></p><h2 id="坐标轴"><a class="markdownIt-Anchor" href="#坐标轴"></a> 坐标轴</h2><h3 id="设置坐标轴-label"><a class="markdownIt-Anchor" href="#设置坐标轴-label"></a> 设置坐标轴 label</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.xlabel(<span class="string">'r [mm]'</span>,fontsize=<span class="number">12</span>)</span><br></pre></td></tr></table></figure><h3 id="调整坐标轴范围"><a class="markdownIt-Anchor" href="#调整坐标轴范围"></a> 调整坐标轴范围</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.axis([<span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">4</span>])   <span class="comment"># 改变取值范围，[xmin, xmax, ymin, ymax]</span></span><br><span class="line">plt.axis(xmin =<span class="number">0</span>, xmax = <span class="number">0.5</span>, ymin = <span class="number">0</span>, ymax = <span class="number">0.55</span>)</span><br><span class="line">plt.xlim(<span class="number">0</span>,<span class="number">0.35</span>)</span><br><span class="line">plt.ylim(<span class="number">0</span>,<span class="number">0.2</span>)</span><br></pre></td></tr></table></figure><h3 id="自定义刻度"><a class="markdownIt-Anchor" href="#自定义刻度"></a> 自定义刻度</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x_new=np.array([<span class="number">5</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">20</span>])</span><br><span class="line">plt.xticks(x_new)</span><br></pre></td></tr></table></figure><h3 id="刻度朝内"><a class="markdownIt-Anchor" href="#刻度朝内"></a> 刻度朝内</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.tick_params(direction=<span class="string">'in'</span>)</span><br></pre></td></tr></table></figure><h3 id="刻度小数点位数"><a class="markdownIt-Anchor" href="#刻度小数点位数"></a> 刻度小数点位数</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.ticker <span class="keyword">as</span> ticker</span><br><span class="line">plt.gca().xaxis.set_major_formatter(ticker.FormatStrFormatter(<span class="string">'%.6f'</span>))</span><br></pre></td></tr></table></figure><h3 id="隐藏坐标"><a class="markdownIt-Anchor" href="#隐藏坐标"></a> 隐藏坐标</h3><p>在包含几个子图的图标中，可能需要隐藏一些重复的坐标</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ax1 = plt.subplot(<span class="number">420</span>+i)</span><br><span class="line">plt.setp(ax1.get_xticklabels(), visible=<span class="literal">False</span>)</span><br><span class="line">plt.setp(ax1.get_yticklabels(), visible=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><h3 id="隐藏-ticks-和-label"><a class="markdownIt-Anchor" href="#隐藏-ticks-和-label"></a> 隐藏 ticks 和 label</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ax1.set_xticks([])</span><br></pre></td></tr></table></figure><h3 id="隐藏子刻度"><a class="markdownIt-Anchor" href="#隐藏子刻度"></a> 隐藏子刻度</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.minorticks_off()</span><br></pre></td></tr></table></figure><h3 id="科学计数"><a class="markdownIt-Anchor" href="#科学计数"></a> 科学计数</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.ticklabel_format(axis=<span class="string">"x"</span>, style=<span class="string">"sci"</span>, scilimits=(<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">ax.ticklabel_format(axis=<span class="string">"x"</span>, style=<span class="string">"sci"</span>, scilimits=(<span class="number">0</span>,<span class="number">0</span>))</span><br></pre></td></tr></table></figure><h2 id="x-y-坐标等比例"><a class="markdownIt-Anchor" href="#x-y-坐标等比例"></a> x y 坐标等比例</h2><p>这个用于CFD模拟场的云图，保证 x y 长度是等比例的。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ax=plt.gca()</span><br><span class="line">ax.set_aspect(<span class="number">1.0</span>) <span class="comment"># set uniform length of axis</span></span><br></pre></td></tr></table></figure><h2 id="使用-latex-公式"><a class="markdownIt-Anchor" href="#使用-latex-公式"></a> 使用 LaTeX 公式</h2><p>用 <code>$</code> 包围起来并在前边加上 <code>r</code> 即可，最好 <code>$</code> 和公式之间留一个空格。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.xlabel(<span class="string">r'Scalar dissipation rate $ [s^&#123;-1&#125;] $'</span>,fontsize=<span class="number">12</span>)</span><br></pre></td></tr></table></figure><h2 id="任意位置添加文字"><a class="markdownIt-Anchor" href="#任意位置添加文字"></a> 任意位置添加文字</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.text(<span class="number">1</span>, <span class="number">17</span>, <span class="string">r"z=%s mm"</span>%(str(Z)))</span><br></pre></td></tr></table></figure><h2 id="子图-subplot"><a class="markdownIt-Anchor" href="#子图-subplot"></a> 子图 subplot</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.subplots_adjust(left=<span class="number">0.11</span>,bottom=<span class="number">0.1</span>,top=<span class="number">0.97</span>,right=<span class="number">0.9</span>,hspace=<span class="number">0.000001</span>,wspace=<span class="number">0.000001</span>)</span><br><span class="line"></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> Z <span class="keyword">in</span> [<span class="string">'2'</span>,<span class="string">'10'</span>,<span class="string">'30'</span>,<span class="string">'50'</span>]:</span><br><span class="line">    i=i+<span class="number">1</span></span><br><span class="line">    ax1 = plt.subplot(<span class="number">410</span>+i)</span><br><span class="line">    plt.plot(R_Mean,U_Mean,linestyle=<span class="string">'--'</span>,marker=<span class="string">'o'</span>, color=<span class="string">'r'</span>,label=<span class="string">"sim"</span>)</span><br></pre></td></tr></table></figure><p><code>subplot(410+i)</code> 表示子图 4x1 排列，即 4 行 1 列。此处的循环，令 <code>i</code> 分分别等于 1 2 3 4。</p><p>也可以用<code>subplot(4,1,i)</code>表示。</p><p>绘制着色的多个子图（云图或者上色=的散点图）需要注意他们的数据 min max可能不同。<br>可以设置 vmin vmax是他们保持一致：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">plt.scatter(x1, y1, c&#x3D;z1, s&#x3D;2, marker&#x3D;&#39;o&#39;, vmin&#x3D;minZ, vmax&#x3D;maxZ)</span><br><span class="line">plt.scatter(x2, y2, c&#x3D;z2, s&#x3D;2, marker&#x3D;&#39;s&#39;, vmin&#x3D;minZ, vmax&#x3D;maxZ)</span><br></pre></td></tr></table></figure><h2 id="图片标题"><a class="markdownIt-Anchor" href="#图片标题"></a> 图片标题</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.title(<span class="string">'source_Yc'</span>,fontsize=<span class="number">12</span>)</span><br></pre></td></tr></table></figure><h2 id="alpha-表示不透明度1表示完全不透明"><a class="markdownIt-Anchor" href="#alpha-表示不透明度1表示完全不透明"></a> alpha 表示不透明度，1表示完全不透明</h2><p>可以用于 plot scatter contour contourf 中。</p><h1 id="输出图片"><a class="markdownIt-Anchor" href="#输出图片"></a> 输出图片</h1><h2 id="紧凑布局"><a class="markdownIt-Anchor" href="#紧凑布局"></a> 紧凑布局</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.savefig(<span class="string">"abc.png"</span>, dpi=<span class="number">500</span>, bbox_inches=<span class="string">'tight'</span>, pad_inches=<span class="number">0.01</span>)</span><br><span class="line">plt.savefig(<span class="string">"abc.pdf"</span>, bbox_inches=<span class="string">'tight'</span>, pad_inches=<span class="number">0.01</span>)</span><br><span class="line">plt.close()</span><br><span class="line"></span><br><span class="line">fig = plt.figure()</span><br><span class="line">fig.savefig(<span class="string">"abc.png"</span>, dpi=<span class="number">500</span>, bbox_inches=<span class="string">'tight'</span>, pad_inches=<span class="number">0.01</span>)</span><br><span class="line">fig.savefig(<span class="string">"abc.pdf"</span>, bbox_inches=<span class="string">'tight'</span>, pad_inches=<span class="number">0.01</span>)</span><br><span class="line">fig.close()</span><br></pre></td></tr></table></figure><h1 id="python-相关"><a class="markdownIt-Anchor" href="#python-相关"></a> python 相关</h1><h2 id="利用正则表达式获取当前目录下的某些文件"><a class="markdownIt-Anchor" href="#利用正则表达式获取当前目录下的某些文件"></a> 利用正则表达式获取当前目录下的某些文件</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> glob</span><br><span class="line">files = glob.iglob(<span class="string">r'0.*'</span>)</span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">    <span class="keyword">print</span> file</span><br></pre></td></tr></table></figure><p>普通版本：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">files = [<span class="string">'0.1'</span>, <span class="string">'0.2'</span>]</span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">    <span class="keyword">print</span> file</span><br></pre></td></tr></table></figure><h2 id="换行"><a class="markdownIt-Anchor" href="#换行"></a> 换行</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ylabel(<span class="string">'this is vertical\ntest'</span>, multialignment=<span class="string">'center'</span>)<span class="comment">#\n表示换行</span></span><br></pre></td></tr></table></figure><h2 id="灰色系列填充彩图"><a class="markdownIt-Anchor" href="#灰色系列填充彩图"></a> 灰色系列填充彩图</h2><h2 id="在图中使用其它字体"><a class="markdownIt-Anchor" href="#在图中使用其它字体"></a> 在图中使用其它字体</h2><p><a href="https://stackoverflow.com/a/53645383" target="_blank" rel="external nofollow noopener noreferrer">https://stackoverflow.com/a/53645383</a><br>我成功操作的经历：</p><blockquote><p>把字体拷贝到：<br>/public/home/yao1/packages_ZY/anaconda_ZY/anaconda3/lib/python3.6/site-packages/matplotlib/mpl-data/fonts/ttf<br>然后：<br>rm -rf ~/.cache/matplotlib/</p></blockquote><p>使用字体：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> rcParams</span><br><span class="line">rcParams.update(&#123;<span class="string">'font.size'</span>: <span class="number">12</span>, <span class="string">'font.family'</span>: <span class="string">'Times New Roman'</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> rcParams</span><br><span class="line">rcParams.update(&#123;<span class="string">'font.size'</span>: <span class="number">12</span>, <span class="string">'font.family'</span>: <span class="string">'simsun'</span>&#125;)</span><br><span class="line"></span><br><span class="line">ax1.legend(loc=<span class="string">'upper right'</span>, bbox_to_anchor=(<span class="number">0.92</span>, <span class="number">3.7</span>), ncol=<span class="number">3</span>,fontsize=<span class="number">10</span>,prop=&#123;<span class="string">'family'</span>:<span class="string">'simsun'</span>&#125;)</span><br><span class="line"></span><br><span class="line">plt.text(<span class="number">1.03</span>,<span class="number">5.4</span>,<span class="string">'平均值'</span>,fontname=<span class="string">'simsun'</span>)</span><br></pre></td></tr></table></figure><h1 id="疑难解答"><a class="markdownIt-Anchor" href="#疑难解答"></a> 疑难解答</h1><h2 id="服务器绘图"><a class="markdownIt-Anchor" href="#服务器绘图"></a> 服务器绘图</h2><p>报错 <code>QXcbConnection: Could not connect to display</code></p><p>solution：<br>在脚本的<strong>最前边</strong>加上</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib</span><br><span class="line">matplotlib.use(<span class="string">'Agg'</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM 官方代码发布通知栏</title>
      <link href="/release/"/>
      <url>/release/</url>
      
        <content type="html"><![CDATA[<a id="more"></a><ul><li>17/02/2014, <a href="https://openfoam.org/release/2-3-0" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 2.3.0</a></li><li>10/12/2014, <a href="https://openfoam.org/release/2-3-1" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 2.3.1</a></li><li>22/05/2015, <a href="https://openfoam.org/release/2-4-0" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 2.4.0</a></li><li>03/11/2015, <a href="https://openfoam.org/release/3-0-0" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 3.0.0</a></li><li>15/12/2015, <a href="https://openfoam.org/release/3-0-1" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 3.0.1</a></li><li>28/06/2016, <a href="https://openfoam.org/release/4-0" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 4.0</a></li><li>13/10/2016, <a href="https://openfoam.org/release/4-1" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 4.1</a></li><li>26/07/2017, <a href="https://openfoam.org/release/5-0" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 5.0</a></li><li>10/07/2018, <a href="https://openfoam.org/release/6" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 6</a></li><li>27/06/2019, <a href="https://www.openfoam.com/releases/openfoam-v1906" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM® v1906</a></li><li>08/07/2019, <a href="https://openfoam.org/release/7" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 7</a></li><li>02/11/2019, <a href="https://sourceforge.net/projects/foam-extend/files/foam-extend-4.1" target="_blank" rel="external nofollow noopener noreferrer">foam-extend 4.1</a></li><li>23/12/2019, <a href="https://www.openfoam.com/releases/openfoam-v1912" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM® v1912</a></li><li>30/06/2006, <a href="https://openfoam.com/releases/openfoam-v2006" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM® v2006</a></li><li>22/07/2020, <a href="https://openfoam.org/release/8" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 8</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> release </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>自适应输出间隔</title>
      <link href="/adjustableWrite/"/>
      <url>/adjustableWrite/</url>
      
        <content type="html"><![CDATA[<p>自适应输出间隔</p><a id="more"></a><p>controlDict 中加入如下代码：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    fileUpdate1</span><br><span class="line">    &#123;</span><br><span class="line">        type              timeActivatedFileUpdate;</span><br><span class="line">        libs              (&quot;libutilityFunctionObjects.so&quot;);</span><br><span class="line">        writeControl      timeStep;</span><br><span class="line">        writeInterval     1;</span><br><span class="line">        fileToUpdate      &quot;$FOAM_CASE&#x2F;system&#x2F;controlDict&quot;;</span><br><span class="line">        timeVsFile</span><br><span class="line">        (</span><br><span class="line">            (0.2 &quot;$FOAM_CASE&#x2F;system&#x2F;controlDict1&quot;)</span><br><span class="line">            (0.4 &quot;$FOAM_CASE&#x2F;system&#x2F;controlDict2&quot;)</span><br><span class="line">            (0.6 &quot;$FOAM_CASE&#x2F;system&#x2F;controlDict3&quot;)</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后复制几份 controlDict</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cp system&#x2F;controlDict system&#x2F;controlDict1</span><br><span class="line">cp system&#x2F;controlDict system&#x2F;controlDict2</span><br><span class="line">cp system&#x2F;controlDict system&#x2F;controlDict3</span><br></pre></td></tr></table></figure><p>从 0.2 开始，用的是 controlDict1 里的设置。<br>从 0.4 开始，用的是 controlDict2 里的设置。<br>从 0.6 开始，用的是 controlDict3 里的设置。<br>我们可以在这三个 controlDict 里设置不同的输出时间间隔。<br>这样就能随意操控输出间隔了。<br>当然了，还可以控制其它参数，请自行探索。<br>timeActivatedFileUpdate 这个功能还可以用于其他文件，请自行探索。</p><p>OpenFOAM 自带的 timeActivatedFileUpdate 不支持发动机算例。<br>因为在算例里边，发动机里边的 Time 是按照曲轴转角来计算的。<br>但是在代码中仍然是按照秒来计算的。<br>我修改了一下官方代码，现在已支持发动机算例！<br><a href="https://github.com/ZhangYanTJU/functionObjects" target="_blank" rel="external nofollow noopener noreferrer">代码地址</a></p>]]></content>
      
      
      <categories>
          
          <category> using </category>
          
      </categories>
      
      
        <tags>
            
            <tag> functionObject </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM Learning Resources</title>
      <link href="/studyMaterials/"/>
      <url>/studyMaterials/</url>
      
        <content type="html"><![CDATA[<p>I think this is the most comprehensive learning resources about OpenFOAM.</p><a id="more"></a><h1 id="official-websites"><a class="markdownIt-Anchor" href="#official-websites"></a> Official websites</h1><ol><li><a href="https://openfoam.org/" target="_blank" rel="external nofollow noopener noreferrer">https://openfoam.org/</a></li><li><a href="https://github.com/OpenFOAM/OpenFOAM-dev" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/OpenFOAM/OpenFOAM-dev</a></li><li><a href="https://www.openfoam.com/" target="_blank" rel="external nofollow noopener noreferrer">https://www.openfoam.com/</a></li><li><a href="https://develop.openfoam.com/Development/OpenFOAM-plus/" target="_blank" rel="external nofollow noopener noreferrer">https://develop.openfoam.com/Development/OpenFOAM-plus/</a></li><li><a href="https://sourceforge.net/projects/openfoamplus" target="_blank" rel="external nofollow noopener noreferrer">https://sourceforge.net/projects/openfoamplus</a></li><li><a href="https://sourceforge.net/projects/foam-extend/" target="_blank" rel="external nofollow noopener noreferrer">https://sourceforge.net/projects/foam-extend/</a></li><li><a href="http://openfoamworkshop.org/" target="_blank" rel="external nofollow noopener noreferrer">http://openfoamworkshop.org/</a></li></ol><h1 id="installation"><a class="markdownIt-Anchor" href="#installation"></a> Installation</h1><ol><li><a href="https://openfoam.org/download/" target="_blank" rel="external nofollow noopener noreferrer">online installation</a></li><li><a href="http://openfoamwiki.net/index.php/Installation" target="_blank" rel="external nofollow noopener noreferrer">compilation</a></li><li><a href="https://bitbucket.org/bgschaid/ansiblefoaminstallation" target="_blank" rel="external nofollow noopener noreferrer">ansibleFoamInstallation</a></li></ol><h1 id="best-of-the-best"><a class="markdownIt-Anchor" href="#best-of-the-best"></a> Best of the Best</h1><ol><li><a href="https://cfd.direct/openfoam/user-guide/" target="_blank" rel="external nofollow noopener noreferrer">User Guide</a></li><li><a href="https://www.cfd-online.com/Forums/openfoam/146697-getting-started-openfoam.html" target="_blank" rel="external nofollow noopener noreferrer">Getting Started with OpenFOAM-wyldckat</a></li><li><a href="http://www.wolfdynamics.com/our-services/training/openfoam-intro-training.html?id=50" target="_blank" rel="external nofollow noopener noreferrer">University of Genoa</a></li><li><a href="https://wiki.openfoam.com/" target="_blank" rel="external nofollow noopener noreferrer">wikiOpenFOAM</a> <a href="https://wiki.openfoam.com/%223_weeks%22_series" target="_blank" rel="external nofollow noopener noreferrer">“3 weeks” series</a></li><li><a href="https://github.com/ParticulateFlow/OSCCAR-doc" target="_blank" rel="external nofollow noopener noreferrer">A little User-Manual</a></li><li><a href="http://www.tfd.chalmers.se/~hani/kurser/OS_CFD/" target="_blank" rel="external nofollow noopener noreferrer">CFD with OpenSource Software-Chalmers</a></li><li><a href="http://openfoamwiki.net/index.php/Main_Page" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAMwiki</a></li><li><a href="https://github.com/psu-efd/PSU-OpenFOAM-Course-Notes" target="_blank" rel="external nofollow noopener noreferrer">PSU-OpenFOAM-Course-Notes</a></li><li><a href="https://github.com/UnnamedMoose/BasicOpenFOAMProgrammingTutorials" target="_blank" rel="external nofollow noopener noreferrer">BasicOpenFOAMProgrammingTutorials</a></li><li><a href="https://www.researchgate.net/project/OpenFOAM-Tutoring" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM-Tutoring</a></li><li><a href="https://www.researchgate.net/project/OpenFOAM-study" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM-study</a></li><li><a href="https://www.cypriensoulaine.com/openfoam" target="_blank" rel="external nofollow noopener noreferrer">Cyprien Soulaine-OPENFOAM® TRAINING</a></li><li><a href="https://eprints.soton.ac.uk/166633/" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM workshop</a></li></ol><h1 id="books"><a class="markdownIt-Anchor" href="#books"></a> Books</h1><ol><li>The finite volume method in computational fluid dynamics : an advanced introduction with OpenFOAM® and Matlab®——<a href="http://download.library1.org/main/1505000/2116544840216f17655dc061da311d9a/%28Fluid%20mechanics%20and%20its%20applications%20volume%20113%29%20Darwish%2C%20M._%20Mangani%2C%20L._%20Moukalled%2C%20F%20-%20The%20finite%20volume%20method%20in%20computational%20fluid%20dynamics%20_%20an%20advanced%20introduction%20with%20OpenFOAM%C2%AE%20and%20Matlab.pdf" target="_blank" rel="external nofollow noopener noreferrer">download</a></li><li>Mathematics, Numerics, Derivations and OpenFOAM®——<a href="https://www.researchgate.net/publication/307546712_Mathematics_Numerics_Derivations_and_OpenFOAMR" target="_blank" rel="external nofollow noopener noreferrer">download</a></li><li>The OpenFOAM Technology Primer——<a href="http://sourceflux.de/book/" target="_blank" rel="external nofollow noopener noreferrer">download</a></li><li>Getting Started with OpenFOAM® Technology: RAW——<a href="https://kupdf.net/download/getting-started-with-openfoam-reg-technology-raw-ebook_58ff2a83dc0d60ba43959ea9_pdf" target="_blank" rel="external nofollow noopener noreferrer">download</a></li><li>Jasak Phd thesis ——<a href="https://foam-extend.fsb.hr/wp-content/uploads/2016/12/Jasak_PhD_1996.pdf" target="_blank" rel="external nofollow noopener noreferrer">download</a></li><li>Algorithm on Solvers and Models in OpenFOAM——<a href="https://wenku.baidu.com/view/7b2fc1db8bd63186bdebbc0c" target="_blank" rel="external nofollow noopener noreferrer">download</a></li></ol><h1 id="blogs"><a class="markdownIt-Anchor" href="#blogs"></a> Blogs</h1><ol><li><a href="http://blog.sina.com.cn/s/articlelist_1608493030_0_1.html" target="_blank" rel="external nofollow noopener noreferrer">苏军伟</a></li><li><a href="../sources/OFblog_su.pdf">苏军伟博文集</a></li><li><a href="https://foam-extend.fsb.hr/openfoam/tutorials/" target="_blank" rel="external nofollow noopener noreferrer">Jasak</a></li><li><a href="http://cfdyna.com/Home/OpenFOAM.html" target="_blank" rel="external nofollow noopener noreferrer">cfdyna</a></li><li><a href="http://dyfluid.com" target="_blank" rel="external nofollow noopener noreferrer">东岳流体</a></li><li><a href="http://blog.sina.com.cn/s/blog_97cadb820102vxyk.html" target="_blank" rel="external nofollow noopener noreferrer">WayneWangY</a></li><li><a href="http://xiaopingqiu.github.io/categories/OpenFOAM/" target="_blank" rel="external nofollow noopener noreferrer">Giskard’s CFD Learning Tricks</a></li><li><a href="https://holzmann-cfd.de/" target="_blank" rel="external nofollow noopener noreferrer">Tobias Holzmann</a></li><li><a href="http://sourceflux.de/blog/" target="_blank" rel="external nofollow noopener noreferrer">sourceflux</a></li><li><a href="http://caefn.com" target="_blank" rel="external nofollow noopener noreferrer">Fumiya</a></li><li><a href="https://www.slideshare.net/fumiyanozaki96/presentations" target="_blank" rel="external nofollow noopener noreferrer">Fumiya Slides</a></li><li><a href="https://marinecfd.xyz" target="_blank" rel="external nofollow noopener noreferrer">Zhaoweiwen</a></li><li><a href="http://blog.sina.com.cn/s/articlelist_5593422497_10_1.html" target="_blank" rel="external nofollow noopener noreferrer">Cu2SO4</a></li><li><a href="http://penguinitis.g1.xrea.com/" target="_blank" rel="external nofollow noopener noreferrer">penguinitis</a></li><li><a href="https://jibranhaider.weebly.com/" target="_blank" rel="external nofollow noopener noreferrer">Jibran</a></li><li><a href="http://www.cfdnotes.com/" target="_blank" rel="external nofollow noopener noreferrer">Hiroaki</a></li><li><a href="http://blog.pfan.cn/bioexplore" target="_blank" rel="external nofollow noopener noreferrer">CFD——OpenFOAM</a></li><li><a href="https://www.cfdsupport.com/OpenFOAM-Training-by-CFD-Support/" target="_blank" rel="external nofollow noopener noreferrer">CFD SUPPORT</a></li><li><a href="https://snow-stone.github.io/" target="_blank" rel="external nofollow noopener noreferrer">snow-stone</a></li><li><a href="http://pavanakumar.github.io/compressibleFoam/index.html" target="_blank" rel="external nofollow noopener noreferrer">compressibleFoam</a></li><li><a href="http://cfd.at/tutorials" target="_blank" rel="external nofollow noopener noreferrer">TU Wien</a></li><li><a href="https://chengdi123000.github.io" target="_blank" rel="external nofollow noopener noreferrer">chengdi</a></li><li><a href="http://www.probabilisticmoney.com/?page_id=84" target="_blank" rel="external nofollow noopener noreferrer">probabilisticmoney</a></li><li><a href="https://zhulianhua.github.io" target="_blank" rel="external nofollow noopener noreferrer">zhulianhua</a></li><li><a href="https://www.thefoamhouse.es/" target="_blank" rel="external nofollow noopener noreferrer">thefoamhouse</a></li><li><a href="http://maoyanjun.top/" target="_blank" rel="external nofollow noopener noreferrer">Mao Yanjun</a></li><li><a href="https://albertopassalacqua.com/" target="_blank" rel="external nofollow noopener noreferrer">Alberto</a></li><li><a href="https://openfoam.tech/" target="_blank" rel="external nofollow noopener noreferrer">openfoam.tech</a></li><li><a href="http://hassankassem.me/posts/" target="_blank" rel="external nofollow noopener noreferrer">Hassan</a></li><li><a href="https://ddai.me/" target="_blank" rel="external nofollow noopener noreferrer">Dezhi Dai</a></li><li><a href="https://foamscience.github.io/" target="_blank" rel="external nofollow noopener noreferrer">foamscience</a></li><li><a href="https://petebachant.me/posts/" target="_blank" rel="external nofollow noopener noreferrer">petebachant</a></li><li><a href="http://olesenm.github.io/" target="_blank" rel="external nofollow noopener noreferrer">Mark Olesen</a></li><li><a href="https://blog.csdn.net/xxyhjy" target="_blank" rel="external nofollow noopener noreferrer">xxyhjy</a></li><li><a href="http://blog.sina.com.cn/s/articlelist_1395915742_2_1.html" target="_blank" rel="external nofollow noopener noreferrer">Jay_见贤思齐</a></li><li><a href="http://blog.sina.com.cn/s/articlelist_1784149880_1_1.html" target="_blank" rel="external nofollow noopener noreferrer">蝇王</a></li><li><a href="https://chengpengzhao.com/categories/%E5%B7%A5%E4%BD%9C/OpenFOAM/" target="_blank" rel="external nofollow noopener noreferrer">Zcp</a></li><li><a href="http://myheutagogy.com/" target="_blank" rel="external nofollow noopener noreferrer">Andre Weiner</a></li><li><a href="http://www.probabilisticmoney.com/?page_id=84" target="_blank" rel="external nofollow noopener noreferrer">ProbabilisticMoney</a></li></ol><h1 id="youtube"><a class="markdownIt-Anchor" href="#youtube"></a> YouTube</h1><ol><li><a href="https://www.youtube.com/playlist?list=PLqxhJj6bcnY9RoIgzeF6xDh5L9bbeK3BL" target="_blank" rel="external nofollow noopener noreferrer">Jasak</a></li><li><a href="https://www.youtube.com/channel/UCqCLabkRddpbHj4wYNFYjAA" target="_blank" rel="external nofollow noopener noreferrer">Kenneth Hoste</a></li><li><a href="https://www.youtube.com/user/fifaman114" target="_blank" rel="external nofollow noopener noreferrer">Theo Ong</a></li></ol><h1 id="forums"><a class="markdownIt-Anchor" href="#forums"></a> Forums</h1><ol><li><a href="https://www.cfd-online.com/Forums/openfoam/" target="_blank" rel="external nofollow noopener noreferrer">cfd-online</a></li><li><a href="http://www.cfd-china.com/" target="_blank" rel="external nofollow noopener noreferrer">cfd-china</a></li></ol><h1 id="others"><a class="markdownIt-Anchor" href="#others"></a> Others</h1><ol><li><a href="https://openfoamwiki.net/index.php/Handy_links" target="_blank" rel="external nofollow noopener noreferrer">openfoamwiki</a></li><li><a href="http://www.sourceflux.de/blog/101-things-read-starting-openfoam/" target="_blank" rel="external nofollow noopener noreferrer">101-things-read-starting-openfoam</a></li><li><a href="http://openfoam-extend.sourceforge.net/OpenFOAM_Workshops/OFW11_2016_Guimaraes/courses.html" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM_Workshops courses</a></li><li><a href="https://sourceforge.net/projects/openfoam-extend/files/OpenFOAM_Workshops/" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM_Workshops courses resources</a></li><li><a href="https://cfd.direct/openfoam/productive-cfd/" target="_blank" rel="external nofollow noopener noreferrer">cfd.direct</a></li><li><a href="https://www.researchgate.net/post/Where_could_I_find_specific_material_to_learn_OpenFOAM" target="_blank" rel="external nofollow noopener noreferrer">researchgate Questions</a></li><li><a href="http://www.cloudpyme.eu/en/training/inclass/" target="_blank" rel="external nofollow noopener noreferrer">cloudpyme</a></li><li><a href="http://homepages.cae.wisc.edu/~hessel/openfoam/Resources/index_OpenFOAMResources.html" target="_blank" rel="external nofollow noopener noreferrer">cae.wisc.edu</a></li><li><a href="https://eprints.soton.ac.uk/200155/" target="_blank" rel="external nofollow noopener noreferrer">Programming session: from the C++ basics to the compilation of user libraries</a></li><li><a href="https://qmplus.qmul.ac.uk/pluginfile.php/624310/mod_resource/content/2/mohamed.pdf" target="_blank" rel="external nofollow noopener noreferrer">Getting started with CFD packages OpenFOAM and FLUENT</a></li></ol><iframe src="https://docs.google.com/spreadsheets/d/17JCGN5AthdLDKMrCLHMzWkcg8Dmn7q19Qc0aHIf7wgE/pubhtml" name="target" width="650" height="600" frameborder="0" scrolling="auto"></iframe><p><a href="https://docs.google.com/spreadsheets/export?format=pdf&amp;id=17JCGN5AthdLDKMrCLHMzWkcg8Dmn7q19Qc0aHIf7wgE" target="_blank" rel="external nofollow noopener noreferrer">download1</a></p><p><a href="../sources/OpenFOAM_google_sheets.pdf">download2</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM 中的字典</title>
      <link href="/dictionary/"/>
      <url>/dictionary/</url>
      
        <content type="html"><![CDATA[<p>OpenFOAM 中的 dictionary 和 IOdictionary</p><a id="more"></a><h1 id="常见用法"><a class="markdownIt-Anchor" href="#常见用法"></a> 常见用法</h1><h2 id="创建-iodictionary"><a class="markdownIt-Anchor" href="#创建-iodictionary"></a> 创建 IOdictionary</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">IOdictionary transportProperties<span class="comment">//字典的变量名</span></span><br><span class="line">(</span><br><span class="line">    IOobject</span><br><span class="line">    (</span><br><span class="line">        <span class="string">"transportProperties"</span>,<span class="comment">//字典名字</span></span><br><span class="line">        runTime.constant(),   <span class="comment">//字典位于constant下</span></span><br><span class="line">        mesh,</span><br><span class="line">        IOobject::MUST_READ_IF_MODIFIED,</span><br><span class="line">        IOobject::NO_WRITE</span><br><span class="line">    )</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>创建字典并不是创建文件！<br>如果想自定义路径呢？<br>可以把 <code>runTime.constant()</code> 改成 <code>&quot;./Properties&quot;</code>。<br>这样的话，我们就需要在当前算例目录下新建一个文件夹 <code>Properties</code>，文件夹里需要有一个文件 <code>transportProperties</code>。<br>该文件还必须包含文件头（header）：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">FoamFile</span><br><span class="line">&#123;</span><br><span class="line">    version     <span class="number">2.0</span>;</span><br><span class="line">    format      ascii;</span><br><span class="line">    <span class="class"><span class="keyword">class</span>       <span class="title">dictionary</span>;</span></span><br><span class="line">    location    <span class="string">"constant"</span>;</span><br><span class="line">    object      thermophysicalProperties;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>里边的信息可以随意，比如 <code>location</code> 仍然写 <code>constant</code> 也没关系。</p><h2 id="使用已有-iodictionary"><a class="markdownIt-Anchor" href="#使用已有-iodictionary"></a> 使用已有 IOdictionary</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> dictionary&amp; subModelDict = parcels.subModelProperties();<span class="comment">//这里获取已有的字典</span></span><br><span class="line"><span class="built_in">vector</span> <span class="built_in">position</span> = subModelDict.subDict(<span class="string">"injectionModels"</span>).subDict(<span class="string">"model1"</span>).lookup(<span class="string">"position"</span>);</span><br><span class="line"><span class="comment">//subDict 是子字典</span></span><br></pre></td></tr></table></figure><p>这里的 <code>parcels.subModelProperties()</code> 是 <code>SprayCloudProperties</code> 中的 <code>subModels</code>。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">const</span> wordList <span class="title">fuelList</span><span class="params">(thermo.subDict(<span class="string">"liquids"</span>).keys())</span></span>;</span><br></pre></td></tr></table></figure><p>这里的 <code>thermo</code> 是 <code>thermophysicalProperties</code>。</p><h2 id="通过字典读取变量"><a class="markdownIt-Anchor" href="#通过字典读取变量"></a> 通过字典读取变量</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">word</span> <span class="title">fuel</span><span class="params">(dict.lookup(<span class="string">"fuel"</span>))</span></span>;</span><br><span class="line"><span class="function">dimensionedScalar <span class="title">DT</span><span class="params">(dict.lookup(<span class="string">"DT"</span>))</span></span>;</span><br><span class="line"><span class="function">scalarList <span class="title">Z_param</span><span class="params">(dict.lookup(<span class="string">"Z_param"</span>))</span></span>;</span><br><span class="line">scalar Sct = readScalar(dict.lookup(<span class="string">"Sct"</span>));</span><br><span class="line">label int_a=readLabel(dict.lookup(<span class="string">"int_a"</span>));</span><br><span class="line"><span class="function">Switch <span class="title">flagg</span><span class="params">(dict.lookup(<span class="string">"flagg"</span>))</span></span>;</span><br></pre></td></tr></table></figure><p>另外还可以给定默认值，即 <code>lookupOrdefault</code> 函数：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">word</span> <span class="title">fuel2</span><span class="params">(dict.lookupOrDefault(<span class="string">"fuel2"</span>,fuel))</span></span>;</span><br><span class="line"><span class="function">dimensionedScalar <span class="title">DT2</span><span class="params">(dict.lookupOrDefault(<span class="string">"DT2"</span>,DT))</span></span>;</span><br><span class="line"><span class="function">scalarList <span class="title">Z_param2</span><span class="params">(dict.lookupOrDefault(<span class="string">"Z_param2"</span>,Z_param))</span></span>;</span><br><span class="line">scalar Sct2 = dict.lookupOrDefault(<span class="string">"Sct2"</span>, <span class="number">9.</span>);</span><br><span class="line"><span class="function">label <span class="title">int_a2</span><span class="params">(dict.lookupOrDefault(<span class="string">"int_a2"</span>, <span class="number">25</span>))</span></span>;</span><br><span class="line"><span class="function">Switch <span class="title">flagg2</span><span class="params">(dict.lookupOrDefault(<span class="string">"flagg2"</span>,<span class="literal">false</span>))</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//或者：</span></span><br><span class="line"><span class="function"><span class="keyword">word</span> <span class="title">fuel3</span><span class="params">(dict.lookupOrDefault&lt;<span class="keyword">word</span>&gt;(<span class="string">"fuel3"</span>,fuel))</span></span>;</span><br><span class="line"><span class="function">dimensionedScalar <span class="title">DT3</span><span class="params">(dict.lookupOrDefault&lt;dimensionedScalar&gt;(<span class="string">"DT3"</span>,DT))</span></span>;</span><br><span class="line"><span class="function">scalarList <span class="title">Z_param3</span><span class="params">(dict.lookupOrDefault&lt;scalarList&gt;(<span class="string">"Z_param3"</span>,Z_param))</span></span>;</span><br><span class="line">scalar Sct3 = dict.lookupOrDefault&lt;scalar&gt;(<span class="string">"Sct3"</span>, <span class="number">9.</span>);</span><br><span class="line"><span class="function">Switch <span class="title">flagg3</span><span class="params">(dict.lookupOrDefault&lt;Switch&gt;(<span class="string">"flagg3"</span>,<span class="literal">false</span>))</span></span>;</span><br><span class="line"><span class="function">label <span class="title">int_a3</span><span class="params">(dict.lookupOrDefault&lt;label&gt;(<span class="string">"int_a3"</span>, <span class="number">35</span>))</span></span>;</span><br></pre></td></tr></table></figure><p>算例文件：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">fuel ZY<span class="number">.3</span>;<span class="comment">// word 中允许有 点 ？</span></span><br><span class="line">DT DT [<span class="number">0</span> <span class="number">2</span> <span class="number">-1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>] <span class="number">1e-05</span>;</span><br><span class="line"><span class="comment">//Z_param (0 0.2 1);  //OK</span></span><br><span class="line"><span class="comment">//Z_param 3(0 0.2 1); //OK too</span></span><br><span class="line">Z_param <span class="number">101</span>&#123;<span class="number">0</span>&#125;;       <span class="comment">//OK too</span></span><br><span class="line">Sct <span class="number">10.2</span>;</span><br><span class="line">flagg <span class="literal">true</span>; <span class="comment">//expected 'true/false', 'on/off' </span></span><br><span class="line"></span><br><span class="line">Sct2 <span class="number">10.8</span>;</span><br></pre></td></tr></table></figure><p>如果重复给定，那么最后边的那个会起作用。</p><p>给定一个全是 0 的多维数组：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">zeroList</span><br><span class="line"><span class="number">21</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">308</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="number">101</span>&#123;<span class="number">0</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br></pre></td></tr></table></figure><p>看一下这两个函数的代码，发现 <code>lookup</code> 返回的是 <code>ITstream</code>，而 <code>lookupOrDefault</code> 返回的是它的模板类型。<br>疑问：</p><ul><li>为什么需要 <code>readScalar</code> 才能使用 <code>lookup</code> 读取标量？可能是因为 <code>ITstream</code> 无法隐式的转换成 <code>scalar</code>。</li><li>为什么 <code>lookupOrDefault</code> 不给定模板也可以呢？因为它的第二个参数的类型就是模板的类型啊。</li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">ITstream&amp; <span class="title">lookup</span><span class="params">(<span class="keyword">const</span> <span class="keyword">word</span>&amp;,<span class="keyword">bool</span> recursive=<span class="literal">false</span>,<span class="keyword">bool</span> patternMatch=<span class="literal">true</span>)</span> <span class="keyword">const</span></span>;</span><br><span class="line"></span><br><span class="line">Foam::ITstream&amp; Foam::dictionary::lookup</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; keyword,</span><br><span class="line">    <span class="keyword">bool</span> recursive,</span><br><span class="line">    <span class="keyword">bool</span> patternMatch</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> lookupEntry(keyword, recursive, patternMatch).stream();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Foam::entry&amp; Foam::dictionary::lookupEntry</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; keyword,</span><br><span class="line">    <span class="keyword">bool</span> recursive,</span><br><span class="line">    <span class="keyword">bool</span> patternMatch</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> entry* entryPtr = lookupEntryPtr(keyword, recursive, patternMatch);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (entryPtr == <span class="literal">nullptr</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        FatalIOErrorInFunction</span><br><span class="line">        (</span><br><span class="line">            *<span class="keyword">this</span></span><br><span class="line">        )   &lt;&lt; <span class="string">"keyword "</span> &lt;&lt; keyword &lt;&lt; <span class="string">" is undefined in dictionary "</span></span><br><span class="line">            &lt;&lt; name()</span><br><span class="line">            &lt;&lt; <span class="built_in">exit</span>(FatalIOError);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> *entryPtr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;<span class="title">T</span> <span class="title">lookupOrDefault</span>(<span class="title">const</span> <span class="title">word</span>&amp;,<span class="title">const</span> <span class="title">T</span>&amp;,<span class="title">bool</span> <span class="title">recursive</span>=<span class="title">false</span>,<span class="title">bool</span> <span class="title">patternMatch</span>=<span class="title">true</span>) <span class="title">const</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">T</span> <span class="title">Foam</span>:</span>:dictionary::lookupOrDefault</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; keyword,</span><br><span class="line">    <span class="keyword">const</span> T&amp; deflt,</span><br><span class="line">    <span class="keyword">bool</span> recursive,</span><br><span class="line">    <span class="keyword">bool</span> patternMatch</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> entry* entryPtr = lookupEntryPtr(keyword, recursive, patternMatch);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (entryPtr)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> pTraits&lt;T&gt;(entryPtr-&gt;stream());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (writeOptionalEntries)</span><br><span class="line">        &#123;</span><br><span class="line">            IOInfoInFunction(*<span class="keyword">this</span>)</span><br><span class="line">                &lt;&lt; <span class="string">"Optional entry '"</span> &lt;&lt; keyword &lt;&lt; <span class="string">"' is not present,"</span></span><br><span class="line">                &lt;&lt; <span class="string">" returning the default value '"</span> &lt;&lt; deflt &lt;&lt; <span class="string">"'"</span></span><br><span class="line">                &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> deflt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Foam::entry* Foam::dictionary::lookupEntryPtr</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; keyword,</span><br><span class="line">    <span class="keyword">bool</span> recursive,</span><br><span class="line">    <span class="keyword">bool</span> patternMatch</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    HashTable&lt;entry*&gt;::const_iterator iter = hashedEntries_.<span class="built_in">find</span>(keyword);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (iter == hashedEntries_.<span class="built_in">end</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (patternMatch &amp;&amp; patternEntries_.<span class="built_in">size</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            DLList&lt;entry*&gt;::const_iterator wcLink =</span><br><span class="line">                patternEntries_.<span class="built_in">begin</span>();</span><br><span class="line">            DLList&lt;autoPtr&lt;regExp&gt;&gt;::const_iterator reLink =</span><br><span class="line">                patternRegexps_.<span class="built_in">begin</span>();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Find in patterns using regular expressions only</span></span><br><span class="line">            <span class="keyword">if</span> (findInPatterns(patternMatch, keyword, wcLink, reLink))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> wcLink();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (recursive &amp;&amp; &amp;parent_ != &amp;dictionary::null)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> parent_.lookupEntryPtr(keyword, recursive, patternMatch);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> iter();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="无网格创建-iodictionary"><a class="markdownIt-Anchor" href="#无网格创建-iodictionary"></a> 无网格创建 IOdictionary</h2><p>这段代码来自与<a href="https://github.com/ZmengXu" target="_blank" rel="external nofollow noopener noreferrer">Zmeng</a>的私下交流。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt; &quot;Reading thommieDict\n&quot; &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">const fileName caseDirOrig &#x3D; getEnv(&quot;FOAM_CASE&quot;);</span><br><span class="line">const fileName rootDirSource &#x3D; caseDirOrig.path();</span><br><span class="line">const fileName caseDirSource &#x3D; caseDirOrig.name();</span><br><span class="line"></span><br><span class="line">Info&lt;&lt; &quot;Source: &quot; &lt;&lt; rootDirSource &lt;&lt; &quot; &quot; &lt;&lt; caseDirSource &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">Time runTimeSource</span><br><span class="line">(</span><br><span class="line">    Time::controlDictName,</span><br><span class="line">    rootDirSource,</span><br><span class="line">    caseDirSource</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">IOdictionary thommieDict</span><br><span class="line">(</span><br><span class="line">    IOobject</span><br><span class="line">    (</span><br><span class="line">        &quot;thommieDict&quot;,</span><br><span class="line">        runTimeSource.system(),</span><br><span class="line">        runTimeSource,</span><br><span class="line">        IOobject::MUST_READ_IF_MODIFIED,</span><br><span class="line">        IOobject::NO_WRITE</span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">const dictionary geometrys(thommieDict.subDict(&quot;geometrys&quot;));</span><br></pre></td></tr></table></figure><h1 id="代码解析"><a class="markdownIt-Anchor" href="#代码解析"></a> 代码解析</h1><img src="http://www.plantuml.com/plantuml/svg/jLZVRzew57xdh_0J2Ykjxkvh0MaQtOfkLwg1j4bNLvL93f3R44UsGulM_k-p7ISujWCPR7reKv_lVEUdJno72MOCHN78Ov9Ykhl76_ZHGUBdyH4zq7YBEQ08Sop-LykNopW1YKAf-FLOGZ-Ib76QXvnGLa8lwhH1A36erEygWbv9y0Ks2w1ecQTAPq_YqmfwI2qN25jcwZqJ6gdmxasrjqvenNquPiOnZqEq82H1ppJcCCsKNdAJSXe3Ar2tcAtdU9700CJoxjq8hSKAH1gakGg_zfQxACDKA6Zn-EukPhnYo33dGDCwXSRWd9C7JWSKLZSlsQW2VuKLl6JiqGv9f_YJdMBjKc4I9OGyvTai91b4itmXBU-4bM2VpsvV9O92c5CMRw7uLnl_WdcuDijpUNLrrR9B3dJ8CLI_AQrZiTAV2Ak0DrsNwxYaNyHI5Fy98Bi5705jSgl10-H8JoFulWGws4D69OtkqB8b30IwXsShpEFRpNMYlkLS52UPzBCEI_024YHye_mkJk4-bqPz44YZ9i3iziFxSRm2PK_-gOivUO9KRWUadbXDAWAT0QRX6k4qqfrTHQeAkYHv6XtexU4I9ypJuMY8H2E39ocrRNJsxhdu3NIETrsJxdJN9dFTLPhkX3GEdIHos6I9c5Q3OaBFHtFDFjzby6SjJEaObZXFUCrCyJp_8_O-HD5lCzbWJ5FWQB9yeC3aJZPDdH5NurlZ_APNqfYfWMAG71n1xn3B5rB3ibnJQW5l6d0QteBQZxLH4ZIbDvkCxsnittZZR7B6luhoYO6ZAdDa31DzC9aTyLQkwAaP1du98vH3DBVbwkZn13kv7qVYXRXZWLbCDdJS55Fu9efvdAxgirSaWF6Ovnp-WPqqQtehcUL3pwjGD5fBDHn5GT6cVPrJe2jGNQgTBS1R4aSAR8xANrBHQQdE34Kr2mQo1QhEZhz280QiIDjP5Ee5UvOF8KumFOd1wS_-eMGwi-k8O_CMUM70TUtjLRF8Vfbjppsy-JrkPfXtUzT6OrBO2DSzKq99mpLELzRMA0aHIShkxrkI59vBYJxXq12ctWpjYn4qHQW22XDnY0hC5KvnoiHHD70rx1CgUf6uwk2fPbbj3CYNq_w0UjqaENWE5yJVP7WLi_9IHHnCVGHwGZjljVtHU9e1nRKFbVrvXsZPl_yr3bZbG8aR7ivl2RjeYNjjYHiC6e4YpebEZ2VIfVZO50VcYHtlQ6IKmpMkrQQssc3W5C7dqEU4B73YSSTuQLQfydmjoUVt7WFg-UzU8zVh2LnldOw-GrXW1fDfovk42-ScOLmgbjS8JP_9jXtjz6HA5lz3oAlHSGJMFCoEQxR_Yjp6bEUYbjLbaNnum7nTdYN4SUOl-vx6TxTJ4bNpO2ooQN-rrq15LYMgxBbcmfNgECUdVMJ4wKNllhPJrpKRnDiStX8VBE_rSOoljgtKhEdRfhAU_FsWm7EQgW_ZwxUMZL0g5LIVIYcNNtkzdg0HYQpV8wB1w-Mb4IFgJ8eBCLT0OLL6MGZjGY63kmdXh2XS7TFv2G00"><h2 id="一些函数探秘"><a class="markdownIt-Anchor" href="#一些函数探秘"></a> 一些函数探秘</h2><p>算例里的文件片段：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">RanzMarshallCoeffs</span><br><span class="line">&#123;</span><br><span class="line">    BirdCorrection  <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>代码：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> dictionary&amp; subModelDict = parcels.subModelProperties().subDict(<span class="string">"RanzMarshallCoeffs"</span>);</span><br><span class="line">Info&lt;&lt;<span class="string">"RanzMarshallCoeffs.toc()==="</span>&lt;&lt;subModelDict.toc()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">Info&lt;&lt;<span class="string">"RanzMarshallCoeffs.keys()==="</span>&lt;&lt;subModelDict.keys()&lt;&lt;<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">RanzMarshallCoeffs.toc()===<span class="number">1</span>(BirdCorrection)</span><br><span class="line">RanzMarshallCoeffs.keys()===<span class="number">1</span>(BirdCorrection)</span><br></pre></td></tr></table></figure><p>算例里的文件片段：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">liquids</span><br><span class="line">&#123;</span><br><span class="line">C7H16</span><br><span class="line">    &#123;</span><br><span class="line">        defaultCoeffs   yes;</span><br><span class="line">    &#125;</span><br><span class="line">    IC8H18</span><br><span class="line">    &#123;</span><br><span class="line">        defaultCoeffs   yes;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>代码：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">const</span> wordList <span class="title">fuelList</span><span class="params">(thermo.subDict(<span class="string">"liquids"</span>).keys())</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">const</span> wordList <span class="title">fuelCoeff1</span><span class="params">(thermo.subDict(<span class="string">"liquids"</span>).subDict(<span class="string">"C7H16"</span>).keys())</span></span>;</span><br><span class="line">Info&lt;&lt;<span class="string">"fuelList==="</span>&lt;&lt;fuelList&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">Info&lt;&lt;<span class="string">"fuelCoeff1==="</span>&lt;&lt;fuelCoeff1&lt;&lt;<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">fuelList===</span><br><span class="line"><span class="number">2</span></span><br><span class="line">(</span><br><span class="line">C7H16</span><br><span class="line">IC8H18</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fuelCoeff1===<span class="number">1</span>(defaultCoeffs)</span><br></pre></td></tr></table></figure><p>算例里的文件片段：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Cd   constant <span class="number">0.88</span>;</span><br></pre></td></tr></table></figure><p>其实这里的 <code>Cd</code> 是读取给一个 <code>TimeFunction1&lt;scalar&gt;</code> 的类型。<br>这里我们强行读取后边的标量：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">scalar Cd_ = <span class="number">0.</span>;</span><br><span class="line"><span class="function">token <span class="title">firstToken</span><span class="params">(modelDict.lookup(<span class="string">"Cd"</span>)[<span class="number">1</span>])</span></span>;</span><br><span class="line"><span class="comment">//这里 lookup 得到一个list，我们取[1]，即后边的 0.88</span></span><br><span class="line"><span class="keyword">if</span> (firstToken.isScalar())</span><br><span class="line">&#123;</span><br><span class="line">    Cd_ = firstToken.scalarToken();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其实“更”正确的用法是：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">TimeFunction1&lt;scalar&gt; <span class="title">Cd2_</span><span class="params">(mesh.time(),<span class="string">"Cd"</span>)</span></span>;</span><br><span class="line">Cd2_.reset(modelDict);</span><br><span class="line">Info&lt;&lt;<span class="string">"Cd2_==="</span>&lt;&lt;Cd2_.value(<span class="number">0.</span>)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">scalar Cd_ = Cd2_.value(<span class="number">0.</span>);</span><br></pre></td></tr></table></figure><p>算例里的文件片段：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="number">37</span> liquids</span><br><span class="line"><span class="number">38</span> &#123;</span><br><span class="line"><span class="number">39</span>   C7H16</span><br><span class="line"><span class="number">40</span>    &#123;</span><br><span class="line"><span class="number">41</span>        defaultCoeffs   yes;</span><br><span class="line"><span class="number">42</span>    &#125;</span><br><span class="line"><span class="number">43</span>    IC8H18</span><br><span class="line"><span class="number">44</span>    &#123;</span><br><span class="line"><span class="number">45</span>        defaultCoeffs   yes;</span><br><span class="line"><span class="number">46</span>    &#125;</span><br><span class="line"><span class="number">47</span> &#125;</span><br></pre></td></tr></table></figure><p>代码：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt;<span class="string">"thermo.subDict(liquids).subDict(C7H16).parent()==="</span>&lt;&lt;thermo.subDict(<span class="string">"liquids"</span>).subDict(<span class="string">"C7H16"</span>).parent()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">Info&lt;&lt;<span class="string">"thermo.subDict(liquids).topDict()==="</span>&lt;&lt;thermo.subDict(<span class="string">"liquids"</span>).topDict()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">Info&lt;&lt;<span class="string">"thermo.subDict(liquids).startLineNumber()==="</span>&lt;&lt;thermo.subDict(<span class="string">"liquids"</span>).startLineNumber()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">Info&lt;&lt;<span class="string">"thermo.subDict(liquids).endLineNumber()==="</span>&lt;&lt;thermo.subDict(<span class="string">"liquids"</span>).endLineNumber()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">Info&lt;&lt;<span class="string">"thermo.subDict(liquids).tokens()==="</span>&lt;&lt;thermo.subDict(<span class="string">"liquids"</span>).tokens()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">Info&lt;&lt;<span class="string">"thermo.subDict(liquids).toc()==="</span>&lt;&lt;thermo.subDict(<span class="string">"liquids"</span>).toc()&lt;&lt;<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure><p>输出：<br><code>parent</code> 返回的是上一级字典。<br><code>topDict</code> 返回的是最顶层的字典。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">thermo.subDict(liquids).startLineNumber()===<span class="number">41</span></span><br><span class="line">thermo.subDict(liquids).endLineNumber()===<span class="number">45</span></span><br><span class="line">thermo.subDict(liquids).tokens()===</span><br><span class="line"><span class="number">12</span></span><br><span class="line">(</span><br><span class="line">C7H16</span><br><span class="line">&#123;</span><br><span class="line">defaultCoeffs</span><br><span class="line">yes</span><br><span class="line">;</span><br><span class="line">&#125;</span><br><span class="line">IC8H18</span><br><span class="line">&#123;</span><br><span class="line">defaultCoeffs</span><br><span class="line">yes</span><br><span class="line">;</span><br><span class="line">&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">thermo.subDict(liquids).toc()===</span><br><span class="line"><span class="number">2</span></span><br><span class="line">(</span><br><span class="line">C7H16</span><br><span class="line">IC8H18</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>tokens</code> 就是这个字典中的所有元素，这里有 12 个元素，包括字符串和标点符号。<br>而 <code>toc</code> 是 <code>keys</code> 一样的？他们的定义如下：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Foam::wordList Foam::dictionary::toc() <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">wordList <span class="title">keys</span><span class="params">(<span class="built_in">size</span>())</span></span>;</span><br><span class="line"></span><br><span class="line">    label nKeys = <span class="number">0</span>;</span><br><span class="line">    forAllConstIter(IDLList&lt;entry&gt;, *<span class="keyword">this</span>, iter)</span><br><span class="line">    &#123;</span><br><span class="line">        keys[nKeys++] = iter().keyword();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> keys;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Foam::List&lt;Foam::keyType&gt; Foam::dictionary::keys(<span class="keyword">bool</span> patterns=<span class="literal">false</span>) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">List&lt;keyType&gt; <span class="title">keys</span><span class="params">(<span class="built_in">size</span>())</span></span>;</span><br><span class="line"></span><br><span class="line">    label nKeys = <span class="number">0</span>;</span><br><span class="line">    forAllConstIter(IDLList&lt;entry&gt;, *<span class="keyword">this</span>, iter)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (iter().keyword().isPattern() ? patterns : !patterns)</span><br><span class="line">        &#123;</span><br><span class="line">            keys[nKeys++] = iter().keyword();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    keys.setSize(nKeys);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> keys;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="踩过的坑"><a class="markdownIt-Anchor" href="#踩过的坑"></a> 踩过的坑</h1><p>我想读取一个文件，但是并行时只想让 master 读取。</p><h2 id="初次尝试"><a class="markdownIt-Anchor" href="#初次尝试"></a> 初次尝试</h2><p>首先构造一个 <code>IOdictionary</code>，NO_READ。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">IOdictionary Dict</span><br><span class="line">(</span><br><span class="line">  IOobject</span><br><span class="line">  (</span><br><span class="line">     &quot;dummyName&quot;,&#x2F;&#x2F;tableName</span><br><span class="line">     path,</span><br><span class="line">     mesh,</span><br><span class="line">     IOobject::NO_READ,</span><br><span class="line">     IOobject::NO_WRITE</span><br><span class="line">  )</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>然后在 master 读取</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">if (onlyMasterRead&amp;&amp;Pstream::parRun())</span><br><span class="line">&#123;</span><br><span class="line">    if (Pstream::master())</span><br><span class="line">    &#123;</span><br><span class="line">        Dict.readOpt() &#x3D; IOobject::MUST_READ;</span><br><span class="line">        Dict.readData(this-&gt;readStream(typeName));</span><br><span class="line">        Dict.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    Dict.readOpt() &#x3D; IOobject::MUST_READ;</span><br><span class="line">    Dict.readData(this-&gt;readStream(typeName));</span><br><span class="line">    Dict.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这段代码在本地测试时没问题，但是提交到超算之后就报错了：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[1] --&gt; FOAM FATAL IO ERROR: </span><br><span class="line">[1] error in IOstream &quot;IOstream&quot; for operation operator&gt;&gt;(Istream&amp;, List&lt;T&gt;&amp;) : reading first token</span><br><span class="line">[1] </span><br><span class="line">[1] file: IOstream at line 0.</span><br><span class="line">[1] </span><br><span class="line">[1]     From function void Foam::IOstream::fatalCheck(const char*) const</span><br><span class="line">[1]     in file db&#x2F;IOstreams&#x2F;IOstreams&#x2F;IOstream.C at line 109.</span><br><span class="line">[1] FOAM parallel run exiting</span><br></pre></td></tr></table></figure><p>注意到这里master没有报这个错，其它核都报了。<br>因此猜测，IOdictionary必须每个核保持一直，不能有差异！</p><h2 id="再次尝试"><a class="markdownIt-Anchor" href="#再次尝试"></a> 再次尝试</h2><p>首先构造一个 <code>IOdictionary</code>，读取一个特别小的 dummyName。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">IOdictionary Dict</span><br><span class="line">(</span><br><span class="line">  IOobject</span><br><span class="line">  (</span><br><span class="line">     &quot;dummyName&quot;,&#x2F;&#x2F;tableName</span><br><span class="line">     path,</span><br><span class="line">     mesh,</span><br><span class="line">     IOobject::MUST_READ,</span><br><span class="line">     IOobject::NO_WRITE</span><br><span class="line">  )</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>然后在 master 读取真正的文件</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">if (onlyMasterRead&amp;&amp;Pstream::parRun())</span><br><span class="line">&#123;</span><br><span class="line">    if (Pstream::master())</span><br><span class="line">    &#123;</span><br><span class="line">        Dict.rename(tableName);</span><br><span class="line">        Dict.readData(this-&gt;readStream(typeName));</span><br><span class="line">        Dict.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    Dict.rename(tableName);</span><br><span class="line">    Dict.readData(this-&gt;readStream(typeName));</span><br><span class="line">    Dict.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>还是和上边一样的问题！</p><h2 id="解决方案"><a class="markdownIt-Anchor" href="#解决方案"></a> 解决方案</h2><p>不用 <code>IOdictionary</code>，而是用 <code>dictionary</code></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">if (onlyMasterRead&amp;&amp;Pstream::parRun())</span><br><span class="line">&#123;</span><br><span class="line">    if (Pstream::master())</span><br><span class="line">    &#123;</span><br><span class="line">        tableValues_ &#x3D; dictionary(IFstream(tablePath+&quot;&#x2F;&quot;+tableName)()).lookupOrDefault&lt;List&lt;scalar&gt;&gt;(tableName, defaultList);</span><br><span class="line">    &#125;</span><br><span class="line">    Pstream::scatter(tableValues_);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    tableValues_ &#x3D; dictionary(IFstream(tablePath+&quot;&#x2F;&quot;+tableName)()).lookupOrDefault&lt;List&lt;scalar&gt;&gt;(tableName, defaultList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> dictionary </tag>
            
            <tag> IOdictionary </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM 中的喷雾速度计算</title>
      <link href="/sprayVelocity/"/>
      <url>/sprayVelocity/</url>
      
        <content type="html"><![CDATA[<p>从数学公式到 C++ 代码分析喷雾粒子速度计算，以及喷雾引起的气相速度源项</p><a id="more"></a><p>本文下标 p 表示 parcel，g 表示 gas，无下标的也是表示环境气体。</p><p><a href="https://research.chalmers.se/en/publication/724" target="_blank" rel="external nofollow noopener noreferrer">Niklas Nordin 博士论文</a>中的公式：</p><p>为了计算粒子的速度，构造速度方程：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>m</mi><mi>p</mi></msub><mfrac><mrow><mi>d</mi><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><msub><mi mathvariant="bold">F</mi><mi mathvariant="bold">p</mi></msub></mrow><annotation encoding="application/x-tex">m_p \dfrac{d \mathbf{u}_p}{d t}=\mathbf{F_p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.972218em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16110799999999997em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">F</mi><mi mathvariant="bold">p</mi></msub><mo>=</mo><mo>−</mo><mfrac><mrow><mi>π</mi><msup><mi>D</mi><mn>2</mn></msup></mrow><mn>8</mn></mfrac><mi>ρ</mi><msub><mi>C</mi><mi>D</mi></msub><mrow><mo fence="true">∣</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo fence="true">∣</mo></mrow><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{F_p}=-\dfrac{\pi D^{2}}{8} \rho C_D\left|\mathbf{u}_{p}-\mathbf{u}\right|\left(\mathbf{u}_{p}-\mathbf{u}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.972218em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16110799999999997em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.177108em;vertical-align:-.686em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">8</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose delimcenter" style="top:0">∣</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose delimcenter" style="top:0">)</span></span></span></span></span></span></p><p>其中：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mi>D</mi></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.15999999999999992em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>24</mn><mrow><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub></mrow></mfrac></mstyle><mrow><mo fence="true">(</mo><mn>1</mn><mo>+</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn><mn>6</mn></mfrac></mstyle><mi>R</mi><msubsup><mi>e</mi><mi>p</mi><mrow><mn>2</mn><mi mathvariant="normal">/</mi><mn>3</mn></mrow></msubsup><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub><mo>&lt;</mo><mn>1000</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.424</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub><mo>&gt;</mo><mn>1000</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">C_D=\left\{\begin{array}{ll}{\dfrac{24}{Re_{p}}\left(1+\dfrac{1}{6} R e_{p}^{2 / 3}\right)} &amp; {Re_p&lt;1000} \\ {0.424} &amp; {Re_p&gt;1000}\end{array}\right.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.6221079999999994em;vertical-align:-1.561054em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em"><span style="top:-2.49999em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-3.15001em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.30002em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0610539999999995em"><span style="top:-4.061054em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">6</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.5834080000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span style="top:-3.2198em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">/</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2526999999999999em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span></span></span></span><span style="top:-2.248946em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span><span class="mord">2</span><span class="mord">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.561054em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0610539999999995em"><span style="top:-4.061054em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span></span><span style="top:-2.248946em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.561054em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub><mo>=</mo><mfrac><mrow><mi>ρ</mi><mrow><mo fence="true">∣</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo fence="true">∣</mo></mrow><msub><mi>d</mi><mi>p</mi></msub></mrow><msub><mi>μ</mi><mi>g</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">Re_{p}=\dfrac{\rho\left|\mathbf{u}_{p}-\mathbf{u}\right| d_p}{\mu_g}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.399108em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose delimcenter" style="top:0">∣</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>可以推导出：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mi>p</mi></msub><mo>=</mo><mfrac><mrow><mi>d</mi><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mrow><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi></mrow><msub><mi>τ</mi><mi mathvariant="bold">u</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">a_p=\dfrac{d \mathbf{u}_{p}}{d t}=-\dfrac{\mathbf{u}_{p}-\mathbf{u}}{\tau_{\mathbf{u}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.09633em;vertical-align:-.8360000000000001em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.26033em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.161108em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">u</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>τ</mi><mi mathvariant="normal">u</mi></msub><mo>=</mo><mfrac><mrow><mn>8</mn><msub><mi>m</mi><mi>p</mi></msub></mrow><mrow><mi>π</mi><mi>ρ</mi><msub><mi>C</mi><mi>D</mi></msub><msubsup><mi>d</mi><mi>p</mi><mn>2</mn></msubsup><mrow><mo fence="true">∣</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo fence="true">∣</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mn>4</mn><mn>3</mn></mfrac><mfrac><mrow><msub><mi>ρ</mi><mi>p</mi></msub><msub><mi>d</mi><mi>p</mi></msub></mrow><mrow><mi>ρ</mi><msub><mi>C</mi><mi>p</mi></msub><mrow><mo fence="true">∣</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo fence="true">∣</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">\tau_{\mathrm{u}} =\dfrac{8 m_{p}}{\pi \rho C_D d_p^{2}\left|\mathbf{u}_{p}-\mathbf{u}\right|} =\dfrac{4}{3} \dfrac{\rho_{p} d_p}{\rho C_{p}\left|\mathbf{u}_{p}-\mathbf{u}\right|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">u</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.390548em;vertical-align:-1.069108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7401079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose delimcenter" style="top:0">∣</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">8</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.069108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose delimcenter" style="top:0">∣</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">a_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 是粒子的加速度，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">d_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 是粒子的直径。</p><p>可以变形为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi>d</mi><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi></mrow><msub><mi>τ</mi><mi>u</mi></msub></mfrac></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi></mrow><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>4</mn><mn>3</mn></mfrac></mstyle><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><msub><mi>ρ</mi><mi>p</mi></msub><msub><mi>d</mi><mi>p</mi></msub></mrow><mrow><mi>ρ</mi><msub><mi>C</mi><mi>p</mi></msub><mrow><mo fence="true">∣</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo fence="true">∣</mo></mrow></mrow></mfrac></mstyle></mrow></mfrac></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mn>3</mn><mo stretchy="false">(</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo stretchy="false">)</mo><mi>ρ</mi><msub><mi>C</mi><mi>D</mi></msub><mrow><mo fence="true">∣</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo fence="true">∣</mo></mrow></mrow><mrow><mn>4</mn><msub><mi>ρ</mi><mi>p</mi></msub><msub><mi>d</mi><mi>p</mi></msub></mrow></mfrac></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mn>3</mn><mo stretchy="false">(</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo stretchy="false">)</mo><msub><mi>μ</mi><mi>g</mi></msub><msub><mi>C</mi><mi>D</mi></msub></mrow><mrow><mn>4</mn><msub><mi>ρ</mi><mi>p</mi></msub><msup><mi>D</mi><mn>2</mn></msup></mrow></mfrac></mstyle><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi>ρ</mi><mrow><mo fence="true">∣</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo fence="true">∣</mo></mrow><msub><mi>d</mi><mi>p</mi></msub></mrow><msub><mi>μ</mi><mi>g</mi></msub></mfrac></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>3</mn><mn>4</mn></mfrac></mstyle><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><msub><mi>μ</mi><mi>g</mi></msub><msub><mi>C</mi><mi>D</mi></msub><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub></mrow><mrow><msub><mi>ρ</mi><mi>p</mi></msub><msubsup><mi>d</mi><mi>p</mi><mn>2</mn></msubsup></mrow></mfrac></mstyle><mo stretchy="false">(</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{ll} \dfrac{d \mathbf{u}_{p}}{d t}\\ =-\dfrac{\mathbf{u}_p-\mathbf{u}}{\tau_u}\\ =-\dfrac{\mathbf{u}_p-\mathbf{u}}{\dfrac{4}{3} \dfrac{\rho_{p} d_p}{\rho C_{p}\left|\mathbf{u}_{p}-\mathbf{u}\right|}}\\ =-\dfrac{3(\mathbf{u}_p-\mathbf{u})\rho C_D \left|\mathbf{u}_{p}-\mathbf{u}\right|}{4 \rho_p d_p}\\ =-\dfrac{3(\mathbf{u}_p-\mathbf{u})\mu_g C_D}{4\rho_p D^2}\dfrac{\rho\left|\mathbf{u}_{p}-\mathbf{u}\right| d_p}{\mu_g}\\ =-\dfrac{3}{4}\dfrac{\mu_g C_D Re_p}{\rho_p d_p^2}(\mathbf{u}_{p}-\mathbf{u}) \end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:14.875302000000001em;vertical-align:-7.187651em"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.687651000000001em"><span style="top:-9.743211em"><span class="pstrut" style="height:3.427em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-7.796880999999999em"><span class="pstrut" style="height:3.427em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.26033em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-5.700550999999999em"><span class="pstrut" style="height:3.427em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.26033em"><span style="top:-2.11em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose delimcenter" style="top:0">∣</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.6014399999999998em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-4.048439999999999em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.233548em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.0400030000000005em"><span class="pstrut" style="height:3.427em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose">)</span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose delimcenter" style="top:0">∣</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:.35910499999999956em"><span class="pstrut" style="height:3.427em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.740108em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose delimcenter" style="top:0">∣</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:2.691543em"><span class="pstrut" style="height:3.427em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7401079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.069108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:7.187651em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span></span></span></span></span></span></span></p><p>还原到牛顿第二定律中：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mi>p</mi></msub><mo>=</mo><msub><mi>m</mi><mi>p</mi></msub><mfrac><mrow><mi>d</mi><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">F_p = m_p \dfrac{d \mathbf{u}_p}{d t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><msub><mi>m</mi><mi>p</mi></msub><mfrac><mn>3</mn><mn>4</mn></mfrac><mfrac><mrow><msub><mi>μ</mi><mi>g</mi></msub><msub><mi>C</mi><mi>D</mi></msub><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub></mrow><mrow><msub><mi>ρ</mi><mi>p</mi></msub><msubsup><mi>d</mi><mi>p</mi><mn>2</mn></msubsup></mrow></mfrac><mo stretchy="false">(</mo><mi mathvariant="bold">u</mi><mo>−</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">=m_p \dfrac{3}{4}\dfrac{\mu_g C_D Re_p}{\rho_p d_p^2}(\mathbf{u}-\mathbf{u}_{p})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.429438em;vertical-align:-1.069108em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7401079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.069108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">u</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><mfrac><mrow><mn>3</mn><msub><mi>m</mi><mi>p</mi></msub><msub><mi>μ</mi><mi>g</mi></msub><msub><mi>C</mi><mi>D</mi></msub><mi>R</mi><mi>e</mi></mrow><mrow><mn>4</mn><msub><mi>ρ</mi><mi>p</mi></msub><msubsup><mi>d</mi><mi>p</mi><mn>2</mn></msubsup></mrow></mfrac><mo stretchy="false">(</mo><mi mathvariant="bold">u</mi><mo>−</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">=\dfrac{3m_p\mu_gC_DRe}{4\rho_p d_p^2}(\mathbf{u}-\mathbf{u}_{p})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.429438em;vertical-align:-1.069108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7401079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord mathdefault">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.069108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">u</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>以下代码中的 <code>mass</code> 经常是指当前 parcel 中包含的一个 particle 的质量，需要乘以粒子数才等于当前 parcel 的总质量。<br><code>ReactingParcel::calc</code> 中调用：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Explicit momentum source for particle</span></span><br><span class="line"><span class="built_in">vector</span> Su = Zero;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Linearised momentum source coefficient</span></span><br><span class="line">scalar Spu = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Momentum transfer from the particle to the carrier phase</span></span><br><span class="line"><span class="built_in">vector</span> dUTrans = Zero;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Calculate new particle velocity</span></span><br><span class="line"><span class="keyword">this</span>-&gt;U_ =</span><br><span class="line">    <span class="keyword">this</span>-&gt;calcVelocity(cloud, td, dt, Res, mus, mass1, Su, dUTrans, Spu);</span><br></pre></td></tr></table></figure><p><code>KinematicParcel::calcVelocity</code></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ParcelType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">template</span>&lt;class TrackCloudType&gt;</span></span><br><span class="line"><span class="class"><span class="title">const</span> <span class="title">Foam</span>:</span>:<span class="built_in">vector</span> Foam::KinematicParcel&lt;ParcelType&gt;::calcVelocity</span><br><span class="line">(</span><br><span class="line">    TrackCloudType&amp; cloud,</span><br><span class="line">    trackingData&amp; td,</span><br><span class="line">    <span class="keyword">const</span> scalar dt,</span><br><span class="line">    <span class="keyword">const</span> scalar Re,</span><br><span class="line">    <span class="keyword">const</span> scalar mu,</span><br><span class="line">    <span class="keyword">const</span> scalar mass,</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">vector</span>&amp; Su,</span><br><span class="line">    <span class="built_in">vector</span>&amp; dUTrans,</span><br><span class="line">    scalar&amp; Spu</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">typename</span> TrackCloudType::parcelType&amp; p =</span><br><span class="line">        <span class="keyword">static_cast</span>&lt;<span class="keyword">const</span> <span class="keyword">typename</span> TrackCloudType::parcelType&amp;&gt;(*<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">typename</span> TrackCloudType::parcelType::trackingData&amp; ttd =</span><br><span class="line">        <span class="keyword">static_cast</span>&lt;<span class="keyword">typename</span> TrackCloudType::parcelType::trackingData&amp;&gt;(td);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">typename</span> TrackCloudType::forceType&amp; forces = cloud.forces();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Momentum source due to particle forces</span></span><br><span class="line">    <span class="keyword">const</span> forceSuSp Fcp = forces.calcCoupled(p, ttd, dt, mass, Re, mu);</span><br><span class="line">    <span class="keyword">const</span> forceSuSp Fncp = forces.calcNonCoupled(p, ttd, dt, mass, Re, mu);</span><br><span class="line">    <span class="keyword">const</span> scalar massEff = forces.massEff(p, ttd, mass);</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">// Shortcut splitting assuming no implicit non-coupled force ...</span></span><br><span class="line">    <span class="comment">// Calculate the integration coefficients</span></span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">vector</span> acp = (Fcp.Sp()*td.Uc() + Fcp.Su())/massEff;</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">vector</span> ancp = (Fncp.Su() + Su)/massEff;</span><br><span class="line">    <span class="keyword">const</span> scalar bcp = Fcp.Sp()/massEff;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Integrate to find the new parcel velocity</span></span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">vector</span> deltaU = cloud.UIntegrator().delta(U_, dt, acp + ancp, bcp);</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">vector</span> deltaUncp = ancp*dt;</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">vector</span> deltaUcp = deltaU - deltaUncp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate the new velocity and the momentum transfer terms</span></span><br><span class="line">    <span class="built_in">vector</span> Unew = U_ + deltaU;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    dUTrans -= massEff*deltaUcp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Spu = dt*Fcp.Sp();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Apply correction to velocity and dUTrans for reduced-D cases</span></span><br><span class="line">    <span class="keyword">const</span> polyMesh&amp; mesh = cloud.pMesh();</span><br><span class="line">    meshTools::constrainDirection(mesh, mesh.solutionD(), Unew);</span><br><span class="line">    meshTools::constrainDirection(mesh, mesh.solutionD(), dUTrans);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Unew;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>forces.calcCoupled</code> 和 <code>forces.calcNonCoupled</code> 都定义于 <code>ParticleForce</code> 中，但是返回值是 0，在其派生类中重新定义真正的函数，当我们选用 <code>SphereDragForce</code> 时，返回值是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mn>3</mn><msub><mi>m</mi><mi>p</mi></msub><mi>μ</mi><msub><mi>C</mi><mi>D</mi></msub><mi>R</mi><mi>e</mi></mrow><mrow><mn>4</mn><mi>ρ</mi><msubsup><mi>d</mi><mi>p</mi><mn>2</mn></msubsup></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\dfrac{3m_p\mu C_DRe}{4\rho d_p^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.429438em;vertical-align:-1.069108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7401079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">μ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord mathdefault">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.069108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>。</p><p>然后再回到 <code>KinematicParcel::calcVelocity</code>：</p><table><thead><tr><th>代码中的变量</th><th>数学公式</th></tr></thead><tbody><tr><td><code>Fcp</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mn>3</mn><msub><mi>m</mi><mi>p</mi></msub><mi>μ</mi><msub><mi>C</mi><mi>D</mi></msub><mi>R</mi><mi>e</mi></mrow><mrow><mn>4</mn><msub><mi>ρ</mi><mi>p</mi></msub><msubsup><mi>d</mi><mi>p</mi><mn>2</mn></msubsup></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\dfrac{3m_p\mu C_DRe}{4\rho_p d_p^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.429438em;vertical-align:-1.069108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7401079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">μ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord mathdefault">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.069108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></td></tr><tr><td><code>Fncp</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span></span></span></span></td></tr><tr><td><code>massEff</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>m</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">m_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>acp</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">u</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{u}_{c}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.59444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> <code>Fcp</code><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">/</mi><msub><mi>m</mi><mi>p</mi></msub><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mn>3</mn><msub><mi mathvariant="bold">u</mi><mi>c</mi></msub><mi>μ</mi><msub><mi>C</mi><mi>D</mi></msub><mi>R</mi><mi>e</mi></mrow><mrow><mn>4</mn><msub><mi>ρ</mi><mi>p</mi></msub><msubsup><mi>d</mi><mi>p</mi><mn>2</mn></msubsup></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">/m_p=\dfrac{3 \mathbf{u}_{c} \mu C_D Re}{4\rho_p d_p^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord">/</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.4294379999999998em;vertical-align:-1.069108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7401079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">μ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord mathdefault">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.069108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></td></tr><tr><td><code>ancp</code></td><td>0</td></tr><tr><td><code>bcp</code></td><td><code>Fcp</code><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">/</mi><msub><mi>m</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">/m_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord">/</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>deltaU</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mtext>Fcp</mtext><msub><mi>m</mi><mi>p</mi></msub></mfrac></mstyle><mo stretchy="false">(</mo><msub><mi mathvariant="bold">u</mi><mi mathvariant="bold">c</mi></msub><mo>−</mo><msub><mi mathvariant="bold">u</mi><mi mathvariant="bold">p</mi></msub><mo stretchy="false">)</mo><mi>d</mi><mi>t</mi><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mn>3</mn><mi>μ</mi><msub><mi>C</mi><mi>D</mi></msub><mi>R</mi><mi>e</mi></mrow><mrow><mn>4</mn><msub><mi>ρ</mi><mi>p</mi></msub><msubsup><mi>d</mi><mi>p</mi><mn>2</mn></msubsup></mrow></mfrac></mstyle><mo stretchy="false">(</mo><msub><mi mathvariant="bold">u</mi><mi mathvariant="bold">c</mi></msub><mo>−</mo><msub><mi mathvariant="bold">u</mi><mi mathvariant="bold">p</mi></msub><mo stretchy="false">)</mo><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\dfrac{\text{Fcp}}{m_p}(\mathbf{u_c}-\mathbf{u_p})dt=\dfrac{3\mu C_DRe}{4\rho_p d_p^2}(\mathbf{u_c}-\mathbf{u_p})dt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">Fcp</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.161108em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16110799999999997em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.4294379999999998em;vertical-align:-1.069108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7401079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span><span class="mord mathdefault">μ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord mathdefault">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.069108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.161108em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16110799999999997em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span></span></td></tr><tr><td><code>deltaUncp</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span></span></span></span></td></tr><tr><td><code>deltaUcp</code></td><td><code>deltaU</code></td></tr><tr><td><code>dUTrans</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>−</mo><msub><mi>m</mi><mi>d</mi></msub><mo>∗</mo></mrow><annotation encoding="application/x-tex">-m_d*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.73333em;vertical-align:-.15em"></span><span class="mord">−</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">∗</span></span></span></span><code>deltaU</code></td></tr><tr><td><code>Spu</code></td><td><code>dt*Fcp</code></td></tr></tbody></table><p>其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">u</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{u}_{c}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.59444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 是粒子当前所在位置的插值气相速度。<br>可以发现这里的 <code>deltaU</code> 与上文提到的文献中的公式是一样的。这就是粒子速度方程了。</p><p>接下来讨论粒子对于气相速度的影响。首先看一下速度输运方程：<br>首先看一下速度输运方程：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">tmp&lt;fvVectorMatrix&gt; tUEqn</span><br><span class="line">(</span><br><span class="line">    fvm::ddt(rho, U) + fvm::div(phi, U)</span><br><span class="line">  + MRF.DDt(rho, U)</span><br><span class="line">  + turbulence-&gt;divDevRhoReff(U)</span><br><span class="line">==</span><br><span class="line">    rho()*g</span><br><span class="line">  + parcels.SU(U)</span><br><span class="line">  + fvOptions(rho, U)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (pimple.momentumPredictor())</span><br><span class="line">&#123;</span><br><span class="line">    solve(UEqn == -fvc::grad(p));</span><br><span class="line"></span><br><span class="line">    fvOptions.correct(U);</span><br><span class="line">    K = <span class="number">0.5</span>*magSqr(U);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>KinematicCloud::SU</code></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Foam</span>:</span>:tmp&lt;Foam::fvVectorMatrix&gt;</span><br><span class="line">Foam::KinematicCloud&lt;CloudType&gt;::SU(volVectorField&amp; U) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (debug)</span><br><span class="line">    &#123;</span><br><span class="line">        Info&lt;&lt; <span class="string">"UTrans min/max = "</span> &lt;&lt; <span class="built_in">min</span>(UTrans()).value() &lt;&lt; <span class="string">", "</span></span><br><span class="line">            &lt;&lt; <span class="built_in">max</span>(UTrans()).value() &lt;&lt; nl</span><br><span class="line">            &lt;&lt; <span class="string">"UCoeff min/max = "</span> &lt;&lt; <span class="built_in">min</span>(UCoeff()).value() &lt;&lt; <span class="string">", "</span></span><br><span class="line">            &lt;&lt; <span class="built_in">max</span>(UCoeff()).value() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (solution_.coupled())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (solution_.semiImplicit(<span class="string">"U"</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">const</span> volScalarField::Internal</span><br><span class="line">                Vdt(mesh_.V()*<span class="keyword">this</span>-&gt;db().time().deltaT());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> UTrans()/Vdt - fvm::Sp(UCoeff()/Vdt, U) + UCoeff()/Vdt*U;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            tmp&lt;fvVectorMatrix&gt; tfvm(<span class="keyword">new</span> fvVectorMatrix(U, dimForce));</span><br><span class="line">            fvVectorMatrix&amp; fvm = tfvm.ref();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            fvm.source() = -UTrans()/(<span class="keyword">this</span>-&gt;db().time().deltaT());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> tfvm;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> tmp&lt;fvVectorMatrix&gt;(<span class="keyword">new</span> fvVectorMatrix(U, dimForce));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ReactingParcel::calc</code> 中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Transfer mass lost to carrier mass, momentum and enthalpy sources</span></span><br><span class="line">forAll(dMass, i)</span><br><span class="line">&#123;</span><br><span class="line">    scalar dm = np0*dMass[i];</span><br><span class="line">    label gid = composition.localToCarrierId(<span class="number">0</span>, i);</span><br><span class="line">    scalar hs = composition.carrier().Hs(gid, td.pc(), T0);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    cloud.rhoTrans(gid)[<span class="keyword">this</span>-&gt;cell()] += dm;</span><br><span class="line">    cloud.UTrans()[<span class="keyword">this</span>-&gt;cell()] += dm*U0;</span><br><span class="line">    cloud.hsTrans()[<span class="keyword">this</span>-&gt;cell()] += dm*hs;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Update momentum transfer</span></span><br><span class="line">cloud.UTrans()[<span class="keyword">this</span>-&gt;cell()] += np0*dUTrans;</span><br><span class="line">cloud.UCoeff()[<span class="keyword">this</span>-&gt;cell()] += np0*Spu;</span><br><span class="line"><span class="comment">// np0 是当前 parcel 中的粒子数</span></span><br></pre></td></tr></table></figure><p>再看一下文献：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo stretchy="true">‾</mo></mover><msub><mover accent="true"><mi>u</mi><mo>~</mo></mover><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo stretchy="true">‾</mo></mover><msub><mover accent="true"><mi>u</mi><mo>~</mo></mover><mi>i</mi></msub><msub><mover accent="true"><mi>u</mi><mo>~</mo></mover><mi>j</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>p</mi><mo stretchy="true">‾</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mover accent="true"><mi>τ</mi><mo stretchy="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo stretchy="true">‾</mo></mover><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><msub><mover accent="true"><mover accent="true"><mi>S</mi><mo>˙</mo></mover><mo stretchy="true">‾</mo></mover><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\frac{\partial \overline{\rho} \tilde{u}_{i}}{\partial t}+\frac{\partial \overline{\rho} \tilde{u}_{i} \tilde{u}_{j}}{\partial x_{j}}=-\frac{\partial \overline{p}}{\partial x_{i}}+\frac{\partial \overline{\tau}_{i j}}{\partial x_{j}}-\frac{\partial \overline{\rho} \Gamma_{i j}}{\partial x_{j}}+\overline{\dot{S}}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6678599999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">u</span></span></span><span style="top:-3.35em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6678599999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">u</span></span></span><span style="top:-3.35em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6678599999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">u</span></span></span><span style="top:-3.35em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">p</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.27019em;vertical-align:-.15em"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.12019em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9201900000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span></span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.055550000000000016em">˙</span></span></span></span></span></span></span></span><span style="top:-4.04019em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mover accent="true"><mi>S</mi><mo>˙</mo></mover><mo stretchy="true">‾</mo></mover><mi>i</mi></msub><mo>=</mo><mfrac><mn>1</mn><msub><mi>V</mi><mi>f</mi></msub></mfrac><munderover><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mi>p</mi></mrow></munderover><mrow><mo fence="true">(</mo><msub><mi>n</mi><mrow><mi>d</mi><mo separator="true">,</mo><mi>m</mi></mrow></msub><msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><mrow><mi>d</mi><mo separator="true">,</mo><mi>m</mi></mrow></msub><msub><mi>u</mi><mrow><mi>d</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mi>m</mi></mrow></msub><mo>−</mo><msub><mi>n</mi><mrow><mi>d</mi><mo separator="true">,</mo><mi>m</mi></mrow></msub><msub><mi>F</mi><mrow><mi>d</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mi>m</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\overline{\dot{S}}_{i}=\frac{1}{V_{f}} \sum_{m=1}^{n p} \left(n_{d, m} \dot{m}_{d, m} u_{d, i, m}-n_{d, m} F_{d, i, m}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.27019em;vertical-align:-.15em"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.12019em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9201900000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span></span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.055550000000000016em">˙</span></span></span></span></span></span></span></span><span style="top:-4.04019em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.965618em;vertical-align:-1.267113em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6985050000000004em"><span style="top:-1.882887em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.347113em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">)</span></span></span></span></span></span></p><p>可以发现公式第一部分是液滴蒸发变成气相带来的速度，第二部分是液滴和气相之间的相互作用力。这两部分分别对应代码中的 <code>dm*U0</code> 和 <code>np0*dUTrans</code>。 其中的 <code>dUTrans</code> 在 <code>KinematicParcel::calcVelocity</code> 中计算：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>U</mi><mi>T</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo>=</mo><mo>−</mo><msub><mi>m</mi><mi>p</mi></msub><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>U</mi></mrow><annotation encoding="application/x-tex">dUTrans=-m_pdeltaU</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:.10903em">U</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord">−</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.10903em">U</span></span></span></span>。然后文献中的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mo>=</mo><msub><mi>m</mi><mi>d</mi></msub><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>U</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">F=m_d\dfrac{deltaU}{dt}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.13889em">F</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.10903em">U</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>。这是所有 parcel 的合力，即 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mi>i</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mi>p</mi></mrow></msubsup><msub><mi>F</mi><mrow><mi>d</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">F_i=\sum_{m=1}^{n p} F_{d,i,m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-.29971000000000003em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.804292em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029000000000005em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>，这里的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65952em;vertical-align:0"></span><span class="mord mathdefault">i</span></span></span></span> 表示力的三个方向，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">m</span></span></span></span> 表示对所有 parcel 循环，np 是当前网格 parcel 的个数。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>n</mi><mrow><mi>d</mi><mo separator="true">,</mo><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">n_{d,m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 表示第 m 个 parcel 中 particle 的个数，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>cot</mi><mo>⁡</mo><msub><mi>m</mi><mrow><mi>d</mi><mo separator="true">,</mo><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\cot m_{d,m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9011879999999999em;vertical-align:-.286108em"></span><span class="mop">cot</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 表示第 m 个 parcel 的蒸发速率，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>u</mi><mrow><mi>d</mi><mo separator="true">,</mo><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">u_{d,m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 表示第 m 个 parcel 的速度。</p><p>事实上，代码中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">UTrans = dm*U0 + np0*dUTrans</span><br><span class="line"><span class="comment">//dm是蒸发出来的总质量（已经乘过np0了），np0是当前parcel所包含的particle个数</span></span><br><span class="line">SU.source() = - UTrans/deltaT = - (dm*U0 + np0*dUTrans)/deltaT </span><br><span class="line">= - (dm*U0 - np0*m*deltaU)/deltaT</span><br><span class="line">= - (dm/deltaT*U0 - np0*m*deltaU/deltaT)</span><br></pre></td></tr></table></figure><p><code>SU.source()</code><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><mo>−</mo><mo stretchy="false">(</mo><msub><mi>n</mi><mi>d</mi></msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><msub><mi>u</mi><mi>d</mi></msub><mo>−</mo><mi>F</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">=-(n_d\dot m u_d - F)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">−</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.13889em">F</span><span class="mclose">)</span></span></span></span></p>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Lagrangian </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM 速度输运方程中的应力张量项</title>
      <link href="/shearRateTensor/"/>
      <url>/shearRateTensor/</url>
      
        <content type="html"><![CDATA[<p>无摘要</p><a id="more"></a><h2 id="速度输运方程"><a class="markdownIt-Anchor" href="#速度输运方程"></a> 速度输运方程</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">tmp&lt;fvVectorMatrix&gt; tUEqn</span><br><span class="line">(</span><br><span class="line">    fvm::ddt(rho, U) + fvm::div(phi, U)</span><br><span class="line">  + turbulence-&gt;divDevRhoReff(U)</span><br><span class="line"> ==</span><br><span class="line">  - fvc::grad(p)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>对应的公式：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo stretchy="false">(</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><mo>−</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><mrow><msubsup><mi>u</mi><mi>i</mi><mo mathvariant="normal">′</mo></msubsup><msubsup><mi>u</mi><mi>j</mi><mo mathvariant="normal">′</mo></msubsup></mrow><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{ \partial }{ \partial t }( \bar\rho\widetilde{u_i} ) + \frac{ \partial\bar\rho\widetilde{u_i}\widetilde{u_j} }{ \partial x_j } = \frac{ \partial \overline \sigma _{ij} }{ \partial x_j } + \frac{ \partial }{ \partial x_j}( -\bar\rho\widetilde{ u&#x27;_iu&#x27;_j } )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord">−</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.019692em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.27686399999999994em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.733692em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>其中公式中的粘性应力<br><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mover accent="true"><mi>τ</mi><mo stretchy="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mover accent="true"><mi>p</mi><mo stretchy="true">‾</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>2</mn><mi>μ</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>S</mi><mo stretchy="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><msub><mover accent="true"><mi>S</mi><mo stretchy="true">‾</mo></mover><mrow><mi>k</mi><mi>k</mi></mrow></msub><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo>−</mo><mover accent="true"><mi>p</mi><mo stretchy="true">‾</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\overline \sigma _{ij} = \overline\tau_{ij} - \overline p\delta_{ij} = 2\mu( \overline S_{ij} - \frac{1}{3}\overline S_{kk}\delta_{ij} ) - \overline p\delta_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.916668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.916668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.1132em">τ</span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">p</span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.169438em;vertical-align:-.286108em"></span><span class="mord">2</span><span class="mord mathdefault">μ</span><span class="mopen">(</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8833300000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em">S</span></span><span style="top:-3.80333em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.2283300000000001em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8833300000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em">S</span></span><span style="top:-3.80333em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">p</span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>。</p><p>雷诺应力<br><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo>−</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><mrow><msubsup><mi>u</mi><mi>i</mi><mo mathvariant="normal">′</mo></msubsup><msubsup><mi>u</mi><mi>j</mi><mo mathvariant="normal">′</mo></msubsup></mrow><mo stretchy="true">~</mo></mover></mrow><annotation encoding="application/x-tex">\Gamma_{ij}=-\bar\rho \widetilde {u&#x27;_iu_j&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.432664em;vertical-align:-.4129719999999999em"></span><span class="mord">−</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.019692em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.27686399999999994em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.733692em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span></span></span></span>，<br>根据 Boussinesq 假设：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><msub><mi mathvariant="normal">Γ</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>2</mn><msub><mi>μ</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mover accent="true"><msub><mi>S</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo stretchy="true">~</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Gamma_{ij}-\frac{1}{3}\Gamma_{kk}\delta_{ij}=2\mu_t(\widetilde{S_{ij}}-\frac{1}{3}\widetilde{S_{kk}}\delta_{ij})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.229438em;vertical-align:-.286108em"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.28833em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，这里简化成了不可压版本：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>2</mn><msub><mi>μ</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mover accent="true"><msub><mi>S</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo stretchy="true">~</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Gamma_{ij}=2\mu_t(\widetilde{S_{ij}}-\frac{1}{3}\widetilde{S_{kk}}\delta_{ij})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.229438em;vertical-align:-.286108em"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.28833em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>。</p><p>这个 <code>turbulence-&gt;divDevRhoReff(U)</code> 就是公式中的粘性应力和雷诺应力移到方程左边了。<br>下面详细解释了这个过程：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">BasicTurbulenceModel</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:tmp&lt;Foam::fvVectorMatrix&gt;</span><br><span class="line">Foam::linearViscousStress&lt;BasicTurbulenceModel&gt;::divDevRhoReff</span><br><span class="line">(</span><br><span class="line">    volVectorField&amp; U</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">    (</span><br><span class="line">      - fvc::div((<span class="keyword">this</span>-&gt;alpha_*<span class="keyword">this</span>-&gt;rho_*<span class="keyword">this</span>-&gt;nuEff())*dev2(T(fvc::grad(U))))</span><br><span class="line">      - fvm::laplacian(<span class="keyword">this</span>-&gt;alpha_*<span class="keyword">this</span>-&gt;rho_*<span class="keyword">this</span>-&gt;nuEff(), U)</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>代码中表示的公式是</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mrow><mo fence="true">(</mo><mi>ρ</mi><mo>∗</mo><msub><mi>ν</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><mrow><mo fence="true">(</mo><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>2</mn><mn>3</mn></mfrac></mstyle><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mo stretchy="false">(</mo><mi>ρ</mi><mo>∗</mo><msub><mi>ν</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mo>−</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mrow><mo fence="true">(</mo><mi>ρ</mi><mo>∗</mo><msub><mi>ν</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><mo>+</mo><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo stretchy="false">)</mo><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>2</mn><mn>3</mn></mfrac></mstyle><mi>ρ</mi><mo>∗</mo><msub><mi>ν</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mo>−</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mrow><mo fence="true">(</mo><mi>ρ</mi><mo>∗</mo><msub><mi>ν</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><mo>+</mo><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo stretchy="false">)</mo><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>2</mn><mn>3</mn></mfrac></mstyle><mi>ρ</mi><mo>∗</mo><msub><mi>ν</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi mathvariant="bold">u</mi><mo stretchy="false">)</mo><mi mathvariant="bold">I</mi><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mo>−</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mrow><mo fence="true">(</mo><mn>2</mn><mi>ρ</mi><mo>∗</mo><msub><mi>ν</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>2</mn><mn>3</mn></mfrac></mstyle><mi>ρ</mi><mo>∗</mo><msub><mi>ν</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><msub><mi>S</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mo>−</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mrow><mo fence="true">(</mo><mn>2</mn><mi>ρ</mi><mo>∗</mo><mo stretchy="false">(</mo><mi>ν</mi><mo>+</mo><msub><mi>ν</mi><mi>t</mi></msub><mo stretchy="false">)</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>2</mn><mn>3</mn></mfrac></mstyle><mi>ρ</mi><mo>∗</mo><mo stretchy="false">(</mo><mi>ν</mi><mo>+</mo><msub><mi>ν</mi><mi>t</mi></msub><mo stretchy="false">)</mo><msub><mi>S</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mo>−</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mo stretchy="false">(</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{ll} &amp;-\nabla\cdot\left(\rho*\nu_{eff}\left((\nabla\otimes\mathbf{u})^T-\dfrac{2}{3}tr(\nabla\otimes\mathbf{u})^T\right)\right)\\ &amp;-\nabla\cdot(\rho*\nu_{eff}\nabla\otimes\mathbf{u})\\ &amp;=-\nabla\cdot \left( \rho*\nu_{eff}(\nabla\otimes\mathbf{u}+(\nabla\otimes\mathbf{u})^T)-\dfrac{2}{3}\rho*\nu_{eff} tr(\nabla\otimes\mathbf{u})^T \right)\\ &amp;=-\nabla\cdot \left( \rho*\nu_{eff}(\nabla\otimes\mathbf{u}+(\nabla\otimes\mathbf{u})^T)-\dfrac{2}{3}\rho*\nu_{eff}(\nabla \cdot \mathbf{u})\mathbf{I} \right)\\ &amp;=-\nabla\cdot \left( 2\rho*\nu_{eff}S_{ij}-\dfrac{2}{3}\rho*\nu_{eff}S_{kk}\delta_{ij} \right)\\ &amp;=-\nabla\cdot \left( 2\rho*(\nu+\nu_t)S_{ij}-\dfrac{2}{3}\rho*(\nu+\nu_t)S_{kk}\delta_{ij} \right)\\ &amp;=-\nabla\cdot(\tau_{ij}+\Gamma_{ij}) \end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:14.40015em;vertical-align:-6.950075em"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.450074999999999em"><span style="top:-9.450075em"><span class="pstrut" style="height:3.45em"></span><span class="mord"></span></span><span style="top:-7.660044999999999em"><span class="pstrut" style="height:3.45em"></span><span class="mord"></span></span><span style="top:-5.850045em"><span class="pstrut" style="height:3.45em"></span><span class="mord"></span></span><span style="top:-3.4500149999999996em"><span class="pstrut" style="height:3.45em"></span><span class="mord"></span></span><span style="top:-1.0499849999999995em"><span class="pstrut" style="height:3.45em"></span><span class="mord"></span></span><span style="top:1.3500449999999997em"><span class="pstrut" style="height:3.45em"></span><span class="mord"></span></span><span style="top:3.140075em"><span class="pstrut" style="height:3.45em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.950075em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.450074999999999em"><span style="top:-9.450075em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord">−</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.06366em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:-7.660044999999999em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord">−</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mopen">(</span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.06366em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose">)</span></span></span><span style="top:-5.850045em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.06366em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.06366em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:-3.4500149999999996em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.06366em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.06366em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose">)</span><span class="mord"><span class="mord mathbf">I</span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:-1.0499849999999995em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord">2</span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.06366em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.06366em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:1.3500449999999997em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord">2</span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-.06366em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-.06366em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:3.140075em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.950075em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><mo>=</mo><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac></mstyle></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\nabla\otimes\mathbf{u}= \left( \begin{matrix} \dfrac{\partial u}{\partial x}&amp;\dfrac{\partial u}{\partial y}&amp;\dfrac{\partial u}{\partial z}\\ \dfrac{\partial v}{\partial x}&amp;\dfrac{\partial v}{\partial y}&amp;\dfrac{\partial v}{\partial z}\\ \dfrac{\partial w}{\partial x}&amp;\dfrac{\partial w}{\partial y}&amp;\dfrac{\partial w}{\partial z} \end{matrix} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.76666em;vertical-align:-.08333em"></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.44444em;vertical-align:0"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:6.75564em;vertical-align:-3.12782em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.550045em"><span style="top:-.7499750000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎝</span></span></span><span style="top:-1.9049850000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-2.5049950000000005em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-3.1050050000000002em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-3.705015em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-4.305025em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-5.550045em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎛</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.050045em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.62782em"><span style="top:-5.62782em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.37594em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.12406em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.12782em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.62782em"><span style="top:-5.62782em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.37594em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.12406em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.12782em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.62782em"><span style="top:-5.62782em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.37594em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.12406em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.12782em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.550045em"><span style="top:-.7499750000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎠</span></span></span><span style="top:-1.9049850000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-2.5049950000000005em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-3.1050050000000002em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-3.705015em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-4.305025em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-5.550045em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.050045em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>=</mo><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac></mstyle></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">(\nabla\otimes\mathbf{u})^T= \left( \begin{matrix} \dfrac{\partial u}{\partial x}&amp;\dfrac{\partial v}{\partial x}&amp;\dfrac{\partial w}{\partial x}\\ \dfrac{\partial u}{\partial y}&amp;\dfrac{\partial v}{\partial y}&amp;\dfrac{\partial w}{\partial y}\\ \dfrac{\partial u}{\partial z}&amp;\dfrac{\partial v}{\partial z}&amp;\dfrac{\partial w}{\partial z} \end{matrix} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913309999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:6.36676em;vertical-align:-2.93338em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25004em"><span style="top:-1.0499800000000006em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎝</span></span></span><span style="top:-2.2049900000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-2.805em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-3.4050100000000003em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-4.00502em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-5.250039999999999em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎛</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75004em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.43338em"><span style="top:-5.43338em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.3759399999999995em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.1240599999999996em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.93338em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.43338em"><span style="top:-5.43338em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.3759399999999995em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.1240599999999996em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.93338em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.43338em"><span style="top:-5.43338em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.3759399999999995em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.1240599999999996em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.93338em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25004em"><span style="top:-1.0499800000000006em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎠</span></span></span><span style="top:-2.2049900000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-2.805em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-3.4050100000000003em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-4.00502em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-5.250039999999999em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75004em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><mo stretchy="false">)</mo><mo>=</mo><mi>t</mi><mi>r</mi><mrow><mo fence="true">(</mo><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>k</mi></msub></mrow></mfrac><mo>=</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi mathvariant="bold">u</mi><mo>=</mo><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">tr(\nabla\otimes\mathbf{u})=tr\left((\nabla\otimes\mathbf{u})^T\right)=\dfrac{\partial u_k}{\partial x_k}=\nabla \cdot \mathbf{u}=tr(S_{ij})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.2413409999999998em;vertical-align:-.35001em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">(</span></span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913309999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.44444em;vertical-align:0"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>strain rate <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">S_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> :</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>j</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo fence="true">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><mo>+</mo><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">S_{ij}=\frac{1}{2}( \frac{ \partial u_i }{ \partial x_j } + \frac {\partial u_j }{ \partial x_i } )=\dfrac{1}{2}\left(\nabla\otimes\mathbf{u}+(\nabla\otimes\mathbf{u})^T\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">(</span></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913309999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">)</span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo stretchy="false">(</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle><mo>+</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo stretchy="false">(</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac></mstyle><mo>+</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo stretchy="false">(</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac></mstyle><mo>+</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mn>31</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mn>32</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac></mstyle></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">S_{ij}= \left( \begin{matrix} \dfrac{\partial u}{\partial x}&amp;\dfrac{1}{2}(\dfrac{\partial u}{\partial y}+\dfrac{\partial v}{\partial x})&amp;\dfrac{1}{2}(\dfrac{\partial u}{\partial z}+\dfrac{\partial w}{\partial x})\\ S_{21}&amp;\dfrac{\partial v}{\partial y}&amp;\dfrac{1}{2}(\dfrac{\partial v}{\partial z}+\dfrac{\partial w}{\partial y})\\ S_{31}&amp;S_{32}&amp;\dfrac{\partial w}{\partial z} \end{matrix} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:6.60009em;vertical-align:-3.050045em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.550045em"><span style="top:-.7499750000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎝</span></span></span><span style="top:-1.9049850000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-2.5049950000000005em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-3.1050050000000002em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-3.705015em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-4.305025em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-5.550045em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎛</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.050045em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5305999999999997em"><span style="top:-5.5306em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.27872em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-1.02684em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.0305999999999997em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5305999999999997em"><span style="top:-5.5306em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span style="top:-3.27872em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.02684em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.0305999999999997em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5305999999999997em"><span style="top:-5.5306em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span style="top:-3.27872em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span style="top:-1.02684em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.0305999999999997em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.550045em"><span style="top:-.7499750000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎠</span></span></span><span style="top:-1.9049850000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-2.5049950000000005em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-3.1050050000000002em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-3.705015em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-4.305025em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-5.550045em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.050045em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">S_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 是对称矩阵，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mn>12</mn></msub><mo>=</mo><msub><mi>S</mi><mn>21</mn></msub><mo separator="true">,</mo><mtext> </mtext><msub><mi>S</mi><mn>13</mn></msub><mo>=</mo><msub><mi>S</mi><mn>31</mn></msub><mo separator="true">,</mo><mtext> </mtext><msub><mi>S</mi><mn>23</mn></msub><mo>=</mo><msub><mi>S</mi><mn>32</mn></msub></mrow><annotation encoding="application/x-tex">S_{12}=S_{21},\ S_{13}=S_{31},\ S_{23} = S_{32}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8777699999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace"> </span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8777699999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace"> </span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>。</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>S</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>k</mi></msub></mrow></mfrac></mstyle><mo>=</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi mathvariant="bold">u</mi></mrow><annotation encoding="application/x-tex">tr(S_{ij})=S_{kk}=\dfrac{\partial u_k}{\partial x_k}=\nabla\cdot \mathbf{u}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.44444em;vertical-align:0"></span><span class="mord"><span class="mord mathbf">u</span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">S_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 在代码中是：<code>symm(fvc::grad(U))</code>，其中 <code>symm(tensor) = 1/2*(tensor + T(tensor))</code>。</p><p>deformation rate tensor <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>S</mi><mn>11</mn></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mo stretchy="false">(</mo><msub><mi>S</mi><mn>11</mn></msub><mo>+</mo><msub><mi>S</mi><mn>22</mn></msub><mo>+</mo><msub><mi>S</mi><mn>33</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mn>12</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mn>13</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>S</mi><mn>22</mn></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mo stretchy="false">(</mo><msub><mi>S</mi><mn>11</mn></msub><mo>+</mo><msub><mi>S</mi><mn>22</mn></msub><mo>+</mo><msub><mi>S</mi><mn>33</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mn>23</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mn>31</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mn>32</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>S</mi><mn>33</mn></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mo stretchy="false">(</mo><msub><mi>S</mi><mn>11</mn></msub><mo>+</mo><msub><mi>S</mi><mn>22</mn></msub><mo>+</mo><msub><mi>S</mi><mn>33</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi mathvariant="bold">u</mi><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{ll} &amp;D_{ij}= S_{ij}-\frac{1}{3}tr(S_{ij})\\ &amp;= \left( \begin{matrix} S_{11}-\frac{1}{3}(S_{11}+S_{22}+S_{33}) &amp; S_{12} &amp; S_{13} \\ S_{21} &amp; S_{22}-\frac{1}{3}(S_{11}+S_{22}+S_{33}) &amp; S_{23} \\ S_{31} &amp; S_{32} &amp; S_{33}-\frac{1}{3}(S_{11}+S_{22}+S_{33}) \end{matrix} \right) \\ &amp;=S_{ij}-\frac{1}{3}\nabla\cdot \mathbf{u} \delta_{ij} \end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.02554em;vertical-align:-2.76277em"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.26277em"><span style="top:-6.475324em"><span class="pstrut" style="height:4.057662em"></span><span class="mord"></span></span><span style="top:-4.0576620000000005em"><span class="pstrut" style="height:4.057662em"></span><span class="mord"></span></span><span style="top:-1.6548919999999996em"><span class="pstrut" style="height:4.057662em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.76277em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.26277em"><span style="top:-6.475324em"><span class="pstrut" style="height:4.057662em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-4.0576620000000005em"><span class="pstrut" style="height:4.057662em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em"><span style="top:-2.2500000000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎝</span></span></span><span style="top:-4.05002em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎛</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0576619999999997em"><span style="top:-4.212554em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.0074459999999994em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-1.8023379999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5576620000000005em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0576619999999997em"><span style="top:-4.212554em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.0074459999999994em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-1.8023379999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5576620000000005em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0576619999999997em"><span style="top:-4.212554em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.0074459999999994em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-1.8023379999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5576620000000005em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em"><span style="top:-2.2500000000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎠</span></span></span><span style="top:-4.05002em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em"><span></span></span></span></span></span></span></span></span></span><span style="top:-1.6548919999999996em"><span class="pstrut" style="height:4.057662em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.76277em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 在代码中是：<code>dev(symm(fvc::grad(U)))</code>，也就是 <code>dev(S_{ij})</code>。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">Cmpt</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Tensor</span> &lt;Cmpt&gt; <span class="title">dev</span>(<span class="title">const</span> <span class="title">Tensor</span> &lt;Cmpt &gt;&amp; <span class="title">t</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">return</span> t - SphericalTensor &lt;Cmpt &gt;::oneThirdsI*tr(t);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">Cmpt</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Tensor</span> &lt;Cmpt&gt; <span class="title">dev2</span>(<span class="title">const</span> <span class="title">Tensor</span> &lt;Cmpt &gt;&amp; <span class="title">t</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">return</span> t - SphericalTensor &lt;Cmpt &gt;::twoThirdsI*tr(t);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>参考文献：<br>Tobias Holzmann. Mathematics, Numerics, Derivations and OpenFOAM®, Holzmann CFD,<br>URL <a href="http://www.holzmann-cfd.de" target="_blank" rel="external nofollow noopener noreferrer">www.holzmann-cfd.de</a>, DOI: 10.13140/RG.2.2.27193.36960.</p><p>以下公式适用于可压缩流动：</p><p>Cauchy stress tensor <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>σ</mi><mo>=</mo><mi>σ</mi><mo>=</mo><mo>−</mo><mi>p</mi><mi mathvariant="bold">I</mi><mo>+</mo><mo stretchy="false">[</mo><mi>σ</mi><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">)</mo><mi mathvariant="bold">I</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbf{\sigma}=\mathbf{\sigma}=-p\mathbf{I}+[\mathbf{\sigma}-\frac{1}{3}tr(\mathbf{\sigma})\mathbf{I}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8805499999999999em;vertical-align:-.19444em"></span><span class="mord">−</span><span class="mord mathdefault">p</span><span class="mord"><span class="mord mathbf">I</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span class="mclose">)</span><span class="mord"><span class="mord mathbf">I</span></span><span class="mclose">]</span></span></span></span></p><p>shear−rate tensor <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>τ</mi><mo>=</mo><mi>σ</mi><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">)</mo><mi mathvariant="bold">I</mi><mo>=</mo><msup><mi>σ</mi><mrow><mi>d</mi><mi>e</mi><mi>v</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{\tau}=\mathbf{\sigma}-\frac{1}{3}tr(\mathbf{\sigma})\mathbf{I}=\mathbf{\sigma}^{dev}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span class="mclose">)</span><span class="mord"><span class="mord mathbf">I</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.849108em;vertical-align:0"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.849108em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:.03588em">v</span></span></span></span></span></span></span></span></span></span></span></span></p><p>即：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>σ</mi><mo>=</mo><mo>−</mo><mi>p</mi><mi mathvariant="bold">I</mi><mo>+</mo><mi>τ</mi></mrow><annotation encoding="application/x-tex">\mathbf{\sigma}=-p\mathbf{I}+\mathbf{\tau}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8805499999999999em;vertical-align:-.19444em"></span><span class="mord">−</span><span class="mord mathdefault">p</span><span class="mord"><span class="mord mathbf">I</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span></span></span></span></span></p><p>Reynolds-Stress tensor<br><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mi>t</mi></msub><mo>=</mo><mo>−</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><mrow><msubsup><mi>u</mi><mi>i</mi><mo mathvariant="normal">′</mo></msubsup><msubsup><mi>u</mi><mi>j</mi><mo mathvariant="normal">′</mo></msubsup></mrow><mo stretchy="true">~</mo></mover></mrow><annotation encoding="application/x-tex">\overline \mathbf{\sigma}_t=-\bar\rho \widetilde {u&#x27;_iu_j&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.78056em;vertical-align:-.15em"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.432664em;vertical-align:-.4129719999999999em"></span><span class="mord">−</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.019692em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.27686399999999994em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.733692em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span></span></span></span></p><p>Boussinesq 假设：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mi>t</mi></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><msub><mi>μ</mi><mi>t</mi></msub><mover accent="true"><mi mathvariant="bold">D</mi><mo>ˉ</mo></mover><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mover accent="true"><mi mathvariant="bold">D</mi><mo>ˉ</mo></mover><mo stretchy="false">)</mo><mi mathvariant="bold">I</mi></mrow><annotation encoding="application/x-tex">\overline \mathbf{\sigma}_t-\frac{1}{3}tr(\overline \mathbf{\sigma}_t)=2\mu_t \bar \mathbf{D}-\frac{2}{3}tr(\bar \mathbf{D})\mathbf{I}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.78056em;vertical-align:-.15em"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.0173299999999998em;vertical-align:-.19444em"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8228899999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">D</span></span></span><span style="top:-3.25511em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8228899999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">D</span></span></span><span style="top:-3.25511em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em">ˉ</span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathbf">I</span></span></span></span></span></span></p><p>这里的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi mathvariant="bold">D</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar \mathbf{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8228899999999999em;vertical-align:0"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8228899999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">D</span></span></span><span style="top:-3.25511em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em">ˉ</span></span></span></span></span></span></span></span></span> 是变形速率张量，deformation rate tensor，一般也称为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">S_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mo>−</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><mrow><msubsup><mi>u</mi><mi>i</mi><mo mathvariant="normal">′</mo></msubsup><msubsup><mi>u</mi><mi>j</mi><mo mathvariant="normal">′</mo></msubsup></mrow><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mo>−</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><mrow><msup><mi>u</mi><mo mathvariant="normal">′</mo></msup><msup><mi>u</mi><mo mathvariant="normal">′</mo></msup></mrow><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mo>−</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><mrow><msup><mi>v</mi><mo mathvariant="normal">′</mo></msup><msup><mi>v</mi><mo mathvariant="normal">′</mo></msup></mrow><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mo>−</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><mrow><msup><mi>w</mi><mo mathvariant="normal">′</mo></msup><msup><mi>w</mi><mo mathvariant="normal">′</mo></msup></mrow><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mn>2</mn><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mi mathvariant="bold">I</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">tr(\overline \mathbf{\sigma}_t)=tr(-\bar\rho \widetilde {u&#x27;_iu_j&#x27;}) =(-\bar\rho \widetilde {u&#x27;u&#x27;})+(-\bar\rho \widetilde {v&#x27;v&#x27;})+(-\bar\rho \widetilde {w&#x27;w&#x27;})=-2\bar\rho \mathbf{I}k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.432664em;vertical-align:-.4129719999999999em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord">−</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.019692em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.27686399999999994em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.733692em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.213892em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.963892em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6778919999999999em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6778919999999999em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.677892em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.213892em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.963892em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6778919999999999em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6778919999999999em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.677892em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.213892em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.963892em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6778919999999999em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6778919999999999em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.677892em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord">−</span><span class="mord">2</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">I</span></span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span></span></p><p>故雷诺应力可以写为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mi>t</mi></msub><mo>=</mo><mn>2</mn><msub><mi>μ</mi><mi>t</mi></msub><mover accent="true"><mi mathvariant="bold">D</mi><mo>ˉ</mo></mover><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mover accent="true"><mi mathvariant="bold">D</mi><mo>ˉ</mo></mover><mo stretchy="false">)</mo><mi mathvariant="bold">I</mi><mo>+</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><msub><mi>μ</mi><mi>t</mi></msub><mover accent="true"><mi mathvariant="bold">D</mi><mo>ˉ</mo></mover><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mover accent="true"><mi mathvariant="bold">D</mi><mo>ˉ</mo></mover><mo stretchy="false">)</mo><mi mathvariant="bold">I</mi><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mi mathvariant="bold">I</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">\overline \mathbf{\sigma}_t=2\mu_t \bar \mathbf{D}-\frac{2}{3}tr(\bar \mathbf{D})\mathbf{I}+\frac{1}{3}tr(\overline \mathbf{\sigma}_t) =2\mu_t \bar \mathbf{D}-\frac{2}{3}tr(\bar \mathbf{D})\mathbf{I}-\frac{2}{3}\bar\rho \mathbf{I}k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.78056em;vertical-align:-.15em"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.0173299999999998em;vertical-align:-.19444em"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8228899999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">D</span></span></span><span style="top:-3.25511em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8228899999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">D</span></span></span><span style="top:-3.25511em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em">ˉ</span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathbf">I</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.0173299999999998em;vertical-align:-.19444em"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8228899999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">D</span></span></span><span style="top:-3.25511em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8228899999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">D</span></span></span><span style="top:-3.25511em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em">ˉ</span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathbf">I</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">I</span></span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>τ</mi><mo stretchy="true">‾</mo></mover><mi>t</mi></msub><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mi mathvariant="bold">I</mi><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mn>2</mn><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mi mathvariant="bold">I</mi><mi>k</mi><mspace linebreak="newline"></mspace><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mn>2</mn><msub><mi>μ</mi><mi>t</mi></msub><mover accent="true"><mi mathvariant="bold">D</mi><mo>ˉ</mo></mover><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><msub><mi>μ</mi><mi>t</mi></msub><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mi mathvariant="bold">D</mi><mo stretchy="false">)</mo><mi mathvariant="bold">I</mi><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mi mathvariant="bold">I</mi><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mn>2</mn><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mi mathvariant="bold">I</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">tr(\overline \mathbf{\sigma}_t)=tr(\overline \mathbf{\tau}_t-\frac{2}{3}\bar\rho \mathbf{I}k)=-2\bar\rho \mathbf{I}k\\ tr(\overline \mathbf{\sigma}_t)=tr(2\mu_t\bar \mathbf{D}-\frac{2}{3}\mu_ttr(\mathbf{D})\mathbf{I}-\frac{2}{3}\bar\rho \mathbf{I}k)=-2\bar\rho \mathbf{I}k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">I</span></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord">−</span><span class="mord">2</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">I</span></span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.07289em;vertical-align:-.25em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8228899999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">D</span></span></span><span style="top:-3.25511em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">D</span></span><span class="mclose">)</span><span class="mord"><span class="mord mathbf">I</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">I</span></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord">−</span><span class="mord">2</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">I</span></span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span></span></p><h2 id="对于-rans"><a class="markdownIt-Anchor" href="#对于-rans"></a> 对于 RANS</h2><p>速度输运方程：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo stretchy="false">(</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{ \partial }{ \partial t }( \bar\rho\widetilde{u_i} ) + \frac{ \partial\bar\rho\widetilde{u_i}\widetilde{u_j} }{ \partial x_j } = \frac{ \partial \overline \sigma _{ij} }{ \partial x_j } + \frac{ \partial }{ \partial x_j}( \Gamma_{ij} )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>这里的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\Gamma_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 对应上文中的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>σ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\sigma_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>。</p><p>最后变形为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo stretchy="false">(</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>p</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>−</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mrow><mo fence="true">(</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>k</mi><mo fence="true">)</mo></mrow><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mrow><mo fence="true">[</mo><mn>2</mn><mo stretchy="false">(</mo><mi>μ</mi><mo>+</mo><msub><mi>μ</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>k</mi></msub></mrow></mfrac><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{ \partial }{ \partial t }( \bar\rho\widetilde{u_i} ) + \frac{ \partial\bar\rho\widetilde{u_i}\widetilde{u_j} }{ \partial x_j } = -\frac{\partial p}{\partial x_i} -\frac{\partial}{\partial x_j}\left(\frac{2}{3}\bar\rho \delta_{ij}k\right) +\frac{\partial}{\partial x_j}\left[2(\mu+\mu_t)(S_{ij}-\frac{\partial u_k}{\partial x_k}\delta_{ij})\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.4221079999999997em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.4221079999999997em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">[</span></span><span class="mord">2</span><span class="mopen">(</span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p><p>OF 速度输运方程代码里边并没有包含 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span> 这一项，因此代码里的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault">p</span></span></span></span> 并不是真正的压力，而是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>+</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mi>ρ</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">p+\frac{2}{3}\rho k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">ρ</span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span>。Page 76 in the book of Tobias.</p><h2 id="对于-les"><a class="markdownIt-Anchor" href="#对于-les"></a> 对于 LES</h2><p>速度输运方程：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo stretchy="false">(</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>−</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{ \partial }{ \partial t }( \bar\rho\widetilde{u_i} ) + \frac{ \partial\bar\rho\widetilde{u_i}\widetilde{u_j} }{ \partial x_j } = \frac{ \partial \overline \sigma _{ij} }{ \partial x_j } - \frac{ \partial }{ \partial x_j}( \Gamma_{ij} )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>Boussinesq 假设：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><msub><mi mathvariant="normal">Γ</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo>−</mo><mn>2</mn><msub><mi>μ</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mover accent="true"><msub><mi>S</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo stretchy="true">~</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Gamma_{ij}-\frac{1}{3}\Gamma_{kk}\delta_{ij}=-2\mu_t(\widetilde{S_{ij}}-\frac{1}{3}\widetilde{S_{kk}}\delta_{ij})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.229438em;vertical-align:-.286108em"></span><span class="mord">−</span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>LES 中有 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi mathvariant="normal">Γ</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo>=</mo><mn>2</mn><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mi>k</mi></mrow><annotation encoding="application/x-tex">tr(\Gamma_{ij})=\Gamma_{kk}=2\bar\rho k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord">2</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span></p><p>因此：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo>−</mo><mn>2</mn><msub><mi>μ</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mover accent="true"><msub><mi>S</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo stretchy="true">~</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mi>k</mi><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\Gamma_{ij}=-2\mu_t(\widetilde{S_{ij}}-\frac{1}{3}\widetilde{S_{kk}}\delta_{ij})-\frac{2}{3}\bar\rho k \delta_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.229438em;vertical-align:-.286108em"></span><span class="mord">−</span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></span></p><p>速度输运方程可以变形为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo stretchy="false">(</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>p</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mrow><mo fence="true">(</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>k</mi><mo fence="true">)</mo></mrow><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mrow><mo fence="true">[</mo><mn>2</mn><mo stretchy="false">(</mo><mi>μ</mi><mo>+</mo><msub><mi>μ</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>k</mi></msub></mrow></mfrac><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{ \partial }{ \partial t }( \bar\rho\widetilde{u_i} ) + \frac{ \partial\bar\rho\widetilde{u_i}\widetilde{u_j} }{ \partial x_j } = -\frac{\partial p}{\partial x_i} +\frac{\partial}{\partial x_j}\left(\frac{2}{3}\bar\rho \delta_{ij}k\right) +\frac{\partial}{\partial x_j}\left[2(\mu+\mu_t)(S_{ij}-\frac{\partial u_k}{\partial x_k}\delta_{ij})\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.4221079999999997em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.4221079999999997em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">[</span></span><span class="mord">2</span><span class="mopen">(</span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p><p>那么按照 Tobias 的说法，OF 速度输运方程代码里边并没有包含 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span> 这一项，因此代码里的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault">p</span></span></span></span> 并不是真正的压力，而是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mi>ρ</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">p-\frac{2}{3}\rho k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">ρ</span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span>？</p><p>按照上边的观点，OF代码中的 p 其实并不是真实的压力，那么它怎么能用于气体状态方程呢？这个问题是论坛里网友提出来的：<a href="https://www.cfd-online.com/Forums/openfoam-solving/193246-favre-reynolds-average-openfoam.html#3" target="_blank" rel="external nofollow noopener noreferrer">cfd-online</a>。</p><p>其实最简单的就是把缺失的那个 k 补上，为什么大家不这么做呢？看看网上的讨论。<br><a href="https://www.cfd-online.com/Forums/openfoam-solving/58214-calculating-divdevreff.html" target="_blank" rel="external nofollow noopener noreferrer">https://www.cfd-online.com/Forums/openfoam-solving/58214-calculating-divdevreff.html</a></p><h2 id="一些矢量和张量的操作"><a class="markdownIt-Anchor" href="#一些矢量和张量的操作"></a> 一些矢量和张量的操作</h2><p>LES 中经常出现的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><mover accent="true"><mi>S</mi><mo>~</mo></mover><mi mathvariant="normal">∣</mi><mo>=</mo><msqrt><mrow><mn>2</mn><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover></mrow></msqrt></mrow><annotation encoding="application/x-tex">|\tilde S|=\sqrt{2\widetilde{S_{ij}}\widetilde{S_{ij}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1701899999999998em;vertical-align:-.25em"></span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9201899999999998em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em">S</span></span><span style="top:-3.6023300000000003em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">~</span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.84em;vertical-align:-.526389em"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.313611em"><span class="svg-align" style="top:-3.8em"><span class="pstrut" style="height:3.8em"></span><span class="mord" style="padding-left:1em"><span class="mord">2</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span style="top:-3.273611em"><span class="pstrut" style="height:3.8em"></span><span class="hide-tail" style="min-width:1.02em;height:1.8800000000000001em"><svg width="400em" height="1.8800000000000001em" viewbox="0 0 400000 1944" preserveaspectratio="xMinYMin slice"><path d="M1001,80H400000v40H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5c53.7,-170.3,84.5,-266.8,92.5,-289.5c4,-6.7,10,-10,18,-10zM1001 80H400000v40H1013z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.526389em"><span></span></span></span></span></span></span></span></span>，用代码表示是：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">volSymmTensorField Sij = symm(fvc::grad(U));</span><br><span class="line">volScalarField magSij = <span class="built_in">sqrt</span>(<span class="number">2</span>*(Sij &amp;&amp; Sij));</span><br></pre></td></tr></table></figure><p>这里的 <code>&amp;&amp;</code> 的操作是缩并，也叫双内积，两个二阶张量的缩并是一个标量。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//- Double-dot-product between a symmetric tensor and a symmetric tensor</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Cmpt</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Cmpt</span></span></span><br><span class="line"><span class="class"><span class="title">operator</span>&amp;&amp;(<span class="title">const</span> <span class="title">SymmTensor</span>&lt;Cmpt&gt;&amp; <span class="title">st1</span>, <span class="title">const</span> <span class="title">SymmTensor</span>&lt;Cmpt&gt;&amp; <span class="title">st2</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">    (</span><br><span class="line">        st1.xx()*st2.xx() + <span class="number">2</span>*st1.xy()*st2.xy() + <span class="number">2</span>*st1.xz()*st2.xz()</span><br><span class="line">                          +   st1.yy()*st2.yy() + <span class="number">2</span>*st1.yz()*st2.yz()</span><br><span class="line">                                                +   st1.zz()*st2.zz()</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>&amp;</code> 是内积，也叫数量积，也叫点乘，两个矢量的内积是一个标量。<br><code>^</code> 是叉乘，两个矢量的叉乘，仍旧是一个矢量。在三维几何中，向量a和向量b的叉乘结果是一个向量，更为熟知的叫法是法向量，该向量垂直于a和b向量构成的平面。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Cmpt</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Vector</span>&lt;Cmpt&gt; <span class="title">operator</span>^(<span class="title">const</span> <span class="title">Vector</span>&lt;Cmpt&gt;&amp; <span class="title">v1</span>, <span class="title">const</span> <span class="title">Vector</span>&lt;Cmpt&gt;&amp; <span class="title">v2</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">return</span> Vector&lt;Cmpt&gt;</span><br><span class="line">    (</span><br><span class="line">        (v1.y()*v2.z() - v1.z()*v2.y()),</span><br><span class="line">        (v1.z()*v2.x() - v1.x()*v2.z()),</span><br><span class="line">        (v1.x()*v2.y() - v1.y()*v2.x())</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>外积 <code>a*b</code>，也叫量积（tensor-product），两个矢量可以形成一个二阶张量。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Cmpt</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">typename</span> <span class="title">outerProduct</span>&lt;Vector&lt;Cmpt&gt;, Vector&lt;Cmpt&gt;&gt;:</span>:type</span><br><span class="line"><span class="keyword">operator</span>*(<span class="keyword">const</span> Vector&lt;Cmpt&gt;&amp; v1, <span class="keyword">const</span> Vector&lt;Cmpt&gt;&amp; v2)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> Tensor&lt;Cmpt&gt;</span><br><span class="line">    (</span><br><span class="line">        v1.x()*v2.x(), v1.x()*v2.y(), v1.x()*v2.z(),</span><br><span class="line">        v1.y()*v2.x(), v1.y()*v2.y(), v1.y()*v2.z(),</span><br><span class="line">        v1.z()*v2.x(), v1.z()*v2.y(), v1.z()*v2.z()</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>q</mi><mi>r</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>u</mi><mi>i</mi></msub><msub><mi>u</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">sqr(U)=u_iu_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:.03588em">q</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.10903em">U</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></span></p><p>这个全局函数没看懂什么意思：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Cmpt</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Vector</span>&lt;Cmpt&gt; <span class="title">perpendicular</span>(<span class="title">const</span> <span class="title">Vector</span>&lt;Cmpt&gt;&amp; <span class="title">v</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function">Vector&lt;Cmpt&gt; <span class="title">u</span><span class="params">(Zero)</span></span>;</span><br><span class="line">    u[findMin(cmptMag(v))] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> u ^ v;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TurbulenceModels </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>fvMesh 简单分析（待补充）</title>
      <link href="/fvMesh/"/>
      <url>/fvMesh/</url>
      
        <content type="html"><![CDATA[<p>无摘要</p><a id="more"></a> <img src="http://www.plantuml.com/plantuml/svg/jLXRRzis57xFh-1U0dlpslIrwGeuJhCPQ1DZJZ9WBmKZ7Kj4AL8bAQVPiF--Gqgs9PcIc3ZEInBnE_SBp-59nAdM95SiOuQjuGlezDyJWZzVlnBx3z7i7o0vLJG30qhZTtVy2nES2I2SFW0dOY6PC7eq9f4Ksfpx89_Y1FeHSu4I1ELND1f03YDcm7cOj03LDz2pS1lUXKCzI7J-OXCIajamnDJGhU_NJ9c2yfA2vDQ0AmOyFYt_tZ8Zlv6pSn_92lttcMbpwluQnZkDTmGtZmBKSuckWINfWoo62Ui6IHulEcn29rs2GW_57XULs0YpO9dIl39s-syxC2KQC10b4BmX-HDCeKGf34y4H1WVPfvQGhTsxuJwij4BjeA3mSvFtMWhUAT2i7XVRNMB3qPR7NmruGNRV0a6EpsUX_RMVAVQFZIcm-yWiISg5fMPDrBqyQTnAnVMc2DILRbSPe8mgaFJ1jYwe0-i8yffdVEzv4KModcgWEwWfD7nCscO55j3J9P_g0dxYEThg5pYQK0JVmsFpmbfrP5H1H2s8WcMi71QLPsHQSAgtaYC92QjUY2IjduQRVL1IajRlqL6jPWw2NCHmuzs86zbBhbCM6GxK0hHDxtNQHrlTtQNvw1k5QCYAT0dbGHthY2NoZQe5UKQ9axg7rIdIp0_4mrcOHGUYeBptAXccFRbkBh-c-Lt-T54M0_TWpBCbl2nX3GovJWsb3teLIGqodem5sPSQeWlP25YgfwwDHWFXDgnAHlvIwre7QTurqvrZcM_R0DB2VUk8tnmL1zFYSRcOQl-4e6De_VlfO2G89GTvPZLi6bmnqob6sLIcKXi7tYl7rNIuWb7QXRtcLDlz2HZ0adG1tZygyuevw-WnF8Ru2YdZ-lJgKWuXDj9VooPmBDtPnFBzErRCXSaXaG1w5Ve5PmQlyLDDHwf4Xlin6dnLugt55v7J4IyYF7c4bQ1DpwLWdhYDQ2804tARvSuZIo_gmF3OQUapo0Iamv9nNH3uE4IPr94T0s7DRTsY-vfoTLTtjUC1pIk-ly17EmK5Kgj3SNxT-DrDBoy36vJdFjI79n6zQYCkuZALlzCecifRBjx9fLj6Rqa69yx3Qk2Oz6MsnaJAxaDcVE8cmxdRac_kAXFaNQ0BASrEzAoIIKNEM0julrqfMZafbFS0fkERFDjSoKrjatAQZfa8hOb2ThiatCPEV5TX84Kw9ebNgqqmO6M2loLuO2_IsR9OliI8yoKEtA8_Uy7pjIKwbdNEjl2zJn5r5drF9dKEGN05bsBgKTgWCIUrvw6n03Sh6CBRS6kElPFdzHGNDyxKrszK9n_EVGO4WISTMwG7ewjxN6xYEsz--pUFkgBM5dQbqy21w380ZTZQEy-tiijWBAnY1okI1Ux0TBQcqsTr7r-YIgz_49eFNOSfamdmm7YtPjFUsb_YIezt0OeTszWTKhxTVu2FNgu1L3k1_OGFJgu1IJxlYSFAPqERgsnojw64SSRsGvae_7UvsaSOrVJJ2IUmvl2sA__dVmF"> <img src="http://www.plantuml.com/plantuml/svg/jHhBRjiwTk-lu6o4D7MBp68siMiWTPBMG18RiPiBpCQW9ThML185adAQc-RVxo4fIYH5EqwAwS8nUHuy3vuNtP9cJxU4Rz7mzwTFQBsJttjPKlbxgCShjiOncHI2i99cMAIqS37Mktcy9JdXdMsQLLtq10lixg1Ud67Ew_Lp3y6_vHBDMBh3WY15i5ogxK_htLTQ5GbcMlnLlLWED3Yl15vbf6PrarGNIS88vscnEKMWtqmm7pN3AvAXk6ABD0Sr4_BBnzZHD3b53m7QIo0fEAX8akkKPCcGnpZ3h0yacHHW16HdxwKB4V8iZKaorpvv8B6WJ34uHVDr25qZpXNt6Z77cp2kOlr0CuVj-4r2Z8yLejocBQRbwrkIhmX3rrKHovl36xzB7w0u8vXz8pI_esAQILbFFWmiU5N2NI4741e6WUtsffp4SBA0kqKpb7BfZn-ACVg2rZZZnA7be3sfpz9ql5KqSb1p_9FCroSVaCBp8RVIB_k0uxq0ZqJQibg1Wv1uAab2req9FzOR9kpany27EC5bBnhk5t4CLcgOQfLbw4H8mAUHvfaHKR42bNMYEJ_NqC6BfjkbJ5GuqyY8hlu7r-YUR58ks1DmsgRySdM0Lmqtt3INHygI21Nua1GQwjAvQaTDKd4jwucSsRabCiiz901L2LJ60TnxVWDwejJiS5_SLe3FDf9lkpfpqJpVhw-6klegkXzIXWZHnu8mdxnHvdD67mdJt_VpA4YwsOBC1_XKPHdcysecZD23PzJZ2S_UJ-cJYhmSlaeuGWyyVZTXM5hUIRCHylE4YsebsaXd-wEn8Iq7SNTELOZG-6XH_VoaxD557A64P0Bxk2GleUCWGzqVB21DZMIkaa6CoWN3gU13jNj-hYwa_8vsE4kJCSrBi7SXU2S_NYMfQF9Nc_-dbJ1LeOamgwf8FzK9FiVbh0umC72P-rHAnTQi8vJJ7PdHL0gZEPHouLG8zqWuGK7vQoTAP4Oa_-icYJLQX3pCYPX99zSeHyG2KCX0Qipt5qkX53RsgyLMnV9HWgOgbvzCff3A2SxFp_NVQyfo3Bas5_qMj2DC7dvNgQeFAmi6cQjKwPKMogrnNlQjmgoy7CwshImdFW6KSC4gub-9kksOGfB2S2NRygOeQRtzhoydfc0eJxYdEwXVzg2YtaklrtFBdMw6JShkbIpDKv7kIDkBDx2wKJRhPw_agqvP1aYh02cg76u8JdGBCnVmyVpZRlpzukxRrML_DftSBURBs-a3B1RJsNIf8Vhxx68n_bxll0miXZ79iaiYFKHvAXkrv-kByTLoTdDnTpNlg-_Zgxl5_TLoSJ-fDoud5z_qSdnrSxDSN2tcBrRxftL6kLJQwVXLh4ocwdhgmE6cmvItMmOwZW51rLHLAGrOfOGQeEfS2D0KBmDKVbGPWIIDNDnlQgKB3auYQlsL_j80LoPLitsEEXiE5S88RQ199OAbyULXF5xFM1qqN0aAhSRGqdM4115VCOSMPC83ZReXIUKGH99f3958XlBZ4Xmo1fz3ePAkNy2Mqxx_bnRG1K57irPHBcS-ntq0rzUvMJa-RC1cqK3bQGtKBBWrDs26immiAezkplGLscHqXLK-aug0SPsreuawAATA1KPayKdSwwYk1oHSqDUvCOAMTBp5nSO2T4RCMyLuxw1fv6tBmmZHBD6buntpKbgaGjKjPmnfTgKzTGSNk-CGpkBBb17DCZHvI0nv7-PRN18V8tZpP0fQjBVlpKEBINcXiQKJYy71fM798GV2KN9QWAvZZQjCfM9Q3BfmcOxcrGgiqV2HLsO5QdHAO9tmqupSOJaE9PBCwsWCL37kWdqMEjrDO1CNCNa5MUM-FRXwL2MY0Nl47_RDTwvoLjzIotPoe0HNvOA2jTpMXv7DPAeBO8HI6YOtulvmEHn5Msi6nj1tsvcmmgESlAWjyjGUYOuXkFFddy5hjck2EkXI_pwt4waEvl2mk7G7ArD_QkBmZCaz8gUsH5OHykJK2QtujWyUvDQKgZ2p-HwmPNATJ2AxZ0MH3nImg2bWUqnlLQl8AbVT2RijPEvZWbNFehQW-VHMfNF8xO8NjHNF9xTAeKFkLhQeNillGQFRRmSs8AeXZcsEUwGvbTk3br0z3SuCoHDCSsdSjK_6YT7Dgha-dgd40Kohzyy_FEk_Pp0069BwhzmP66vd3YExfli7k_L-BvKbH5mB4KiXN79d1T3O21Ix0iLxX36s-VtR5Tb_CNhVPAg7J4Z7kdtfrEu5d9dHJHhZMiAsDXw8fmEHj3U63aJFlhZP7p5ABvmaCopYBJ46a1bcA3EmsZuTHPsXqwHcCqiEN7RwN8TPhI0mG-NVVGjaz92GjGCnuaf8_BV_IE0DTDRwJvymsWS5_pa173s7T8x1kpaku4zEYj0xYlsy_l4FdjVtFSqqk-rm5W0wlMO7EcvgGE0X1NeYxlT7K59qumGzMw2piYdzw6YA9CG6YN_oS1fKi6lPVJ2nfHjQm4qJJxQf62af4yP8VPMdlsDeJuauLSywWW6mgBAi5En0LzQSDFz9eDFX_Fzso5Mo8HTPkYdaJUcUqWzs2KapU0HFV-tCiNgP48JbQO63fxw7gxoaTVBhDdC5UTGfjB_Va1Oa8GB3HKdk7OnZ7FQNx3Ft6r8dTWIAQqHWVVRvx3z_wCG7cjtBYVw8OnMUFlNVRpbLZd_rEn8WOXPlqTeVQ7MShQ6panw-Lh-ZsBw0pDethGiWf6O1hQ94jjSpaGP2MB9UQEI6SzqaANxXiuvXhqocNx4AANnGREUKplCQ6AvvD0lrSSOkFkkti7inhulrVmDuzXv7hxikUSDlUE_u3KtUfFVzZXQYxFIx5fB_EqCVwIzV8OUmfsavgfDyKi7al8ZG0yug4zC6HyvPfQlif5ZJ6QE_deQrIKVgcUfGn_nnpL9I9AX-1O-Q1-NXyCJizMlvk-nbo_RI-mS0"><p>primitiveMesh没有更顶层的类了。常用的方法：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> label <span class="title">nCells</span><span class="params">()</span> <span class="keyword">const</span></span>; <span class="comment">//返回网格个数</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> cellList&amp; <span class="title">cells</span><span class="params">()</span> <span class="keyword">const</span></span>; <span class="comment">//返回所有的 cell，cell 是由 faces 构成的</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> labelList&amp; <span class="title">cellCells</span><span class="params">(<span class="keyword">const</span> label celli)</span> <span class="keyword">const</span></span>; <span class="comment">//返回 celli 的 邻居们</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> labelList&amp; <span class="title">edgeCells</span><span class="params">(<span class="keyword">const</span> label edgeI)</span> <span class="keyword">const</span></span>; <span class="comment">//返回共用这条边的所有网格</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> labelList&amp; <span class="title">pointCells</span><span class="params">(<span class="keyword">const</span> label pointi)</span> <span class="keyword">const</span></span>; <span class="comment">//返回共用这个点的所有网格</span></span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt;<span class="string">"mesh.cells()[0]==="</span>&lt;&lt;mesh.cells()[<span class="number">0</span>]&lt;&lt;<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure><p>返回包围第0个cell的所有面的index：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">mesh.cells()[<span class="number">0</span>]===<span class="number">6</span>(<span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">4379997</span> <span class="number">4382913</span> <span class="number">4391661</span>)</span><br></pre></td></tr></table></figure><p>surfaceInterpolation没有更顶层的类了。</p><p>lduMesh没有更顶层的类了。</p><p>fvMesh 常用的方法：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//- Return cell volumes</span></span><br><span class="line">const DimensionedField&lt;scalar, volMesh&gt;&amp; V() const;</span><br><span class="line"><span class="comment">//- Return old-time cell volumes</span></span><br><span class="line">const DimensionedField&lt;scalar, volMesh&gt;&amp; V0() const;</span><br><span class="line"><span class="comment">//- Return old-old-time cell volumes</span></span><br><span class="line">const DimensionedField&lt;scalar, volMesh&gt;&amp; V00() const;</span><br><span class="line"><span class="comment">//- Return sub-cycle cell volumes</span></span><br><span class="line">tmp&lt;DimensionedField&lt;scalar, volMesh&gt;&gt; Vsc() const;</span><br><span class="line"><span class="comment">//- Return sub-cycl old-time cell volumes</span></span><br><span class="line">tmp&lt;DimensionedField&lt;scalar, volMesh&gt;&gt; Vsc0() const;</span><br><span class="line"><span class="comment">//- Return cell face area vectors</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> surfaceVectorField&amp; <span class="title">Sf</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line"><span class="comment">//- Return cell face area magnitudes</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> surfaceScalarField&amp; <span class="title">magSf</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line"><span class="comment">//- Return cell face motion fluxes</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> surfaceScalarField&amp; <span class="title">phi</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line"><span class="comment">//- Return cell centres as volVectorField</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> volVectorField&amp; <span class="title">C</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line"><span class="comment">//- Return face centres as surfaceVectorField</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> surfaceVectorField&amp; <span class="title">Cf</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//- Internal face owner</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> labelUList&amp; <span class="title">owner</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> lduAddr().lowerAddr();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//- Internal face neighbour</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> labelUList&amp; <span class="title">neighbour</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> lduAddr().upperAddr();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>画了一个<code>2*2*1</code>的网格：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Mesh Information</span><br><span class="line">----------------</span><br><span class="line">  nPoints: 18</span><br><span class="line">  nCells: 4</span><br><span class="line">  nFaces: 20</span><br><span class="line">  nInternalFaces: 4</span><br></pre></td></tr></table></figure><p>以下三张图为李建治绘制：<br><img src="/album/mesh1.gif" alt=""><br><img src="/album/mesh2.gif" alt=""><br><img src="/album/mesh3.gif" alt=""></p><p>下面这段代码来自 <em><a href="http://www.cfd-china.com/topic/1228" target="_blank" rel="external nofollow noopener noreferrer">CFD中文网</a></em></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> labelUList&amp; owner = mesh.owner();</span><br><span class="line"><span class="comment">//这里的owner只考虑了内部面？</span></span><br><span class="line">Info&lt;&lt;<span class="string">"owner==="</span>&lt;&lt;owner&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">const</span> labelUList&amp; neighbour = mesh.neighbour();</span><br><span class="line">Info&lt;&lt;<span class="string">"neighbour==="</span>&lt;&lt;neighbour&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">forAll(T,cellI)</span><br><span class="line">&#123;    </span><br><span class="line">Info&lt;&lt;<span class="string">"cellI==="</span>&lt;&lt;cellI&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    forAll(mesh.cells()[cellI], faceI)</span><br><span class="line">    <span class="comment">//遍历当前 cellI 的所有面</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (mesh.isInternalFace(mesh.cells()[cellI][faceI])) </span><br><span class="line">        <span class="comment">//如果这个cellI由6个面包围，则faceI从0到5遍历</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">const</span> label faceIndex = mesh.cells()[cellI][faceI];</span><br><span class="line">            <span class="comment">//faceIndex 是当前 faceI 真实 index</span></span><br><span class="line">            Info&lt;&lt; <span class="string">" one of faceIndex is "</span> &lt;&lt; faceIndex;</span><br><span class="line">            Info&lt;&lt; <span class="string">", and this face's owner is "</span></span><br><span class="line">                &lt;&lt; owner[faceIndex] &lt;&lt; <span class="string">", its neighbour is "</span></span><br><span class="line">                &lt;&lt; neighbour[faceIndex] &lt;&lt; nl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">owner&#x3D;&#x3D;&#x3D;4(0 0 1 2)</span><br><span class="line">这里内部面只有 0 1 2 3，对应的owner是 0 0 1 2</span><br><span class="line">neighbour&#x3D;&#x3D;&#x3D;4(1 2 3 3)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cellI&#x3D;&#x3D;&#x3D;0</span><br><span class="line"> one of faceIndex is 0, and this face&#39;s owner is 0, its neighbour is 1</span><br><span class="line"> one of faceIndex is 1, and this face&#39;s owner is 0, its neighbour is 2</span><br><span class="line">cellI&#x3D;&#x3D;&#x3D;1</span><br><span class="line"> one of faceIndex is 2, and this face&#39;s owner is 1, its neighbour is 3</span><br><span class="line"> one of faceIndex is 0, and this face&#39;s owner is 0, its neighbour is 1</span><br><span class="line">cellI&#x3D;&#x3D;&#x3D;2</span><br><span class="line"> one of faceIndex is 3, and this face&#39;s owner is 2, its neighbour is 3</span><br><span class="line"> one of faceIndex is 1, and this face&#39;s owner is 0, its neighbour is 2</span><br><span class="line">cellI&#x3D;&#x3D;&#x3D;3</span><br><span class="line"> one of faceIndex is 2, and this face&#39;s owner is 1, its neighbour is 3</span><br><span class="line"> one of faceIndex is 3, and this face&#39;s owner is 2, its neighbour is 3</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//- Internal face owner</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> labelUList&amp; <span class="title">owner</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> lduAddr().lowerAddr();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">fvMesh::lduAddr()&#123;<span class="keyword">return</span> *lduPtr_;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">mutable</span> fvMeshLduAddressing* lduPtr_;</span><br></pre></td></tr></table></figure><img src="http://www.plantuml.com/plantuml/svg/ZLBBQiCm4BpxA_OKaZI6qcDUK2Y5WjC6qfvACRAbDWB5DdeufS7_NlaHIrMLnytUcLdDpYx3wXvZJeIWsHVCmn0-onKHsyYk1ob3GdYHGn37iEQqH980HX9170SXGmbX4HLoEXKggJ-0vNl2Qs4y2y8qp-hIaJK0LHG6hKjpY_9M5yPBA91CjquBh3Rfbc35oA35Zx-Qevsjo2uX71vLbagg5RMx6xVrm9WRZg113vn8nJFRTUKJzhvTeJMGLzZFChGme4wNiHdvdNvOdKwExVfmCgc2AkYsoQxT8mZwqyNvG7Oemo7MF98Psav9b31Y5ZhMmOcSoxLiTkN1ytr6-4QYSvosXqMoBFeM6vOvnP3hu97C-MBOPsNc78nc7Ir5B8sQ1uwHsSXBRy-7HiQOWKzTcydGtKsRgrvgIRbKYC4LXmaBk9sTK_oxo8iA_oasrUVyR9EBLzZ9V7FL2TeslJHp9HUfrh4ut7OUoUbJXidtdo7HnCu34YDwLGKZT_EcFW6Xjuxu4X9z_QPp5Vm2">]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> fvMesh </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM 拉格朗日库深度解析</title>
      <link href="/lagrangian/"/>
      <url>/lagrangian/</url>
      
        <content type="html"><![CDATA[<p>拉格朗日库类解析</p><a id="more"></a><h1 id="类的结构"><a class="markdownIt-Anchor" href="#类的结构"></a> 类的结构</h1><details><summary>点开查看 UML</summary><img src="http://www.plantuml.com/plantuml/svg/nLhTRziu4d_FNq6WWE1WdIBFJIx0hfDsWzrSWrffhqy18z4sMtqTHQNrzVg_7pyb3aN9aZTtruV6uipyD1mEvuDKNJ6yNsLbawBBVv-TeNNxVFA1u8JJOXkala7gJxolo0dhCmBPatX7M5uEaLqexdCweYT_q8BacDCaJ7TnlWPOeVZ98CN5IJecBQKiS8zPGZ9d-0qIGq8-8qhAJi_bSmGLj_YhUFK4N4ue3PXRHLr-5m5mLqOdRv81JZ5FNDUe5VXnWiI_iwGiQewgCjlVaNeNeLpy_wX9JvZj4r9mHXEKb2LBQO4vgGqrmqz2Eu6UKJ322N-B4z8RlETmQECmrGdEC4Cr9zLR9YrJ5e2tP7HxpygaDtYRcg7dagQ8aKr64huuTSTABfHUw6a-bMM6Kig8UeNBbknmiIKnuGkXQipeRPyePpLCNGb3B0A8vHqMqsBtc2SxGtzyHEeHqK9Gz7HhCQg8hvIEEygrH2peNrjVZPQ8om7XETUOuqZZ_QBjiINyx-IRTTBRwyKfKhFMFA5r3d4uYnwvgmvvkyKFZHiN623Tyn1XqnC8E4M88V8uN53hDu4NHWxH5xbD1mKaIG_UOyekjGfNG8LrXOEAegHXJ5WsfZa9JqWOvxP8QKBgbhSTWPpEAiMag4lc20YNAUfDoN8eyYoSNl0LWe2zLLCkLnRzDJE4M-cd1Su66Nuhco8LAWsjUgMzFw1ELTOK6EAd5wVUl74ztaGj_Txw6nMmSWb9BKpWKBuIKjcD8107iCuoik5dxPlCY_tugz_uognXOM4VmN3gFSQOYUre1irK7o0FsvLm06yzK1utxCd3w8PQzszLifvf2MblGAjbXpLcX1vyFg6QFoIKyuUKUZqiP_2LZYX6TI6LV2HPcL2-jwkDp3-mJNAn2YgQQXOGy11FGpjBYWItN5xcObEytzmMHDW81tcUowp9_TZ3fGSWo9420o0iQgBxCJ7D491Q7v9Q-r8Vo2Hh020X8nOoMJui7v9bkioR169-6i9SrdIRun7aJn1PimFic_9OR26vNGhqfNa3X5UPjIPS-iT7d3KYBdeP4gboRjatb0CWNV6QrXLXjGmzOOIUvYa765Q3TTc8EB4gcQagZeGJAisMLB4kBv_9L4ar8FEF2p1KQqonf9IryVUlW7p2MNQKF6MymHbIEDmcFg5I9VUxy0xZXIf7HYYUAbOJaHMmBX9_XXD3C36TuOQNzvnTgj9EL5iAmvO9LpAogcHQFOwnwuWfs1ycCBVOUGEukpHZosQRGnB88GB3eziBc52kXzGSPO9HQVBHhHI3QaJT54FLPN2UaPtdOOdsBNQomOWkvnmk5JN5Ira9p6pI865fHG32Mw-00zOQe4M6EEnOIWeNl7D8MuLecuY2K5f355pgfrczL80KwJMZpwIu4QNX_b8LNrVoTQO9RDkbFg-jP8M5xcWnXUty85DE2pqbqGFLm7Uw6KJgTxXexDGUMcQXwX3fF5mGk2evHUVuvZQLeiTqCcNX1aJroeE30LXenh0MN9bj_KecYjy9DbK-OOlNhrz3zus34r-5jyhEgvjUAC6-V79SDqosY4OdEUcUsdDpwC_0AenilX57Zm_lXNZAhehlyFU3JAlgyDj8LTEiB0upRiuVeVE4jqqyjD6anc4FKXJvtwddX-4tM8s3nCrvhp-4YnPAnIQRbTbQWRob94lRVHIcViLLXQTbstXEQbvLSxYL5dC4teKIV-ob-LMLW10Cfnxr0aIOI-as8q_7ipExjTKC4STWCwJUZLGGyK054FkrWh1gc5CHXBUE-Ab93Ix7oS5O51BIEy8xaORfH7R8vo2bQ8__RCyNR02zt-6QhDJPPPTQB4fJfPWJcJhR0om5lDI6hbrFIINR4Wnz3bTL4W6QrV8lJl-VMGaTIaiQ06QcYVad3fbiPUsb2jNk8M-wt_Ui-wtylfxOHgBH7EXTI1oL1Qkn52TRpIjaOJ-g4nMOUgfUZb7jAHJfvG5VyIEQiYeKFhreEH13gk4O8eWw0engQBOpv3cPi1fXGMqJzmBB79XouGafsI3vjy0vSMw6F8tSXmjugdaE3oFjsIsCAqYTry2Xl87F6VrdGrEn0RqJppz-fqLAliF1lVTuNNBld3JntbR3PrfyKGfxKdTb3aUQcZ3eakdvwA5rk5XHymyt7qrmkBD6a6oC4gJjmwF2H442Jy9wXGzFhTt2KC9yGOAqud-bfn2XxLTUvlHV-A_4R87o6oFuQrCTY_2_o29TKtTSM0VNJZiwMJQGbFxH9GdtVlke3A6sneHpWyRhIhJSm9voUuD36fgewR2PgNaV4_nm3oBCYK6xIT3Vq7dl-k6sMEzhJl8-amaQcNW3PdVgGgB9ts-6sDkW8DdbiO5GwgOWRBi_A7DDlope4dqPfETTizOHpH5fNbt2OlyAFOiuilv6I3L7YEy8ntC4S5RjPWc8skXcim4IlQCqTnaV7qMQt1162dcpoakfejXIZ572q1RNQ2DnknluSEVJtTUrz8zgPGtzOLIwpO3s_4kuWRny8Eb7SmovXSce-ZL_ei9LpEYjYiL2uAvCIVOdhVabdEjbkxj5HMCZjqs4jW3gBZqKp0Z4bL0Hy7f8wh3-jlj-uJ1U5PBmKDUyJ4J_8G7ABAFJ5Aq7X7ni7M3VqYoVWEanUrYo6jpg-u5riYCvCKVrSgojCompT9GtR-njkf1HXtXzTiTp0Fkg99kDsx29fAhKg-sDgnujisU25cWewDiIi1ee0MKcG2xWKqEpL6RlzqdILBX8zk1zkYiSffDdgP3UaI-ebQZ2-8s21czJU1-8CCrYS8N5Mq_7JZdK1NZmC0Hk-Iad9dxHDnm0WldDne615gEbkk2pWaNK1WluYgD1N4sc1voeYpTGZoCXN2tc1gl8ZrLGenU0SxKx8kX5WPW7TNmnKA3fz10QEH7Kq-nO4ByT1m4uSWEmttw4uszauk_YT7YFEzoMsOCEnkh8nEh5I9HneGqpk2uKXS_cMQjoXpcZtw_G-c7H2q61YpE_NZrOgyweK-VMgF1MJdwBAQ_zikaoNaqxMC_EhcLdrR6pQjXvzIliaSsnZ3xTxVgMXPCM8_DxYJ8i_BtOKbnSSmJwnHrHTys2QnR84ZdVoMwQBDjVapfXz8ca05z42aRMwiDQTvYHOGBXkb-EnSngZvZXxoXyfISNcWpGb9m6jTzvZ2Ly-VjzbZfVltHli2WkeM84L1U_EBKC6CfBwTClKzcOLyjyeGxZ5cP1mCBPLP8VywfS9CR4eFsUGN_XsJq_LAXlF7EIhpu23dmJ8ulHErmPi-QukhSV3dUd0Uvt_3yWHiZhRm9Tv1W_diclpWYgO5SOzpGrRTZwptUQ5fdPZFPmyIYrykfuzv9U9pf73T1jx7pEmzr6tEisrkfZMCHmId7t_Vo4hc9Np-j2ThNJXlmoOCSfXN4yXIaOhYURDd9DEtGrwDKHyKWTCP3iZGadPlkMUohud5AYvUxN4bgWhILs2z_MkxedDRo9Xtdm11wuMU7LQo-fjmJ_VcWyQIu2sSvDTgSNXpBc8OJbOBO4s6vIl1XCbnUZ-V9YFF65_T_BUXU3QUyYdFSkGedFltW3OTM6ZrMPsqiIlK41DuX-YSVg7pHrzz67a2gFrI095DMz3eSqKP0vCT1iiUbJY9mfM0Uz0Ftdv3b4pXoyflD8Z0FXnKvzGM77VCXcdI3KSeRSI6pwJ4NDxuUdp_H0M75UivOdE3FuqRftv1DKJ7853elwKOcqMmXSdhYRnTuqusV2y9RuNqgsEy2vzD8hto41zySUdmTZRhr68T2JmmIlO7fQUfvkZwk8QEnqGbrip757Q4jCd5JaJ0ekprG0111S5IOO93BsWA-U8eXQoG6d-0y0"></details><h1 id="喷雾子模型"><a class="markdownIt-Anchor" href="#喷雾子模型"></a> 喷雾子模型</h1><h2 id="kinematicparcel"><a class="markdownIt-Anchor" href="#kinematicparcel"></a> KinematicParcel</h2><p>Kinematic parcel class with rotational motion (as spherical particles only) and one/two-way coupling with the continuous phase.</p><ul><li>InjectionModel<ul><li>CellZoneInjection</li><li>ConeInjection</li><li>ConeNozzleInjection</li><li>…</li></ul></li></ul><img src="http://www.plantuml.com/plantuml/svg/jLPFJ-iu4B_pAIojX5eH4EmHkaXikvLwA8sMBbVanbFgVOuTsKvumFBTTn8d9avDjtfwsqkTcV7y_SsCfqALxA7SB1K3yJirG2R_d9-JXVmRCikLREWduQSJcIe9z-hjJO3ddcI26ZEuF9dM9jQl1To-dn3ydLayCzYI-b_I78YNkBukgCv0r6VoURnnzq2MUKj5JxbvBpRtPRu1dHIR9Hh6lpd_3kp3oJyzaLGhYwu08unQYfI6yOl9gA2QFAmMJpS1fLAYp66jB1K3Jexw0_gQvp0lPHFdrSH9tJPYSw5U_gGM8XfSPe1rB44tc4xf4sP2XelLt346B33UIq8_8GEBCgNQyan0avK1qwB_bn7QWuMYemSPN4ATQjB5R7msAwvjIGNPA2L8HGLdFfvHXeAMzADPZCblvF8cShNGW28mL_eUljjrwqkhekTXqgWx9H9UKfUWn74RqcDJmhccZGFZcA4jbsmAGjpPL1dU-DcgH6M2T_ejs3dDeF-TMfvK69f2MqLxDsbqWjPAh-IzidDLIeOnMbt2q7mRXG7hWBlQTYKoaLIP98Yz2Y8BUOnZ7rdiX82gTsheGQKugrsthaRJ7MJVOgORp8NQQW0tvB57nrUOE0lCbGLs7op1x4RjrJCk1PT00jnX9aPZqfYCIlMQyw2SRzN_bEhQSI0ug5RjtH_I2tt2rmi6cLihftOVk9V97kbg754tYFSdgQCLQFeChcNgSJainjumYkVlYz4q4BQG5mAhFd4hOOse_VQv21fOS1TNoC8Uh8_9uTrmVMthMrm-pt2kOsjsc0o1XttMTVYTQ_dOG4hwD9d6MgyPEtkDtniQgnU9pNTmSCHAuxtKgW0S1D4nSBI3d_avRQ_6RBeHM0hnEWEJQRw1Gz1kAxLLevMn6cX-IfJ1P7-SjCi-yWpOt_ZDvkR-MG1sfzWxprF5fKruFkCc--Wl-IskqFh--zPEQyUej8yWLCRjQxB5R84nfOQPvXN87gFRl5ZiMkMEwcVeFmPuXSpWAN0-S6hePBi8ppk7l6ST8wY2Ad44pzfH79NWKkvBT3EyrBIst94TtZpSEhA3WVDJwHhK8QT3tnuLCJXGpRXsmOQ-1XsUWdu0fBDG9lxysRO5G3nlkO1ZhjWTMBgeqtAqzAhSIoyjhKgjdZ2EAEMRqhy-RudXRp3haGSvG6mzGdOLfVuwe4gbS_y8wyhsrv8-TwIuqrDsc9zYCRsbTY8iGXnsizhpvoqEHpzX6SVtt8_kE1BPIZ-wu8xGzTMWlxYu6F-lq_RmXl8J-FZf6vCyuZcDi_XV"><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">InjectionModelList</span></span></span><br><span class="line"><span class="class">:</span></span><br><span class="line">    <span class="keyword">public</span> PtrList&lt;InjectionModel&lt;CloudType&gt;&gt;</span><br></pre></td></tr></table></figure><img src="http://www.plantuml.com/plantuml/svg/RKzDImCn4BtxA-QqRB47lTOYY7eGN1IwzsMOZ3LjabcIsGKf_dVJhAwMcjFZVUJD8uSfmLFOCQcLq8XXzsoJhk-T3ARzwFdsS07vTHtS4N4sTrqXBXEXmmXgFMyKezOB80b9Ryxans3-5qTnW-TMflwwEE1Fy6e9PzprulGF73dYbbyn4hichwb_3ADO0qDlKBdXz3xpohvtcLnJ6Tz6fFtlt9Aoqq6dKWLqX4lDEA1dc9NLgY_r4zPZoeRj0ofMe6Q-nqOTqC5tmvlKBqaZewz0KZPzVW40"><p><code>ConeNozzleInjection</code> 构造函数：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">tanVec1_ = normalised(perpendicular(direction_));</span><br><span class="line">tanVec2_ = normalised(direction_ ^ tanVec1_);</span><br></pre></td></tr></table></figure><p><code>ConeNozzleInjection::setPositionAndCell</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">scalar beta = mathematical::twoPi*rndGen.globalScalar01();</span><br><span class="line">normal_ = tanVec1_*<span class="built_in">cos</span>(beta) + tanVec2_*<span class="built_in">sin</span>(beta);</span><br></pre></td></tr></table></figure><p><code>ConeNozzleInjection::setProperties</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">scalar alpha = <span class="built_in">sin</span>(coneAngle);</span><br><span class="line">scalar dcorr = <span class="built_in">cos</span>(coneAngle);</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span> normal = alpha*normal_;</span><br><span class="line"><span class="built_in">vector</span> dirVec = dcorr*direction_;</span><br><span class="line">dirVec += normal;</span><br><span class="line">dirVec /= mag(dirVec);<span class="comment">//dirVec是速度方向向量</span></span><br></pre></td></tr></table></figure><p><code>ConeNozzleInjection::setProperties</code> 函数的作用是设置出射粒子的速度和直径：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">parcel.d() = sizeDistribution_-&gt;sample();</span><br></pre></td></tr></table></figure><p><code>ConeNozzleInjection::setProperties</code> 函数在 <code>InjectionModel::inject</code> 中被调用。<br>粒子直径在这里给定，然后在哪里更新呢？我知道的有破碎模型里边。在 <code>SprayParcel::calc</code> 中调用了破碎模型的 <code>update</code>，<code>this-&gt;d()</code> 作为引用参数传入 <code>update</code> 函数，被破碎模型修改。</p><p><code>InjectionModel::prepareForNextTimeStep</code></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Number of parcels to inject</span></span><br><span class="line">newParcels = <span class="keyword">this</span>-&gt;parcelsToInject(t0, t1);</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:label Foam::ConeNozzleInjection&lt;CloudType&gt;::parcelsToInject</span><br><span class="line"><span class="comment">//计算该时间步长内喷射的 parcels 数</span></span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar time0,</span><br><span class="line">    <span class="keyword">const</span> scalar time1</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ((time0 &gt;= <span class="number">0.0</span>) &amp;&amp; (time0 &lt; duration_))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">floor</span>((time1 - time0)*parcelsPerSecond_);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>KinematicCloud</code> 中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//- Injector models</span></span><br><span class="line">InjectionModelList&lt;KinematicCloud&lt;CloudType&gt;&gt; injectors_;</span><br><span class="line"></span><br><span class="line"><span class="comment">//- construct</span></span><br><span class="line">injectors_</span><br><span class="line">(</span><br><span class="line">    subModelProperties_.subOrEmptyDict(<span class="string">"injectionModels"</span>),</span><br><span class="line">    *<span class="keyword">this</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">const</span> <span class="title">Foam</span>:</span>:InjectionModelList&lt;Foam::KinematicCloud&lt;CloudType&gt;&gt;&amp;</span><br><span class="line">Foam::KinematicCloud&lt;CloudType&gt;::injectors() <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> injectors_;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">injectors_.inject(cloud, td);</span><br><span class="line"></span><br><span class="line">injectors_.updateMesh();</span><br><span class="line"></span><br><span class="line">injectors_.info(Info);</span><br></pre></td></tr></table></figure><p>最重要的 <code>inject</code> 函数在 <code>KinematicCloud::evolveCloud</code> 函数被调用。</p><h3 id="distributionmodel"><a class="markdownIt-Anchor" href="#distributionmodel"></a> distributionModel</h3><img src="http://www.plantuml.com/plantuml/svg/ZOq_2y8m44VtVeg3WYWkxiLDT2f81zTmpHqOp1z9BaKHlxjDeLC5NU_UUpzjCIKWaoIQFei9lWt4zbKf1USOXBKm0Q4WA5NLElWa8wuBYV6vD0_ZJpLLtQ6du5OGFPtObyjWecIqC0H3eA-iR-iDJC6chBNiUevmp7wAfxAtdPsaqMA4XEvkUTPW3xjcmJZZBsZpBmeV_r2CtsBl3m00"><p>哪里被用到？<br>答：<code>InjectionModel</code> 的派生类中，比如 <code>ConeNozzleInjection.H</code> 中：<br>类外申明：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Forward declaration of classes</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">distributionModel</span>;</span></span><br></pre></td></tr></table></figure><p>类内申明：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> autoPtr&lt;distributionModel&gt; sizeDistribution_;</span><br></pre></td></tr></table></figure><p><code>ConeNozzleInjection.C</code> 中，先 <code>#include &quot;distributionModel.H&quot;</code>，然后在构造函数中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">sizeDistribution_</span><br><span class="line">(</span><br><span class="line">    distributionModel::New</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">this</span>-&gt;coeffDict().subDict(<span class="string">"sizeDistribution"</span>),</span><br><span class="line">        owner.rndGen()</span><br><span class="line">    )</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>这其实是很好的一个 RTS 的简单使用典范，可以参考这个，制作自己的 RTS。</p><ul><li>particleForces<ul><li>SphereDrag</li><li>…</li></ul></li><li>patchInteractionModel<ul><li>localInteraction</li><li>rebound</li><li>standardWallInteraction</li><li>none</li></ul></li></ul><h2 id="thermoparcel"><a class="markdownIt-Anchor" href="#thermoparcel"></a> ThermoParcel</h2><p>Thermodynamic parcel class with one/two-way coupling with the continuous phase. Includes Kinematic parcel sub-models, plus:</p><ul><li>heatTransferModel<ul><li>RanzMarshall</li></ul></li><li>surfaceFilmModel<ul><li>thermoSurfaceFilm</li></ul></li></ul><h2 id="reactingparcel"><a class="markdownIt-Anchor" href="#reactingparcel"></a> ReactingParcel</h2><p>Reacting parcel class with one/two-way coupling with the continuous phase.</p><ul><li>compositionModel<ul><li>SinglePhaseMixture<br>算例文件 sprayCloudProperties：</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">compositionModel SinglePhaseMixture;</span><br><span class="line"></span><br><span class="line">singlePhaseMixtureCoeffs</span><br><span class="line">&#123;</span><br><span class="line">    phases</span><br><span class="line">    (</span><br><span class="line">        liquid</span><br><span class="line">        &#123;</span><br><span class="line">            C7H16               <span class="number">0.39</span>;</span><br><span class="line">            C8H18               <span class="number">0.61</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意这里给定的混合燃料的质量分数。</p><p><code>CompositionModel</code> 中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">phasePropertiesList phaseProps_;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:CompositionModel&lt;CloudType&gt;::CompositionModel</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> dictionary&amp; dict,</span><br><span class="line">    CloudType&amp; owner,</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; type</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    CloudSubModelBase&lt;CloudType&gt;(owner, dict, typeName, type),</span><br><span class="line">    thermo_(owner.thermo()),</span><br><span class="line">    phaseProps_</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">this</span>-&gt;coeffDict().lookup(<span class="string">"phases"</span>),</span><br><span class="line">        thermo_.carrier().species(),</span><br><span class="line">        thermo_.liquids().components(),</span><br><span class="line">        thermo_.solids().components()</span><br><span class="line">    )</span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure><p><code>phasePropertiesList</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">List&lt;phaseProperties&gt; props_;</span><br><span class="line"></span><br><span class="line">Foam::phasePropertiesList::phasePropertiesList</span><br><span class="line">(</span><br><span class="line">    Istream&amp; is,</span><br><span class="line">    <span class="keyword">const</span> wordList&amp; gasNames,</span><br><span class="line">    <span class="keyword">const</span> wordList&amp; liquidNames,</span><br><span class="line">    <span class="keyword">const</span> wordList&amp; solidNames</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    props_(is),</span><br><span class="line">    phaseTypeNames_(),</span><br><span class="line">    stateLabels_()</span><br><span class="line">&#123;</span><br><span class="line">    forAll(props_, i)</span><br><span class="line">    &#123;</span><br><span class="line">        props_[i].reorder(gasNames, liquidNames, solidNames);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    phaseTypeNames_.setSize(props_.<span class="built_in">size</span>());</span><br><span class="line">    stateLabels_.setSize(props_.<span class="built_in">size</span>());</span><br><span class="line">    forAll(props_, i)</span><br><span class="line">    &#123;</span><br><span class="line">        phaseTypeNames_[i] = props_[i].phaseTypeName();</span><br><span class="line">        stateLabels_[i] = props_[i].stateLabel();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>phaseProperties</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Foam::phaseProperties::phaseProperties(Istream&amp; is)</span><br><span class="line">:</span><br><span class="line">    phase_(UNKNOWN),</span><br><span class="line">    stateLabel_(<span class="string">"(unknown)"</span>),</span><br><span class="line">    names_(<span class="number">0</span>),</span><br><span class="line">    Y_(<span class="number">0</span>),</span><br><span class="line">    carrierIds_(<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">    is.check(<span class="string">"Foam::phaseProperties::phaseProperties(Istream&amp; is)"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function">dictionaryEntry <span class="title">phaseInfo</span><span class="params">(dictionary::null, is)</span></span>;</span><br><span class="line"></span><br><span class="line">    phase_ = phaseTypeNames[phaseInfo.keyword()];</span><br><span class="line">    stateLabel_ = phaseToStateLabel(phase_);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (phaseInfo.<span class="built_in">size</span>() &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        label nComponents = phaseInfo.<span class="built_in">size</span>();</span><br><span class="line">        names_.setSize(nComponents, <span class="string">"unknownSpecie"</span>);</span><br><span class="line">        Y_.setSize(nComponents, <span class="number">0.0</span>);</span><br><span class="line">        carrierIds_.setSize(nComponents, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">        label cmptI = <span class="number">0</span>;</span><br><span class="line">        forAllConstIter(IDLList&lt;entry&gt;, phaseInfo, iter)</span><br><span class="line">        &#123;</span><br><span class="line">            names_[cmptI] = iter().keyword();</span><br><span class="line">            Y_[cmptI] = readScalar(phaseInfo.lookup(names_[cmptI]));</span><br><span class="line">            cmptI++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        checkTotalMassFraction();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个 <code>CompositionModel</code> 在哪里使用呢？<br>首先 <code>compositionModel_</code> 在 <code>ReactingCloud</code> 中定义，并提供了一个接口函数 <code>composition()</code>。<br>在 <code>ReactingParcel</code> 的 <code>calcPhaseChange</code> 函数中，如下片段中被用到：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> CompositionModel&lt;reactingCloudType&gt;&amp; composition =</span><br><span class="line">        cloud.composition();</span><br><span class="line"></span><br><span class="line"><span class="function">scalarField <span class="title">X</span><span class="params">(composition.liquids().X(Y))</span></span>;</span><br><span class="line"></span><br><span class="line">forAll(dMassPC, i)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> label cid = composition.localToCarrierId(idPhase, i);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar dh = phaseChange.dh(cid, i, td.pc(), Tdash);</span><br><span class="line">    Sh -= dMassPC[i]*dh/dt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">forAll(dMassPC, i)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> label cid = composition.localToCarrierId(idPhase, i);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar Cp = composition.carrier().Cp(cid, td.pc(), Tsdash);</span><br><span class="line">    <span class="keyword">const</span> scalar W = composition.carrier().W(cid);</span><br><span class="line">    <span class="keyword">const</span> scalar Ni = dMassPC[i]/(<span class="keyword">this</span>-&gt;areaS(d)*dt*W);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar Dab =</span><br><span class="line">        composition.liquids().properties()[i].D(td.pc(), Tsdash, Wc);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Molar flux of species coming from the particle (kmol/m^2/s)</span></span><br><span class="line">    N += Ni;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sum of Ni*Cpi*Wi of emission species</span></span><br><span class="line">    NCpW += Ni*Cp*W;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Concentrations of emission species</span></span><br><span class="line">    Cs[cid] += Ni*d/(<span class="number">2.0</span>*Dab);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在 <code>SprayParcel</code> 的 <code>calc</code> 函数中，如下片段中被用到：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> CompositionModel&lt;reactingCloudType&gt;&amp; composition =</span><br><span class="line">        cloud.composition();</span><br><span class="line">        </span><br><span class="line">                                                       </span><br><span class="line"></span><br><span class="line"><span class="function">scalarField <span class="title">X0</span><span class="params">(composition.liquids().X(<span class="keyword">this</span>-&gt;Y()))</span></span>;</span><br><span class="line"></span><br><span class="line">scalar TMax = composition.liquids().Tc(X0);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (composition.liquids().pv(pc0, T0, X0) &gt;= pc0*<span class="number">0.999</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Set TMax to boiling temperature</span></span><br><span class="line">    TMax = composition.liquids().pvInvert(pc0, X0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>在 <code>SprayParcel</code> 的 <code>calcAtomization</code> 函数中，如下片段中被用到：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">scalar chi = <span class="number">0.0</span>;</span><br><span class="line"><span class="keyword">if</span> (atomization.calcChi())</span><br><span class="line">&#123;</span><br><span class="line">    chi = <span class="keyword">this</span>-&gt;chi(cloud, td, composition.liquids().X(<span class="keyword">this</span>-&gt;Y()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="http://www.plantuml.com/plantuml/svg/jLPRRzem67tdL_WfeYeW7lO6G-fOwT02xHIghQggoZXUQyt4cUtGTLt_-tp9nGc6K6dZeHJxVEUx7N_sbB8iZhBrWiMOVe02W_6VVXzCsIPbWaZ24hFJQIvOM4II1ugl7fNTWloI6SUT3g9GY1s2yLGxMZsdUFBI0UfpVm-kEDb2YK4C9LI_pN8ViKH848KNgqVCDom0qdpVZ-nsgdrTSPPYBWaM8L7WSataACLzXX1MOUIiftjOkoV0x8nSr1eAWg8K8r8a5G04EIUOU_6K_Cn8d4Ehq89yGtYDF7a4JY8D6mhNgkI9ARINxednsE7GTHOjG25LxKDDt8P4kfS9JkGIRXHjdhK9oNYR-uBDApQFknMTejgaXgMNbven2Y2bx6d9v8nbIGpUW--G2koZf0n1MXAw0VJ-hOyLcpQYzpYpIoH-enkB5ieBv3E2gGhuPjXQKmSFllbY0ZxUEiUMS9b1waNcwXqMIb2n3njcHRuNK1o12etsZm16ZFfmwWYVRo7De9uWvJ4kZ6tmuDF-xjJJgos2jFvpvIzJuKDq1uF1OGXgXKpJLaXOGxmMWtHtn1uzIfsE5UEptfxcgkd5tXdw9lsySAmM4ZLdYUXFtC5sExmRt7HFHg-jyZfAMiV8oYcdP-uUBg96Z1jM4v0wjqs_c9JLx3M3ScVRcRXLaHTuiyOSpB84QQathool-y3w__ytWQsc8B_nCPTO0FH_K39-U-UUpDOkL1t8rfIWMWDESP9jgbnUBiwYNZZ_SZt_s8ikG_NtUlbvUVbr-LfCIfMCeh3kTH_YSqKmBWbwuDsaqQZHGG6KM6lbTjMfNB5i-gNt9Y1nHU0Ey9lQkJFIA6zBHnb5DFiKqjyo4WEEbJFrCjbfgdd0cFnEHWvUO5bURcB7AezZrmmzOlHZnIIa2zN06OScbhegR4rilLXKbgRhYCNMKTRCghxlFGi7Cts0miJRQsxOzvT_J-ZvuAPvskZptZFZdfS6oCa_rvQNfT98O4Lom9VUhzrojg-a_L7HzRqWzBgFhVwWBMGPEBhqJWPIVzrLcgkE_5y0"><ul><li>phaseChangeModel<ul><li>liquidEvaporationBoil</li><li>liquidEvaporation</li></ul></li></ul><h2 id="spray"><a class="markdownIt-Anchor" href="#spray"></a> spray</h2><ul><li>atomizationModel<ul><li>BlobsSheetAtomization</li><li>LISAAtomization</li></ul></li><li>breakupModel<ul><li>ETAB</li><li>PilchErdman</li><li>ReitzDiwakar</li><li>ReitzKHRT</li><li>SHF</li><li>TAB</li></ul></li><li>stochasticCollisionModel<ul><li>ORourke</li><li>trajectory</li><li>none</li></ul></li></ul><h2 id="turbulence"><a class="markdownIt-Anchor" href="#turbulence"></a> turbulence</h2><ul><li>dispersionModel<ul><li>stochasticDispersionRAS</li><li>GradientDispersionRAS</li></ul></li></ul><h1 id="从求解器到库的调用过程"><a class="markdownIt-Anchor" href="#从求解器到库的调用过程"></a> 从求解器到库的调用过程</h1><p>solver 中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">basicSprayCloud parcels</span><br><span class="line">(</span><br><span class="line">    <span class="string">"sprayCloud"</span>,</span><br><span class="line">    rho,</span><br><span class="line">    U,</span><br><span class="line">    g,</span><br><span class="line">    slgThermo</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">parcels.evolve();</span><br></pre></td></tr></table></figure><p>其中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> SprayCloud</span><br><span class="line">&lt;</span><br><span class="line">    ReactingCloud</span><br><span class="line">    &lt;</span><br><span class="line">        ThermoCloud</span><br><span class="line">        &lt;</span><br><span class="line">            KinematicCloud</span><br><span class="line">            &lt;</span><br><span class="line">                Cloud</span><br><span class="line">                &lt;</span><br><span class="line">                    basicSprayParcel</span><br><span class="line">                &gt;</span><br><span class="line">            &gt;</span><br><span class="line">        &gt;</span><br><span class="line">    &gt;</span><br><span class="line">&gt; basicSprayCloud;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> SprayParcel</span><br><span class="line">&lt;</span><br><span class="line">    ReactingParcel</span><br><span class="line">    &lt;</span><br><span class="line">        ThermoParcel</span><br><span class="line">        &lt;</span><br><span class="line">            KinematicParcel</span><br><span class="line">            &lt;</span><br><span class="line">                particle</span><br><span class="line">            &gt;</span><br><span class="line">        &gt;</span><br><span class="line">    &gt;</span><br><span class="line">&gt; basicSprayParcel;</span><br></pre></td></tr></table></figure><p>构造函数：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:SprayCloud&lt;CloudType&gt;::SprayCloud</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; cloudName,</span><br><span class="line">    <span class="keyword">const</span> volScalarField&amp; rho,</span><br><span class="line">    <span class="keyword">const</span> volVectorField&amp; U,</span><br><span class="line">    <span class="keyword">const</span> dimensionedVector&amp; g,</span><br><span class="line">    <span class="keyword">const</span> SLGThermo&amp; thermo,</span><br><span class="line">    <span class="keyword">bool</span> readFields</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    CloudType(cloudName, rho, U, g, thermo, <span class="literal">false</span>),</span><br><span class="line">    sprayCloud(),</span><br><span class="line">    cloudCopyPtr_(<span class="literal">nullptr</span>),</span><br><span class="line">    averageParcelMass_(<span class="number">0.0</span>),</span><br><span class="line">    atomizationModel_(<span class="literal">nullptr</span>),</span><br><span class="line">    breakupModel_(<span class="literal">nullptr</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;solution().active())</span><br><span class="line">    &#123;</span><br><span class="line">        setModels();</span><br><span class="line"></span><br><span class="line">        averageParcelMass_ = <span class="keyword">this</span>-&gt;injectors().averageParcelMass();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (readFields)</span><br><span class="line">        &#123;</span><br><span class="line">            parcelType::readFields(*<span class="keyword">this</span>, <span class="keyword">this</span>-&gt;composition());</span><br><span class="line">            <span class="keyword">this</span>-&gt;deleteLostParticles();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Info &lt;&lt; <span class="string">"Average parcel mass: "</span> &lt;&lt; averageParcelMass_ &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;solution().resetSourcesOnStartup())</span><br><span class="line">    &#123;</span><br><span class="line">        CloudType::resetSourceTerms();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SprayCloud&lt;CloudType&gt;</code> 中的 <code>CloudType</code> 是 <code>ReactingCloud</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:ReactingCloud&lt;CloudType&gt;::ReactingCloud</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; cloudName,</span><br><span class="line">    <span class="keyword">const</span> volScalarField&amp; rho,</span><br><span class="line">    <span class="keyword">const</span> volVectorField&amp; U,</span><br><span class="line">    <span class="keyword">const</span> dimensionedVector&amp; g,</span><br><span class="line">    <span class="keyword">const</span> SLGThermo&amp; thermo,</span><br><span class="line">    <span class="keyword">bool</span> readFields</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    CloudType(cloudName, rho, U, g, thermo, <span class="literal">false</span>),</span><br><span class="line">    reactingCloud(),</span><br><span class="line">    cloudCopyPtr_(<span class="literal">nullptr</span>),</span><br><span class="line">    constProps_(<span class="keyword">this</span>-&gt;particleProperties()),</span><br><span class="line">    compositionModel_(<span class="literal">nullptr</span>),</span><br><span class="line">    phaseChangeModel_(<span class="literal">nullptr</span>),</span><br><span class="line">    rhoTrans_(thermo.carrier().species().<span class="built_in">size</span>())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;solution().active())</span><br><span class="line">    &#123;</span><br><span class="line">        setModels();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (readFields)</span><br><span class="line">        &#123;</span><br><span class="line">            parcelType::readFields(*<span class="keyword">this</span>, <span class="keyword">this</span>-&gt;composition());</span><br><span class="line">            <span class="keyword">this</span>-&gt;deleteLostParticles();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Set storage for mass source fields and initialise to zero</span></span><br><span class="line">    forAll(rhoTrans_, i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">word</span>&amp; specieName = thermo.carrier().species()[i];</span><br><span class="line">        rhoTrans_.<span class="built_in">set</span></span><br><span class="line">        (</span><br><span class="line">            i,</span><br><span class="line">            <span class="keyword">new</span> volScalarField::Internal</span><br><span class="line">            (</span><br><span class="line">                IOobject</span><br><span class="line">                (</span><br><span class="line">                    <span class="keyword">this</span>-&gt;name() + <span class="string">":rhoTrans_"</span> + specieName,</span><br><span class="line">                    <span class="keyword">this</span>-&gt;db().time().timeName(),</span><br><span class="line">                    <span class="keyword">this</span>-&gt;db(),</span><br><span class="line">                    IOobject::READ_IF_PRESENT,</span><br><span class="line">                    IOobject::AUTO_WRITE</span><br><span class="line">                ),</span><br><span class="line">                <span class="keyword">this</span>-&gt;mesh(),</span><br><span class="line">                dimensionedScalar(dimMass, <span class="number">0</span>)</span><br><span class="line">            )</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;solution().resetSourcesOnStartup())</span><br><span class="line">    &#123;</span><br><span class="line">        resetSourceTerms();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ReactingCloud&lt;CloudType&gt;</code> 中的 <code>CloudType</code> 是 <code>ThermoCloud</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:ThermoCloud&lt;CloudType&gt;::ThermoCloud</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; cloudName,</span><br><span class="line">    <span class="keyword">const</span> volScalarField&amp; rho,</span><br><span class="line">    <span class="keyword">const</span> volVectorField&amp; U,</span><br><span class="line">    <span class="keyword">const</span> dimensionedVector&amp; g,</span><br><span class="line">    <span class="keyword">const</span> SLGThermo&amp; thermo,</span><br><span class="line">    <span class="keyword">bool</span> readFields</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    CloudType</span><br><span class="line">    (</span><br><span class="line">        cloudName,</span><br><span class="line">        rho,</span><br><span class="line">        U,</span><br><span class="line">        thermo.thermo().mu(),</span><br><span class="line">        g,</span><br><span class="line">        <span class="literal">false</span></span><br><span class="line">    ),</span><br><span class="line">    thermoCloud(),</span><br><span class="line">    cloudCopyPtr_(<span class="literal">nullptr</span>),</span><br><span class="line">    constProps_(<span class="keyword">this</span>-&gt;particleProperties()),</span><br><span class="line">    thermo_(thermo),</span><br><span class="line">    T_(thermo.thermo().T()),</span><br><span class="line">    p_(thermo.thermo().p()),</span><br><span class="line">    heatTransferModel_(<span class="literal">nullptr</span>),</span><br><span class="line">    TIntegrator_(<span class="literal">nullptr</span>),</span><br><span class="line">    radiation_(<span class="literal">false</span>),</span><br><span class="line">    radAreaP_(<span class="literal">nullptr</span>),</span><br><span class="line">    radT4_(<span class="literal">nullptr</span>),</span><br><span class="line">    radAreaPT4_(<span class="literal">nullptr</span>),</span><br><span class="line">    hsTrans_</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">new</span> volScalarField::Internal</span><br><span class="line">        (</span><br><span class="line">            IOobject</span><br><span class="line">            (</span><br><span class="line">                <span class="keyword">this</span>-&gt;name() + <span class="string">":hsTrans"</span>,</span><br><span class="line">                <span class="keyword">this</span>-&gt;db().time().timeName(),</span><br><span class="line">                <span class="keyword">this</span>-&gt;db(),</span><br><span class="line">                IOobject::READ_IF_PRESENT,</span><br><span class="line">                IOobject::AUTO_WRITE</span><br><span class="line">            ),</span><br><span class="line">            <span class="keyword">this</span>-&gt;mesh(),</span><br><span class="line">            dimensionedScalar(dimEnergy, <span class="number">0</span>)</span><br><span class="line">        )</span><br><span class="line">    ),</span><br><span class="line">    hsCoeff_</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">new</span> volScalarField::Internal</span><br><span class="line">        (</span><br><span class="line">            IOobject</span><br><span class="line">            (</span><br><span class="line">                <span class="keyword">this</span>-&gt;name() + <span class="string">":hsCoeff"</span>,</span><br><span class="line">                <span class="keyword">this</span>-&gt;db().time().timeName(),</span><br><span class="line">                <span class="keyword">this</span>-&gt;db(),</span><br><span class="line">                IOobject::READ_IF_PRESENT,</span><br><span class="line">                IOobject::AUTO_WRITE</span><br><span class="line">            ),</span><br><span class="line">            <span class="keyword">this</span>-&gt;mesh(),</span><br><span class="line">            dimensionedScalar(dimEnergy/dimTemperature, <span class="number">0</span>)</span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;solution().active())</span><br><span class="line">    &#123;</span><br><span class="line">        setModels();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (readFields)</span><br><span class="line">        &#123;</span><br><span class="line">            parcelType::readFields(*<span class="keyword">this</span>);</span><br><span class="line">            <span class="keyword">this</span>-&gt;deleteLostParticles();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;solution().resetSourcesOnStartup())</span><br><span class="line">    &#123;</span><br><span class="line">        resetSourceTerms();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ThermoCloud&lt;CloudType&gt;</code> 中的 <code>CloudType</code> 是 <code>KinematicCloud</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:KinematicCloud&lt;CloudType&gt;::KinematicCloud</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; cloudName,</span><br><span class="line">    <span class="keyword">const</span> volScalarField&amp; rho,</span><br><span class="line">    <span class="keyword">const</span> volVectorField&amp; U,</span><br><span class="line">    <span class="keyword">const</span> volScalarField&amp; mu,</span><br><span class="line">    <span class="keyword">const</span> dimensionedVector&amp; g,</span><br><span class="line">    <span class="keyword">bool</span> readFields</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    CloudType(rho.mesh(), cloudName, <span class="literal">false</span>),</span><br><span class="line">    kinematicCloud(),</span><br><span class="line">    cloudCopyPtr_(<span class="literal">nullptr</span>),</span><br><span class="line">    mesh_(rho.mesh()),</span><br><span class="line">    particleProperties_</span><br><span class="line">    (</span><br><span class="line">        IOobject</span><br><span class="line">        (</span><br><span class="line">            cloudName + <span class="string">"Properties"</span>,</span><br><span class="line">            rho.mesh().time().constant(),</span><br><span class="line">            rho.mesh(),</span><br><span class="line">            IOobject::MUST_READ_IF_MODIFIED,</span><br><span class="line">            IOobject::NO_WRITE</span><br><span class="line">        )</span><br><span class="line">    ),</span><br><span class="line">    outputProperties_</span><br><span class="line">    (</span><br><span class="line">        IOobject</span><br><span class="line">        (</span><br><span class="line">            cloudName + <span class="string">"OutputProperties"</span>,</span><br><span class="line">            mesh_.time().timeName(),</span><br><span class="line">            <span class="string">"uniform"</span>/cloud::prefix/cloudName,</span><br><span class="line">            mesh_,</span><br><span class="line">            IOobject::READ_IF_PRESENT,</span><br><span class="line">            IOobject::NO_WRITE</span><br><span class="line">        )</span><br><span class="line">    ),</span><br><span class="line">    solution_(mesh_, particleProperties_.subDict(<span class="string">"solution"</span>)),</span><br><span class="line">    constProps_(particleProperties_),</span><br><span class="line">    subModelProperties_</span><br><span class="line">    (</span><br><span class="line">        particleProperties_.subOrEmptyDict(<span class="string">"subModels"</span>, solution_.active())</span><br><span class="line">    ),</span><br><span class="line">    rndGen_(<span class="number">0</span>),</span><br><span class="line">    cellOccupancyPtr_(),</span><br><span class="line">    cellLengthScale_(mag(cbrt(mesh_.V()))),</span><br><span class="line">    rho_(rho),</span><br><span class="line">    U_(U),</span><br><span class="line">    mu_(mu),</span><br><span class="line">    g_(g),</span><br><span class="line">    pAmbient_(<span class="number">0.0</span>),</span><br><span class="line">    forces_</span><br><span class="line">    (</span><br><span class="line">        *<span class="keyword">this</span>,</span><br><span class="line">        mesh_,</span><br><span class="line">        subModelProperties_.subOrEmptyDict</span><br><span class="line">        (</span><br><span class="line">            <span class="string">"particleForces"</span>,</span><br><span class="line">            solution_.active()</span><br><span class="line">        ),</span><br><span class="line">        solution_.active()</span><br><span class="line">    ),</span><br><span class="line">    functions_</span><br><span class="line">    (</span><br><span class="line">        *<span class="keyword">this</span>,</span><br><span class="line">        particleProperties_.subOrEmptyDict(<span class="string">"cloudFunctions"</span>),</span><br><span class="line">        solution_.active()</span><br><span class="line">    ),</span><br><span class="line">    injectors_</span><br><span class="line">    (</span><br><span class="line">        subModelProperties_.subOrEmptyDict(<span class="string">"injectionModels"</span>),</span><br><span class="line">        *<span class="keyword">this</span></span><br><span class="line">    ),</span><br><span class="line">    dispersionModel_(<span class="literal">nullptr</span>),</span><br><span class="line">    patchInteractionModel_(<span class="literal">nullptr</span>),</span><br><span class="line">    stochasticCollisionModel_(<span class="literal">nullptr</span>),</span><br><span class="line">    surfaceFilmModel_(<span class="literal">nullptr</span>),</span><br><span class="line">    UIntegrator_(<span class="literal">nullptr</span>),</span><br><span class="line">    UTrans_</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">new</span> volVectorField::Internal</span><br><span class="line">        (</span><br><span class="line">            IOobject</span><br><span class="line">            (</span><br><span class="line">                <span class="keyword">this</span>-&gt;name() + <span class="string">":UTrans"</span>,</span><br><span class="line">                <span class="keyword">this</span>-&gt;db().time().timeName(),</span><br><span class="line">                <span class="keyword">this</span>-&gt;db(),</span><br><span class="line">                IOobject::READ_IF_PRESENT,</span><br><span class="line">                IOobject::AUTO_WRITE</span><br><span class="line">            ),</span><br><span class="line">            mesh_,</span><br><span class="line">            dimensionedVector(dimMass*dimVelocity, Zero)</span><br><span class="line">        )</span><br><span class="line">    ),</span><br><span class="line">    UCoeff_</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">new</span> volScalarField::Internal</span><br><span class="line">        (</span><br><span class="line">            IOobject</span><br><span class="line">            (</span><br><span class="line">                <span class="keyword">this</span>-&gt;name() + <span class="string">":UCoeff"</span>,</span><br><span class="line">                <span class="keyword">this</span>-&gt;db().time().timeName(),</span><br><span class="line">                <span class="keyword">this</span>-&gt;db(),</span><br><span class="line">                IOobject::READ_IF_PRESENT,</span><br><span class="line">                IOobject::AUTO_WRITE</span><br><span class="line">            ),</span><br><span class="line">            mesh_,</span><br><span class="line">            dimensionedScalar( dimMass, <span class="number">0</span>)</span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (solution_.active())</span><br><span class="line">    &#123;</span><br><span class="line">        setModels();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (readFields)</span><br><span class="line">        &#123;</span><br><span class="line">            parcelType::readFields(*<span class="keyword">this</span>);</span><br><span class="line">            <span class="keyword">this</span>-&gt;deleteLostParticles();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (solution_.resetSourcesOnStartup())</span><br><span class="line">    &#123;</span><br><span class="line">        resetSourceTerms();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>KinematicCloud&lt;CloudType&gt;</code> 中的 <code>CloudType</code> 是 <code>Cloud</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ParticleType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:Cloud&lt;ParticleType&gt;::Cloud</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> polyMesh&amp; pMesh,</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; cloudName,</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">bool</span> checkClass</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    cloud(pMesh, cloudName),</span><br><span class="line">    polyMesh_(pMesh),</span><br><span class="line">    globalPositionsPtr_()</span><br><span class="line">&#123;</span><br><span class="line">    checkPatches();</span><br><span class="line"></span><br><span class="line">    polyMesh_.tetBasePtIs();</span><br><span class="line">    polyMesh_.oldCellCentres();</span><br><span class="line"></span><br><span class="line">    initCloud(checkClass);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SprayCloud&lt;class CloudType&gt;</code> 的构造函数中：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">parcelType::readFields(*this, this-&gt;composition());</span><br></pre></td></tr></table></figure><p><code>parcelType</code> 是 <code>typedef typename CloudType::particleType parcelType;</code></p><p><code>SprayCloud</code> 的模板 <code>CloudType</code> 是 <code>ReactingCloud</code>，但是这里没有 <code>particleType</code></p><p><code>ReactingCloud</code> 的模板 <code>CloudType</code> 是 <code>ThermoCloud</code>，但是这里没有 <code>particleType</code></p><p><code>ThermoCloud</code> 的模板 <code>CloudType</code> 是 <code>KinematicCloud</code>，但是这里没有 <code>particleType</code></p><p><code>KinematicCloud</code> 的模板 <code>CloudType</code> 是 <code>Cloud</code></p><p><code>Cloud</code> 有个模板 <code>&lt;class ParticleType&gt;</code>，然后重命名了： <code>typedef ParticleType particleType;</code></p><p><code>Cloud</code> 的模板 <code>ParticleType</code> 是 <code>basicSprayParcel</code>，它是 <code>SprayParcel&lt;...&gt;</code> 的别名</p><p><code>SprayParcelIO.C</code> 中定义了<a href="https://github.com/OpenFOAM/OpenFOAM-7/blob/master/src/lagrangian/spray/parcels/Templates/SprayParcel/SprayParcelIO.C#L110" target="_blank" rel="external nofollow noopener noreferrer">readFields</a></p><p>其中又调用了 <code>ParcelType::readFields(c, compModel);</code>，即 <code>SprayParcel</code> 的模板兼基类 <code>ReactingParcel::readFields</code>。<br>定义于 <a href="https://github.com/OpenFOAM/OpenFOAM-7/blob/master/src/lagrangian/intermediate/parcels/Templates/ReactingParcel/ReactingParcelIO.C#L96" target="_blank" rel="external nofollow noopener noreferrer">ReactingParcelIO.C</a></p><p>其中又调用了 <code>ParcelType::readFields(c);</code>，即 <code>ReactingParcel</code> 的模板兼基类 <code>ThermoParcel::readFields</code>。<br>定义于 <a href="https://github.com/OpenFOAM/OpenFOAM-7/blob/master/src/lagrangian/intermediate/parcels/Templates/ThermoParcel/ThermoParcelIO.C#L80" target="_blank" rel="external nofollow noopener noreferrer">ThermoParcelIO.C</a></p><p>其中又调用了 <code>ParcelType::readFields(c);</code>，即 <code>ThermoParcel</code> 的模板兼基类 <code>KinematicParcel::readFields</code>。<br>定义于 <a href="https://github.com/OpenFOAM/OpenFOAM-7/blob/master/src/lagrangian/intermediate/parcels/Templates/KinematicParcel/KinematicParcelIO.C#L99" target="_blank" rel="external nofollow noopener noreferrer">KinematicParcelIO.C</a></p><p>其中又调用了 <code>ParcelType::readFields(c);</code>，即 <code>KinematicParcel</code> 的模板兼基类 <code>particle::readFields</code>。<br>定义于 <a href="https://github.com/OpenFOAM/OpenFOAM-7/blob/109ba3c8d53a8fa1e97854b168a16970aaeea951/src/lagrangian/basic/particle/particleTemplates.C#L42" target="_blank" rel="external nofollow noopener noreferrer">particleTemplates.C</a></p><p><code>initCloud</code> 定义：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ParticleType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:Cloud&lt;ParticleType&gt;::initCloud(<span class="keyword">const</span> <span class="keyword">bool</span> checkClass)</span><br><span class="line">&#123;</span><br><span class="line">    readCloudUniformProperties();</span><br><span class="line"></span><br><span class="line">    <span class="function">IOPosition&lt;Cloud&lt;ParticleType&gt;&gt; <span class="title">ioP</span><span class="params">(*<span class="keyword">this</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> valid = ioP.headerOk();</span><br><span class="line">    Istream&amp; is = ioP.readStream(checkClass ? typeName : <span class="string">""</span>, valid);</span><br><span class="line">    <span class="keyword">if</span> (valid)</span><br><span class="line">    &#123;</span><br><span class="line">        ioP.readData(is, *<span class="keyword">this</span>);</span><br><span class="line">        ioP.<span class="built_in">close</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!valid &amp;&amp; debug)</span><br><span class="line">    &#123;</span><br><span class="line">        Pout&lt;&lt; <span class="string">"Cannot read particle positions file:"</span> &lt;&lt; nl</span><br><span class="line">            &lt;&lt; <span class="string">"    "</span> &lt;&lt; ioP.objectPath() &lt;&lt; nl</span><br><span class="line">            &lt;&lt; <span class="string">"Assuming the initial cloud contains 0 particles."</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Ask for the tetBasePtIs to trigger all processors to build</span></span><br><span class="line">    <span class="comment">// them, otherwise, if some processors have no particles then</span></span><br><span class="line">    <span class="comment">// there is a comms mismatch.</span></span><br><span class="line">    polyMesh_.tetBasePtIs();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>函数调用过程：</p><img src="http://www.plantuml.com/plantuml/svg/xPPFKy8m4CNl_HGzmb6FuOIee-E8Z33SOzZII9hjR596_FIcDXsQ_iEZ1pZHtLzU-ZPl26oT4pyj51Oxnk28wWYpYBr83HctKlY6yVLD2fIXB-O43qCB6ZsPn9Dskzhezs4QsnHqFBcPHh7xi6Vz2S9ArA-u0yMO_7sUzJVTDZadU4HQmfVTo0pM5l81s81TeP5bPQvt2r3AWyqHb10d0QgokYBCWQm4uzbtu4vJx_-81mEx17UcVe7lCzXccjv42k9GALxoDOO6diR0jfynjiVBiiW-WDuIjy9fg1eDybIfCPRX4Lf9gitNY5CiptpBLL5BDNoFK_u0HfdEE_LWe0p4azlfu1h1bRYNnit6k5dKsfNfm4q9TWptEYh9MHC8pPJjTK495n0Q6XHRfTp08kLw3-Ci4hap7HRlliWJSBiXhaq25A2zWzg2GY7jwKosvjiDGRbiRZ6Jtzm60-u3xmZueSWRydeda-ZyBGhsw-Gzm_CUrzHUK_jFKkkp6rmDKYVehl7MBU2hmG--hxMpFb3EqLZ_H-07"><p><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayCloud.html#a9e3bb886209d951167cd385c1ffe0b00" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayCloud::evolve</code></a> 里边调用了 <a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicCloud.html#afa1e21a16cc62ccc11ccc7f665c5a144" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicCloud::solve</code></a>。<br><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicCloud.html#afa1e21a16cc62ccc11ccc7f665c5a144" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicCloud::solve</code></a> 里边调用了：</p><ul><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ThermoCloud.html#acc0c9e165d2cf19698ab1a7672a29ab6" target="_blank" rel="external nofollow noopener noreferrer"><code>ThermoCloud::preEvolve</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicCloud.html#aa8127553bbd9a6fb2451bf9252f4d0ec" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicCloud::evolveCloud</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayCloud.html#ac1b66fe77173de9e5e8542b2823d6071" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayCloud::info</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicCloud.html#a0bf23f36eb3424966e359419a566eb0a" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicCloud::postEvolve</code></a></li></ul><p><a href="https://cpp.openfoam.org/v6/classFoam_1_1ThermoCloud.html#acc0c9e165d2cf19698ab1a7672a29ab6" target="_blank" rel="external nofollow noopener noreferrer"><code>ThermoCloud::preEvolve</code></a> 里边调用了 <a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicCloud.html#acc0c9e165d2cf19698ab1a7672a29ab6" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicCloud::preEvolve</code></a>。<br><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicCloud.html#aa8127553bbd9a6fb2451bf9252f4d0ec" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicCloud::evolveCloud</code></a> 里边调用了：</p><ul><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ReactingCloud.html#acf214ed9b415b06b398e6fff63b72de0" target="_blank" rel="external nofollow noopener noreferrer"><code>ReactingCloud::resetSourceTerms</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1InjectionModel.html#a1efd0f4865994975c398a06e939ca132" target="_blank" rel="external nofollow noopener noreferrer"><code>InjectionModel::inject</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicCloud.html#a1edcf781ffdd6fb958953cdeddf71a33" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicCloud::motion</code></a></li><li><a href=""><code>StochasticCollisionModel::update</code></a></li></ul><p><a href="https://cpp.openfoam.org/v6/classFoam_1_1ReactingCloud.html#acf214ed9b415b06b398e6fff63b72de0" target="_blank" rel="external nofollow noopener noreferrer"><code>ReactingCloud::resetSourceTerms</code></a> 里边调用了：</p><ul><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ThermoCloud.html#acf214ed9b415b06b398e6fff63b72de0" target="_blank" rel="external nofollow noopener noreferrer"><code>ThermoCloud::resetSourceTerms</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicCloud.html#acf214ed9b415b06b398e6fff63b72de0" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicCloud::resetSourceTerms</code></a></li></ul><p><a href="https://cpp.openfoam.org/v6/classFoam_1_1InjectionModel.html#a1efd0f4865994975c398a06e939ca132" target="_blank" rel="external nofollow noopener noreferrer"><code>InjectionModel::inject</code></a> 里边调用了：</p><ul><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1InjectionModel.html#a0726459c9d46022422d21dffbeab6fe4" target="_blank" rel="external nofollow noopener noreferrer"><code>InjectionModel::prepareForNextTimeStep</code></a></li><li><a href=""><code>ConeNozzleInjection::setPositionAndCell</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayCloud.html#a3b7f36d51838109c584a2ae57c525d57" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayCloud::setParcelThermoProperties</code></a></li><li><a href=""><code>ConeNozzleInjection::setProperties</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayCloud.html#a4810c2551eb5f79b13085844cbbdbf89" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayCloud::checkParcelProperties</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1InjectionModel.html#a50d527210ab32e5c250fd6d77804d2f4" target="_blank" rel="external nofollow noopener noreferrer"><code>InjectionModel::setNumberOfParticles</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicParcel.html#ac2c0edbd947f1f38ebd3fcde0db7cd6a" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicParcel::move</code></a></li></ul><p><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicCloud.html#a1edcf781ffdd6fb958953cdeddf71a33" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicCloud::motion</code></a>里边调用了 <a href="https://cpp.openfoam.org/v6/classFoam_1_1Cloud.html#a927440a07e7ac9cd352f1c6fa795fd72" target="_blank" rel="external nofollow noopener noreferrer"><code>Cloud::move</code></a>。<br><a href="https://cpp.openfoam.org/v6/classFoam_1_1Cloud.html#a927440a07e7ac9cd352f1c6fa795fd72" target="_blank" rel="external nofollow noopener noreferrer"><code>Cloud::move</code></a> 又调用了 <a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicParcel.html#ac2c0edbd947f1f38ebd3fcde0db7cd6a" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicParcel::move</code></a>。</p><p><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicParcel.html#ac2c0edbd947f1f38ebd3fcde0db7cd6a" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicParcel::move</code></a> 里边调用了：</p><ul><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayParcel.html#ab9947c318454c7c84f1d08de15d3b6a4" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayParcel::setCellValues</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicParcel.html#a1bc117321c28afadf842ad099038e6e3" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicParcel::calcDispersion</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayParcel.html#afb56ef4d31b0047419b9a94d9d07e337" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayParcel::calc</code></a></li></ul><p><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayParcel.html#ab9947c318454c7c84f1d08de15d3b6a4" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayParcel::setCellValues</code></a> 里边调用了：</p><ul><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ReactingParcel.html#ab9947c318454c7c84f1d08de15d3b6a4" target="_blank" rel="external nofollow noopener noreferrer"><code>ReactingParcel::setCellValues</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ThermoParcel.html#ab9947c318454c7c84f1d08de15d3b6a4" target="_blank" rel="external nofollow noopener noreferrer"><code>ThermoParcel::setCellValues</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicParcel.html#ab9947c318454c7c84f1d08de15d3b6a4" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicParcel::setCellValues</code></a></li></ul><p><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayParcel.html#afb56ef4d31b0047419b9a94d9d07e337" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayParcel::calc</code></a> 里边调用了：</p><ul><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ReactingParcel.html#afb56ef4d31b0047419b9a94d9d07e337" target="_blank" rel="external nofollow noopener noreferrer"><code>ReactingParcel::calc</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayParcel.html#a5d5a39332fd9601bd70ac84d88d07ca1" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayParcel::calcAtomization</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayParcel.html#ac4be6f5656ddaff54ac59367ad4cb7e6" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayParcel::calcBreakup</code></a></li></ul><p><a href="https://cpp.openfoam.org/v6/classFoam_1_1ReactingParcel.html#afb56ef4d31b0047419b9a94d9d07e337" target="_blank" rel="external nofollow noopener noreferrer"><code>ReactingParcel::calc</code></a> 里边调用了：</p><ul><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ThermoParcel.html#aa693ff3229c8055efb30de7e7b5d4cd4" target="_blank" rel="external nofollow noopener noreferrer"><code>ThermoParcel::calcSurfaceValues</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ReactingParcel.html#a5448b022ac7f36caaf13cbc2a1d7ad55" target="_blank" rel="external nofollow noopener noreferrer"><code>ReactingParcel::calcPhaseChange</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ReactingParcel.html#a76ae2d53800c1eabf2b4f8d64b9a74fd" target="_blank" rel="external nofollow noopener noreferrer"><code>ReactingParcel::correctSurfaceValues</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ThermoParcel.html#a07a39662807bbdfccfc4fbf057b8ce48" target="_blank" rel="external nofollow noopener noreferrer"><code>ThermoParcel::calcHeatTransfer</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicParcel.html#a5fb95697e23fac02d5105e791201797d" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicParcel::calcVelocity</code></a></li></ul><p><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayCloud.html#ac1b66fe77173de9e5e8542b2823d6071" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayCloud::info</code></a> 里边调用了：</p><ul><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ReactingCloud.html#ac1b66fe77173de9e5e8542b2823d6071" target="_blank" rel="external nofollow noopener noreferrer"><code>ReactingCloud::info</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ThermoCloud.html#ac1b66fe77173de9e5e8542b2823d6071" target="_blank" rel="external nofollow noopener noreferrer"><code>ThermoCloud::info</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicCloud.html#ac1b66fe77173de9e5e8542b2823d6071" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicCloud::info</code></a></li></ul><p>经过验证，<code>ThermoParcel::calc</code> 函数从来没有被调用！<br><code>KinematicParcel::calc</code> 函数也从来没有被调用！</p><p><code>move</code> 定义于 <code>KinematicParcel</code> 和 <code>Cloud</code> 中。<br><code>Cloud</code> 中的 <code>move</code> 一个时间步长内只调用一次。</p><p><code>Added 10 new parcels</code>，对应 <code>KinematicParcel::move</code> 就调用 10 次，这里是在 <code>InjectionModel::inject</code> 中被调用的。后来如果破碎了，parcels 数变成 20 了，那么 move 函数又调用 20 次，这里是在 <code>KinematicCloud::motion</code> 中被调用的。</p><p><code>KinematicParcel::move</code> 调用了 <code>SprayParcel::calc</code>，并且每个 <code>move</code> 函数内，<code>calc</code> 调用不止一次。<br><code>SprayParcel::calc</code>中调用了喷雾的 <code>calcAtomization</code> 和 <code>calcBreakup</code>，因此这个里边，粒子直径被修改了，粒子个数也可能被修改。</p><p>以下 UML 图来自 <a href="https://openfoamwiki.net/index.php/OpenFOAM_guide/UML/lagrangian" target="_blank" rel="external nofollow noopener noreferrer">openfoamwiki</a>，基于OF2.3.X，可供参考。</p><details><summary>Click to expand!</summary><p><img src="https://openfoamwiki.net/images/d/df/UML_lagrangian_solver2Cloud.png" alt=""><br><img src="https://openfoamwiki.net/images/0/05/UML_lagrangian_cloud2Particle.png" alt=""><br><img src="https://openfoamwiki.net/images/5/51/UML_lagrangian_particleType.png" alt=""><br><img src="https://openfoamwiki.net/images/a/a7/UML_lagrangian_CFO_readRTST.png" alt=""><br><img src="https://openfoamwiki.net/images/1/1a/UML_lagrangian_CFO_defRTST.png" alt=""></p></details><p>喷雾信息输出到info:</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Solving <span class="number">3</span>-D cloud sprayCloud</span><br><span class="line"></span><br><span class="line">Cloud: sprayCloud injector: model1</span><br><span class="line">    Added <span class="number">18</span> <span class="keyword">new</span> parcels</span><br><span class="line"></span><br><span class="line">Cloud: sprayCloud</span><br><span class="line">    Current number of parcels       = <span class="number">18</span></span><br><span class="line">    Current mass in system          = <span class="number">1.19539e-11</span></span><br><span class="line">    Linear momentum                 = (<span class="number">-1.22046e-12</span> <span class="number">2.17761e-13</span> <span class="number">-1.86459e-11</span>)</span><br><span class="line">   |Linear momentum|                = <span class="number">1.86871e-11</span></span><br><span class="line">    Linear kinetic energy           = <span class="number">2.07355e-11</span></span><br><span class="line">    model1:</span><br><span class="line">        number of parcels added     = <span class="number">18</span></span><br><span class="line">        mass introduced             = <span class="number">1.19539e-11</span></span><br><span class="line">    Parcel fate (number, mass)</span><br><span class="line">      - escape                      = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">      - stick                       = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    Temperature <span class="built_in">min</span>/<span class="built_in">max</span>             = <span class="number">358.01</span>, <span class="number">358.026</span></span><br><span class="line">    Mass <span class="built_in">transfer</span> phase change      = <span class="number">5.38154e-18</span></span><br><span class="line">    D10, D32, Dmax (mu)             = <span class="number">178.438</span>, <span class="number">274.262</span>, <span class="number">337.897</span></span><br><span class="line">    Liquid penetration <span class="number">95</span>% mass (m) = <span class="number">1.59326e-06</span></span><br></pre></td></tr></table></figure><p>代码中的调用顺序：<br>在 <code>KinematicCloud::solve</code> 中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">cloud.info();</span><br></pre></td></tr></table></figure><p>这里的 <code>cloud</code> 类型是模板 <code>TrackCloudType</code>。为了搞清楚它的真实面目，我们修改一下这里的代码，然后编译（这里必须执行 Lagrangian 库下的 Allwmake，然后编译求解器）。<br>后来发现好像只需要编译求解器就行了，因为那些是模板，在求解器中才实例化？<br>添加下面的代码到任意位置：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">cloud.abc();</span><br></pre></td></tr></table></figure><p>编译库是并不会报错，编译求解器时报错如下：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">src/lagrangian/intermediate/lnInclude/KinematicCloud.C(<span class="number">97</span>): error: <span class="class"><span class="keyword">class</span> "<span class="title">Foam</span>:</span>:SprayCloud&lt;Foam::ReactingCloud&lt;Foam::ThermoCloud&lt;Foam::KinematicCloud&lt;Foam::Cloud&lt;Foam::basicSprayParcel&gt;&gt;&gt;&gt;&gt;<span class="string">" has no member "</span>abc<span class="string">"</span></span><br><span class="line"><span class="string">      cloud.abc();</span></span><br></pre></td></tr></table></figure><p>所以这里的 <code>cloud</code> 是 <code>SprayCloud</code>，它的 <code>info</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:SprayCloud&lt;CloudType&gt;::info()</span><br><span class="line">&#123;</span><br><span class="line">    CloudType::info();</span><br><span class="line">    scalar d32 = <span class="number">1.0e+6</span>*<span class="keyword">this</span>-&gt;Dij(<span class="number">3</span>, <span class="number">2</span>);</span><br><span class="line">    scalar d10 = <span class="number">1.0e+6</span>*<span class="keyword">this</span>-&gt;Dij(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    scalar dMax = <span class="number">1.0e+6</span>*<span class="keyword">this</span>-&gt;Dmax();</span><br><span class="line">    scalar pen = <span class="keyword">this</span>-&gt;penetration(<span class="number">0.95</span>);</span><br><span class="line"></span><br><span class="line">    Info &lt;&lt; <span class="string">"    D10, D32, Dmax (mu)             = "</span> &lt;&lt; d10 &lt;&lt; <span class="string">", "</span> &lt;&lt; d32</span><br><span class="line">         &lt;&lt; <span class="string">", "</span> &lt;&lt; dMax &lt;&lt; nl</span><br><span class="line">         &lt;&lt; <span class="string">"    Liquid penetration 95% mass (m) = "</span> &lt;&lt; pen &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Foam</span>:</span>:scalar Foam::KinematicCloud&lt;CloudType&gt;::Dmax() <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    scalar d = -great;</span><br><span class="line">    forAllConstIter(<span class="keyword">typename</span> KinematicCloud&lt;CloudType&gt;, *<span class="keyword">this</span>, iter)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> parcelType&amp; p = iter();</span><br><span class="line">        d = <span class="built_in">max</span>(d, p.d());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    reduce(d, maxOp&lt;scalar&gt;());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">max</span>(<span class="number">0.0</span>, d);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SprayCloud</code> 的 <code>CloudType</code> 是 <code>ReactingCloud</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:ReactingCloud&lt;CloudType&gt;::info()</span><br><span class="line">&#123;</span><br><span class="line">    CloudType::info();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>-&gt;phaseChange().info(Info);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ReactingCloud</code> 的 <code>CloudType</code> 是 <code>ThermoCloud</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:ThermoCloud&lt;CloudType&gt;::info()</span><br><span class="line">&#123;</span><br><span class="line">    CloudType::info();</span><br><span class="line"></span><br><span class="line">    Info&lt;&lt; <span class="string">"    Temperature min/max             = "</span> &lt;&lt; Tmin() &lt;&lt; <span class="string">", "</span> &lt;&lt; Tmax()</span><br><span class="line">        &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ThermoCloud</code> 的 <code>CloudType</code> 是 <code>KinematicCloud</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:KinematicCloud&lt;CloudType&gt;::info()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">vector</span> linearMomentum = linearMomentumOfSystem();</span><br><span class="line">    reduce(linearMomentum, sumOp&lt;<span class="built_in">vector</span>&gt;());</span><br><span class="line"></span><br><span class="line">    scalar linearKineticEnergy = linearKineticEnergyOfSystem();</span><br><span class="line">    reduce(linearKineticEnergy, sumOp&lt;scalar&gt;());</span><br><span class="line"></span><br><span class="line">    Info&lt;&lt; <span class="string">"Cloud: "</span> &lt;&lt; <span class="keyword">this</span>-&gt;name() &lt;&lt; nl</span><br><span class="line">        &lt;&lt; <span class="string">"    Current number of parcels       = "</span></span><br><span class="line">        &lt;&lt; returnReduce(<span class="keyword">this</span>-&gt;<span class="built_in">size</span>(), sumOp&lt;label&gt;()) &lt;&lt; nl</span><br><span class="line">        &lt;&lt; <span class="string">"    Current mass in system          = "</span></span><br><span class="line">        &lt;&lt; returnReduce(massInSystem(), sumOp&lt;scalar&gt;()) &lt;&lt; nl</span><br><span class="line">        &lt;&lt; <span class="string">"    Linear momentum                 = "</span></span><br><span class="line">        &lt;&lt; linearMomentum &lt;&lt; nl</span><br><span class="line">        &lt;&lt; <span class="string">"   |Linear momentum|                = "</span></span><br><span class="line">        &lt;&lt; mag(linearMomentum) &lt;&lt; nl</span><br><span class="line">        &lt;&lt; <span class="string">"    Linear kinetic energy           = "</span></span><br><span class="line">        &lt;&lt; linearKineticEnergy &lt;&lt; nl;</span><br><span class="line"></span><br><span class="line">    injectors_.info(Info);</span><br><span class="line">    <span class="keyword">this</span>-&gt;surfaceFilm().info(Info);</span><br><span class="line">    <span class="keyword">this</span>-&gt;patchInteraction().info(Info);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Lagrangian </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM 场（field）的操作和运算</title>
      <link href="/fields/"/>
      <url>/fields/</url>
      
        <content type="html"><![CDATA[<p><strong>F</strong>ield <strong>O</strong>peration <strong>A</strong>nd <strong>M</strong>anipulation</p><a id="more"></a><h1 id="field-相关类的结构"><a class="markdownIt-Anchor" href="#field-相关类的结构"></a> field 相关类的结构</h1><p>几个常见的类：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">volScalarField</span><br><span class="line">volVectorField</span><br><span class="line">surfaceScalarField</span><br><span class="line">surfaceVectorField</span><br></pre></td></tr></table></figure><p>其实它们都是别名，定义如下：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> GeometricField&lt;scalar, fvPatchField, volMesh&gt; volScalarField;<span class="comment">//src\finiteVolume\fields\volFields\volFieldsFwd.H</span></span><br><span class="line"><span class="keyword">typedef</span> GeometricField&lt;<span class="built_in">vector</span>, fvPatchField, volMesh&gt; volVectorField;</span><br><span class="line"><span class="keyword">typedef</span> GeometricField&lt;scalar, fvsPatchField, surfaceMesh&gt; surfaceScalarField;<span class="comment">//src\finiteVolume\fields\surfaceFields\surfaceFieldsFwd.H</span></span><br><span class="line"><span class="keyword">typedef</span> GeometricField&lt;<span class="built_in">vector</span>, fvsPatchField, surfaceMesh&gt; surfaceVectorField;</span><br></pre></td></tr></table></figure><p>发现，它们实际上都是 <code>GeometricField</code>，不过是提供的模板不同。<br>下面给出 <code>GeometricField</code> 类的 UML 类图。首先我们看到它需要三个模板：<code>&lt;Type,PatchField,GeoMesh&gt;</code>。<br>结合 <code>volScalarField</code> 和 <code>surfaceScalarField</code> 的定义，我们不难发现：第一个 <code>Type</code> 可以是 <code>scalar</code> <code>vector</code> 等，第二个 <code>PatchField</code> 可以是 <code>fvPatchField</code> <code>fvsPatchField</code>（这里的 s 表示 surface） 等，第三个 <code>GeoMesh</code> 可以是 <code>volMesh</code> <code>surfaceMesh</code> 等。</p><img src="http://www.plantuml.com/plantuml/svg/pLfBRoEv4RxhLn1x4DJhDdO3v2G_0Azb3mIi7x0zkqU1wgRiplGBR4eUH_4f0N99W3qaG91Va4kGFUQIVvFPpSz8yTLDijbI-pN97COjibui5ejVLVSaoKXU9KLEujE4f37Q_yrkNDpdk-WTAJB2Q1A9yK6Kugfo1lTl7aeINc8MtOdV8KoVaUhkS3r0y6ysGvSqMM56q1d9veIYqsKUCL1MmPmWsPqNHOeemV5qSKb9HN8s2foPYpI-0IjT0YvzEK-J236m8YQBMkYE6X0JESu8KdQDn_n_nF_RHlXDiSnZJ1y4W_d3PfmuxfCUqM8EqJHdXEOujRaQZmdwGpdGOP91Dnv7MSdu8z8FhgDZp73jt6p9y3mbACLpaYB6dPZ7vACpwzjJmyHcDL-Y1H_u-fBH5ug0dLnDmJED9ErYD5SFWd7MEuvMHHABQ15yrIY2IORYH921k67WfwjZgKloZjx28R0j5FrEagT93hiWj3GKYNeImaU1dD_8iRAfwbtN5EEnaCKzEaGbJRA49IiYnguwp7cA35kxteIXlGjTYZh8lUjsGh2RPcWIoMcnPnKhA56feBBPM_Fsj5IT-tdbIdh7xn0LFXNFuNTjrsVYXVQLNZ52JLHGIYAcj-suoED4nBesHgJSd12-uuIIF7AMoR9otp55vo6_EOV0dPMG7I5hwnF9JG2bbc2X-9ucZ4mWVuqkAWP7D1jkKxv9yOt70PIa-ACof8fmYYd2QNc7WnQD6halAEmEIS7aaR1naS1vQWiMffyb-HcmQkDHKVaiA5CS4JH2ZZj2vDtfpUuTek0fikFcige5EpAosZyciIIqw9Ay7nt-26unJ7A9kQG92pVCuuyJvjfO2-n_C3QeS1RsTi9vp94NY7z26dXDjPshWclpc5FGPGGPhBaoRHKgKAONnVnN4933KFxcElHphU6QrFFyx44wgmtZcWzSv0I82AVHCWLi80X6GR3toZPycrHiYEunNAQnKC_rL2q27B4bJXi2T51FlePHjUl_rzxn6VBPNLJZ9_KRS2INikyw09BHQuQ38VajDB_0rWRcRfBH_-Y3cCV1mAP7ExkxXpNe6uWnfsQi9sMrg7_shnEjyiL6cMB1Q0u8xcxcWFP52xJRC7_aecvHXBIT9vxDpBaimI1oN935eh8G6rdXT0bJ9b3WSI30T-L7rJLAddPN2T_6Ip6xW8jSJ4DyLIB0PA6Ow4b7Hzh5ft3Ej8ElGIydEQCF8pEvV20F_2547aG3mJ60SkWOLiJuzk-Y9Xm6waoqncLGD0FxAkh4qjPR2p4E0DlCDP3fYpLDh3JgG4eRr0o3_c8qa-Rnhq1Ptm1MxbpktbjzvgKdtLx3e3vydZdfwotjYVMhDrBCfaPzBxr-OyD8WQX92BjcpcuIUFMCBaBJR39FX4WR4yWHuh30zVK5JmFaY-rD16y-CZDFBJhihz2knXjlR6WyMBUQuI8lIpUnHx9vDqgxlJ9zPCtXQCLhK_zuIifsfOEUKN7rqFd4EgllIcgnNWPtsKv1sm9a2Ay8nRTa6zazIMxl0AWTIV9w6Iq3vCrXUU5vahtBSwMxuZjQ0jh7llFnb9O2JxAU2spWN5pcdRLltrF7THZoZDQTCiiRYXDMRKrq4mAwA97IYWMgbdEPu5t9rsf2ULtJRSL465M49W2xGNY6o_OWhKT5dECbAyvmEJBED_mi2UL5UQdob70pZAOFfsbIGeQ2Of2urzt-crpIxmKkUjR5xBFiHHSxoKfUPUtBSFdk-hIWsQ7wY-Pf4NrGecGpicAOibPtoomVlFshPm8r4oWiLWqCLy5j3ZanxhjyLKjISQaQr9hgI6Mh8bLvn6gJpuppAl6sDPJXF2bb2Nk6eHPHRozaQwxKjUJsYW1SpW3Yc7vpYsDLEgqIokjKf1f-7qdr7RzqzNwiAM5BcgC5JYkoz-ZX0QScjpb_CUBoyCFXPOcAPPcIU9CEMDnH102-SZP2GiGhSWkdGTGmSorbhtk_N4Lo4xLf_RRH-x932xIts1PiOG3_-uW-OemMYDm_pv94R6Ys5aCtgHcDhc0Tf1PjAqnThdOSD_lAqsgIt_hgM1KadeHi7bkLbmCF4q_g7WwxYo6oacZIr53sH5Qu75HrczNAMbN-Zc87-MqZDllnOXvYcAGCox9Rk_6yO5D8iWHY4boufxpw9RjBAlT4TPVkROBl5MPHX1vR9AgfWYsB4J6qeRAtT7k8pLtfvpuXv9nRDo-Mr3u-J_LMaYViHFSqL6TBNYQ0M8eigsJ3hdv41vxfyLZST139mTgdXBoYWYs-4MMITh3SMmkEcXZKW9veZHpF8SjrwB6FtkO5ssVJUmi7AG5EUycZjnLVhwphxBxwycpFZjvM_9ijJxt5qlU1kYyMA_dGlFZYluBdiuQzara3Bbjr4k17kmjbjAKKVZH6rgAkaiFDcDra4bXIj4dhwuJaoqpXc6k0QMJzxk9Y4dvpD7aqviMdG2M_XzPdxwzlPbSdHvEmVffDJsTd5vFfwVHa4kg1owkJwvFpc_3yGj2OqiHgbRYZzpSNi--lfZSdKBzypQdrZr-OB8ia9STt9FeWSj6QVwO0rcPbM3-TuGhEHvZa1KiM3_gl77tqmD1pg0_Z4v2zRyiEqIyF7NMSjDhO4nE0c5USvkyxS1gXntn3pfifs6CEDy0yFSALSGAu2C32F6gDGzx5gTLzQ-DEDTri5ABmLvlJE1pTDyFgAoykXD0B8TASkKsBEKwjSIDEk0tYORRnTQIEHAjeufvI9qGlSbYlFlGlaQgdq5pYWOgkq5hXWOwYqBF20wD8VhPnpOJOcyzXSjZQ4pWZeaRnBwOn4R3AtV-3XH0YxqXEA2GzR1LJqZR-POxy0Ca2RziABOEesJ-t0117Ku4lazOveYwRUuALX0xUBLnsPI3wKtRSaNjE7go5iU0wDG3iTLvlzVtMTdlAd5T0nnox5aDxJqfb6_lwkm8k2k0rszkO1mmhp5M7ljwu7kJ2WwUnkn_2jFdabtWi68irZiRZqu83NR4TB0X2OuaZU4uXJeDGhX3cDROsvKxrjRt5rBvqNe-yYBdZWqpOgsjv9MPREZVjVdDQ51-MvGMTa0LUfbO6RR_R3JjUWF2l49IFGtDtOYbKj7w0nEdY_fhG8lZgg__y-DkV__Itd__wkv_-yez6rx__-NSO-lJ37pxzyCTFl__NJt_-yGqMqjlAdhgFulYcuAtq6lQgtJHLenvEH4-p3xs5WVsLx_MDmgxqRixsUxjcchWoEuljzofrT_eLs-R-hm23hfSw_kyeSTprXVMEvuj-3-dZuBy0"><p><code>GeometricField</code> 类定义于 <code>src\OpenFOAM\fields\GeometricFields\GeometricField</code>。</p><ul><li><code>GeometricField</code>–场+网格，包含内部场及其边界场，边界场是场的场（FieldField）</li><li><code>DimensionedField</code>–带单位的场，只有内部场，没有边界场</li><li><code>Field</code>–数组（即 List）+代数操作</li></ul><h1 id="field-相关类的用法"><a class="markdownIt-Anchor" href="#field-相关类的用法"></a> field 相关类的用法</h1><h2 id="构造"><a class="markdownIt-Anchor" href="#构造"></a> 构造</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">volScalarField A_</span><br><span class="line">(</span><br><span class="line">    IOobject</span><br><span class="line">    (</span><br><span class="line">        <span class="string">"A"</span>,</span><br><span class="line">        mesh.time().timeName(),</span><br><span class="line">        mesh, <span class="comment">//字典注册对象</span></span><br><span class="line">        IOobject::MUST_READ, <span class="comment">// MUST_READ_IF_MODIFIED  NO_READ READ_IF_PRESENT</span></span><br><span class="line">        IOobject::AUTO_WRITE, <span class="comment">// NO_WRITE</span></span><br><span class="line">        <span class="literal">true</span> <span class="comment">//默认是注册</span></span><br><span class="line">    ),</span><br><span class="line">    mesh</span><br><span class="line">)</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">volScalarField B_</span><br><span class="line">(</span><br><span class="line">    IOobject</span><br><span class="line">    (</span><br><span class="line">        <span class="string">"B"</span>,</span><br><span class="line">        mesh.time().timeName(),</span><br><span class="line">        mesh,</span><br><span class="line">        IOobject::NO_READ,</span><br><span class="line">        IOobject::NO_WRITE</span><br><span class="line">    ),</span><br><span class="line">    mesh,</span><br><span class="line">    dimensionedScalar(dimensionSet(<span class="number">1</span>, <span class="number">-3</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), <span class="number">0.</span>)</span><br><span class="line">    <span class="comment">// 量纲还可以：dimless，或者 dimMass/dimVolume</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>上述两种构造函数对应 <code>GeometricField</code> 源代码中的：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">GeometricField(<span class="keyword">const</span> IOobject&amp;,<span class="keyword">const</span> Mesh&amp;);</span><br><span class="line">GeometricField(<span class="keyword">const</span> IOobject&amp;,<span class="keyword">const</span> Mesh&amp;,<span class="keyword">const</span> dimensioned&lt;Type&gt;&amp;,<span class="keyword">const</span> <span class="keyword">word</span>&amp; patchFieldType=PatchField&lt;Type&gt;::calculatedType());</span><br></pre></td></tr></table></figure><p>第一种是从文件中读取，内部场和边界场的初始值都由文件给定，边界条件也由文件给定。<br>第二种不需要从文件中读取，内部场和边界场的初始值都是这里给定的 0，边界条件默认是 calculated。也可以指定边界条件类型，如：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">volScalarField C_</span><br><span class="line">(</span><br><span class="line">    IOobject</span><br><span class="line">    (</span><br><span class="line">        <span class="string">"C"</span>,</span><br><span class="line">        mesh.time().timeName(),</span><br><span class="line">        mesh,</span><br><span class="line">        IOobject::NO_READ,</span><br><span class="line">        IOobject::NO_WRITE</span><br><span class="line">    ),</span><br><span class="line">    mesh,</span><br><span class="line">    dimensionedScalar(dimensionSet(<span class="number">1</span>, <span class="number">-3</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), <span class="number">0.</span>),</span><br><span class="line">    zeroGradientFvPatchScalarField::typeName</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>除了常规的 <code>IOobject</code> 构造，还有复制构造：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">tmp&lt;volScalarField&gt; tmagGradP = mag(fvc::grad(p));</span><br><span class="line">volScalarField normalisedGradP</span><br><span class="line">(</span><br><span class="line">    <span class="string">"normalisedGradP"</span>,<span class="comment">//如果不指定名字，默认是什么？</span></span><br><span class="line">    tmagGradP()/<span class="built_in">max</span>(tmagGradP())</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2 id="获取"><a class="markdownIt-Anchor" href="#获取"></a> 获取</h2><ul><li>const<ul><li><code>Internal&amp; internalField()</code>, 有量纲的内部场</li><li><code>Internal::FieldType&amp; primitiveField()</code>, 无量纲的内部场</li><li><code>Boundary&amp; boundaryField()</code>, 无量纲的边界场</li></ul></li></ul><p>-non-const<br>* <code>ref()</code>, 有量纲的内部场<br>* <code>primitiveFieldRef()</code>, 无量纲的内部场<br>* <code>boundaryFieldRef()</code>, 无量纲的边界场</p><p>用 <code>forAll</code> 来遍历的时候，遍历的其实就是那个 <code>field&lt;Type&gt;</code>。<br>所以总体是有量纲的，用 <code>forAll</code> 对每个 cell 或 face 遍历的时候，就失去量纲了。</p><p>使用举例：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt;<span class="string">"T============"</span>&lt;&lt;thermo.T()&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 有量纲的 内部+边界</span></span><br><span class="line">Info&lt;&lt;<span class="string">"T.internalField()============"</span>&lt;&lt;thermo.T().internalField()&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 有量纲的 内部+边界</span></span><br><span class="line">Info&lt;&lt;<span class="string">"T.primitiveField()============"</span>&lt;&lt;thermo.T().primitiveField()&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 无量纲的 内部</span></span><br><span class="line">Info&lt;&lt;<span class="string">"T.boundaryField()============"</span>&lt;&lt;thermo.T().boundaryField()&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 无量纲的 边界</span></span><br><span class="line">Info&lt;&lt;<span class="string">"T.ref()============"</span>&lt;&lt;thermo.T().ref()&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 有量纲的 内部+边界</span></span><br><span class="line">Info&lt;&lt;<span class="string">"T.primitiveFieldRef()============"</span>&lt;&lt;thermo.T().primitiveFieldRef()&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 无量纲的 内部</span></span><br><span class="line">Info&lt;&lt;<span class="string">"T.boundaryFieldRef()============"</span>&lt;&lt;thermo.T().boundaryFieldRef()&lt;&lt;<span class="built_in">endl</span>; <span class="comment">//无量纲的 边界</span></span><br></pre></td></tr></table></figure><p>T文件：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">dimensions [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">internalField uniform <span class="number">900</span>;</span><br><span class="line"></span><br><span class="line">boundaryField</span><br><span class="line">&#123;</span><br><span class="line">    walls</span><br><span class="line">    &#123;</span><br><span class="line">        type fixedValue;</span><br><span class="line">        value uniform <span class="number">1800</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">T============dimensions      [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">internalField   uniform <span class="number">900</span>;</span><br><span class="line"></span><br><span class="line">boundaryField</span><br><span class="line">&#123;</span><br><span class="line">    walls</span><br><span class="line">    &#123;</span><br><span class="line">        type            fixedValue;</span><br><span class="line">        value           uniform <span class="number">1800</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">T.internalField()============dimensions      [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">internalField   uniform <span class="number">900</span>;</span><br><span class="line"></span><br><span class="line">boundaryField</span><br><span class="line">&#123;</span><br><span class="line">    walls</span><br><span class="line">    &#123;</span><br><span class="line">        type            fixedValue;</span><br><span class="line">        value           uniform <span class="number">1800</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">T.primitiveField()============<span class="number">8</span>&#123;<span class="number">900</span>&#125;</span><br><span class="line">T.boundaryField()============</span><br><span class="line"><span class="number">1</span></span><br><span class="line">(</span><br><span class="line">    type            fixedValue;</span><br><span class="line">    value           uniform <span class="number">1800</span>;</span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">T.ref()============dimensions      [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">internalField   uniform <span class="number">900</span>;</span><br><span class="line"></span><br><span class="line">boundaryField</span><br><span class="line">&#123;</span><br><span class="line">    walls</span><br><span class="line">    &#123;</span><br><span class="line">        type            fixedValue;</span><br><span class="line">        value           uniform <span class="number">1800</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">T.primitiveFieldRef()============<span class="number">8</span>&#123;<span class="number">900</span>&#125;</span><br><span class="line">T.boundaryFieldRef()============</span><br><span class="line"><span class="number">1</span></span><br><span class="line">(</span><br><span class="line">    type            fixedValue;</span><br><span class="line">    value           uniform <span class="number">1800</span>;</span><br><span class="line"></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>这里有一个奇怪的现象，即 ref 指的是内部场，但这里输出的确实内部+边界。不要被这里迷惑了，其它地方仍指的是内部场：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">dimensionedScalar <span class="title">A</span><span class="params">(dimTemperature, <span class="number">100.</span>)</span></span>;</span><br><span class="line">thermo.T().ref() = A;</span><br><span class="line">Info&lt;&lt;<span class="string">"T============"</span>&lt;&lt;thermo.T()&lt;&lt;<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">T============dimensions      [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">internalField   uniform <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">boundaryField</span><br><span class="line">&#123;</span><br><span class="line">    walls</span><br><span class="line">    &#123;</span><br><span class="line">        type            fixedValue;</span><br><span class="line">        value           uniform <span class="number">1800</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="场的操作和运算-field-operation-and-manipulation"><a class="markdownIt-Anchor" href="#场的操作和运算-field-operation-and-manipulation"></a> 场的操作和运算( Field Operation And Manipulation)</h1><h2 id="ioobject-中定义的函数"><a class="markdownIt-Anchor" href="#ioobject-中定义的函数"></a> IOobject 中定义的函数</h2><ul><li>writeOpt<br>使用举例：</li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">mu_.writeOpt() = IOobject::AUTO_WRITE;</span><br></pre></td></tr></table></figure><h2 id="dimensionedfield-中定义的函数"><a class="markdownIt-Anchor" href="#dimensionedfield-中定义的函数"></a> DimensionedField 中定义的函数</h2><ul><li>平均</li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">p.average() = gAverage(p)</span><br></pre></td></tr></table></figure><ul><li>加权平均</li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">p.weightedAverage(weightField) = gSum(weightField*p)/gSum(weightField)</span><br></pre></td></tr></table></figure><p>使用举例：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt;<span class="string">"average p is "</span>&lt;&lt;p.weightedAverage(mesh.V()).value()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="comment">//全场压力的体积加权平均值</span></span><br></pre></td></tr></table></figure><ul><li>dimensions<br>使用举例：</li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Z_.dimensions().reset(dimless);</span><br></pre></td></tr></table></figure><h2 id="geometricfield-中定义的函数"><a class="markdownIt-Anchor" href="#geometricfield-中定义的函数"></a> GeometricField 中定义的函数</h2><ul><li>max, min<br>取最大值，包括内部场和边界场。并行计算时，Info输出的是master的还是全局的？未测试<br>使用举例：</li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt;<span class="string">"T=== "</span>&lt;&lt;<span class="built_in">max</span>(thermo.T())&lt;&lt;<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure><ul><li>writeMinMax<br>输出最小最大值，只包括内部场。</li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Type</span>, <span class="title">template</span>&lt;class&gt; <span class="title">class</span> <span class="title">PatchField</span>, <span class="title">class</span> <span class="title">GeoMesh</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:GeometricField&lt;Type, PatchField, GeoMesh&gt;::writeMinMax</span><br><span class="line">(</span><br><span class="line">    Ostream&amp; os</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    os  &lt;&lt; <span class="string">"min/max("</span> &lt;&lt; <span class="keyword">this</span>-&gt;name() &lt;&lt; <span class="string">") = "</span></span><br><span class="line">        &lt;&lt; Foam::<span class="built_in">min</span>(*<span class="keyword">this</span>).value() &lt;&lt; <span class="string">", "</span></span><br><span class="line">        &lt;&lt; Foam::<span class="built_in">max</span>(*<span class="keyword">this</span>).value()</span><br><span class="line">        &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用举例：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Z_.writeMinMax(Info);</span><br></pre></td></tr></table></figure><p>下面是详细的测试：<br>T文件：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">dimensions [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">internalField uniform <span class="number">900</span>;</span><br><span class="line"></span><br><span class="line">boundaryField</span><br><span class="line">&#123;</span><br><span class="line">    walls</span><br><span class="line">    &#123;</span><br><span class="line">        type fixedValue;</span><br><span class="line">        value uniform <span class="number">1800</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用举例：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt;<span class="string">"max(T)=== "</span>&lt;&lt;<span class="built_in">max</span>(thermo.T())&lt;&lt;<span class="built_in">endl</span>; <span class="comment">//内部+边界</span></span><br><span class="line">Info&lt;&lt;<span class="string">"min(T)=== "</span>&lt;&lt;<span class="built_in">min</span>(thermo.T())&lt;&lt;<span class="built_in">endl</span>; <span class="comment">//内部+边界</span></span><br><span class="line">Info&lt;&lt;<span class="string">"max(T.internalField)=== "</span>&lt;&lt;<span class="built_in">max</span>(thermo.T().internalField())&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 内部</span></span><br><span class="line">Info&lt;&lt;<span class="string">"min(T.internalField)=== "</span>&lt;&lt;<span class="built_in">min</span>(thermo.T().internalField())&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 内部</span></span><br><span class="line">Info&lt;&lt;<span class="string">"max(T.ref)=== "</span>&lt;&lt;<span class="built_in">max</span>(thermo.T().ref())&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 内部</span></span><br><span class="line">Info&lt;&lt;<span class="string">"min(T.ref)=== "</span>&lt;&lt;<span class="built_in">min</span>(thermo.T().ref())&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 内部</span></span><br><span class="line">Info&lt;&lt;<span class="string">"max(T.boundaryField)=== "</span>&lt;&lt;<span class="built_in">max</span>(thermo.T().boundaryField())&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 边界</span></span><br><span class="line">Info&lt;&lt;<span class="string">"min(T.boundaryField)=== "</span>&lt;&lt;<span class="built_in">min</span>(thermo.T().boundaryField())&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 边界</span></span><br><span class="line">thermo.T().writeMinMax(Info); <span class="comment">// 内部</span></span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">max</span>(T)=== <span class="built_in">max</span>(T) [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>] <span class="number">1800</span></span><br><span class="line"><span class="built_in">min</span>(T)=== <span class="built_in">min</span>(T) [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>] <span class="number">900</span></span><br><span class="line"><span class="built_in">max</span>(T.internalField)=== <span class="built_in">max</span>(T) [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>] <span class="number">900</span></span><br><span class="line"><span class="built_in">min</span>(T.internalField)=== <span class="built_in">min</span>(T) [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>] <span class="number">900</span></span><br><span class="line"><span class="built_in">max</span>(T.ref)=== <span class="built_in">max</span>(T) [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>] <span class="number">900</span></span><br><span class="line"><span class="built_in">min</span>(T.ref)=== <span class="built_in">min</span>(T) [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>] <span class="number">900</span></span><br><span class="line"><span class="built_in">max</span>(T.boundaryField)=== <span class="number">1800</span></span><br><span class="line"><span class="built_in">min</span>(T.boundaryField)=== <span class="number">1800</span></span><br><span class="line"><span class="built_in">min</span>/<span class="built_in">max</span>(T) = <span class="number">900</span>, <span class="number">900</span></span><br></pre></td></tr></table></figure><ul><li>gMax<br>max的并行版，但是返回的是无量纲的值？</li></ul><h2 id="fieldfunctions"><a class="markdownIt-Anchor" href="#fieldfunctions"></a> FieldFunctions</h2><p>一些底层的函数，一般用不到</p><h2 id="dimensionedfieldfunctions"><a class="markdownIt-Anchor" href="#dimensionedfieldfunctions"></a> DimensionedFieldFunctions</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">pow</span></span><br><span class="line">sqr</span><br><span class="line">magSqr</span><br><span class="line">mag</span><br><span class="line">cmptAv</span><br><span class="line">gMax</span><br><span class="line">gMin</span><br><span class="line">gSum</span><br><span class="line">gSumMag</span><br><span class="line">gAverage</span><br><span class="line">+</span><br><span class="line">-</span><br><span class="line">*外积</span><br><span class="line">/</span><br><span class="line">^叉乘</span><br><span class="line">&amp;点乘，内积</span><br><span class="line">&amp;&amp; 双内积</span><br></pre></td></tr></table></figure><h2 id="geometricfieldfunctions"><a class="markdownIt-Anchor" href="#geometricfieldfunctions"></a> GeometricFieldFunctions</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">pow</span></span><br><span class="line">sqr</span><br><span class="line">magSqr</span><br><span class="line">mag</span><br><span class="line">cmptAv</span><br><span class="line">gMax返回的是无量纲的？</span><br><span class="line">gMin</span><br><span class="line">gSum</span><br><span class="line">gSumMag</span><br><span class="line">gAverage</span><br><span class="line">+</span><br><span class="line">-</span><br><span class="line">*外积</span><br><span class="line">/</span><br><span class="line">^叉乘</span><br><span class="line">&amp;点乘，内积</span><br><span class="line">&amp;&amp; 双内积</span><br></pre></td></tr></table></figure><h2 id="fvc-中的操作"><a class="markdownIt-Anchor" href="#fvc-中的操作"></a> fvc 中的操作</h2><h3 id="volumeintegrate"><a class="markdownIt-Anchor" href="#volumeintegrate"></a> volumeIntegrate</h3><p>volumeIntegrate 的功能是对每个网格的某个物理量，乘以其网格体积，然后形成一个新的场。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">volumeIntegrate(df) = df.mesh().V()*df.field();</span><br></pre></td></tr></table></figure><h3 id="domainintegrate"><a class="markdownIt-Anchor" href="#domainintegrate"></a> domainIntegrate</h3><p>domainIntegrate 的功能是对某个物理量，乘以其网格体积，然后对所有网格求和。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">domainIntegrate(df) = gSum(fvc::volumeIntegrate(df));</span><br></pre></td></tr></table></figure><p>这里的 gSum 是对全场求和。</p><p>其它 fvc 中的操作</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">surfaceIntegrate</span><br><span class="line">surfaceSum</span><br><span class="line">Su</span><br><span class="line">Sp</span><br><span class="line">SuSp</span><br><span class="line">snGrad</span><br><span class="line">reconstruct</span><br><span class="line">laplacian</span><br><span class="line">grad</span><br><span class="line">flux</span><br><span class="line">div</span><br><span class="line">DDt</span><br><span class="line">curl</span><br><span class="line">average</span><br><span class="line">cellReduce</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> field </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM 中的喷雾传热传质</title>
      <link href="/sprayHeatMass/"/>
      <url>/sprayHeatMass/</url>
      
        <content type="html"><![CDATA[<p>从数学公式到C++代码全面解析喷雾传热传质过程原理</p><a id="more"></a><h1 id="传热传质计算公式"><a class="markdownIt-Anchor" href="#传热传质计算公式"></a> 传热传质计算公式</h1><p>首先是能量传递，气相通过温差热传导传热给液相，液相接受能量，使自己升温并蒸发。蒸发出来的热量重新回到气相。这里有一个潜热的关系，即蒸发出来的那部分液相的能量+潜热=蒸发出来的气相所包含的能量。所以说，由喷雾引起的气相能量源项是：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mn>1</mn><msub><mi>V</mi><mi>c</mi></msub></mfrac><msub><mo>∑</mo><mi>p</mi></msub><msub><mi>N</mi><mi>p</mi></msub><mo stretchy="false">(</mo><msub><mi>T</mi><mi>p</mi></msub><mo>−</mo><msub><mi>T</mi><mi>c</mi></msub><mo stretchy="false">)</mo><mi>π</mi><msub><mi>D</mi><mi>p</mi></msub><msub><mi>λ</mi><mi>m</mi></msub><mi>N</mi><msub><mi>u</mi><mi>m</mi></msub><mo>−</mo><mfrac><mn>1</mn><msub><mi>V</mi><mi>c</mi></msub></mfrac><msub><mo>∑</mo><mi>p</mi></msub><msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><mi>p</mi></msub><msub><mi>N</mi><mi>p</mi></msub><mi>h</mi><mo stretchy="false">(</mo><msub><mi>T</mi><mi>p</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{ 1 }{ V_{c} } \sum\nolimits_p N_p( T_p - T_{c} )\pi {D_p}\lambda_m Nu_m - \frac{ 1 }{ V_{c} }\sum\nolimits_p \dot m_p N_p h(T_p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.1574400000000002em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop"><span class="mop op-symbol large-op" style="position:relative;top:-.000004999999999977245em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-.29831799999999997em"><span style="top:-2.10029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.735818em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.1574400000000002em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop"><span class="mop op-symbol large-op" style="position:relative;top:-.000004999999999977245em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-.29831799999999997em"><span style="top:-2.10029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.735818em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><msub><mi>T</mi><mi>p</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h(T_p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 是蒸发出来的气相处于液滴温度下的焓。如果气相求解的是显焓的输运方程，则这里是显焓。如果是绝对焓的输运方程，则这里是绝对焓。</p><p>另一方面，对于液相，<br>文献中液滴温度计算公式：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><mi>p</mi></msub><mo>=</mo><mfrac><mrow><mi>d</mi><msub><mi>m</mi><mi>p</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mi>π</mi><msub><mi>D</mi><mi>p</mi></msub><mi mathvariant="script">D</mi><mi>S</mi><mi>h</mi><msub><mi>ρ</mi><mi>m</mi></msub><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msub><mi>B</mi><mi>M</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\dot m_p = \frac{dm_p}{dt}=-\pi D_p\mathcal{D}Sh \rho_m \ln(1+B_M)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9539679999999999em;vertical-align:-.286108em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord">−</span><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathcal" style="margin-right:.02778em">D</span></span><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>m</mi><mi>p</mi></msub><mfrac><mrow><mi>d</mi><msub><mi>h</mi><mi>p</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><mi>p</mi></msub><msub><mi>h</mi><mi>v</mi></msub><mo stretchy="false">(</mo><msub><mi>T</mi><mi>p</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mi>π</mi><mi>D</mi><mi>κ</mi><mi>N</mi><mi>u</mi><mo stretchy="false">(</mo><mi>T</mi><mo>−</mo><msub><mi>T</mi><mi>p</mi></msub><mo stretchy="false">)</mo><mi>f</mi></mrow><annotation encoding="application/x-tex">m_p\frac{dh_p}{dt}= \dot m_p h_v(T_p)+\pi D\kappa Nu(T-T_p)f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">κ</span><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord mathdefault">u</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:.10764em">f</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>=</mo><mfrac><mi>z</mi><mrow><msup><mi>e</mi><mi>z</mi></msup><mo>−</mo><mn>1</mn></mrow></mfrac><mo separator="true">,</mo><mi>z</mi><mo>=</mo><mo>−</mo><mfrac><mrow><msub><mi>c</mi><mrow><mi>p</mi><mo separator="true">,</mo><mi>v</mi></mrow></msub><msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><mi>p</mi></msub></mrow><mrow><mi>π</mi><mi>D</mi><mi>κ</mi><mi>N</mi><mi>u</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">f=\frac{z}{e^z-1}, z=-\frac{c_{p,v}\dot m_p}{\pi D\kappa Nu}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.8768900000000002em;vertical-align:-.7693300000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.590392em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.04398em">z</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord">1</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.7693300000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault" style="margin-right:.04398em">z</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.03086em;vertical-align:-.686em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.34486em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">κ</span><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord mathdefault">u</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03588em">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>d</mi><msub><mi>T</mi><mi>p</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>T</mi><mo>−</mo><msub><mi>T</mi><mi>p</mi></msub></mrow><msub><mi>τ</mi><mi>h</mi></msub></mfrac><mi>f</mi><mo>−</mo><mfrac><mn>1</mn><msub><mi>c</mi><mrow><mi>l</mi><mo separator="true">,</mo><mi>p</mi></mrow></msub></mfrac><mfrac><mrow><msub><mi>h</mi><mi>v</mi></msub><mo stretchy="false">(</mo><msub><mi>T</mi><mi>p</mi></msub><mo stretchy="false">)</mo></mrow><msub><mi>τ</mi><mi>e</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\frac{dT_p}{dt}=\frac{T-T_p}{\tau_h}f-\frac{1}{c_{l,p}}\frac{h_v(T_p)}{\tau_e}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.19633em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.399108em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.01968em">l</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>τ</mi><mi>e</mi></msub><mo>=</mo><mfrac><msub><mi>m</mi><mi>p</mi></msub><mrow><mi>π</mi><mi>D</mi><mi mathvariant="script">D</mi><mi>S</mi><mi>h</mi><msub><mi>ρ</mi><mi>v</mi></msub><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>B</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\tau_e=\frac{m_p}{\pi D\mathcal{D}Sh\rho_v\ln(1+B)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.04356em;vertical-align:-.936em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord"><span class="mord mathcal" style="margin-right:.02778em">D</span></span><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord mathdefault" style="margin-right:.05017em">B</span><span class="mclose">)</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>τ</mi><mi>h</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>m</mi><mi>p</mi></msub><msub><mi>C</mi><mrow><mi>l</mi><mo separator="true">,</mo><mi>p</mi></mrow></msub></mrow><mrow><mi>π</mi><mi>D</mi><mi>κ</mi><mi>N</mi><mi>u</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\tau_h=\frac{m_pC_{l,p}}{\pi D\kappa Nu}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">κ</span><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord mathdefault">u</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.01968em">l</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h1 id="代码解析"><a class="markdownIt-Anchor" href="#代码解析"></a> 代码解析</h1><p>首先从求解器代码中可以获知气相能量输运方程中的源项是 <code>parcels.Sh(he)</code>。</p><p><code>Sh</code> 函数定义于 ThermoCloudI.H：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Foam</span>:</span>:tmp&lt;Foam::fvScalarMatrix&gt;</span><br><span class="line">Foam::ThermoCloud&lt;CloudType&gt;::Sh(volScalarField&amp; hs) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;solution().coupled())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;solution().semiImplicit(<span class="string">"h"</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="function"><span class="keyword">const</span> volScalarField <span class="title">Cp</span><span class="params">(thermo_.thermo().Cp())</span></span>;</span><br><span class="line">            <span class="keyword">const</span> volScalarField::Internal</span><br><span class="line">                Vdt(<span class="keyword">this</span>-&gt;mesh().V()*<span class="keyword">this</span>-&gt;db().time().deltaT());</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">                hsTrans()/Vdt</span><br><span class="line">              - fvm::SuSp(hsCoeff()/(Cp*Vdt), hs)</span><br><span class="line">              + hsCoeff()/(Cp*Vdt)*hs;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            tmp&lt;fvScalarMatrix&gt; tfvm(<span class="keyword">new</span> fvScalarMatrix(hs, dimEnergy/dimTime));</span><br><span class="line">            fvScalarMatrix&amp; fvm = tfvm.ref();</span><br><span class="line"></span><br><span class="line">            fvm.source() = -hsTrans()/(<span class="keyword">this</span>-&gt;db().time().deltaT());</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> tfvm;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> tmp&lt;fvScalarMatrix&gt;(<span class="keyword">new</span> fvScalarMatrix(hs, dimEnergy/dimTime));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中的 <code>hsTrans()</code> 定义于 <code>ThermoCloudI.H</code>：<code>return hsTrans_();</code>。<br>其中 <code>hsTrans_</code> 的类型是 <code>autoPtr&lt;volScalarField::Internal&gt;</code>。<br>在 <code>ReactingParcel</code> 的 <code>calc</code> 函数中计算它：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">hsTrans()[cellI] += dm*hs 正数！</span><br><span class="line">hsTrans()[cellI] += np0*dhsTrans 负数！</span><br></pre></td></tr></table></figure><p><code>dm</code> 是蒸发质量，<code>hs</code> 是蒸发出来的气相的显焓（按照液滴温度计算的），<code>dhsTrans</code> 在 <code>calcHeatTransfer</code>中计算。<br><code>calcHeatTransfer</code> 定义于 <code>ThermalParcel</code>，调用于 <code>ReactingParcel</code> 中的 <code>calc</code> 函数，返回新的粒子温度。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ParcelType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">template</span>&lt;class TrackCloudType&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:scalar Foam::ThermoParcel&lt;ParcelType&gt;::calcHeatTransfer</span><br><span class="line">(</span><br><span class="line">    TrackCloudType&amp; cloud,</span><br><span class="line">    trackingData&amp; td,</span><br><span class="line">    <span class="keyword">const</span> scalar dt,</span><br><span class="line">    <span class="keyword">const</span> scalar Re,</span><br><span class="line">    <span class="keyword">const</span> scalar Pr,</span><br><span class="line">    <span class="keyword">const</span> scalar kappa,</span><br><span class="line">    <span class="keyword">const</span> scalar NCpW,</span><br><span class="line">    <span class="keyword">const</span> scalar Sh,</span><br><span class="line">    scalar&amp; dhsTrans,</span><br><span class="line">    scalar&amp; Sph</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!cloud.heatTransfer().active())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> T_;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar d = <span class="keyword">this</span>-&gt;d();</span><br><span class="line">    <span class="keyword">const</span> scalar rho = <span class="keyword">this</span>-&gt;rho();</span><br><span class="line">    <span class="keyword">const</span> scalar As = <span class="keyword">this</span>-&gt;areaS(d);</span><br><span class="line">    <span class="keyword">const</span> scalar V = <span class="keyword">this</span>-&gt;volume(d);</span><br><span class="line">    <span class="keyword">const</span> scalar m = rho*V;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calc heat transfer coefficient</span></span><br><span class="line">    scalar htc = cloud.heatTransfer().htc(d, Re, Pr, kappa, NCpW);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate the integration coefficients</span></span><br><span class="line">    <span class="keyword">const</span> scalar bcp = htc*As/(m*Cp_);</span><br><span class="line">    <span class="keyword">const</span> scalar acp = bcp*td.Tc();</span><br><span class="line">    scalar ancp = Sh;</span><br><span class="line">    <span class="keyword">if</span> (cloud.radiation())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> tetIndices tetIs = <span class="keyword">this</span>-&gt;currentTetIndices();</span><br><span class="line">        <span class="keyword">const</span> scalar Gc = td.GInterp().interpolate(<span class="keyword">this</span>-&gt;coordinates(), tetIs);</span><br><span class="line">        <span class="keyword">const</span> scalar sigma = physicoChemical::sigma.value();</span><br><span class="line">        <span class="keyword">const</span> scalar epsilon = cloud.constProps().epsilon0();</span><br><span class="line"></span><br><span class="line">        ancp += As*epsilon*(Gc/<span class="number">4.0</span> - sigma*pow4(T_));</span><br><span class="line">    &#125;</span><br><span class="line">    ancp /= m*Cp_;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Integrate to find the new parcel temperature</span></span><br><span class="line">    <span class="keyword">const</span> scalar deltaT = cloud.TIntegrator().delta(T_, dt, acp + ancp, bcp);</span><br><span class="line">    <span class="keyword">const</span> scalar deltaTncp = ancp*dt;</span><br><span class="line">    <span class="keyword">const</span> scalar deltaTcp = deltaT - deltaTncp;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate the new temperature and the enthalpy transfer terms</span></span><br><span class="line">    scalar Tnew = T_ + deltaT;</span><br><span class="line">    Tnew = <span class="built_in">min</span>(<span class="built_in">max</span>(Tnew, cloud.constProps().TMin()), cloud.constProps().TMax());</span><br><span class="line"></span><br><span class="line">    dhsTrans -= m*Cp_*deltaTcp;</span><br><span class="line"></span><br><span class="line">    Sph = dt*m*Cp_*bcp;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Tnew;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中用到的其它函数定义：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Type</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Type</span> <span class="title">Foam</span>:</span>:integrationScheme::explicitDelta</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> Type&amp; phi,</span><br><span class="line">    <span class="keyword">const</span> scalar dtEff,</span><br><span class="line">    <span class="keyword">const</span> Type&amp; Alpha,</span><br><span class="line">    <span class="keyword">const</span> scalar Beta</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> (Alpha - Beta*phi)*dtEff;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Type</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Type</span> <span class="title">Foam</span>:</span>:integrationScheme::delta</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> Type&amp; phi,</span><br><span class="line">    <span class="keyword">const</span> scalar dt,</span><br><span class="line">    <span class="keyword">const</span> Type&amp; Alpha,</span><br><span class="line">    <span class="keyword">const</span> scalar Beta</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> explicitDelta(phi, dtEff(dt, Beta), Alpha, Beta);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Foam::scalar Foam::integrationSchemes::Euler::dtEff</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar dt,</span><br><span class="line">    <span class="keyword">const</span> scalar Beta</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> dt/(<span class="number">1</span> + Beta*dt);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Foam::scalar Foam::integrationSchemes::analytical::dtEff</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar dt,</span><br><span class="line">    <span class="keyword">const</span> scalar Beta</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">        mag(Beta*dt) &gt; small</span><br><span class="line">      ? (<span class="number">1</span> - <span class="built_in">exp</span>(- Beta*dt))/Beta</span><br><span class="line">      : dt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>calcHeatTransfer</code> 函数中的数学原理：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>s</mi><mo>=</mo><mi>π</mi><mi>d</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">As=\pi dd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault">A</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord mathdefault">d</span><span class="mord mathdefault">d</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mi>t</mi><mi>c</mi><mo>=</mo><mi>N</mi><mi>u</mi><mfrac><mi>κ</mi><msub><mi>D</mi><mi>p</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">htc=Nu\frac{\kappa}{D_p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">t</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.079668em;vertical-align:-.972108em"></span><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord mathdefault">u</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">κ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mi>c</mi><mi>p</mi><mo>=</mo><mfrac><mrow><mi>h</mi><mi>t</mi><mi>c</mi><mo>∗</mo><mi>A</mi><mi>s</mi></mrow><mrow><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>N</mi><mi>u</mi><mi>κ</mi><mi>π</mi><msub><mi>D</mi><mi>p</mi></msub></mrow><mrow><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">bcp=\frac{htc*As}{mC_p}=\frac{Nu\kappa\pi D_p}{mC_p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="mord mathdefault">t</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord mathdefault">A</span><span class="mord mathdefault">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord mathdefault">u</span><span class="mord mathdefault">κ</span><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>c</mi><mi>p</mi><mo>=</mo><mi>b</mi><mi>c</mi><mi>p</mi><mo>∗</mo><mi>T</mi><mi>c</mi><mi>e</mi><mi>l</mi><mi>l</mi><mo>=</mo><mfrac><mrow><mi>N</mi><mi>u</mi><mi>κ</mi><mi>π</mi><msub><mi>D</mi><mi>p</mi></msub><msub><mi>T</mi><mrow><mi>c</mi><mi>e</mi><mi>l</mi><mi>l</mi></mrow></msub></mrow><mrow><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">acp=bcp*Tcell=\frac{Nu\kappa\pi D_p T_{cell}}{mC_p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord mathdefault">u</span><span class="mord mathdefault">κ</span><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:.01968em">l</span><span class="mord mathdefault mtight" style="margin-right:.01968em">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>n</mi><mi>c</mi><mi>p</mi><mo>=</mo><mfrac><mrow><mi>S</mi><mi>h</mi></mrow><mrow><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><mi>p</mi></msub><msub><mi>h</mi><mi>v</mi></msub></mrow><mrow><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">ancp=\frac{Sh}{mC_p}=\frac{\dot m_p h_v}{mC_p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mo stretchy="false">(</mo><mi>p</mi><mi>h</mi><mi>i</mi><mo separator="true">,</mo><mi>d</mi><mi>t</mi><mo separator="true">,</mo><mi>A</mi><mi>l</mi><mi>p</mi><mi>h</mi><mi>a</mi><mo separator="true">,</mo><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mi>l</mi><mi>p</mi><mi>h</mi><mi>a</mi><mo>−</mo><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo>∗</mo><mi>p</mi><mi>h</mi><mi>i</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>d</mi><mi>t</mi><mi>E</mi><mi>f</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">delta(phi, dt, Alpha, Beta)=(Alpha-Beta*phi)*dtEff</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault" style="margin-right:.05017em">B</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.05017em">B</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mord mathdefault" style="margin-right:.10764em">f</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>l</mi><mi>p</mi><mi>h</mi><mi>a</mi><mo>=</mo><mi>a</mi><mi>c</mi><mi>p</mi><mo>+</mo><mi>a</mi><mi>n</mi><mi>c</mi><mi>p</mi><mo>=</mo><mfrac><mrow><msub><mi>N</mi><mi>u</mi></msub><mi>κ</mi><mi>π</mi><mi>D</mi><mi>T</mi><mi>c</mi></mrow><mrow><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi>S</mi><mi>h</mi></mrow><mrow><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">Alpha=acp+ancp=\frac{N_u\kappa\pi DTc}{mC_p}+\frac{Sh}{mC_p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">κ</span><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mord mathdefault">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo>=</mo><mi>b</mi><mi>c</mi><mi>p</mi><mo>=</mo><mfrac><mrow><msub><mi>N</mi><mi>u</mi></msub><mi>κ</mi><mi>π</mi><mi>D</mi></mrow><mrow><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">Beta=bcp=\frac{N_u\kappa\pi D}{mC_p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.05017em">B</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">κ</span><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord mathdefault" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mi>h</mi><mi>i</mi><mo>=</mo><msub><mi>T</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">phi=T_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>T</mi><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mi>l</mi><mi>p</mi><mi>h</mi><mi>a</mi><mo>−</mo><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo>∗</mo><msub><mi>T</mi><mi>p</mi></msub><mo stretchy="false">)</mo><mo>∗</mo><mi>d</mi><mi>t</mi><mi>E</mi><mi>f</mi><mi>f</mi><mo>=</mo><mo stretchy="false">(</mo><mfrac><mrow><mi>N</mi><mi>u</mi><mi>κ</mi><mi>π</mi><msub><mi>D</mi><mi>p</mi></msub><msub><mi>T</mi><mi>c</mi></msub></mrow><mrow><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><mi>p</mi></msub><msub><mi>h</mi><mi>v</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>−</mo><mfrac><mrow><mi>N</mi><mi>u</mi><mi>κ</mi><msub><mi>D</mi><mi>p</mi></msub><msub><mi>T</mi><mi>p</mi></msub></mrow><mrow><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac><mo stretchy="false">)</mo><mi>d</mi><mi>t</mi><mi>E</mi><mi>f</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">deltaT=(Alpha-Beta*T_p)*dtEff=(\frac{Nu\kappa\pi D_pT_c}{mC_p}+\frac{\dot m_ph_v}{dt}-\frac{Nu\kappa D_pT_p}{mC_p})dtEff</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.05017em">B</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-.972108em"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord mathdefault">u</span><span class="mord mathdefault">κ</span><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord mathdefault">u</span><span class="mord mathdefault">κ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mord mathdefault" style="margin-right:.10764em">f</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>t</mi><mi>E</mi><mi>f</mi><mi>f</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mo>−</mo><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo>∗</mo><mi>d</mi><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">dtEff=(1 - exp(- Beta*dt))/Beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathdefault" style="margin-right:.05017em">B</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:.05017em">B</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>T</mi><mi>c</mi><mi>p</mi><mo>=</mo><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>T</mi><mo>−</mo><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>T</mi><mi>n</mi><mi>c</mi><mi>p</mi><mo>=</mo><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>T</mi><mo>−</mo><mi>a</mi><mi>n</mi><mi>c</mi><mi>p</mi><mo>∗</mo><mi>d</mi><mi>t</mi><mo>=</mo><mo stretchy="false">?</mo></mrow><annotation encoding="application/x-tex">deltaTcp=deltaT-deltaTncp=deltaT-ancp*dt=?</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.77777em;vertical-align:-.08333em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.77777em;vertical-align:-.08333em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.6597200000000001em;vertical-align:-.19444em"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mclose">?</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>h</mi><mi>s</mi><mi>T</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo>=</mo><mo>−</mo><mi>m</mi><mo>∗</mo><msub><mi>C</mi><mi>p</mi></msub><mo>∗</mo><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>T</mi><mi>c</mi><mi>p</mi><mo>=</mo><mi>a</mi><mi>n</mi><mi>c</mi><mi>p</mi><mo>∗</mo><mi>d</mi><mi>t</mi><mo>∗</mo><mi>m</mi><mo>∗</mo><msub><mi>C</mi><mi>p</mi></msub><mo>−</mo><mi>m</mi><mo>∗</mo><mi>C</mi><msub><mi>p</mi><mo>∗</mo></msub><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">dhsTrans = -m*C_p*deltaTcp=ancp*dt*m*C_p -m*Cp_*deltaT</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">h</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord">−</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.6597200000000001em;vertical-align:-.19444em"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.46528em;vertical-align:0"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.46528em;vertical-align:0"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.175696em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>h</mi><mi>s</mi><mi>T</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo>=</mo><msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><mi>p</mi></msub><msub><mi>h</mi><mi>v</mi></msub><mi>d</mi><mi>t</mi><mo>−</mo><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">dhsTrans =\dot m_p h_v dt-m C_p deltaT</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">h</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>p</mi><mi>h</mi><mo>=</mo><mi>N</mi><mi>u</mi><mi>κ</mi><mi>π</mi><msub><mi>D</mi><mi>p</mi></msub><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">Sph=Nu\kappa\pi D_pdt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord mathdefault">u</span><span class="mord mathdefault">κ</span><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span></span></span></p><p>上述公式中的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">C_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 是液滴的比热容，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">D_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 是液滴直径，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">D</mi></mrow><annotation encoding="application/x-tex">\mathcal{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord"><span class="mord mathcal" style="margin-right:.02778em">D</span></span></span></span></span>是vapour diffusivity，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">h_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>是汽化潜热，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">T_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>是液滴温度。</p><p><code>calcPhaseChange</code> 定义于 <code>ReactingParcel</code>，调用于 <code>ReactingParcel</code> 中的 <code>calc</code> 函数。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ParcelType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">template</span>&lt;class TrackCloudType&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:ReactingParcel&lt;ParcelType&gt;::calcPhaseChange</span><br><span class="line">(</span><br><span class="line">    TrackCloudType&amp; cloud,</span><br><span class="line">    trackingData&amp; td,</span><br><span class="line">    <span class="keyword">const</span> scalar dt,</span><br><span class="line">    <span class="keyword">const</span> scalar Re,</span><br><span class="line">    <span class="keyword">const</span> scalar Pr,</span><br><span class="line">    <span class="keyword">const</span> scalar Ts,</span><br><span class="line">    <span class="keyword">const</span> scalar nus,</span><br><span class="line">    <span class="keyword">const</span> scalar d,</span><br><span class="line">    <span class="keyword">const</span> scalar T,</span><br><span class="line">    <span class="keyword">const</span> scalar mass,</span><br><span class="line">    <span class="keyword">const</span> label idPhase,</span><br><span class="line">    <span class="keyword">const</span> scalar YPhase,</span><br><span class="line">    <span class="keyword">const</span> scalarField&amp; Y,</span><br><span class="line">    scalarField&amp; dMassPC,</span><br><span class="line">    scalar&amp; Sh,</span><br><span class="line">    scalar&amp; N,</span><br><span class="line">    scalar&amp; NCpW,</span><br><span class="line">    scalarField&amp; Cs</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">typename</span> TrackCloudType::reactingCloudType reactingCloudType;</span><br><span class="line">    <span class="keyword">const</span> CompositionModel&lt;reactingCloudType&gt;&amp; composition =</span><br><span class="line">        cloud.composition();</span><br><span class="line">    PhaseChangeModel&lt;reactingCloudType&gt;&amp; phaseChange = cloud.phaseChange();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!phaseChange.active() || (YPhase &lt; small))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">scalarField <span class="title">X</span><span class="params">(composition.liquids().X(Y))</span></span>;</span><br><span class="line"></span><br><span class="line">    scalar Tvap = phaseChange.Tvap(X);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (T &lt; Tvap)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar TMax = phaseChange.TMax(td.pc(), X);</span><br><span class="line">    <span class="keyword">const</span> scalar Tdash = <span class="built_in">min</span>(T, TMax);</span><br><span class="line">    <span class="keyword">const</span> scalar Tsdash = <span class="built_in">min</span>(Ts, TMax);</span><br><span class="line"></span><br><span class="line">    <span class="function">scalarField <span class="title">hmm</span><span class="params">(dMassPC)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate mass transfer due to phase change</span></span><br><span class="line">    phaseChange.calculate</span><br><span class="line">    (</span><br><span class="line">        dt,</span><br><span class="line">        <span class="keyword">this</span>-&gt;cell(),</span><br><span class="line">        Re,</span><br><span class="line">        Pr,</span><br><span class="line">        d,</span><br><span class="line">        nus,</span><br><span class="line">        Tdash,</span><br><span class="line">        Tsdash,</span><br><span class="line">        td.pc(),</span><br><span class="line">        td.Tc(),</span><br><span class="line">        X,</span><br><span class="line">        dMassPC</span><br><span class="line">    );</span><br><span class="line">    <span class="comment">//此函数的作用就是计算 scalarField&amp; dMassPC，size=液相组分个数，其它全是输入参数</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Limit phase change mass by availability of each specie</span></span><br><span class="line">    dMassPC = <span class="built_in">min</span>(mass*YPhase*Y, dMassPC);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar dMassTot = sum(dMassPC);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Add to cumulative phase change mass</span></span><br><span class="line">    phaseChange.addToPhaseChangeMass(<span class="keyword">this</span>-&gt;nParticle_*dMassTot);</span><br><span class="line"></span><br><span class="line">    forAll(dMassPC, i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> label cid = composition.localToCarrierId(idPhase, i);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> scalar dh = phaseChange.dh(cid, i, td.pc(), Tdash);</span><br><span class="line">        Sh -= dMassPC[i]*dh/dt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Update molar emissions</span></span><br><span class="line">    <span class="keyword">if</span> (cloud.heatTransfer().BirdCorrection())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Average molecular weight of carrier mix - assumes perfect gas</span></span><br><span class="line">        <span class="keyword">const</span> scalar Wc = td.rhoc()*RR*td.Tc()/td.pc();</span><br><span class="line"></span><br><span class="line">        forAll(dMassPC, i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">const</span> label cid = composition.localToCarrierId(idPhase, i);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> scalar Cp = composition.carrier().Cp(cid, td.pc(), Tsdash);</span><br><span class="line">            <span class="keyword">const</span> scalar W = composition.carrier().W(cid);</span><br><span class="line">            <span class="keyword">const</span> scalar Ni = dMassPC[i]/(<span class="keyword">this</span>-&gt;areaS(d)*dt*W);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> scalar Dab =</span><br><span class="line">                composition.liquids().properties()[i].D(td.pc(), Tsdash, Wc);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Molar flux of species coming from the particle (kmol/m^2/s)</span></span><br><span class="line">            N += Ni;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Sum of Ni*Cpi*Wi of emission species</span></span><br><span class="line">            NCpW += Ni*Cp*W;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Concentrations of emission species</span></span><br><span class="line">            Cs[cid] += Ni*d/(<span class="number">2.0</span>*Dab);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>另外还有一个 <code>Sh</code> 的临时 <code>scalar</code>，申明并初始化为 0 于 <code>ReactingParcel</code> 中的 <code>calc</code> 函数。<br>注释说明它是：Explicit enthalpy source for particle。<br>随后通过 <code>calcPhaseChange</code>计算 <code>Sh</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">forAll(dMassPC, i)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> label cid = composition.localToCarrierId(idPhase, i);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar dh = phaseChange.dh(cid, i, td.pc(), Tdash);<span class="comment">//汽化潜热</span></span><br><span class="line">    Sh -= dMassPC[i]*dh/dt;<span class="comment">//dMassPC是蒸发传质，正数。</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里的 <code>dMassPC</code> 是文献传质公式中的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>−</mo><msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><mi>p</mi></msub><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">-\dot m_p dt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord">−</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span></span>，因为蒸发模型得到的 <code>dMassPC</code> 是正数，但是液滴传质是损失质量，所以传质公式中的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\dot m_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9539679999999999em;vertical-align:-.286108em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 是负数。<br>最后在 <code>calc</code> 中通过 <code>calcHeatTransfer</code> 使用 <code>Sh</code>。</p><p>前面已经多次提到这个 <code>ReactingParcel</code> 中的 <code>calc</code> 函数，这里给出它的代码：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ParcelType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">template</span>&lt;class TrackCloudType&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:ReactingParcel&lt;ParcelType&gt;::calc</span><br><span class="line">(</span><br><span class="line">    TrackCloudType&amp; cloud,</span><br><span class="line">    trackingData&amp; td,</span><br><span class="line">    <span class="keyword">const</span> scalar dt</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">typename</span> TrackCloudType::reactingCloudType reactingCloudType;</span><br><span class="line">    <span class="keyword">const</span> CompositionModel&lt;reactingCloudType&gt;&amp; composition =</span><br><span class="line">        cloud.composition();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Define local properties at beginning of time step</span></span><br><span class="line">    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar np0 = <span class="keyword">this</span>-&gt;nParticle_;</span><br><span class="line">    <span class="keyword">const</span> scalar d0 = <span class="keyword">this</span>-&gt;d_;</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">vector</span>&amp; U0 = <span class="keyword">this</span>-&gt;U_;</span><br><span class="line">    <span class="keyword">const</span> scalar T0 = <span class="keyword">this</span>-&gt;T_;</span><br><span class="line">    <span class="keyword">const</span> scalar mass0 = <span class="keyword">this</span>-&gt;mass();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calc surface values</span></span><br><span class="line">    scalar Ts, rhos, mus, Prs, kappas;</span><br><span class="line">    <span class="keyword">this</span>-&gt;calcSurfaceValues(cloud, td, T0, Ts, rhos, mus, Prs, kappas);</span><br><span class="line">    scalar Res = <span class="keyword">this</span>-&gt;Re(rhos, U0, td.Uc(), d0, mus);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sources</span></span><br><span class="line">    <span class="comment">// ~~~~~~~</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Explicit momentum source for particle</span></span><br><span class="line">    <span class="built_in">vector</span> Su = Zero;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Linearised momentum source coefficient</span></span><br><span class="line">    scalar Spu = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Momentum transfer from the particle to the carrier phase</span></span><br><span class="line">    <span class="built_in">vector</span> dUTrans = Zero;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Explicit enthalpy source for particle</span></span><br><span class="line">    scalar Sh = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Linearised enthalpy source coefficient</span></span><br><span class="line">    scalar Sph = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sensible enthalpy transfer from the particle to the carrier phase</span></span><br><span class="line">    scalar dhsTrans = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. Compute models that contribute to mass transfer - U, T held constant</span></span><br><span class="line">    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Phase change</span></span><br><span class="line">    <span class="comment">// ~~~~~~~~~~~~</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Mass transfer due to phase change</span></span><br><span class="line">    <span class="function">scalarField <span class="title">dMassPC</span><span class="params">(Y_.<span class="built_in">size</span>(), <span class="number">0.0</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Molar flux of species emitted from the particle (kmol/m^2/s)</span></span><br><span class="line">    scalar Ne = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sum Ni*Cpi*Wi of emission species</span></span><br><span class="line">    scalar NCpW = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Surface concentrations of emitted species</span></span><br><span class="line">    <span class="function">scalarField <span class="title">Cs</span><span class="params">(composition.carrier().species().<span class="built_in">size</span>(), <span class="number">0.0</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calc mass and enthalpy transfer due to phase change</span></span><br><span class="line">    calcPhaseChange</span><br><span class="line">    (</span><br><span class="line">        cloud,</span><br><span class="line">        td,</span><br><span class="line">        dt,</span><br><span class="line">        Res,</span><br><span class="line">        Prs,</span><br><span class="line">        Ts,</span><br><span class="line">        mus/rhos,</span><br><span class="line">        d0,</span><br><span class="line">        T0,</span><br><span class="line">        mass0,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">1.0</span>,</span><br><span class="line">        Y_,</span><br><span class="line">        dMassPC,</span><br><span class="line">        Sh,</span><br><span class="line">        Ne,</span><br><span class="line">        NCpW,</span><br><span class="line">        Cs</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. Update the parcel properties due to change in mass</span></span><br><span class="line">    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"></span><br><span class="line">    <span class="function">scalarField <span class="title">dMass</span><span class="params">(dMassPC)</span></span>;</span><br><span class="line">    scalar mass1 = updateMassFraction(mass0, dMass, Y_);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>-&gt;Cp_ = composition.Cp(<span class="number">0</span>, Y_, td.pc(), T0);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Update particle density or diameter</span></span><br><span class="line">    <span class="keyword">if</span> (cloud.constProps().constantVolume())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;rho_ = mass1/<span class="keyword">this</span>-&gt;volume();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;d_ = cbrt(mass1/<span class="keyword">this</span>-&gt;rho_*<span class="number">6.0</span>/pi);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Remove the particle when mass falls below minimum threshold</span></span><br><span class="line">    <span class="keyword">if</span> (np0*mass1 &lt; cloud.constProps().minParcelMass())</span><br><span class="line">    &#123;</span><br><span class="line">        td.keepParticle = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (cloud.solution().coupled())</span><br><span class="line">        &#123;</span><br><span class="line">            scalar dm = np0*mass0;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Absorb parcel into carrier phase</span></span><br><span class="line">            forAll(Y_, i)</span><br><span class="line">            &#123;</span><br><span class="line">                scalar dmi = dm*Y_[i];</span><br><span class="line">                label gid = composition.localToCarrierId(<span class="number">0</span>, i);</span><br><span class="line">                scalar hs = composition.carrier().Hs(gid, td.pc(), T0);</span><br><span class="line"></span><br><span class="line">                cloud.rhoTrans(gid)[<span class="keyword">this</span>-&gt;cell()] += dmi;</span><br><span class="line">                cloud.hsTrans()[<span class="keyword">this</span>-&gt;cell()] += dmi*hs;</span><br><span class="line">            &#125;</span><br><span class="line">            cloud.UTrans()[<span class="keyword">this</span>-&gt;cell()] += dm*U0;</span><br><span class="line"></span><br><span class="line">            cloud.phaseChange().addToPhaseChangeMass(np0*mass1);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Correct surface values due to emitted species</span></span><br><span class="line">    correctSurfaceValues(cloud, td, Ts, Cs, rhos, mus, Prs, kappas);</span><br><span class="line">    Res = <span class="keyword">this</span>-&gt;Re(rhos, U0, td.Uc(), <span class="keyword">this</span>-&gt;d(), mus);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. Compute heat- and momentum transfers</span></span><br><span class="line">    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Heat transfer</span></span><br><span class="line">    <span class="comment">// ~~~~~~~~~~~~~</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate new particle temperature</span></span><br><span class="line">    <span class="keyword">this</span>-&gt;T_ =</span><br><span class="line">        <span class="keyword">this</span>-&gt;calcHeatTransfer</span><br><span class="line">        (</span><br><span class="line">            cloud,</span><br><span class="line">            td,</span><br><span class="line">            dt,</span><br><span class="line">            Res,</span><br><span class="line">            Prs,</span><br><span class="line">            kappas,</span><br><span class="line">            NCpW,</span><br><span class="line">            Sh,</span><br><span class="line">            dhsTrans,</span><br><span class="line">            Sph</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>-&gt;Cp_ = composition.Cp(<span class="number">0</span>, Y_, td.pc(), T0);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Motion</span></span><br><span class="line">    <span class="comment">// ~~~~~~</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate new particle velocity</span></span><br><span class="line">    <span class="keyword">this</span>-&gt;U_ =</span><br><span class="line">        <span class="keyword">this</span>-&gt;calcVelocity(cloud, td, dt, Res, mus, mass1, Su, dUTrans, Spu);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. Accumulate carrier phase source terms</span></span><br><span class="line">    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (cloud.solution().coupled())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Transfer mass lost to carrier mass, momentum and enthalpy sources</span></span><br><span class="line">        forAll(dMass, i)</span><br><span class="line">        &#123;</span><br><span class="line">            scalar dm = np0*dMass[i];</span><br><span class="line">            label gid = composition.localToCarrierId(<span class="number">0</span>, i);</span><br><span class="line">            scalar hs = composition.carrier().Hs(gid, td.pc(), T0);</span><br><span class="line"></span><br><span class="line">            cloud.rhoTrans(gid)[<span class="keyword">this</span>-&gt;cell()] += dm;</span><br><span class="line">            cloud.UTrans()[<span class="keyword">this</span>-&gt;cell()] += dm*U0;</span><br><span class="line">            cloud.hsTrans()[<span class="keyword">this</span>-&gt;cell()] += dm*hs;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Update momentum transfer</span></span><br><span class="line">        cloud.UTrans()[<span class="keyword">this</span>-&gt;cell()] += np0*dUTrans;</span><br><span class="line">        cloud.UCoeff()[<span class="keyword">this</span>-&gt;cell()] += np0*Spu;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Update sensible enthalpy transfer</span></span><br><span class="line">        cloud.hsTrans()[<span class="keyword">this</span>-&gt;cell()] += np0*dhsTrans;</span><br><span class="line">        cloud.hsCoeff()[<span class="keyword">this</span>-&gt;cell()] += np0*Sph;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Update radiation fields</span></span><br><span class="line">        <span class="keyword">if</span> (cloud.radiation())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">const</span> scalar ap = <span class="keyword">this</span>-&gt;areaP();</span><br><span class="line">            <span class="keyword">const</span> scalar T4 = pow4(T0);</span><br><span class="line">            cloud.radAreaP()[<span class="keyword">this</span>-&gt;cell()] += dt*np0*ap;</span><br><span class="line">            cloud.radT4()[<span class="keyword">this</span>-&gt;cell()] += dt*np0*T4;</span><br><span class="line">            cloud.radAreaPT4()[<span class="keyword">this</span>-&gt;cell()] += dt*np0*ap*T4;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Lagrangian </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>找对象的正确姿势</title>
      <link href="/lookupObject/"/>
      <url>/lookupObject/</url>
      
        <content type="html"><![CDATA[<p>foundObject，返回是否找到该对象的 Bool 值<br>lookupObject，返回对象，只能使用const成员函数，<br>lookupObjectRef，返回的对象可以使用非const成员函数</p><a id="more"></a><h2 id="最简单的场量"><a class="markdownIt-Anchor" href="#最简单的场量"></a> 最简单的场量：</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>-&gt;mesh().objectRegistry::lookupObject&lt;volScalarField&gt;(<span class="string">"rho"</span>)</span><br><span class="line"><span class="keyword">this</span>-&gt;mesh().objectRegistry::lookupObject&lt;volVectorField&gt;(<span class="string">"U"</span>)</span><br><span class="line"><span class="keyword">this</span>-&gt;mesh().objectRegistry::lookupObject&lt;PtrList&lt;scalarField&gt;&gt;(<span class="string">"this-&gt;thermo().composition().Y()"</span>)</span><br></pre></td></tr></table></figure><h2 id="模型"><a class="markdownIt-Anchor" href="#模型"></a> 模型</h2><h3 id="湍流模型"><a class="markdownIt-Anchor" href="#湍流模型"></a> 湍流模型</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> compressible::turbulenceModel&amp; turbModel =</span><br><span class="line">    <span class="keyword">this</span>-&gt;db().objectRegistry::lookupObject&lt;compressible::turbulenceModel&gt;</span><br><span class="line">    (<span class="string">"turbulence"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> compressible::turbulenceModel&amp; turbModel =</span><br><span class="line">lookupObject&lt;compressible::turbulenceModel&gt;</span><br><span class="line">(</span><br><span class="line">    turbulenceModel::propertiesName</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> compressible::turbulenceModel&amp; turbModel =</span><br><span class="line"><span class="keyword">this</span>-&gt;db().lookupObject&lt;compressible::turbulenceModel&gt;</span><br><span class="line">(</span><br><span class="line">    turbulenceModel::propertiesName</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> compressible::turbulenceModel&amp; turbModel =</span><br><span class="line">db().lookupObject&lt;compressible::turbulenceModel&gt;</span><br><span class="line">(</span><br><span class="line">    IOobject::groupName</span><br><span class="line">    (</span><br><span class="line">        compressible::turbulenceModel::propertiesName,</span><br><span class="line">        internalField().group()</span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line">    </span><br><span class="line"><span class="keyword">const</span> compressible::LESModel&amp; lesModel =</span><br><span class="line">YO2.db().lookupObject&lt;compressible::LESModel&gt;</span><br><span class="line">(</span><br><span class="line">    turbulenceModel::propertiesName</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="喷雾模型"><a class="markdownIt-Anchor" href="#喷雾模型"></a> 喷雾模型</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>-&gt;mesh().objectRegistry::foundObject&lt;sprayCloud&gt;(Foam::sprayCloud::typeName))</span><br><span class="line"><span class="keyword">const</span> basicSprayCloud&amp; spray_ = <span class="keyword">dynamic_cast</span>&lt;<span class="keyword">const</span> basicSprayCloud&amp;&gt;(<span class="keyword">this</span>-&gt;mesh().objectRegistry::lookupObject&lt;sprayCloud&gt;(Foam::sprayCloud::typeName));</span><br><span class="line">basicSprayCloud&amp; spray_ = <span class="keyword">dynamic_cast</span>&lt;basicSprayCloud&amp;&gt;(<span class="keyword">this</span>-&gt;mesh().objectRegistry::lookupObjectRef&lt;sprayCloud&gt;(Foam::sprayCloud::typeName));</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> lookupObject </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM 中的 Run Time Selection</title>
      <link href="/simpleRTS/"/>
      <url>/simpleRTS/</url>
      
        <content type="html"><![CDATA[<p>以一个很简单的例子分析 OpenFOAM 中的 Run Time Selection，如有错误，欢迎指正！</p><a id="more"></a><p>本文内容主要是为了消化 <a href="http://xiaopingqiu.github.io/2016/03/12/RTS1/" target="_blank" rel="external nofollow noopener noreferrer">Giskard 博客</a> 而作，在此致谢！<br>首先简单说下 RTS 的功能：就是在 solver 中创建模型对象的时候，可以使用基类中的 <code>New</code> 函数创建一个基类的指针，然后在 case 的字典文件中选择所需的子模型（派生类），即运行时选择（Run Time Selection）。这对代码的要求就是，通过给定模型的名字（从字典中获取），然后能获取该模型的对象，这就是 <code>New</code> 函数的功能。</p><h1 id="代码路径"><a class="markdownIt-Anchor" href="#代码路径"></a> 代码路径：</h1><p>\src\OpenFOAM\db\runTimeSelection\construction<br>\src\combustionModels\FSD\reactionRateFlameAreaModels</p><h1 id="基类模型类别reactionrateflamearea"><a class="markdownIt-Anchor" href="#基类模型类别reactionrateflamearea"></a> 基类（模型类别）：reactionRateFlameArea</h1><ul><li><p>基类体内调用：<code>TypeName(&quot;reactionRateFlameArea&quot;);</code></p></li><li><p>基类体内调用 <code>declareRunTimeSelectionTable</code>（详细代码见本文末尾），作用如下：</p><ul><li>给 <code>HashTable</code> 起别名，<code>argNames##ConstructorTable</code>，并创建一个该类的指针 <code>argNames##ConstructorTablePtr_</code>。</li><li><strong>定义</strong>类 <code>add##argNames##ConstructorToTable</code>，模板是 <code>baseType##Type</code>。该类的 <code>New</code> 函数很关键，返回基类指针，指向一个临时 <code>new</code> 的对象，对象类型是 <code>baseType##Type</code>。该类的构造函数也很关键，它向 <code>argNames##ConstructorTablePtr_</code> 中 <code>insert</code> 一组 key and value：<code>baseType##Type::typeName</code> 和 <code>New</code> 函数。</li></ul><p>所以关键在于<strong>创建</strong> <code>add##argNames##ConstructorToTable</code> 的对象时它的模板是什么类型。如果模板是基类，那么往哈希表中 <code>insert</code> 的是基类的 <code>typeName</code> 和<strong>返回指向基类对象的基类指针的 <code>New</code> 函数</strong>。如果模板是派生类，那么往哈希表中 <code>insert</code> 的是派生类的 <code>typeName</code> 和<strong>返回指向派生类对象的基类指针的 <code>New</code> 函数</strong>。</p></li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">declareRunTimeSelectionTable</span><br><span class="line">(</span><br><span class="line">    autoPtr,</span><br><span class="line">    reactionRateFlameArea,</span><br><span class="line">    dictionary,</span><br><span class="line">    (</span><br><span class="line">        const word modelType,</span><br><span class="line">        const dictionary&amp; dict,</span><br><span class="line">        const fvMesh&amp; mesh,</span><br><span class="line">        const combustionModel&amp; combModel</span><br><span class="line">    ),</span><br><span class="line">    (modelType, dict, mesh, combModel)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li>基类体内申明了函数</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">static autoPtr&lt;reactionRateFlameArea&gt; New</span><br><span class="line">(</span><br><span class="line">    const dictionary&amp; dict,</span><br><span class="line">    const fvMesh&amp; mesh,</span><br><span class="line">    const combustionModel&amp; combModel</span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li>基类体外调用了</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">defineTypeNameAndDebug(reactionRateFlameArea, 0);</span><br><span class="line">defineRunTimeSelectionTable(reactionRateFlameArea, dictionary);</span><br></pre></td></tr></table></figure><p>reactionRateFlameAreaNew.C 文件中定义了 <code>New</code> 函数，这个函数在 FSD 的构造函数里调用，用于创建本文所说的基类指针。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Foam::autoPtr&lt;Foam::reactionRateFlameArea&gt; Foam::reactionRateFlameArea::New</span><br><span class="line">(</span><br><span class="line">    const dictionary&amp; dict,</span><br><span class="line">    const fvMesh&amp; mesh,</span><br><span class="line">    const combustionModel&amp; combModel</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    word reactionRateFlameAreaType</span><br><span class="line">    (</span><br><span class="line">        dict.lookup(&quot;reactionRateFlameArea&quot;)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    Info&lt;&lt; &quot;Selecting reaction rate flame area correlation &quot;</span><br><span class="line">        &lt;&lt; reactionRateFlameAreaType &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    dictionaryConstructorTable::iterator cstrIter &#x3D;</span><br><span class="line">        dictionaryConstructorTablePtr_-&gt;find(reactionRateFlameAreaType);</span><br><span class="line"></span><br><span class="line">    const label tempOpen &#x3D; reactionRateFlameAreaType.find(&#39;&lt;&#39;);</span><br><span class="line"></span><br><span class="line">    const word className &#x3D; reactionRateFlameAreaType(0, tempOpen);</span><br><span class="line"></span><br><span class="line">    return autoPtr&lt;reactionRateFlameArea&gt;</span><br><span class="line">        (cstrIter()(className, dict, mesh, combModel));</span><br><span class="line">&#125;    </span><br><span class="line">&#x2F;&#x2F;cstrIter 是那个 declareRunTimeSelectionTable 里边定义的 New 函数。</span><br><span class="line">&#x2F;&#x2F;它的形参列表是 declareRunTimeSelectionTable 的 argList（第四个参数）。</span><br><span class="line">&#x2F;&#x2F;它创建一个基类指针，指向派生类的一个对象，同时该对象被构造，构造函数的实参列表是 parList（第五个参数）。</span><br><span class="line">&#x2F;&#x2F; 这里给它的实参是 (className, dict, mesh, combModel)</span><br><span class="line">&#x2F;&#x2F;className&#x3D;&#x3D;&#x3D;relaxation（从字典中读取的）, dict&#x3D;&#x3D;&#x3D;FSDCoeffs, combModel&#x3D;&#x3D;&#x3D;FSD</span><br></pre></td></tr></table></figure><h1 id="派生类具体模型relaxation"><a class="markdownIt-Anchor" href="#派生类具体模型relaxation"></a> 派生类（具体模型）：relaxation</h1><p>派生类体内调用：<code>TypeName(&quot;relaxation&quot;);</code></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">defineTypeNameAndDebug(relaxation, 0);</span><br><span class="line">addToRunTimeSelectionTable</span><br><span class="line">(</span><br><span class="line">    reactionRateFlameArea,</span><br><span class="line">    relaxation,</span><br><span class="line">    dictionary</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>派生类调用 <code>addToRunTimeSelectionTable</code> 的时候，创建了一个 <code>baseType::add##argNames##ConstructorToTable&lt;thisType&gt;</code> 类的对象，这里 <code>thisType</code> 是 <code>relaxation</code>，作为类的模板传入 。我们可以看到，当我们把派生类的类名作为 <code>add</code> 的模板时，<code>New</code> 函数返回的是<strong>指向派生类对象</strong>的基类指针。而这个 <code>New</code> 函数在 <code>add</code> 的构造函数中随同**派生类的 <code>typeName</code> **被插入到哈希表中。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;- Add to hash-table of functions with typename as the key</span><br><span class="line">#define addToRunTimeSelectionTable (baseType,thisType,argNames)</span><br><span class="line">    &#x2F;* Add the thisType constructor function to the table *&#x2F;                   \</span><br><span class="line">    baseType::add##argNames##ConstructorToTable&lt;thisType&gt;                      \</span><br><span class="line">        add##thisType##argNames##ConstructorTo##baseType##Table_</span><br></pre></td></tr></table></figure><p>declareRunTimeSelectionTable 细节展示：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;- Declare a run-time selection</span><br><span class="line">#define declareRunTimeSelectionTable(autoPtr,baseType,argNames,argList,parList)\</span><br><span class="line">                                                                               \</span><br><span class="line">    &#x2F;* Construct from argList function pointer type *&#x2F;                         \</span><br><span class="line">    typedef autoPtr&lt;baseType&gt; (*argNames##ConstructorPtr)argList;              \</span><br><span class="line">                                                                               \</span><br><span class="line">    &#x2F;* Construct from argList function table type *&#x2F;                           \</span><br><span class="line">    typedef HashTable&lt;argNames##ConstructorPtr, word, string::hash&gt;            \</span><br><span class="line">        argNames##ConstructorTable;                                            \</span><br><span class="line">                                                                               \</span><br><span class="line">    &#x2F;* Construct from argList function pointer table pointer *&#x2F;                \</span><br><span class="line">    static argNames##ConstructorTable* argNames##ConstructorTablePtr_;         \</span><br><span class="line">                                                                               \</span><br><span class="line">    &#x2F;* Table constructor called from the table add function *&#x2F;                 \</span><br><span class="line">    static void construct##argNames##ConstructorTables();                      \</span><br><span class="line">                                                                               \</span><br><span class="line">    &#x2F;* Table destructor called from the table add function destructor *&#x2F;       \</span><br><span class="line">    static void destroy##argNames##ConstructorTables();                        \</span><br><span class="line">                                                                               \</span><br><span class="line">    &#x2F;* Class to add constructor from argList to table *&#x2F;                       \</span><br><span class="line">    template&lt;class baseType##Type&gt;                                             \</span><br><span class="line">    class add##argNames##ConstructorToTable                                    \</span><br><span class="line">    &#123;                                                                          \</span><br><span class="line">    public:                                                                    \</span><br><span class="line">                                                                               \</span><br><span class="line">        static autoPtr&lt;baseType&gt; New argList                                   \</span><br><span class="line">        &#123;                                                                      \</span><br><span class="line">            return autoPtr&lt;baseType&gt;(new baseType##Type parList);              \</span><br><span class="line">        &#125;                                                                      \</span><br><span class="line">                                                                               \</span><br><span class="line">        add##argNames##ConstructorToTable                                      \</span><br><span class="line">        (                                                                      \</span><br><span class="line">            const word&amp; lookup &#x3D; baseType##Type::typeName                      \</span><br><span class="line">        )                                                                      \</span><br><span class="line">        &#123;                                                                      \</span><br><span class="line">            construct##argNames##ConstructorTables();                          \</span><br><span class="line">            if (!argNames##ConstructorTablePtr_-&gt;insert(lookup, New))          \</span><br><span class="line">            &#123;                                                                  \</span><br><span class="line">                std::cerr&lt;&lt; &quot;Duplicate entry &quot; &lt;&lt; lookup                       \</span><br><span class="line">                    &lt;&lt; &quot; in runtime selection table &quot; &lt;&lt; #baseType             \</span><br><span class="line">                    &lt;&lt; std::endl;                                              \</span><br><span class="line">                error::safePrintStack(std::cerr);                              \</span><br><span class="line">            &#125;                                                                  \</span><br><span class="line">        &#125;                                                                      \</span><br><span class="line">    &#125;;                                                                         \</span><br></pre></td></tr></table></figure><h1 id="第一次使用自己的-rts"><a class="markdownIt-Anchor" href="#第一次使用自己的-rts"></a> 第一次使用自己的 RTS</h1>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RTS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM 可压缩湍流库深度解析</title>
      <link href="/turb/"/>
      <url>/turb/</url>
      
        <content type="html"><![CDATA[<p>分析可压缩湍流部分的继承关系</p><a id="more"></a><h1 id="of-7"><a class="markdownIt-Anchor" href="#of-7"></a> OF-7</h1><p>继承关系：</p><img src="http://www.plantuml.com/plantuml/svg/rHdRRjiszDrVGI20qQwnkyjReWRe4WSOiBH1x7QF1YDHDc5954ZAcP7btqUAaYLA92LPQRVc8ObvBZmtdfl_-1nWdsEIG7e0tZ-pW3mbCy0p-fX5AF7H7GbGD6byhX1z4gSKCOOV8xHg4FaHPAp9wda2nCzw3UufuSZdA001v52Sv80pdoICWnMEqHJGB97_Q91mVuVOTWfYyLi3x4dqLV0Zz1QZA9Y2BngKPJI4FbhwC88b1epIBNpOalijxiHDZpW9WlGl64KtMA0UrgKwToX-H1JSPabkJLOgz6wFASzW11u9YG15C7Zp5dm0FojWNLikVWjOVbI7rZNMuILhXLVvSIfEK1ZUY8EIeBeI9n5E4B0OJRz0m-qmeLaq7gTUc_1AsjEaQzsuKt2mynI2Q_oIhAsf9aC3MQ56y544SmgvlyLEylPr_Cr0WaKO3YE9iw7uV2Z1O9bsmz1Hod14acwYGnolKC98IVXW9zaJ780zZB186-Az680-eHJbeI-9NoQE75KbiWRW0lmE6VRDASt1i5zwq-qa4jsMh2yxCucLTkJJwt96WFRYYJ-Whc09zogNt45EyT-23kzlAj9Mgd5xk73Y8a5qSrXHcB2KKE5JuSyD8Z4IL_YV4vGp0zwSuisMpzjU_2WJr4ItcGDT23i9emm7gosYCH6O4GfDY4U9L5nCh75rxIYGrxq2Kqe2HKOCmupXFUO7PsmsJhtS0ETIiNCZsNb3bQj-4Pmd_deHAEAt07EDvxJwN8NvmsfvZEnFwAbdzBVkDLKHw-qdrPFdIlYvF7uPKLraDihTv72zPtF8K8lrAoxF58aMBG5yYzdiggPht4FNsANh02CxXNYlJcMI76Nx8HLK5qXU_PFwDw_ytMRXu-Ie5UPI4YNSEz3FBP91TnIsSujdoX7k41mTYpkOfh1wRhPGAD2wT5Te8wolfHMhD0LMbpGARQmqZiJ53CWZhikjPuY-8SPtnru_ZGqY3B5uL_XFK10SlcBc4oQ2lYgskuNgM8ltKNxq5WAzzafcxbTYgPo16F0I9fu52fJ2u3hExB1VxA1VxQ3Vh226Dp7SkS52tmAXqJBjpCT5WxzkQsxB16UcBk-Jp6qwM3MKwgwoeTmjIKPzVKXs4XJY6SW6JkmAO8hMcrrzYDBJXQWLw_U5sKNcBW-FCMpaLyZSXwlqbeblhmbkyFJcchJaa_fpiJoshZCW5mUGvayiOqikUnrBt_hmyJGwzKIrX-oTz2uRCItj-nhnV1niJjuEzTn0TFP4uoh2YEbzxEHk28OgLskUhqVHVAx3BF5JYzUU52hY349rnDrftky_ZbVuxX6y6hhxKYZ7vqk6yoQrU-UIcwfqYdTYlJmkfWKZkSqi0CidB4AujbdMprEA4tujDw2ipUcu6RKMmjqTJgp08YUwK4YCDl28S48IgSbVEE29K37lyaEAteuT1ckXTbcVcLjwJ7D3w25cHUhWL5cjaryTjODhQUXEdXNYuBtvqCrkgrJdCvkpGhCsD_jskis_XDTkAOvUEYgsUgEDrjPxfTRsdd9pULKpokjrZ2TrSZ_0n6MUVoLYAU1_Ceq1zqGyIBvUereZFbMNM1OMIw5kxpKKMOENXTfqfMevofR1sH-KIAEBdc3qWnQzCvXnSi-fTqjWV74X516gSoXx5_7d_raOUnU3rwkNpQzYjUzrSbETM8R65PaUWrvhVJ83onXkY70GsnsAXr0x-MOBbDsGO3AFDyLt1WfMxxIdO4DXyCMuRJYz5dtVeRozw99VQEMPJ9-VZhbB7wY_bT_GUfJ16bQudBpy2m00"><p>solver 中：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Info &lt;&lt; &quot;Creating turbulence model.\n&quot; &lt;&lt; nl;</span><br><span class="line">autoPtr&lt;compressible::turbulenceModel&gt; turbulence</span><br><span class="line">(</span><br><span class="line">    compressible::turbulenceModel::New</span><br><span class="line">    (</span><br><span class="line">        rho,</span><br><span class="line">        U,</span><br><span class="line">        phi,</span><br><span class="line">        thermo</span><br><span class="line">    )</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>其中 <code>Foam::compressible::turbulenceModel</code> 是 <code>Foam::compressible::ThermalDiffusivity&lt;CompressibleTurbulenceModel&lt;fluidThermo&gt;&gt;</code> 的 <code>typedef</code></p><p>所以这里首先调用的是 <code>ThermalDiffusivity</code> 中的 <code>New</code>：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">template&lt;class BasicTurbulenceModel&gt;</span><br><span class="line">Foam::autoPtr&lt;Foam::ThermalDiffusivity&lt;BasicTurbulenceModel&gt;&gt;</span><br><span class="line">Foam::ThermalDiffusivity&lt;BasicTurbulenceModel&gt;::New</span><br><span class="line">(</span><br><span class="line">    const volScalarField&amp; rho,</span><br><span class="line">    const volVectorField&amp; U,</span><br><span class="line">    const surfaceScalarField&amp; phi,</span><br><span class="line">    const transportModel&amp; transport,</span><br><span class="line">    const word&amp; propertiesName</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    return autoPtr&lt;ThermalDiffusivity&gt;</span><br><span class="line">    (</span><br><span class="line">        static_cast&lt;ThermalDiffusivity*&gt;(</span><br><span class="line">        BasicTurbulenceModel::New</span><br><span class="line">        (</span><br><span class="line">            rho,</span><br><span class="line">            U,</span><br><span class="line">            phi,</span><br><span class="line">            transport,</span><br><span class="line">            propertiesName</span><br><span class="line">        ).ptr())</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>CompressibleTurbulenceModel&lt;class TransportModel&gt;</code> 是 <code>BasicTurbulenceModel</code> 的实例化，<br>因此接下来来到了 <code>CompressibleTurbulenceModel</code><br>声明：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">template&lt;class TransportModel&gt;</span><br><span class="line">class CompressibleTurbulenceModel</span><br><span class="line">:</span><br><span class="line">    public TurbulenceModel</span><br><span class="line">    &lt;</span><br><span class="line">        geometricOneField,</span><br><span class="line">        volScalarField,</span><br><span class="line">        compressibleTurbulenceModel,</span><br><span class="line">        TransportModel</span><br><span class="line">    &gt;</span><br></pre></td></tr></table></figure><p><code>New</code> 函数：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">template&lt;class TransportModel&gt;</span><br><span class="line">Foam::autoPtr&lt;Foam::CompressibleTurbulenceModel&lt;TransportModel&gt;&gt;</span><br><span class="line">Foam::CompressibleTurbulenceModel&lt;TransportModel&gt;::New</span><br><span class="line">(</span><br><span class="line">    const volScalarField&amp; rho,</span><br><span class="line">    const volVectorField&amp; U,</span><br><span class="line">    const surfaceScalarField&amp; phi,</span><br><span class="line">    const transportModel&amp; transport,</span><br><span class="line">    const word&amp; propertiesName</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    return autoPtr&lt;CompressibleTurbulenceModel&gt;</span><br><span class="line">    (</span><br><span class="line">        static_cast&lt;CompressibleTurbulenceModel*&gt;(</span><br><span class="line">        TurbulenceModel</span><br><span class="line">        &lt;</span><br><span class="line">            geometricOneField,</span><br><span class="line">            volScalarField,</span><br><span class="line">            compressibleTurbulenceModel,</span><br><span class="line">            transportModel</span><br><span class="line">        &gt;::New</span><br><span class="line">        (</span><br><span class="line">            geometricOneField(),</span><br><span class="line">            rho,</span><br><span class="line">            U,</span><br><span class="line">            phi,</span><br><span class="line">            phi,</span><br><span class="line">            transport,</span><br><span class="line">            propertiesName</span><br><span class="line">        ).ptr())</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接着来到 <code>TurbulenceModel</code> 这里用到了 RTS<br><code>New</code> 函数：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">static autoPtr&lt;TurbulenceModel&gt; New</span><br><span class="line">(</span><br><span class="line">    const alphaField&amp; alpha,</span><br><span class="line">    const rhoField&amp; rho,</span><br><span class="line">    const volVectorField&amp; U,</span><br><span class="line">    const surfaceScalarField&amp; alphaRhoPhi,</span><br><span class="line">    const surfaceScalarField&amp; phi,</span><br><span class="line">    const transportModel&amp; transport,</span><br><span class="line">    const word&amp; propertiesName &#x3D; turbulenceModel::propertiesName</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>构造函数：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Foam::TurbulenceModel&lt;Alpha, Rho, BasicTurbulenceModel, TransportModel&gt;::</span><br><span class="line">TurbulenceModel</span><br><span class="line">(</span><br><span class="line">    const alphaField&amp; alpha,</span><br><span class="line">    const rhoField&amp; rho,</span><br><span class="line">    const volVectorField&amp; U,</span><br><span class="line">    const surfaceScalarField&amp; alphaRhoPhi,</span><br><span class="line">    const surfaceScalarField&amp; phi,</span><br><span class="line">    const transportModel&amp; transport,</span><br><span class="line">    const word&amp; propertiesName</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    BasicTurbulenceModel</span><br><span class="line">    (</span><br><span class="line">        rho,</span><br><span class="line">        U,</span><br><span class="line">        alphaRhoPhi,</span><br><span class="line">        phi,</span><br><span class="line">        propertiesName</span><br><span class="line">    ),</span><br><span class="line">    alpha_(alpha),</span><br><span class="line">    transport_(transport)</span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure><p>它的模板基类 <code>BasicTurbulenceModel</code> 的实例化是 <code>compressibleTurbulenceModel</code>：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Foam::compressibleTurbulenceModel::compressibleTurbulenceModel</span><br><span class="line">(</span><br><span class="line">    const volScalarField&amp; rho,</span><br><span class="line">    const volVectorField&amp; U,</span><br><span class="line">    const surfaceScalarField&amp; alphaRhoPhi,</span><br><span class="line">    const surfaceScalarField&amp; phi,</span><br><span class="line">    const word&amp; propertiesName</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    turbulenceModel</span><br><span class="line">    (</span><br><span class="line">        U,</span><br><span class="line">        alphaRhoPhi,</span><br><span class="line">        phi,</span><br><span class="line">        propertiesName</span><br><span class="line">    ),</span><br><span class="line">    rho_(rho)</span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure><p>最后来到了：<code>turbulenceModel</code></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Foam::turbulenceModel::turbulenceModel</span><br><span class="line">(</span><br><span class="line">    const volVectorField&amp; U,</span><br><span class="line">    const surfaceScalarField&amp; alphaRhoPhi,</span><br><span class="line">    const surfaceScalarField&amp; phi,</span><br><span class="line">    const word&amp; propertiesName</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>初始化列表中：<code>alphaRhoPhi_(alphaRhoPhi)</code><br>另有函数：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">inline const surfaceScalarField&amp; alphaRhoPhi() const</span><br><span class="line">&#123;</span><br><span class="line">    return alphaRhoPhi_;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>combustionModel.H</code> 中：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">inline Foam::tmp&lt;Foam::surfaceScalarField&gt; Foam::combustionModel::phi() const</span><br><span class="line">&#123;</span><br><span class="line">    return turbulence().alphaRhoPhi();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>就是说，<code>solver</code> 中 <code>#include &quot;compressibleCreatePhi.H&quot;</code> 创建的 <code>phi</code> 逐级传到了湍流模型中，我可以使用 <code>Foam::combustionModel::phi()</code> 来调用它。</p><h1 id="of-8"><a class="markdownIt-Anchor" href="#of-8"></a> OF-8</h1><p>继承关系：</p><img src="http://www.plantuml.com/plantuml/svg/xLfPSzis47xNhy1CPZHEOoiztcpLCwcFfohrM4ewVTB096GXug60e1oDg_zU42H8W0HnY7QddJOFZiqzi5WiThzTCavZbD0yNX2OPDkKq5aQeWXC_pmx0q4QRmdAClmGePcMRnH4CCj0h2K-Zm3xjro2Ev9I550KWX1Io9vmmfiWJJ8A5ZX6Oq3ofFX5eQnsCvIjno1cFnN2Beq-CtqfkSKe2iVWaqBDShA20Pe7C8A20qRRDRnVftThRENTrZm9WkHt64NNcB7kbs8xCnG_809kyoIWcAaH6tedRuYodoTl0NyaK-LDgVGT9ZI7KVa8X9WhXsG_Pa_GQdND7WW1y3FulXJ2IOGJ17hyeYwWy5gyf3UDnjjfL_2oS9bkhxB_nc3VhvCPhkXBykvE5HjQp2Lh11zOv6uX3TROADvTZdgjHuSlUBDQUIrPy0zSDFPnQfmFNuvwhKU7BsXrQbjauyUEjXcEqiGkj8_Z1KgoL0Xc-366_MAx58TW1oFCqYDB6XfYa1A2-FqlX0yZUsOkCdYOFYLdG4y_1x_030V6j6vVnIt5gtvaoNwTBYySiwb6LZZocI2QawHKTpWoKzcEBaIx1TJS74bijIkpxWnIWhyn4RoxBgKw2LbMSnWz8kPK9XFybY3E0QOJWX_NTD9xQ1-A53rIdMANOZbzj8fo72xMYCIfNQ0L3gEP0ILSkQ84FN7AjtHQs7XgYidJbb6NRh77QvfStwh8gyXKqJbk_cu2z7unhsFo8tfoZDlEkksehOmvo4AzrhI59JCFB91QXpjnE9FE6PTdP1USzXs3hvzKl4EvyMBV_0ztlD2Kjjf1bOP9GJeCA7O-O4Mx-7kwnjdPPP6a3WEGZ5V1RGmHItzN_igHpc58BVQimyAIqhXtmEquZ6YdYFSH2iFzPvm5QORflin3cvkoF5UHBFwS5gpNUBNACxnZp6U676FDAI53zKd6mXY5vPx1LPptqtxe9_tOJ_gfbyHnnCPCPjkk65fLOgD_N86QPNVdVJVtZGwQV2mEM2MNjR5SIzJ6pJpDIQ1sHaQ1oZoDc4jkUKZJ2104Gu6gT05xlP61etfts8LPlg_Spi9NFAo3MAklijb5Qt5QEhrEgDKRiPgGPN6jVhsPIuMzw1OXuRSip-QqA0jcr7Z_OP1uUM-LcpqTSbbRWLuu_IM2lCQ0dW7etOiEwKDVfFTfO-5xGnnvjI-Qq2XZHZbyEPuOfb5evaYIujXFi0n1ZNbkWNXSEBYr7WrlVx_HT1WktENfyvRgj2rfxZwvbyJfJ8SLL37cAlGLCwwAC7_2B9m1IveFUOII0AdFjmGdzAgOYsLTJVMyhBTIRcOuwILMITF4mZRx26k68nAAP7zr3ayfOQq2tM_Hsw68Mego2xczwEnZp1sXHbWlaqLJupMhFfdLebKusggpOVIUflhEwpgrd2DROmdtckPrzGkwj4hrw60fwKrDbI3mT57Vgh9dtAxtx0h3Q30QlYDKNtnvjpku_l9HWS2PH-4_qod3IhkcJwVw0PD6UaX5XjijrFHEvPdNJMND9kor1bmjCS0ulbZ_BQYjg_cShQib_AoJ1ckNu6l_NMut5Ap-VJrfJnNNo7cfBoVwmUGVsCU4BoUEyfqRtRhB9MuIjTYApqttlO5Walvpu9Oi2iprUif7-cqBdES2wWJlIy4LfkzV2bVUm9ocTvHCRrCOdv-pZR2jKrW0JlRVFnFIE9VnbqCwxLUhoctbhZeIG0o31muzl6OuDe_XOyeEADlig_iWFNdj4Td69wRqlMer92vfSfSq1ey4Xf-qyoJzVCebtFxUiKjtcXcX5UNfJMs8crIcJabU-VpGSf3ZMjwuu5jc_-pbmbAmghHlh1nrhshYcbhrL6wpzgi-YTuB33gyGxV3FBSHL0VgsPUsOxYUjzxrFIYYmXuG5f3X7X0MHKS5X1OH_1yG0m9293ngE8Xd-NMk_Ok5SS_7QihBswFKT5vvwTTfDvBLPs7D2zpswy-kexo-4FjlnvInMTIp-pMCRajQcqPdKmoDe-r6LTFR4RMcMMC2lNBvzcWo0UP4tTEhCQXmZo0FRF4vWrtNelbse4uPnkpU-uL9e-XIoIknQn9OAWFN-CLoHq_QC7mrqQzg8XZLZq-iNwneD5Ly_2EKlm00"><h2 id="湍流模型构建"><a class="markdownIt-Anchor" href="#湍流模型构建"></a> 湍流模型构建</h2><p>solver 中：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Info &lt;&lt; &quot;Creating turbulence model.\n&quot; &lt;&lt; nl;</span><br><span class="line">autoPtr&lt;compressible::momentumTransportModel&gt; turbulence</span><br><span class="line">(</span><br><span class="line">    compressible::momentumTransportModel::New</span><br><span class="line">    (</span><br><span class="line">        rho,</span><br><span class="line">        U,</span><br><span class="line">        phi,</span><br><span class="line">        thermo</span><br><span class="line">    )</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>其中 <code>compressible::momentumTransportModel</code> 是 <code>CompressibleMomentumTransportModel&lt;fluidThermo&gt;</code> 的 <a href="https://github.com/OpenFOAM/OpenFOAM-dev/blob/master/src/MomentumTransportModels/compressible/fluidThermoMomentumTransportModels/fluidThermoMomentumTransportModel.H#L62" target="_blank" rel="external nofollow noopener noreferrer">typedef</a>。</p><p>所以这里首先调用的是 <code>CompressibleMomentumTransportModel::New</code></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">template&lt;class TransportModel&gt;</span><br><span class="line">Foam::autoPtr&lt;Foam::CompressibleMomentumTransportModel&lt;TransportModel&gt;&gt;</span><br><span class="line">Foam::CompressibleMomentumTransportModel&lt;TransportModel&gt;::New</span><br><span class="line">(</span><br><span class="line">    const volScalarField&amp; rho,</span><br><span class="line">    const volVectorField&amp; U,</span><br><span class="line">    const surfaceScalarField&amp; phi,</span><br><span class="line">    const transportModel&amp; transport</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    return autoPtr&lt;CompressibleMomentumTransportModel&gt;</span><br><span class="line">    (</span><br><span class="line">        static_cast&lt;CompressibleMomentumTransportModel*&gt;(</span><br><span class="line">        MomentumTransportModel</span><br><span class="line">        &lt;</span><br><span class="line">            geometricOneField,</span><br><span class="line">            volScalarField,</span><br><span class="line">            compressibleMomentumTransportModel,</span><br><span class="line">            transportModel</span><br><span class="line">        &gt;::New</span><br><span class="line">        (</span><br><span class="line">            geometricOneField(),</span><br><span class="line">            rho,</span><br><span class="line">            U,</span><br><span class="line">            phi,</span><br><span class="line">            phi,</span><br><span class="line">            transport</span><br><span class="line">        ).ptr())</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接下来调用 <code>MomentumTransportModel::New</code></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">template</span><br><span class="line">&lt;</span><br><span class="line">    class Alpha,</span><br><span class="line">    class Rho,</span><br><span class="line">    class BasicMomentumTransportModel,</span><br><span class="line">    class TransportModel</span><br><span class="line">&gt;</span><br><span class="line">Foam::autoPtr</span><br><span class="line">&lt;</span><br><span class="line">    Foam::MomentumTransportModel</span><br><span class="line">    &lt;</span><br><span class="line">        Alpha,</span><br><span class="line">        Rho,</span><br><span class="line">        BasicMomentumTransportModel,</span><br><span class="line">        TransportModel</span><br><span class="line">    &gt;</span><br><span class="line">&gt;</span><br><span class="line">Foam::MomentumTransportModel</span><br><span class="line">&lt;</span><br><span class="line">    Alpha,</span><br><span class="line">    Rho,</span><br><span class="line">    BasicMomentumTransportModel,</span><br><span class="line">    TransportModel</span><br><span class="line">&gt;::New</span><br><span class="line">(</span><br><span class="line">    const alphaField&amp; alpha,</span><br><span class="line">    const rhoField&amp; rho,</span><br><span class="line">    const volVectorField&amp; U,</span><br><span class="line">    const surfaceScalarField&amp; alphaRhoPhi,</span><br><span class="line">    const surfaceScalarField&amp; phi,</span><br><span class="line">    const transportModel&amp; transport</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    const word modelType</span><br><span class="line">    (</span><br><span class="line">        momentumTransportModel::readModelDict</span><br><span class="line">        (</span><br><span class="line">            U.db(),</span><br><span class="line">            alphaRhoPhi.group()</span><br><span class="line">        ).lookup(&quot;simulationType&quot;)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    Info&lt;&lt; &quot;Selecting turbulence model type &quot; &lt;&lt; modelType &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    typename dictionaryConstructorTable::iterator cstrIter &#x3D;</span><br><span class="line">        dictionaryConstructorTablePtr_-&gt;find(modelType);</span><br><span class="line"></span><br><span class="line">    if (cstrIter &#x3D;&#x3D; dictionaryConstructorTablePtr_-&gt;end())</span><br><span class="line">    &#123;</span><br><span class="line">        FatalErrorInFunction</span><br><span class="line">            &lt;&lt; &quot;Unknown MomentumTransportModel type &quot;</span><br><span class="line">            &lt;&lt; modelType &lt;&lt; nl &lt;&lt; nl</span><br><span class="line">            &lt;&lt; &quot;Valid MomentumTransportModel types:&quot; &lt;&lt; endl</span><br><span class="line">            &lt;&lt; dictionaryConstructorTablePtr_-&gt;sortedToc()</span><br><span class="line">            &lt;&lt; exit(FatalError);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return autoPtr&lt;MomentumTransportModel&gt;</span><br><span class="line">    (</span><br><span class="line">        cstrIter()(alpha, rho, U, alphaRhoPhi, phi, transport)</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接下来是 <code>MomentumTransportModel</code> 的构造函数</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">template</span><br><span class="line">&lt;</span><br><span class="line">    class Alpha,</span><br><span class="line">    class Rho,</span><br><span class="line">    class BasicMomentumTransportModel,</span><br><span class="line">    class TransportModel</span><br><span class="line">&gt;</span><br><span class="line">Foam::MomentumTransportModel</span><br><span class="line">&lt;</span><br><span class="line">    Alpha,</span><br><span class="line">    Rho,</span><br><span class="line">    BasicMomentumTransportModel,</span><br><span class="line">    TransportModel</span><br><span class="line">&gt;::MomentumTransportModel</span><br><span class="line">(</span><br><span class="line">    const alphaField&amp; alpha,</span><br><span class="line">    const rhoField&amp; rho,</span><br><span class="line">    const volVectorField&amp; U,</span><br><span class="line">    const surfaceScalarField&amp; alphaRhoPhi,</span><br><span class="line">    const surfaceScalarField&amp; phi,</span><br><span class="line">    const transportModel&amp; transport</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    BasicMomentumTransportModel</span><br><span class="line">    (</span><br><span class="line">        rho,</span><br><span class="line">        U,</span><br><span class="line">        alphaRhoPhi,</span><br><span class="line">        phi</span><br><span class="line">    ),</span><br><span class="line">    alpha_(alpha),</span><br><span class="line">    transport_(transport)</span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure><p>它的模板兼基类 <code>BasicMomentumTransportModel</code> 的实例化是 <code>compressibleMomentumTransportModel</code>，因此又调用了其构造函数</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Foam::compressibleMomentumTransportModel::compressibleMomentumTransportModel</span><br><span class="line">(</span><br><span class="line">    const volScalarField&amp; rho,</span><br><span class="line">    const volVectorField&amp; U,</span><br><span class="line">    const surfaceScalarField&amp; alphaRhoPhi,</span><br><span class="line">    const surfaceScalarField&amp; phi</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    momentumTransportModel</span><br><span class="line">    (</span><br><span class="line">        U,</span><br><span class="line">        alphaRhoPhi,</span><br><span class="line">        phi</span><br><span class="line">    ),</span><br><span class="line">    rho_(rho)</span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure><p>最后来到了 <code>momentumTransportModel</code> 的构造函数</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Foam::momentumTransportModel::momentumTransportModel</span><br><span class="line">(</span><br><span class="line">    const volVectorField&amp; U,</span><br><span class="line">    const surfaceScalarField&amp; alphaRhoPhi,</span><br><span class="line">    const surfaceScalarField&amp; phi</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    IOdictionary(readModelDict(U.db(), alphaRhoPhi.group(), true)),</span><br><span class="line"></span><br><span class="line">    runTime_(U.time()),</span><br><span class="line">    mesh_(U.mesh()),</span><br><span class="line"></span><br><span class="line">    U_(U),</span><br><span class="line">    alphaRhoPhi_(alphaRhoPhi),</span><br><span class="line">    phi_(phi),</span><br><span class="line">    y_(mesh_)</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F; Ensure name of IOdictionary is typeName</span><br><span class="line">    rename(IOobject::groupName(typeName, alphaRhoPhi.group()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="题外话"><a class="markdownIt-Anchor" href="#题外话"></a> 题外话</h3><p>初始化列表中：<code>alphaRhoPhi_(alphaRhoPhi)</code><br>另有函数：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">inline const surfaceScalarField&amp; alphaRhoPhi() const</span><br><span class="line">&#123;</span><br><span class="line">    return alphaRhoPhi_;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>combustionModel.H</code> 中：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">inline Foam::tmp&lt;Foam::surfaceScalarField&gt; Foam::combustionModel::phi() const</span><br><span class="line">&#123;</span><br><span class="line">    return turbulence().alphaRhoPhi();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>就是说，<code>solver</code> 中 <code>#include &quot;compressibleCreatePhi.H&quot;</code> 创建的 <code>phi</code> 逐级传到了湍流模型中，可以使用 <code>Foam::combustionModel::phi()</code> 来调用它。</p><h2 id="输运模型构建"><a class="markdownIt-Anchor" href="#输运模型构建"></a> 输运模型构建</h2><p>solver 中</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt; &quot;Creating thermophysical transport model\n&quot; &lt;&lt; endl;</span><br><span class="line">autoPtr&lt;psiReactionThermophysicalTransportModel&gt; thermophysicalTransport</span><br><span class="line">(</span><br><span class="line">    psiReactionThermophysicalTransportModel::New(turbulence(), thermo)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>由 psiReactionThermophysicalTransportModel.H 可知：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">typedef ThermophysicalTransportModel</span><br><span class="line">&lt;</span><br><span class="line">    compressible::momentumTransportModel,</span><br><span class="line">    psiReactionThermo</span><br><span class="line">&gt; psiReactionThermophysicalTransportModel;</span><br></pre></td></tr></table></figure><p>因此这里调用的是 <code>ThermophysicalTransportModel</code> 的构造函数，参数则是 <code>ThermophysicalTransportModel::New(turbulence(), thermo)</code> 的返回值。<br>我们先看 New，再看构造函数。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">template&lt;class MomentumTransportModel, class ThermoModel&gt;</span><br><span class="line">Foam::autoPtr</span><br><span class="line">&lt;</span><br><span class="line">    Foam::ThermophysicalTransportModel&lt;MomentumTransportModel, ThermoModel&gt;</span><br><span class="line">&gt;</span><br><span class="line">Foam::ThermophysicalTransportModel&lt;MomentumTransportModel, ThermoModel&gt;::New</span><br><span class="line">(</span><br><span class="line">    const momentumTransportModel&amp; momentumTransport,</span><br><span class="line">    const thermoModel&amp; thermo</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    const word modelType</span><br><span class="line">    (</span><br><span class="line">        momentumTransport.lookup(&quot;simulationType&quot;)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    Info&lt;&lt; &quot;Selecting thermophysical transport type &quot; &lt;&lt; modelType &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    typename dictionaryConstructorTable::iterator cstrIter &#x3D;</span><br><span class="line">        dictionaryConstructorTablePtr_-&gt;find(modelType);</span><br><span class="line"></span><br><span class="line">    if (cstrIter &#x3D;&#x3D; dictionaryConstructorTablePtr_-&gt;end())</span><br><span class="line">    &#123;</span><br><span class="line">        FatalErrorInFunction</span><br><span class="line">            &lt;&lt; &quot;Unknown thermophysical transport type &quot;</span><br><span class="line">            &lt;&lt; modelType &lt;&lt; nl &lt;&lt; nl</span><br><span class="line">            &lt;&lt; &quot;Available types:&quot; &lt;&lt; endl</span><br><span class="line">            &lt;&lt; dictionaryConstructorTablePtr_-&gt;sortedToc()</span><br><span class="line">            &lt;&lt; exit(FatalError);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return autoPtr&lt;ThermophysicalTransportModel&gt;</span><br><span class="line">    (</span><br><span class="line">        cstrIter()(momentumTransport, thermo)</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里我们通过指定字典文件中的 <code>simulationType</code> 来决定创建 <code>laminarThermophysicalTransportModel</code> <code>RASThermophysicalTransportModel``LESThermophysicalTransportModel</code> 的其中之一。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">template&lt;class MomentumTransportModel, class ThermoModel&gt;</span><br><span class="line">Foam::ThermophysicalTransportModel&lt;MomentumTransportModel, ThermoModel&gt;::</span><br><span class="line">ThermophysicalTransportModel</span><br><span class="line">(</span><br><span class="line">    const momentumTransportModel&amp; momentumTransport,</span><br><span class="line">    const thermoModel&amp; thermo</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    thermophysicalTransportModel(momentumTransport),</span><br><span class="line">    momentumTransport_(momentumTransport),</span><br><span class="line">    thermo_(thermo)</span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure><p>接下来进入基类的构造函数</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Foam::thermophysicalTransportModel::thermophysicalTransportModel</span><br><span class="line">(</span><br><span class="line">    const compressibleMomentumTransportModel&amp; momentumTransport</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    IOdictionary</span><br><span class="line">    (</span><br><span class="line">        IOobject</span><br><span class="line">        (</span><br><span class="line">            IOobject::groupName</span><br><span class="line">            (</span><br><span class="line">                typeName, momentumTransport.alphaRhoPhi().group()</span><br><span class="line">            ),</span><br><span class="line">            momentumTransport.time().constant(),</span><br><span class="line">            momentumTransport.mesh(),</span><br><span class="line">            &#x2F;&#x2F;***HGW IOobject::MUST_READ_IF_MODIFIED,</span><br><span class="line">            IOobject::READ_IF_PRESENT,</span><br><span class="line">            IOobject::NO_WRITE</span><br><span class="line">        )</span><br><span class="line">    ),</span><br><span class="line"></span><br><span class="line">    momentumTransportModel_(momentumTransport)</span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TurbulenceModels </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM 编程笔记</title>
      <link href="/programmingNote/"/>
      <url>/programmingNote/</url>
      
        <content type="html"><![CDATA[<p>编写代码过程中用到的，或者搜集的一些代码片段。</p><a id="more"></a><h1 id="字典读取变量"><a class="markdownIt-Anchor" href="#字典读取变量"></a> 字典读取变量</h1><p>在求解器中由于计算需要，要求通过字典文件输入某个值：首先创建字典，然后从这个字典读取数据。<br>创建一个字典或者使用已有字典：</p><ul><li>创建字典：</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">IOdictionary transportProperties&#x2F;&#x2F;字典的变量名</span><br><span class="line">(</span><br><span class="line">    IOobject</span><br><span class="line">    (</span><br><span class="line">        &quot;transportProperties&quot;,&#x2F;&#x2F;字典名字</span><br><span class="line">        runTime.constant(),   &#x2F;&#x2F;字典位于constant下</span><br><span class="line">        mesh,</span><br><span class="line">        IOobject::MUST_READ_IF_MODIFIED,</span><br><span class="line">        IOobject::NO_WRITE</span><br><span class="line">    )</span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li>使用已有字典：</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">const dictionary&amp; subModelDict &#x3D; parcels.subModelProperties();&#x2F;&#x2F;这里要先获取已有的字典</span><br><span class="line">vector position &#x3D; subModelDict.subDict</span><br><span class="line">(</span><br><span class="line">    &quot;injectionModels&quot;</span><br><span class="line">).subDict(&quot;model1&quot;).lookup(&quot;position&quot;);</span><br><span class="line">&#x2F;&#x2F;子字典的用法可以参考这里</span><br></pre></td></tr></table></figure><p>然后从这个字典读取数据：</p><ul><li>读取 OF 定义的类型，如 <code>dimensionedScalar</code> 等，直接使用<code>lookup</code> 函数：</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">word fuel(thermo.lookup(&quot;fuel&quot;));</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dimensionedScalar DT</span><br><span class="line">(</span><br><span class="line">transportProperties.lookup(&quot;DT&quot;)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">scalarList Z_param_(flameManDict.lookup(&quot;Z_param&quot;));</span><br></pre></td></tr></table></figure><ul><li>但是读取标量例外，需要这样用：</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">scalar Sct &#x3D; readScalar(transportProperties.lookup(&quot;Sct&quot;));</span><br></pre></td></tr></table></figure><p>另一个函数 <code>lookupOrdefault</code> 如何使用？<br>如下：</p><ul><li><code>B_(dict.lookupOrDefault(&quot;B&quot;, 5.5))</code></li><li><code>deltaByR1Min_(coeffDict_.lookupOrDefault&lt;scalar&gt;(&quot;deltaByR1Min&quot;, 0.0))</code></li><li><code>active_(lookupOrDefault&lt;Switch&gt;(&quot;active&quot;, true))</code></li><li><code>Cg_(lookupOrDefault&lt;scalar&gt;(&quot;Cg&quot;, 2.0))</code></li></ul><p>发现一个奇怪的地方：<br>case文件如下，可以看到D_NaCl需要两个word作为输入。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nu              [0 2 -1 0 0 0 0] 1e-05;</span><br><span class="line">D_NaCl_111         What  [0 2 -1 0 0 0 0] 0.01;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">dimensionedScalar D_NaCl</span><br><span class="line">(</span><br><span class="line">    transportProperties.lookup(<span class="string">"D_NaCl_111"</span>)</span><br><span class="line">);</span><br><span class="line">Info&lt;&lt;<span class="string">"D_NaCl====="</span>&lt;&lt;D_NaCl&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="comment">//output:::::    D_NaCl=====What [0 2 -1 0 0 0 0] 0.01</span></span><br></pre></td></tr></table></figure><p>dimensionedScalar的三个私有数据，分别对应上述输出的三个量。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">template&lt;class Type&gt;</span><br><span class="line">class dimensioned</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F; Private data</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;- Variable name</span><br><span class="line">        word name_;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;- The dimension set</span><br><span class="line">        dimensionSet dimensions_;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;- The data value</span><br><span class="line">        Type value_;</span><br></pre></td></tr></table></figure><p>那么lookup得到了这三个量，然后调用构造函数？</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dimensioned(const word&amp;, const dimensionSet&amp;, const Type);</span><br></pre></td></tr></table></figure><p>那么 nu 呢？为什么只有 dimension 和 value?</p><p>声明</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dimensionedScalar nu0_;</span><br><span class="line">volScalarField nu_;</span><br></pre></td></tr></table></figure><p>定义</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nu0_(&quot;nu&quot;, dimViscosity, viscosityProperties_),</span><br><span class="line">nu_&#x2F;&#x2F;nu_ 是用一个 dimensionedScalar 构造出来的。</span><br><span class="line">(</span><br><span class="line">    IOobject</span><br><span class="line">    (</span><br><span class="line">        name,</span><br><span class="line">        U_.time().timeName(),</span><br><span class="line">        U_.db(),</span><br><span class="line">        IOobject::NO_READ,</span><br><span class="line">        IOobject::NO_WRITE</span><br><span class="line">    ),</span><br><span class="line">    U_.mesh(),</span><br><span class="line">    nu0_</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>读取数据</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">bool Foam::viscosityModels::Newtonian::read</span><br><span class="line">(</span><br><span class="line">    const dictionary&amp; viscosityProperties</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    viscosityModel::read(viscosityProperties);</span><br><span class="line">    viscosityProperties_.lookup(&quot;nu&quot;) &gt;&gt; nu0_;</span><br><span class="line">    nu_ &#x3D; nu0_;</span><br><span class="line">    &#x2F;&#x2F;volScalarField &#x3D; dimensionedScalar 均匀场</span><br><span class="line">    return true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>那么这里的问题就变成了 <code>nu0_</code> 和 <code>D_NaCl</code> 的区别了，再看一下他们 <code>lookup</code> 的具体函数：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">viscosityProperties_.lookup(&quot;nu&quot;) &gt;&gt; nu0_;</span><br><span class="line">&#x2F;&#x2F;这里的 &#96;lookup&#96; 获取了 dimension value 两个值</span><br><span class="line">&#x2F;&#x2F;为什么两个值就够了？</span><br><span class="line"></span><br><span class="line">dimensionedScalar D_NaCl</span><br><span class="line">(</span><br><span class="line">    transportProperties.lookup(&quot;D_NaCl_111&quot;)</span><br><span class="line">    &#x2F;&#x2F;这里 &#96;lookup&#96; 得到了 name dimension value 三个值</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><code>nu_</code> 输出是这样的：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">turbulence.nu&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;dimensions      [0 2 -1 0 0 0 0];</span><br><span class="line"></span><br><span class="line">internalField   uniform 1e-05;</span><br><span class="line"></span><br><span class="line">boundaryField</span><br><span class="line">&#123;</span><br><span class="line">    movingWall</span><br><span class="line">    &#123;</span><br><span class="line">        type            calculated;</span><br><span class="line">        value           uniform 1e-05;</span><br><span class="line">    &#125;</span><br><span class="line">    fixedWalls</span><br><span class="line">    &#123;</span><br><span class="line">        type            calculated;</span><br><span class="line">        value           uniform 1e-05;</span><br><span class="line">    &#125;</span><br><span class="line">    frontAndBack</span><br><span class="line">    &#123;</span><br><span class="line">        type            empty;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>所以说，体标量场没有name，只有dimension和值？值分为内部场值和边界值。</p><h1 id="对某个量全场求和"><a class="markdownIt-Anchor" href="#对某个量全场求和"></a> 对某个量全场求和</h1><h2 id="使用-functionobject"><a class="markdownIt-Anchor" href="#使用-functionobject"></a> 使用 functionObject</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    minMax</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Type of functionObject</span></span><br><span class="line">        type            cellSource;</span><br><span class="line">        <span class="comment">// Where to load it from (if not already in solver)</span></span><br><span class="line">        functionObjectLibs (<span class="string">"libfieldFunctionObjects.so"</span>);</span><br><span class="line">        <span class="comment">// Function object enabled flag</span></span><br><span class="line">        enabled         <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">// Log to output (default: false)</span></span><br><span class="line">        <span class="built_in">log</span>             <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">// Write information to file (default: true)</span></span><br><span class="line">        <span class="built_in">write</span>           <span class="literal">true</span>;</span><br><span class="line">        location        no;</span><br><span class="line">        <span class="comment">// Fields to be monitored - runTime modifiable</span></span><br><span class="line">        fields (dQ);</span><br><span class="line">        <span class="comment">//fields (T);</span></span><br><span class="line">        writeControl    timeStep;</span><br><span class="line">        writeInterval   <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="强行通过某个-const-接口修改变量"><a class="markdownIt-Anchor" href="#强行通过某个-const-接口修改变量"></a> 强行通过某个 <code>const</code> 接口修改变量：</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">volScalarField&amp; mu_ &#x3D; const_cast&lt;volScalarField&amp;&gt;(this-&gt;thermo().mu()());</span><br></pre></td></tr></table></figure><p>这样就可以修改热物理库中的 <code>mu_</code> 了。</p><h1 id="场的加减乘除操作符同时包括内部场和边界场的操作"><a class="markdownIt-Anchor" href="#场的加减乘除操作符同时包括内部场和边界场的操作"></a> 场的加减乘除操作符，同时包括内部场和边界场的操作。</h1><p>哪些类有 <code>lookupOrDefault</code> 这个方法？已知的有：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dimensioned&lt;Type&gt;</span><br><span class="line">dictionary中是一个模板函数</span><br></pre></td></tr></table></figure><p>用法举例：</p><ul><li><p><code>active_(lookupOrDefault&lt;Switch&gt;(&quot;active&quot;, true))</code> 这是在初始化列表中使用，当前类继承自 <code>IOdictionary</code>。</p></li><li><p><code>Cg_(lookupOrDefault&lt;scalar&gt;(&quot;Cg&quot;, 2.0))</code> 这是在初始化列表中使用，当前类继承自 <code>IOdictionary</code>。</p></li><li><p><code>const int nNonOrthCorr(dictionary.lookupOrDefault&lt;int&gt;(&quot;nNonOrthogonalCorrectors&quot;, 0));</code></p></li><li><p><code>scalar maxDeltaT(Dict_.lookupOrDefault&lt;scalar&gt;(&quot;maxDeltaT&quot;, great));</code></p></li><li><p><code>B_(Dict_.lookupOrDefault(&quot;B&quot;, 5.5))</code> 这里为什么不需要提供模板？ B_ 是个 scalar</p></li><li><p><code>deltaByR1Min_(Dict_.lookupOrDefault&lt;scalar&gt;(&quot;deltaByR1Min&quot;, 0.0))</code></p></li><li><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dimensionedScalar Tmax;</span><br><span class="line">Tmax(Dict_.subDict(&quot;subName&quot;).lookup(&quot;Tmax&quot;)),</span><br><span class="line">这里需要字典里边给定它的值和量纲，格式如下：</span><br><span class="line">Tmax     Tmax    [0 0 0 1 0 0 0] 2800.0;</span><br></pre></td></tr></table></figure></li><li><p><code>RASModel</code> 的构造函数里边的这个 <code>IOdictionary</code> 是什么用法？这里的 <code>RASModel</code> 是继承自 <code>IOdictionary</code> 的，所以在构造函数的初始化列表里边，需要先初始化基类的成员，然后正是因为继承关系，所以可以直接使用 <code>IOdictionary</code> 里边的 <code>lookup</code> 等函数！</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">RASModel::RASModel(...)</span><br><span class="line">:</span><br><span class="line">    turbulenceModel(rho, U, phi, thermophysicalModel, turbulenceModelName),</span><br><span class="line">    IOdictionary</span><br><span class="line">    (</span><br><span class="line">        IOobject</span><br><span class="line">        (</span><br><span class="line">            &quot;RASProperties&quot;,</span><br><span class="line">            U.time().constant(),</span><br><span class="line">            U.db(),</span><br><span class="line">            IOobject::MUST_READ_IF_MODIFIED,</span><br><span class="line">            IOobject::NO_WRITE</span><br><span class="line">        )</span><br><span class="line">    ),</span><br><span class="line">    turbulence_(lookup(&quot;turbulence&quot;)),</span><br><span class="line">    printCoeffs_(lookupOrDefault&lt;Switch&gt;(&quot;printCoeffs&quot;, false)),</span><br><span class="line">    coeffDict_(subOrEmptyDict(type + &quot;Coeffs&quot;)),</span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure></li></ul><h1 id="字典的三种使用方法"><a class="markdownIt-Anchor" href="#字典的三种使用方法"></a> 字典的三种使用方法：</h1><ul><li>创建字典文件<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">CCMProperties</span><br><span class="line">(</span><br><span class="line">    IOobject</span><br><span class="line">    (</span><br><span class="line">        <span class="string">"CCMProperties"</span>,</span><br><span class="line">        <span class="keyword">this</span>-&gt;mesh().time().constant(),</span><br><span class="line">        <span class="keyword">this</span>-&gt;mesh(),</span><br><span class="line">        IOobject::MUST_READ,</span><br><span class="line">        IOobject::NO_WRITE,</span><br><span class="line">        <span class="literal">false</span></span><br><span class="line">    )</span><br><span class="line">),</span><br></pre></td></tr></table></figure></li><li>创建某个文件中的字典中的子字典，无须创建，再使用一个 <code>subDict</code> ，如：<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dimensionedScalar Prandtl;</span><br><span class="line">Prandtl(CCMProperties.subDict(&quot;CCM&quot;).lookup(&quot;Prandtl&quot;)),</span><br></pre></td></tr></table></figure></li></ul><h1 id="路径"><a class="markdownIt-Anchor" href="#路径"></a> 路径</h1><p><code>db().time().rootPath()</code> 当前算例的上级目录。<br><code>db().path()</code> 当前运行目录，相当于在运行时执行 <code>pwd</code> 出现的结果。串行时为当前目录，并行时为每一个 processor*，不同的核对应各自的 processor*。<br><code>db().time().globalCaseName()</code> 当前算例的文件夹的名字。<br><code>db().time().timeName()</code> 是当前时间的字符串。</p><p>如果是 collated 模式，则没有 processor* 文件夹，只有 <strong>processors+核数</strong>这个文件夹，想要输出一个文件到这里，可以这么做：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">ostringstream</span> nProcs;</span><br><span class="line">nProcs&lt;&lt;Pstream::nProcs();</span><br><span class="line"><span class="function">fileName <span class="title">outputFile</span><span class="params">(db().time().rootPath()/db().time().globalCaseName()/<span class="string">"processors"</span>+nProcs.str()/db().time().timeName()/+<span class="string">"vortons_"</span>+patch().name())</span></span>;</span><br><span class="line">Info&lt;&lt;<span class="string">"outputFile==="</span>&lt;&lt;outputFile&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="function">fileName <span class="title">outputFile2</span><span class="params">(db().time().rootPath()/db().time().globalCaseName()/<span class="string">"processors"</span>+Foam::name(Pstream::nProcs())/db().time().timeName()/+<span class="string">"vortons_"</span>+patch().name())</span></span>;</span><br><span class="line">Info&lt;&lt;<span class="string">"outputFile2==="</span>&lt;&lt;outputFile2&lt;&lt;<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure><p>上边的outputFile和outputFile2输出相同。</p><h1 id="未解之谜"><a class="markdownIt-Anchor" href="#未解之谜"></a> 未解之谜</h1><p>输运方程中的源项，我只需要内部场，边界场应该怎么处理呢？内部场给了矩阵的 <code>source()</code>，边界场应该没有参与计算。</p>]]></content>
      
      
      <categories>
          
          <category> coding </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM 燃烧化学求解过程解析</title>
      <link href="/chemistry/"/>
      <url>/chemistry/</url>
      
        <content type="html"><![CDATA[<p>分析 OpenFOAM-dev 中的燃烧化学相关类，个人理解有限，希望帮我指正错误！</p><a id="more"></a><h1 id="of-7"><a class="markdownIt-Anchor" href="#of-7"></a> OF-7</h1><h2 id="uml-类图"><a class="markdownIt-Anchor" href="#uml-类图"></a> UML 类图</h2><p>首先给出 UML 图，右键在新标签页中打开链接，可以获得更好的阅读体验。</p><details><summary>OF-7 UML!</summary><img src="http://www.plantuml.com/plantuml/svg/rLhTRzis47_tNq6aWE4WTbjqRxONeCq7wc5PCjjxA8R1e2KgvY9BBaavCRhyxoCfKX8fwiDsqcvzI6toxdZytGVlBfdS-jXZE8uWsO7nFmC_Vem6O0afzYvMQ8qf8xkRs4TXnmiXfQwTRnt0_oqMu8x437aC-S273F8LkV76YoFAGB2zGNJL1Ml-KstC7Z7pLi3JqWnwwi4G4i3bCpWN1quYN4zm0vyKmJOEPtBt6gFG7mud4KCaWc61U55M-WQjbuY0woIIWD3i0ZWASOH0bTHkGMplL6k0VU35X73HQesVLNN2cJgXZ5JlD5qqo6pSJA8j9YpXTmtX4eKWccsGXv4c0J-3zqwoAO9IfpAXeLix35pgDF5FfxsK95K8LogyZuWICrjlnbK2pW5VzP8GCcH9EYCA7TmlBbC9RPscmWcqp9v37UN3D0wtgETmwtrOv6swrOpbgvy3vbKxXel-Tpzc1iTpf-F827aY-LIPI1mxO-s4ynKYw_YyAR6Ov5t0vF-Bjj7cPbVHQhfz5QboT8x2fpeKPWn6FYI-1SJjvTLiHnbQ2yfAgWt5vl5W_FPj1J4OMgfsxY7zd7wyM-suYhIUEoMTxpP8cSbDQLcgN-0hMWrlkTzNsc70RxuHaJ5EZxgKdYjbkBmytywSlC4_xXZvbUjiUt4NV34U4ascxpGkN8OJwzYdJgO2RLSbX7d13TyOMTXSq-UfLNNbkJolzWR5b3MTAj9rmk0oHCLa0BoQFT_psG6FOAD6CWtl-UArjO3pDMnf3_Uhf6GutyewIlkvD3GoB5b3qSr87Ez6l4Rtq9NWlRxnKCpDhvk--HfmApkleyYBfxZGv-3t3zQX2pP1zj4B-XAxBWYdA5_Ua9o2Q0h2AHgrdlJKCw_r_YyfQZ_zEXxYBI84-pYw1t39qodN70HPSE38LL-__UoEchrhgOFhg9UeeNGGJsfAg3sBeuCAetsAelqAejOsvkz-sQPMFNxrrKvtXclvI3wkU8ke2GrpHq6xf215_mszU8bXT9XSjJBxca22RY0Z-8bl1BvdWKIGy14Vi3ZlOsR2T2G3nj0gDMln0UjwMK3EyoZDFgNcphxIP7cfAcEZUarBZwmI-zRuSDNOgQ83gBJLamlJdONfpd-g5--sLolPWVzKPQ-TXLD5nPYLk9OHXywQto8QcqJdxS5_JPUmtL7Mvb5yOIwxoQwI4949hsgnXvcRXD-qq-bCd6CNBrul4ogM3TJCrOF7BUa6bxOXY5BC2y9vGfPSuyX3KZBlQ_Y2EPmHINkh2zU2pbwCWi0iYHzZueEr42HAXyKB3prQQfykr4WmCpX_mbUnarfaUvgG07h8oFYR5QwHdgBMLR3L4EPGTXMMDTa-6oIvk_HWcsgOXY_l2Nhs9RyStULRJfZxx8Nbi-vsrQ8gzwcfgrjabGE1nWHHsR2N06ZJu6iGBgf0IDdoxOwza9DINXU4QCRGfa3kMinPhcUN3HG-3eA4Dal2KO0Zp52ukuQKPIcjezz1M-so0PuLfUiSUofG6WgSvIi0Kr2QJMJI-OrhXMcwxDwjg2jkty1RvT6QlO1poQih7SR1hKEWlBFlN0mcBERzyBZ5YEqyVvCvn-Be-De_jcHSER3Ce0hX6lCygU1HtseWIOTEHK06opWM3Jn3zqGq9efroZ_lCm5fqIkqhbtCNmqScCtto-I3mU0pWanKtWXI10GKuC-7-tVhT_IdlqnP4Z3UiVbSmUUEmZmtoHsSJSkhLvSNdOfveuQy725f0qY7GwP2IzH8caRPF1jCDCV1EaK_A1bFegvxq1aZlwA0zMxv1vx7-4y4r_cSgGXlYN6AxrUjEBbUl6Xcs3DyyOocQwfz-2Fw3QwHhoz6HmQHdbg4yUCb2c0ICZ5fvGgeRwCCW6GPweCOJroqS1n9UF-PmdmX2mtDvDZAs5Jd7_deIQkasciMOsybgSqDzBI98nGnlLgGgZkJrDHpCOhKipdQ1nEgGCJqT5GRneKoC-Ae6QjEuOf23WQB2fs3S5MpIR9DAgrSD7yRom_IzWGnDNbCDVmCwOhdMAcXxSawALxowovvSEuvFnMGT2KcEjX7pe4azwDw0k5RRehqe39ONG5bJPthuY0hMlSxGXVB_I4y9SrgNCKIBljsaJojUM7DDB5Y9cAWAVv9sS5Bo0vCIrMCZG_IEfyGcL5-fFYN6BIEd6E_X-00hGhbVOLKOafz21xz_dSuvr2fqcqVVUzm2vc3e5yg1tnTDOJFlafeiY_B32TLIlY9X_II35PfM1wbtWVgS6D-YVaXbp1eb8OD5fIwkY_V-WR6J5k-clDQR_KVWeFkr-X8_WDv0U2aUXPAfFhi0YRpP1EY3oaqVSKhVeMtH0psgYMaDlVmCPwR-IZsM-34gOusm7FMDq_H5X4vb2hNghmSwriTPh43QMXTYgJWOJ5gB0p4UQAcx9sGJAcJqvTFcjyZORvyidoLSFnHeNXS67wV47oLy1EXbxMKQNzfnr-nqnH_pLBLbzRnfHtgDGp3so0m0h6HLr3fMLQPVspGzO6cqT6yLqvuhvA2jJo90hrXIGVNUeEjCF4_nVxkAWWmhu8ZKGa3vwfcgN4lwLqjCfHgRcKV9vhLtkatWbX28WELuJ3T0sSsEeMT4xLrCdfszJFn1X78Oj8xFSBNTDrkYlPV866K6wKsSQl1Ij4sx_swGMmXS6WCYtVp8o4h5E64biBA5MxEk7AAg0ySfTT7xSpgUy5lzTByE4S-oPHxJSzqMkM7-UNe_-U9-Mio9p6oqsIrDrgK-fSdPHcjt166crN9_oYbYpx_J_wWnpcZK6nFFxHAZZkoby_TcNyq1gwjckQEs3NDl5w-jxTyhqh-S-TV"></details><p>我猜测：<code>ArrheniusReactionRate</code> 也可以直接作为 <code>ReversibleReaction</code> 的模板，而不通过 <code>FallOffReactionRate</code>。</p><p><code>Reaction</code> 的模板是 <code>gasHThermoPhysics</code>，<code>Reaction</code> 的基类是 <code>Foam::species::thermo</code>，全称是 <code>Foam::species::thermo&lt; Foam::janafThermo&lt;Foam::perfectGas&lt;Foam::specie&gt;&gt;, Foam::sensibleEnthalpy&gt;</code>。</p><p><code>ReversibleReaction</code> 的模板是 <code>Reaction</code>，<code>gasHThermoPhysics</code> 和 <code>FallOffReactionRate</code>。而 <code>FallOffReactionRate</code> 的模板是 <code>ArrheniusReactionRate</code> 和 <code>TroeFallOffFunction</code>。<br><code>ReversibleReaction</code> 的基类是 <code>Reaction&lt;gasHThermoPhysics&gt;</code>。</p><p>机理文件怎么读取的？<br><code>Reaction</code> 等相关类的对象在哪里创建的？<br>在 StandardChemistryModel 中申明了反应的 list：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> PtrList&lt;Reaction&lt;ThermoType&gt;&gt;&amp; reactions_;</span><br></pre></td></tr></table></figure><p>StandardChemistryModel 的构造函数中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">reactions_</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">dynamic_cast</span>&lt;<span class="keyword">const</span> reactingMixture&lt;ThermoType&gt;&amp;&gt;(<span class="keyword">this</span>-&gt;thermo())</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>this-&gt;thermo()</code> 返回的是 <code>BasicChemistryModel</code> 中申明的 <code>ReactionThermo&amp; thermo_</code>，这里模板 <code>ReactionThermo</code> 的实例是 <code>psiReactionThermo</code>。<br>thermo_由构造函数中的thermo传入。</p><p>StandardChemistryModel 的模板 ReactionThermo<br>到底是 psiReactionThermo，还是 hePsiThermo？<br>是 psiReactionThermom 又如何，<br>是 hePsiThermo 又如何？<br>dynamic_cast&lt;const reactingMixture<thermotype>&amp;&gt;(this-&gt;thermo())<br>二者之间，哪个可以转化为 reactingMixture？答：hePsiThermo</thermotype></p><p>有这个疑问是因为 solver 中创建 thermo 的时候用的是 psiReactionThermo，但是后来实际上的对象是 hePsiThermo 类型的。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">autoPtr&lt;psiReactionThermo&gt; <span class="title">pThermo</span><span class="params">(psiReactionThermo::New(mesh))</span></span>;</span><br><span class="line">psiReactionThermo&amp; thermo = pThermo();</span><br></pre></td></tr></table></figure><p><code>const PtrList&lt;Reaction&lt;ThermoType&gt;&gt;&amp; reactions_;</code><br>为什么可以这样初始化？没有找到对应的构造函数。<br>答案：<br>下边提到了，reactingMixture 中实际上包括了从机理文件读取的反应的 list，这里的目的是把读取的 list 转移到这里的 reactions_ 中。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">reactions_</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">dynamic_cast</span>&lt;<span class="keyword">const</span> reactingMixture&lt;ThermoType&gt;&amp;&gt;(<span class="keyword">this</span>-&gt;thermo())</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>StandardChemistryModel::calculateRR 中使用了 Reaction 中的函数 omega</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Reaction&lt;ThermoType&gt;&amp; R = reactions_[ri];</span><br><span class="line"><span class="keyword">const</span> scalar omegai = R.omega(pi, Ti, c_, pf, cf, lRef, pr, cr, rRef);</span><br></pre></td></tr></table></figure><p>chemkinReader(chemistryReader 的派生类)中申明了另一个反应的 list:</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">ReactionList&lt;gasHThermoPhysics&gt; reactions_;</span><br></pre></td></tr></table></figure><p>并且定义了接口 reactions()</p><p>读取机理文件后，在 chemkinReader::addReactionType 中 append 所有的 reactions_</p><p><code>reactingMixture</code> 的构造函数</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ThermoType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:reactingMixture&lt;ThermoType&gt;::reactingMixture</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> dictionary&amp; thermoDict,</span><br><span class="line">    <span class="keyword">const</span> fvMesh&amp; mesh,</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; phaseName</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    speciesTable(),</span><br><span class="line">    autoPtr&lt;chemistryReader&lt;ThermoType&gt;&gt;</span><br><span class="line">    (</span><br><span class="line">        chemistryReader&lt;ThermoType&gt;::New(thermoDict, *<span class="keyword">this</span>)</span><br><span class="line">    ),</span><br><span class="line">    multiComponentMixture&lt;ThermoType&gt;</span><br><span class="line">    (</span><br><span class="line">        thermoDict,</span><br><span class="line">        *<span class="keyword">this</span>,</span><br><span class="line">        autoPtr&lt;chemistryReader&lt;ThermoType&gt;&gt;::<span class="keyword">operator</span>()().speciesThermo(),</span><br><span class="line">        mesh,</span><br><span class="line">        phaseName</span><br><span class="line">    ),</span><br><span class="line">    PtrList&lt;Reaction&lt;ThermoType&gt;&gt;</span><br><span class="line">    (</span><br><span class="line">        autoPtr&lt;chemistryReader&lt;ThermoType&gt;&gt;::<span class="keyword">operator</span>()().reactions()</span><br><span class="line">    ),</span><br><span class="line">    speciesComposition_</span><br><span class="line">    (</span><br><span class="line">        autoPtr&lt;chemistryReader&lt;ThermoType&gt;&gt;::<span class="keyword">operator</span>()().specieComposition()</span><br><span class="line">    )</span><br><span class="line">&#123;</span><br><span class="line">    autoPtr&lt;chemistryReader&lt;ThermoType&gt;&gt;::<span class="built_in">clear</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在 dev 版本的 reactingFoam 中，创建了哪些和燃烧化学相关的对象呢？</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">autoPtr&lt;psiReactionThermo&gt; pThermo(psiReactionThermo::New(mesh));</span><br><span class="line">psiReactionThermo&amp; thermo &#x3D; pThermo();</span><br><span class="line">basicSpecieMixture&amp; composition &#x3D; thermo.composition();</span><br><span class="line">PtrList&lt;volScalarField&gt;&amp; Y &#x3D; composition.Y();</span><br><span class="line">autoPtr&lt;CombustionModel&lt;psiReactionThermo&gt;&gt; reaction</span><br><span class="line">(</span><br><span class="line">    CombustionModel&lt;psiReactionThermo&gt;::New(thermo, turbulence())</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><code>reaction</code> 如何使用呢？在 <code>YEqn.H</code> 中</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">reaction-&gt;correct();</span><br><span class="line">Qdot = reaction-&gt;Qdot();</span><br></pre></td></tr></table></figure><p>另外组分方程的源项也通过它调用：<code>reaction-&gt;R(Yi)</code>。</p><p>结合上边的 UML 图，这里的 <code>reaction</code> 的类型实际上是 <code>laminar</code>。<br>函数 <code>correct()</code> 的关键代码是：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>-&gt;chemistryPtr_-&gt;solve(<span class="keyword">this</span>-&gt;mesh().time().deltaTValue());</span><br></pre></td></tr></table></figure><p>其中的 <code>chemistryPtr_</code> 定义于 <code>laminar</code> 的基类 <code>ChemistryCombustion</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">autoPtr&lt;BasicChemistryModel&lt;ReactionThermo&gt;&gt; chemistryPtr_;</span><br></pre></td></tr></table></figure><p><code>ChemistryCombustion</code> 构造函数：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:ChemistryCombustion&lt;ReactionThermo&gt;::ChemistryCombustion</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; modelType,</span><br><span class="line">    ReactionThermo&amp; thermo,</span><br><span class="line">    <span class="keyword">const</span> compressibleTurbulenceModel&amp; turb,</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; combustionProperties</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    CombustionModel&lt;ReactionThermo&gt;</span><br><span class="line">    (</span><br><span class="line">        modelType,</span><br><span class="line">        thermo,</span><br><span class="line">        turb,</span><br><span class="line">        combustionProperties</span><br><span class="line">    ),</span><br><span class="line">    chemistryPtr_(BasicChemistryModel&lt;ReactionThermo&gt;::New(thermo))</span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure><p>即，通过 <code>BasicChemistryModel</code> 调用其派生类 <code>StandardChemistryModel</code> 中的 <code>solve(const scalar deltaT)</code>。但是 <code>BasicChemistryModel</code> 中并没有定义这个 <code>solve</code> 函数，事实上，它是定义在基类 <code>basicChemistryModel</code> 中的纯虚函数。然后在 <code>StandardChemistryModel</code> 中，这个 <code>solve</code> 又调用了同一 <code>class</code> 中的实际干活的另一个 <code>solve(const DeltaTType&amp; deltaT)</code> 函数，在其中，调用了同一 <code>class</code> 的 5 参数的 <code>solve</code> 函数。5 参数的 <code>solve</code> 函数在 <code>EulerImplicit</code> 和 <code>ode</code> 中重新定义。所以这里的 <code>reaction-&gt;correct()</code> 就相当于在这里求解化学反应！</p><p><code>laminar</code> 中的函数 <code>Qdot()</code> 最初的纯虚函数定义于<code>combustionModel</code>，在 <code>laminar</code> 实际定义，返回值是 <code>this-&gt;chemistryPtr_-&gt;Qdot()</code>。因此跳转到了 <code>BasicChemistryModel</code> 类中，和上边的 <code>solve</code> 一样，它也是 <code>basicChemistryModel</code> 的纯虚函数，实际定义于 <code>StandardChemistryModel</code>，返回值是一个 <code>tmp&lt;Foam::volScalarField&gt;</code>，实际计算如下：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">forAll(Y_, i)</span><br><span class="line">&#123;</span><br><span class="line">    forAll(Qdot, celli)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> scalar hi = specieThermo_[i].Hc();</span><br><span class="line">        Qdot[celli] -= hi*RR_[i][celli];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中，<code>Hc()</code> 是该组分的化学焓（英文是 chemical enthalpy，又叫 formation enthalpy），公式是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Δ</mi><msubsup><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow><mn>0</mn></msubsup></mrow><annotation encoding="application/x-tex">\Delta h^0_{f,k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2333239999999999em;vertical-align:-.4192159999999999em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.4168920000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4192159999999999em"><span></span></span></span></span></span></span></span></span></span>，它的计算见 <a href="https://cpp.openfoam.org/v3/a10297_source.html" target="_blank" rel="external nofollow noopener noreferrer">janafThermoI.H</a>。另一篇博文正好给出了<a href="../hEqn/" target="_blank" style="target-new:tab">燃烧反应能量方程</a>，其中显焓输运方程的反应源项，就是这里的 <code>Qdot</code>。</p><p>函数 <code>R(volScalarField&amp; Y)</code> 的返回值是 <code>tmp&lt;Foam::fvScalarMatrix&gt;</code>，我对 <code>matrix</code> 不太熟悉，这个矩阵应该是由此组成：<code>this-&gt;chemistryPtr_-&gt;RR(specieI)</code>。又来到了 BasicChemistryModel 类中，照旧，纯虚函数定义于 <code>basicChemistryModel</code>，实际定义于 <code>StandardChemistryModel</code>（在 StandardChemistryModelI.H 中定义），返回值是 <code>RR_</code>，它的类型是 <code>PtrList&lt;volScalarField::Internal&gt;</code>，代码中的描述是 List of reaction rate per specie [kg/m3/s]。</p><p>总结起来，就是在 solver 中，定义一个燃烧的对象：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">autoPtr&lt;CombustionModel&lt;psiReactionThermo&gt;&gt; reaction</span><br><span class="line">(</span><br><span class="line">    CombustionModel&lt;psiReactionThermo&gt;::New(thermo, turbulence())</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>然后在燃烧模型 <code>ChemistryCombustion</code> 里边，有一个化学模型的指针（Protected data，只能它自己或其派生类能够访问，它的对象不能访问）</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">autoPtr&lt;BasicChemistryModel&lt;ReactionThermo&gt;&gt; chemistryPtr_</span><br></pre></td></tr></table></figure><p>所有关于化学的使用，都是通过它调用。比如求解化学反应方程，就是 <code>reaction-&gt;correct()</code>。而这个 <code>correct</code> 函数的内容是</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">this-&gt;chemistryPtr_-&gt;solve(this-&gt;mesh().time().deltaTValue());</span><br></pre></td></tr></table></figure><p>调用了化学模型里边的 <code>solve</code> 函数。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">template&lt;class ReactionThermo&gt;</span><br><span class="line">Foam::ChemistryCombustion&lt;ReactionThermo&gt;::ChemistryCombustion</span><br><span class="line">(</span><br><span class="line">    const word&amp; modelType,</span><br><span class="line">    ReactionThermo&amp; thermo,</span><br><span class="line">    const compressibleTurbulenceModel&amp; turb,</span><br><span class="line">    const word&amp; combustionProperties</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    CombustionModel&lt;ReactionThermo&gt;</span><br><span class="line">    (</span><br><span class="line">        modelType,</span><br><span class="line">        thermo,</span><br><span class="line">        turb,</span><br><span class="line">        combustionProperties</span><br><span class="line">    ),</span><br><span class="line">    chemistryPtr_(BasicChemistryModel&lt;ReactionThermo&gt;::New(thermo))</span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure><p>燃烧模型的构造函数里边，创建了化学模块的对象，传入了 <code>thermo</code>。</p><p>三个函数完整定义：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:combustionModels::laminar&lt;ReactionThermo&gt;::correct()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;active())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (integrateReactionRate_)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (fv::localEulerDdt::enabled(<span class="keyword">this</span>-&gt;mesh()))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">const</span> scalarField&amp; rDeltaT =</span><br><span class="line">                    fv::localEulerDdt::localRDeltaT(<span class="keyword">this</span>-&gt;mesh());</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;coeffs().found(<span class="string">"maxIntegrationTime"</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                    scalar maxIntegrationTime</span><br><span class="line">                    (</span><br><span class="line">                        readScalar(<span class="keyword">this</span>-&gt;coeffs().lookup(<span class="string">"maxIntegrationTime"</span>))</span><br><span class="line">                    );</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;solve</span><br><span class="line">                    (</span><br><span class="line">                        <span class="built_in">min</span>(<span class="number">1.0</span>/rDeltaT, maxIntegrationTime)()</span><br><span class="line">                    );</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;solve((<span class="number">1.0</span>/rDeltaT)());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;solve(<span class="keyword">this</span>-&gt;mesh().time().deltaTValue());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;calculate();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:tmp&lt;Foam::fvScalarMatrix&gt;</span><br><span class="line">Foam::combustionModels::laminar&lt;ReactionThermo&gt;::R(volScalarField&amp; Y) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">tmp&lt;fvScalarMatrix&gt; <span class="title">tSu</span><span class="params">(<span class="keyword">new</span> fvScalarMatrix(Y, dimMass/dimTime))</span></span>;</span><br><span class="line"></span><br><span class="line">    fvScalarMatrix&amp; Su = tSu.ref();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;active())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> label specieI =</span><br><span class="line">            <span class="keyword">this</span>-&gt;thermo().composition().species()[Y.member()];</span><br><span class="line"></span><br><span class="line">        Su += <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;RR(specieI);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> tSu;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:tmp&lt;Foam::volScalarField&gt;</span><br><span class="line">Foam::combustionModels::laminar&lt;ReactionThermo&gt;::Qdot() <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    tmp&lt;volScalarField&gt; tQdot</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">new</span> volScalarField</span><br><span class="line">        (</span><br><span class="line">            IOobject</span><br><span class="line">            (</span><br><span class="line">                <span class="keyword">this</span>-&gt;thermo().phasePropertyName(typeName + <span class="string">":Qdot"</span>),</span><br><span class="line">                <span class="keyword">this</span>-&gt;mesh().time().timeName(),</span><br><span class="line">                <span class="keyword">this</span>-&gt;mesh(),</span><br><span class="line">                IOobject::NO_READ,</span><br><span class="line">                IOobject::NO_WRITE,</span><br><span class="line">                <span class="literal">false</span></span><br><span class="line">            ),</span><br><span class="line">            <span class="keyword">this</span>-&gt;mesh(),</span><br><span class="line">            dimensionedScalar(<span class="string">"Qdot"</span>, dimEnergy/dimVolume/dimTime, <span class="number">0.0</span>)</span><br><span class="line">        )</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;active())</span><br><span class="line">    &#123;</span><br><span class="line">        tQdot.ref() = <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;Qdot();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> tQdot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="rts"><a class="markdownIt-Anchor" href="#rts"></a> RTS</h2><h3 id="declareruntimeselectiontable"><a class="markdownIt-Anchor" href="#declareruntimeselectiontable"></a> declareRunTimeSelectionTable</h3><p>首先在源代码中全局搜索发现 <code>declareRunTimeSelectionTable</code> 函数在 <code>CombustionModel.H</code> 中被调用。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">declareRunTimeSelectionTable</span><br><span class="line">(</span><br><span class="line">    autoPtr,</span><br><span class="line">    CombustionModel,</span><br><span class="line">    dictionary,</span><br><span class="line">    (</span><br><span class="line">        const word&amp; modelType,</span><br><span class="line">        ReactionThermo&amp; thermo,</span><br><span class="line">        const compressibleTurbulenceModel&amp; turb,</span><br><span class="line">        const word&amp; combustionProperties</span><br><span class="line">    ),</span><br><span class="line">    (modelType, thermo, turb, combustionProperties)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>而这个函数定义于 <code>\src\OpenFOAM\db\runTimeSelection\construction\runTimeSelectionTables.H</code> 中：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#define declareRunTimeSelectionTable(autoPtr,baseType,argNames,argList,parList)\</span><br><span class="line">    typedef autoPtr&lt;baseType&gt; (*argNames##ConstructorPtr)argList;              \</span><br><span class="line">    typedef HashTable&lt;argNames##ConstructorPtr, word, string::hash&gt;            \</span><br><span class="line">        argNames##ConstructorTable;                                            \</span><br><span class="line">    static argNames##ConstructorTable* argNames##ConstructorTablePtr_;         \</span><br><span class="line">    static void construct##argNames##ConstructorTables();                      \</span><br><span class="line">    template&lt;class baseType##Type&gt;                                             \</span><br><span class="line">    class add##argNames##ConstructorToTable                                    \</span><br><span class="line">    &#123;                                                                          \</span><br><span class="line">    public:                                                                    \</span><br><span class="line">        static autoPtr&lt;baseType&gt; New argList                                   \</span><br><span class="line">        &#123;                                                                      \</span><br><span class="line">            return autoPtr&lt;baseType&gt;(new baseType##Type parList);              \</span><br><span class="line">        &#125;                                                                      \</span><br><span class="line">                                                                               \</span><br><span class="line">        add##argNames##ConstructorToTable                                      \</span><br><span class="line">        (                                                                      \</span><br><span class="line">            const word&amp; lookup &#x3D; baseType##Type::typeName                      \</span><br><span class="line">        )                                                                      \</span><br><span class="line">        &#123;                                                                      \</span><br><span class="line">            construct##argNames##ConstructorTables();                          \</span><br><span class="line">            argNames##ConstructorTablePtr_-&gt;insert(lookup, New);               \</span><br><span class="line">        &#125;                                                                      \</span><br><span class="line">    &#125;;                                                                         \</span><br></pre></td></tr></table></figure><ul><li>定义一个函数指针，这样定义的结果是， <code>dictionaryConstructorPtr</code> 代表一个指向参数为 <code>argList</code>，返回类型为 <code>autoPtr&lt; baseType&gt;</code> 的函数指针。</li><li>将一个 key 和 value 分别为 <code>word</code> 和 <code>dictionaryConstructorPtr</code> 的 <code>HashTable</code> 重命名为 <code>argNames##ConstructorTable</code>，即 <code>dictionaryConstructorTable</code>，并创建了一个以它为类型的指针 <code>argNames##ConstructorTablePtr_</code>，即 <strong><code>dictionaryConstructorTablePtr_</code></strong>。</li><li>申明一个类：<code>add##argNames##ConstructorToTable</code>，即 <code>adddictionaryConstructorToTable</code>，它需要模板 <code>baseType##Type</code>，其中的 <code>baseType</code> 是 <code>CombustionModel</code>。</li><li>类中定义了 <code>New</code> 函数，<code>argList</code> 是其形参列表，<code>parList</code> 是返回的 <code>baseType##Type</code> 的构造函数的形参列表。注意，这里调用了<strong>基类的构造函数</strong>！！！</li><li>但是如果我们在派生类中创建这个 add 类的对象的话，它的模板则是派生类，就是说 New 函数的返回值是指向派生类对象基类指针。</li><li>在 <code>add##argNames##ConstructorToTable</code> 的构造函数中，向 <strong><code>dictionaryConstructorTablePtr_</code></strong> 中 <code>insert</code> 了一组 key and value：<br>key 是 <code>typeName</code>，vaule 是 返回 <em>基类 <code>autoPtr</code></em> 的 <code>New</code> 函数。</li></ul><h3 id="definetemplateruntimeselectiontable"><a class="markdownIt-Anchor" href="#definetemplateruntimeselectiontable"></a> defineTemplateRunTimeSelectionTable</h3><p><code>defineTemplateRunTimeSelectionTable</code> 函数被发现调用于 <code>makeCombustionTypes.H</code> 中的 <code>makeCombustion</code> 函数中。<br>而 <code>makeCombustion</code> 函数在 <code>CombustionModels.C</code> 中被调用：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">makeCombustion(psiReactionThermo);</span><br></pre></td></tr></table></figure><p>具体看看这个函数：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#define makeCombustion(Comp)                                                   \</span><br><span class="line">                                                                               \</span><br><span class="line">    typedef CombustionModel&lt;Comp&gt; CombustionModel##Comp;                       \</span><br><span class="line">                                                                               \</span><br><span class="line">    defineTemplateTypeNameAndDebugWithName                                     \</span><br><span class="line">    (                                                                          \</span><br><span class="line">        CombustionModel##Comp,                                                 \</span><br><span class="line">        (                                                                      \</span><br><span class="line">            word(CombustionModel##Comp::typeName_()) + &quot;&lt;&quot; + Comp::typeName    \</span><br><span class="line">          + &quot;&gt;&quot;                                                                \</span><br><span class="line">        ).c_str(),                                                             \</span><br><span class="line">        0                                                                      \</span><br><span class="line">    );                                                                         \</span><br><span class="line">                                                                               \</span><br><span class="line">    defineTemplateRunTimeSelectionTable                                        \</span><br><span class="line">    (                                                                          \</span><br><span class="line">        CombustionModel##Comp,                                                 \</span><br><span class="line">        dictionary                                                             \</span><br><span class="line">    );</span><br></pre></td></tr></table></figure><p>首先 <code>defineTemplateTypeNameAndDebugWithName</code> 函数创建了一个 <code>word</code> 名字是 <code>typeName</code> 值是 <code>Name</code>，即 <code>laminar&lt;psiReactionThermo&gt;</code>。</p><p>其次是调用 <code>defineTemplateRunTimeSelectionTable</code> 函数，它定义于 <code>\src\OpenFOAM\db\runTimeSelection\construction\runTimeSelectionTables.H</code> 中。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#define defineTemplateRunTimeSelectionTable(baseType,argNames)                 \</span><br><span class="line">    defineRunTimeSelectionTablePtr(baseType,argNames);                         \</span><br><span class="line">    defineRunTimeSelectionTableConstructor(baseType,argNames);                 \</span><br><span class="line">    defineRunTimeSelectionTableDestructor(baseType,argNames)</span><br></pre></td></tr></table></figure><p>这里的 <code>baseType</code> 是 <code>CombustionModel##psiReactionThermo</code>，<code>argNames</code> 是 <code>dictionary</code>。<br>包括三个宏函数，第一个函数定义了一个类型为 <code>dictionary##ConstructorTable</code> （即 HashTable 的别名）的名字为 <code>dictionary##ConstructorTablePtr_</code> 的空指针。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#define defineRunTimeSelectionTablePtr(baseType,argNames)                      \</span><br><span class="line">    baseType::argNames##ConstructorTable*                                      \</span><br><span class="line">        baseType::argNames##ConstructorTablePtr_ &#x3D; nullptr</span><br></pre></td></tr></table></figure><p>第二个函数定义了一个函数，名为 <code>constructdictionaryConstructorTables()</code>，作用是创建了一个类型为 <code>dictionaryConstructorTable</code>，名字为 <code>dictionaryConstructorTablePtr_</code> 的对象。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#define defineRunTimeSelectionTableConstructor(baseType,argNames)              \</span><br><span class="line">    void baseType::construct##argNames##ConstructorTables()                    \</span><br><span class="line">    &#123;                                                                          \</span><br><span class="line">            baseType::argNames##ConstructorTablePtr_                           \</span><br><span class="line">                &#x3D; new baseType::argNames##ConstructorTable;                    \</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>第三个函数定义了一个函数（后来在 <code>add##argNames##ConstructorToTable</code> 的析构函数中被调用），名字是 <code>destroydictionaryConstructorTables()</code>。</p><h3 id="创建对象"><a class="markdownIt-Anchor" href="#创建对象"></a> 创建对象</h3><p>我们在创建燃烧模型的对象时（<code>createFields.H</code>）是这样的：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt; &quot;Creating reaction model\n&quot; &lt;&lt; endl;</span><br><span class="line">autoPtr&lt;CombustionModel&lt;psiReactionThermo&gt;&gt; reaction</span><br><span class="line">(</span><br><span class="line">    CombustionModel&lt;psiReactionThermo&gt;::New(thermo, turbulence())</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>调用的是 <code>CombustionModel</code> 中的 <code>New</code>：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;- Selector</span><br><span class="line">static autoPtr&lt;CombustionModel&gt; New</span><br><span class="line">(</span><br><span class="line">    ReactionThermo&amp; thermo,</span><br><span class="line">    const compressibleTurbulenceModel&amp; turb,</span><br><span class="line">    const word&amp; combustionProperties&#x3D;combustionPropertiesName &#x2F;&#x2F;默认值是 combustionPropertiesName</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>定义于它的 C 文件中，返回类型是 <code>autoPtr&lt;CombustionModel&gt;</code>，<code>CombustionModel</code> 需要一个模板，我们给它的是 <code>psiReactionThermo</code>。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">template&lt;class ReactionThermo&gt;</span><br><span class="line">Foam::autoPtr&lt;Foam::CombustionModel&lt;ReactionThermo&gt;&gt;</span><br><span class="line">Foam::CombustionModel&lt;ReactionThermo&gt;::New</span><br><span class="line">(</span><br><span class="line">    ReactionThermo&amp; thermo,</span><br><span class="line">    const compressibleTurbulenceModel&amp; turb,</span><br><span class="line">    const word&amp; combustionProperties</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    return</span><br><span class="line">        combustionModel::New&lt;CombustionModel&lt;ReactionThermo&gt;&gt;</span><br><span class="line">        &#x2F;&#x2F; 这里发现这个 New 调用时需要给它模板，我们给的就是 CombustionModel&lt;psiReactionThermo&gt;</span><br><span class="line">        (</span><br><span class="line">            thermo,</span><br><span class="line">            turb,</span><br><span class="line">            combustionProperties</span><br><span class="line">        );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用了它的基类 combustionModel（但没有在 C 文件中定义）的 New 函数：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; Selectors</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;- Generic New for each of the related chemistry model</span><br><span class="line">    template&lt;class CombustionModel&gt;</span><br><span class="line">    static autoPtr&lt;CombustionModel&gt; New</span><br><span class="line">    (</span><br><span class="line">        typename CombustionModel::reactionThermo&amp; thermo,</span><br><span class="line">        const compressibleTurbulenceModel&amp; turb,</span><br><span class="line">        const word&amp; combustionProperties</span><br><span class="line">    );</span><br></pre></td></tr></table></figure><p>上边这个 New 函数发现是在 <code>combustionModelTemplates.C</code> 中定义的。<br>这里的 <code>CombustionModel</code> 就是 <code>CombustionModel</code>，<code>reactionThermo</code> 是它的模板 <code>ReactionThermo</code>，我们在这里指定它为 <code>psiReactionThermo</code>。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">template&lt;class CombustionModel&gt;</span><br><span class="line">Foam::autoPtr&lt;CombustionModel&gt; Foam::combustionModel::New</span><br><span class="line">(</span><br><span class="line">    typename CombustionModel::reactionThermo&amp; thermo,</span><br><span class="line">    const compressibleTurbulenceModel&amp; turb,</span><br><span class="line">    const word&amp; combustionProperties</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    word combModelName(&quot;none&quot;);</span><br><span class="line">    IOdictionary(combIO).lookup(&quot;combustionModel&quot;) &gt;&gt; combModelName;</span><br><span class="line">    Info&lt;&lt; &quot;Selecting combustion model &quot; &lt;&lt; combModelName &lt;&lt; endl;</span><br><span class="line">    &#x2F;&#x2F; 字典 combustionProperties 里写的那个名字，如 laminar</span><br><span class="line"></span><br><span class="line">    typedef typename CombustionModel::dictionaryConstructorTable cstrTableType;</span><br><span class="line">&#x2F;&#x2F;这是在 declareRunTimeSelectionTable 中的那个 HashTable</span><br><span class="line">    cstrTableType* cstrTable &#x3D; CombustionModel::dictionaryConstructorTablePtr_;</span><br><span class="line">&#x2F;&#x2F;dictionaryConstructorTablePtr_ 在 declareRunTimeSelectionTable 申明过</span><br><span class="line">&#x2F;&#x2F; 并且在 constructdictionaryConstructorTables() 这个函数中分派了实际指向的对象。</span><br><span class="line">&#x2F;&#x2F;这个函数申明于 declareRunTimeSelectionTable，定义于 defineTemplateRunTimeSelectionTable</span><br><span class="line">&#x2F;&#x2F;而这个函数又在 adddictionaryConstructorToTable 的构造函数中被调用</span><br><span class="line">&#x2F;&#x2F;adddictionaryConstructorToTable，即 add##argNames##ConstructorToTable 在 declareRunTimeSelectionTable 中定义</span><br><span class="line"></span><br><span class="line">    const word compCombModelName &#x3D;</span><br><span class="line">        combModelName + &#39;&lt;&#39; + CombustionModel::reactionThermo::typeName + &#39;&gt;&#39;;</span><br><span class="line"></span><br><span class="line">    const word thermoCombModelName &#x3D;</span><br><span class="line">        combModelName + &#39;&lt;&#39; + CombustionModel::reactionThermo::typeName + &#39;,&#39;</span><br><span class="line">      + thermo.thermoName() + &#39;&gt;&#39;;</span><br><span class="line"></span><br><span class="line">    typename cstrTableType::iterator compCstrIter &#x3D;</span><br><span class="line">        cstrTable-&gt;find(compCombModelName);</span><br><span class="line">&#x2F;&#x2F;在哈希表中查询，key 是 laminar&lt;psiReactionThermo&gt; ，返回值是  返回指向基类autoPtr的New函数</span><br><span class="line">    typename cstrTableType::iterator thermoCstrIter &#x3D;</span><br><span class="line">        cstrTable-&gt;find(thermoCombModelName);</span><br><span class="line"></span><br><span class="line">    return autoPtr&lt;CombustionModel&gt;</span><br><span class="line">    (</span><br><span class="line">        thermoCstrIter !&#x3D; cstrTable-&gt;end()</span><br><span class="line">      ? thermoCstrIter()(combModelName, thermo, turb, combustionProperties)</span><br><span class="line">      : compCstrIter()(combModelName, thermo, turb, combustionProperties)</span><br><span class="line">      &#x2F;&#x2F;modeltype 从这里由 combModelName 传入！！！如 laminar</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>里边用到了一个类：<code>CombustionModel::dictionaryConstructorTable</code>，它是在 <code>declareRunTimeSelectionTable</code> 中定义的，就是那个哈希表的别名。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">typedef HashTable&lt;argNames##ConstructorPtr, word, string::hash&gt;</span><br><span class="line">    argNames##ConstructorTable; &#x2F;&#x2F;argNames 是 dictionary</span><br></pre></td></tr></table></figure><p>因为是在 <code>CombustionModel.H</code> 中调用的 <code>declareRunTimeSelectionTable</code>，于是 <code>CombustionModel::dictionaryConstructorTable</code> 就被定义好了。</p><h3 id="laminarsc"><a class="markdownIt-Anchor" href="#laminarsc"></a> laminars.C</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">makeCombustionTypes(laminar, psiReactionThermo);</span><br></pre></td></tr></table></figure><p>而这个函数定义于 makeCombustionTypes.H：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#define makeCombustionTypes(CombModel, Comp)                                   \</span><br><span class="line">                                                                               \</span><br><span class="line">    typedef combustionModels::CombModel&lt;Comp&gt; CombModel##Comp;                 \</span><br><span class="line">                                                                               \</span><br><span class="line">    defineTemplateTypeNameAndDebugWithName                                     \</span><br><span class="line">    (                                                                          \</span><br><span class="line">        CombModel##Comp,                                                       \</span><br><span class="line">        (                                                                      \</span><br><span class="line">            word(CombModel##Comp::typeName_()) + &quot;&lt;&quot; + Comp::typeName + &quot;&gt;&quot;    \</span><br><span class="line">        ).c_str(),                                                             \</span><br><span class="line">        0                                                                      \</span><br><span class="line">    );                                                                         \</span><br><span class="line">                                                                               \</span><br><span class="line">    CombustionModel&lt;Comp&gt;::                                                    \</span><br><span class="line">        add##dictionary##ConstructorToTable&lt;CombModel##Comp&gt;                   \</span><br><span class="line">        add##CombModel##Comp##dictionary##ConstructorTo##CombustionModel##Comp\</span><br><span class="line">##Table_;</span><br><span class="line">&#x2F;&#x2F;这句话的作用和 addToRunTimeSelectionTable 一致，都是创建一个 add 类的对象，创建它的同时，将返回 指向派生类对象的基类指针 的 New 函数插进了 HashTable，即 dictionaryConstructorTable。后续就是在这个里边 find 我们在字典文件中指定的派生类。</span><br></pre></td></tr></table></figure><p>CombModel 是 laminar，Comp 是 psiReactionThermo<br>将 <code>combustionModels::laminar&lt;psiReactionThermo&gt;</code> 重命名为 <code>laminar##psiReactionThermo</code>。<br>在 <code>CombustionModel&lt;psiReactionThermo&gt;</code> 的命名空间下，<br>创建了类型为 <code>adddictionaryConstructorToTable&lt;laminar##psiReactionThermo&gt;</code> 的对象。于是在这里调用了 <code>adddictionaryConstructorToTable</code> 的构造函数！！！倒退至前边所述，这个构造函数中调用了 <code>constructdictionaryConstructorTables()</code>，作用是给 <code>dictionaryConstructorTablePtr_</code> new 一个对象，类型是 <code>dictionaryConstructorTable</code> ，即 <code>HashTable</code>。并且构造函数中还向该<code>dictionaryConstructorTablePtr_</code> insert 了 New 函数：<br>这个函数 <code>new</code> 了一个对象，并将其绑定至基类的指针，该对象的类型是 <code>baseType##Type</code>，即 <code>add</code> 这个类的模板的类型，而我们在这里给它的模板是 laminar##psiReactionThermo。就是说，我们在派生类中创建add这个类的对象时，同时向哈希表中插入了一组key and value，即派生类的typeName和返回指向派生类对象的基类指针的New函数！</p><h3 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h3><p><code>declareRunTimeSelectionTable</code> 创建了一个哈希表的指针 <code>argNames##ConstructorTablePtr_</code>，但是没有给它分配对象。只有当创建第一个 <code>add##argNames##ConstructorToTable&lt;baseType##Type&gt;</code> 对象时，才会 <code>new</code> 一个<code>baseType::argNames##ConstructorTable</code> 对象给它指向。这是这个函数的功能：<code>construct##argNames##ConstructorTables</code>（申明于 <code>declareRunTimeSelectionTable(autoPtr,baseType,argNames,argList,parList)</code>，定义于<code>defineRunTimeSelectionTableConstructor(baseType,argNames)</code>）。<br>此外，创建每个 <code>add##argNames##ConstructorToTable&lt;baseType##Type&gt;</code> 对象时，都会调用它的构造函数，该构造函数数向 <code>argNames##ConstructorTablePtr_</code> 插入一组 key and value：<code>baseType##Type::typeName</code> 和 <code>New</code> 函数。<br>说起这个 <code>New</code> 函数，那就大有来头，它返回基类指针，但是指向的对象类型是 <code>baseType##Type</code>，即<code>add##argNames##ConstructorToTable&lt;baseType##Type&gt;</code> 这个类的模板。<br>我们经常在派生类中创建一个 <code>add</code> 的对象，如：<code>laminars.C</code> 中的 <code>makeCombustionTypes</code> 中的：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CombustionModel&lt;Comp&gt;::add##dictionary##ConstructorToTable&lt;CombModel##Comp&gt;</span><br><span class="line">        add##CombModel##Comp##dictionary##ConstructorTo##CombustionModel##Comp##Table_;</span><br></pre></td></tr></table></figure><p>模板是 <code>laminar##psiReactionThermo</code>，即往哈希表中插入的 <code>New</code> 函数，返回值是基类指针，指向的是 <code>laminar##psiReactionThermo</code> 的对象</p><h1 id="of-8"><a class="markdownIt-Anchor" href="#of-8"></a> OF-8</h1><h2 id="uml-类图-2"><a class="markdownIt-Anchor" href="#uml-类图-2"></a> UML 类图</h2><p>首先给出 UML 图，右键在新标签页中打开链接，可以获得更好的阅读体验。</p><details><summary>OF-8 UML!</summary><img src="http://www.plantuml.com/plantuml/svg/rLhTR-Eu4NzU_nL43Z0SnDuxND_YDC1jFh0fBhUfxJuSYiAW9Ifc8qi-ad9YRFE_bwGeYQH8MLASNBiFMOSSpWn_yy6PSG00Tzz2732S9f3imSL_9c7wd4p02b8SNAtH1bD6zlTfYE8102288QMkpUzYL_nRBi43IHaA60f121daAyNU3q6QK0QYtJsYwo7Oy9_LtlmPis0DWeAjVOe6C8O4S5aCBeJmkmGVfBc7BnNDBetdak0MepWyFxzB6289Z3NwfVCQzsYpGWJSPea4YkfNmacC4mHyl8SQyz6ffWeEGP0ImWLKorneWwWp9QeEukWqNxGfRKXhT3jCMCO1YE4AnI2PRr60KK45_Wf-yb7E49JwEMaDFTi1uz7h48lPR9IJv6hX9isxS76TPvljXO_79U2hGHP3XYncPqGXXSVwCfL87z1Nk4Z1TkHMIZayJUCT6ZbYeECfUQrXuzaw39U01Oq-uphozp1bzg7NWVZfI2vLMlhYI4jRYWjtNAmHsQJWulDd5oKu1oPXbT4Sr1ScxMMx36SU6W8c_rzsYt0taofFc17cewvYAWVsInEmSmQJ49AmdlA_NT_CzvIXZI1k8do4z6kkmyDwpqLHQGStFJT5JhhORr5b1ZUnPOcnTjIo2jxnK6b2UCBliHNnT94Bl9QUBZcvegBQBeEYbHSyCF8hrz_s-Y7utNwnYgj9SkrUeCWRT3crZXJCDUgXIYWBqzj-CF9wRRcGNMqe21PI-A7hwEblDgkeDnc3gnZfAGK4pTjX4BBUJ-z1xMI6x_N85gmBf7JCETlIHhu7kAN1lE-VOkDydWyGso-qhPfXwcQYOKdbVgJI3Ng4hdSa61jFqiByTJis7ntk0xwhgHEw89T9k4N6lTKOWcrKVWoYiSHn2E8PgfQtfA8W1GNX56qKlnkf-g9G_NzCLxlWq08ctI52S8YJHm1NF2zp_K5KHWzEN8_svw_UiEfSqBsbc3jI8LV4-br37TUzFEjRcdKiopgNP5ripmi4fwsjbk7c3qUUD7mlHF81npj4JR2OEr9Qfm_9_TymI5SO9lrOgvNv7naaw1uoWb_uHXG6TS084kuJ0fPMdTTSs9C8a3wPMkM6BcEs3Dd5s9aMSYnZNDBb_b3-IhFLjIhU7QLrNlEK1TttbazYWo7zdOlNc2yknFSMullmvQ04jq5RiO_25vz1zqxaF5LiMJvRXZxtJKuikWkJxhAhHJxMXSGjB8UMBK6INfdBNigRB4RaZbVWEC3CIyMX60m6EM3ySnsaJrgnVwrAxqyJROmLf2YAw3KMHUodIL5nmeobl1Qx404WnLqAzlb7dSueN1VRfPJdCiV7nlA0kwB0p3sm2zBDAgDYsNOvS-FjWxfyZxFT4aGfveWjChBYbaq294Nm5fGlr2PxultSQLr8pLwsYEUKX60ZE8hgRlbUKxAMzyaNcfcOJoeljzQfxu1uWMb68XWWunNUhd6pZ1pDeOApcRQ2UAWmRdw1oucaTuuJxN9jyup96x-HVUVVZpSAibotSlQhkhExfq0MOSC4oA9iclwqoSpUeOmBbJPp71EPAnyo-U5gMn3RQnKrvLLTZEOCRSqJhlNgrEty-Z1HYACeewtuuIJ22MOetjz2oifiFz1g5liAJlEyLlGkWVOOoJL5EgiM0QRraPObXYDnYAj6NKBIuOm7cyCS6hsav6EQNKL2VRFVBBHuRriCLo-hIe2VM1ufs7e5cWPV7OWAmXXkC4-i5MngeHcgl6QnW9giqbICRnXw9ABnL0nc_7FteLYxHh1BVLdxcghdWz3vCPXC9byHPAAXGf0Y8C01_tnw_77p8_tBlshi98gyJGzpJMKGAQDKPdk0yvbpu-RwQk2VOXSsSJuW-H20dfypzV288hOWgnoad5Yr2gPDRfx8PMDfbc8WCMVaLnInqJV-WMSz_XF1JJMRjC2ldPtXntNRmrn1tWWn7DWUV4RpPTKX_YFv3MvGMDoJJcswOheLfy_NA89PpCHGdskYVflga6Ihk938U8AZfboI1KnPu4fMEDfHnwv-M4s8aX2zQ1gg0GnBSR2MPsfxw6MR9YXXseOceMX7SwTOY8wYcFRICRYZ2c9CJwSjKeDM2ISSKtl3AQKYacDdNRbB4A-Rzuc-JwLNwExIqbCcUKE4c1fmvzf-XNJDqxlKrew28WsBVcx5extNl5xWD9H05JbawfjxSzSxI2CyqakKIwmZE1GGDvVbhaDaJGzy3UuwzTZpc4l51e-gYv0Z7f6hhVbqm_JQCropyHN_9Fle6EoZclayNrdqqhsQETQIn1ib76F2F_LDbv-Y7effVOYVCJ4PFqNFuVXZHBs1iVJbvp3eRorpYlWtx_XugBu9Ad-L09M_h4gqL2qJPW4gbcGSIoFp00v-fcx7vlTOzBc7GQEKF61AgQxx_gqlOOp2v4kyEEIyuLFKwufjd2fy8aU0JsfeOKKQnMlWBB9jZ7xECHghu-AxvXLYSDJ89BT_WD_YoANBuh0TO9pm6CPurPlz6TeX8WTnzPAP5u1Zg_VL-wLMxPP-03mjfoqh3I5RrBMZ4r8gU7BwBadsWnBikoJNzmhSFp5etnom7nQixnMeqxAZBZlXl2ss8rLlaDMVTlawwgQZPMzz2-FuMnGP8NlmkA3IXdHr5XS6wRWKKyHzZpJoKvL7h9sx9DBsB4dWLjjZQqp2BsculuaYpElkHDJUmBcgdMhmGkc4hHESQivbioawxT7fTu9OHX83hVFpV0-SsQXfEoTgwsJwwcckqYqYaALaTFe6hopw1PDrU9mqKs_PseHw0LcEVEtsxnxt5XHzmxwQWlv2o1ebEAEr67J5fYy8dLpQH9bIynVDuTMIwTl5wk8O_dvIgllE3kmpsv_fmTF_Lv-rdwe5IP6TRlr-Qr5gtptLsNHmN1XlroutfPGkn_m_-OCUmsU5djtTrQfv7aXNrtmm_-OIt5frrGEnwwh5GH51Pn51WuZNmNy1"></details><p>我猜测：<code>ArrheniusReactionRate</code> 也可以直接作为 <code>ReversibleReaction</code> 的模板，而不通过 <code>FallOffReactionRate</code>。</p><p><code>Reaction</code> 的模板是 <code>gasHThermoPhysics</code>，<code>Reaction</code> 的基类是 <code>Foam::species::thermo</code>，全称是 <code>Foam::species::thermo&lt; Foam::janafThermo&lt;Foam::perfectGas&lt;Foam::specie&gt;&gt;, Foam::sensibleEnthalpy&gt;</code>。</p><p><code>ReversibleReaction</code> 的模板是 <code>Reaction</code>，<code>gasHThermoPhysics</code> 和 <code>FallOffReactionRate</code>。而 <code>FallOffReactionRate</code> 的模板是 <code>ArrheniusReactionRate</code> 和 <code>TroeFallOffFunction</code>。<br><code>ReversibleReaction</code> 的基类是 <code>Reaction&lt;gasHThermoPhysics&gt;</code>。</p><p>疑问：</p><ul><li>机理文件怎么读取的？</li><li><code>Reaction</code> 等相关类的对象在哪里创建的？</li></ul><p>尝试解答：<br>在 <code>StandardChemistryModel</code> 中申明了反应的 list：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> ReactionList&lt;ThermoType&gt; reactions_;</span><br></pre></td></tr></table></figure><p><code>StandardChemistryModel</code> 的构造函数中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">reactions_</span><br><span class="line">(</span><br><span class="line"><span class="keyword">dynamic_cast</span>&lt;<span class="keyword">const</span> multiComponentMixture&lt;ThermoType&gt;&amp;&gt;(<span class="keyword">this</span>-&gt;thermo()).species(),</span><br><span class="line">specieThermo_,</span><br><span class="line"><span class="keyword">this</span>-&gt;mesh(),</span><br><span class="line">*<span class="keyword">this</span></span><br><span class="line">),</span><br></pre></td></tr></table></figure><p>调用的是 ReactionList 的构造函数</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ThermoType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:ReactionList&lt;ThermoType&gt;::ReactionList</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> speciesTable&amp; species,</span><br><span class="line">    <span class="keyword">const</span> PtrList&lt;ThermoType&gt;&amp; speciesThermo,</span><br><span class="line">    <span class="keyword">const</span> objectRegistry&amp; ob,</span><br><span class="line">    <span class="keyword">const</span> dictionary&amp; dict</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Set general temperature limits from the dictionary</span></span><br><span class="line">    Reaction&lt;ThermoType&gt;::TlowDefault =</span><br><span class="line">        dict.lookupOrDefault&lt;scalar&gt;(<span class="string">"Tlow"</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    Reaction&lt;ThermoType&gt;::ThighDefault =</span><br><span class="line">        dict.lookupOrDefault&lt;scalar&gt;(<span class="string">"Thigh"</span>, great);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">const</span> dictionary&amp; <span class="title">reactions</span><span class="params">(dict.subDict(<span class="string">"reactions"</span>))</span></span>;</span><br><span class="line"></span><br><span class="line">    HashPtrTable&lt;ThermoType&gt; thermoDatabase;</span><br><span class="line">    forAll(speciesThermo, i)</span><br><span class="line">    &#123;</span><br><span class="line">        thermoDatabase.insert</span><br><span class="line">        (</span><br><span class="line">            speciesThermo[i].name(),</span><br><span class="line">            speciesThermo[i].clone().ptr()</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>-&gt;setSize(reactions.<span class="built_in">size</span>());</span><br><span class="line">    label i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    forAllConstIter(dictionary, reactions, iter)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;<span class="built_in">set</span></span><br><span class="line">        (</span><br><span class="line">            i++,</span><br><span class="line">            Reaction&lt;ThermoType&gt;::New</span><br><span class="line">            (</span><br><span class="line">                species,</span><br><span class="line">                thermoDatabase,</span><br><span class="line">                ob,</span><br><span class="line">                reactions.subDict(iter().keyword())</span><br><span class="line">            ).ptr()</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>this-&gt;thermo()</code> 返回的是 <code>BasicChemistryModel</code> 中申明的 <code>ReactionThermo&amp; thermo_</code>，这里模板 <code>ReactionThermo</code> 的实例是 <code>psiReactionThermo</code>。<br><code>thermo_</code> 由构造函数中的 <code>thermo</code> 传入。</p><p>有这个疑问是因为 solver 中创建 <code>thermo</code> 的时候用的是 <code>psiReactionThermo</code>，但是后来实际上的对象是 <code>hePsiThermo</code> 类型的。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">autoPtr&lt;psiReactionThermo&gt; <span class="title">pThermo</span><span class="params">(psiReactionThermo::New(mesh))</span></span>;</span><br><span class="line">psiReactionThermo&amp; thermo = pThermo();</span><br></pre></td></tr></table></figure><p>在代码还没运行的时候，我们不知道 thermo 是 <code>hePsiThermo</code> 类型，那代码中为什么可以这样转换类型呢？</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">dynamic_cast</span>&lt;<span class="keyword">const</span> multiComponentMixture&lt;ThermoType&gt;&amp;&gt;(<span class="keyword">this</span>-&gt;thermo())</span><br></pre></td></tr></table></figure><p>StandardChemistryModel::calculateRR 中使用了 Reaction 中的函数 omega</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Reaction&lt;ThermoType&gt;&amp; R = reactions_[ri];</span><br><span class="line"><span class="keyword">const</span> scalar omegai = R.omega(pi, Ti, c_, pf, cf, lRef, pr, cr, rRef);</span><br></pre></td></tr></table></figure><p>在 dev 版本的 reactingFoam 中，创建了哪些和燃烧化学相关的对象呢？</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">autoPtr&lt;psiReactionThermo&gt; pThermo(psiReactionThermo::New(mesh));</span><br><span class="line">psiReactionThermo&amp; thermo &#x3D; pThermo();</span><br><span class="line">basicSpecieMixture&amp; composition &#x3D; thermo.composition();</span><br><span class="line">PtrList&lt;volScalarField&gt;&amp; Y &#x3D; composition.Y();</span><br><span class="line">autoPtr&lt;CombustionModel&lt;psiReactionThermo&gt;&gt; reaction</span><br><span class="line">(</span><br><span class="line">    CombustionModel&lt;psiReactionThermo&gt;::New(thermo, turbulence())</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><code>reaction</code> 如何使用呢？在 <code>YEqn.H</code> 中</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">reaction-&gt;correct();</span><br><span class="line">Qdot = reaction-&gt;Qdot();</span><br></pre></td></tr></table></figure><p>另外组分方程的源项也通过它调用：<code>reaction-&gt;R(Yi)</code>。</p><p>结合上边的 UML 图，这里的 <code>reaction</code> 的类型实际上是 <code>laminar</code>。<br>函数 <code>correct()</code> 的关键代码是：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>-&gt;chemistryPtr_-&gt;solve(<span class="keyword">this</span>-&gt;mesh().time().deltaTValue());</span><br></pre></td></tr></table></figure><p>其中的 <code>chemistryPtr_</code> 定义于 <code>laminar</code> 的基类 <code>ChemistryCombustion</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">autoPtr&lt;BasicChemistryModel&lt;ReactionThermo&gt;&gt; chemistryPtr_;</span><br></pre></td></tr></table></figure><p>BasicChemistryModel 中没有solve函数，为什么可以这样用呢：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>-&gt;chemistryPtr_-&gt;solve(<span class="keyword">this</span>-&gt;mesh().time().deltaTValue());</span><br></pre></td></tr></table></figure><p>原因在此：<br><code>ChemistryCombustion</code> 的构造函数中，初始化了 <code>chemistryPtr_(BasicChemistryModel&lt;ReactionThermo&gt;::New(thermo))</code>。<br>而这个 New 函数返回的又是 <code>basicChemistryModel::New</code>，这个 <code>basicChemistryModel::New</code> 函数才是真正的用于 RTS 的 Selector。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:autoPtr&lt;Foam::BasicChemistryModel&lt;ReactionThermo&gt;&gt;</span><br><span class="line">Foam::BasicChemistryModel&lt;ReactionThermo&gt;::New(ReactionThermo&amp; thermo)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> basicChemistryModel::New&lt;BasicChemistryModel&lt;ReactionThermo&gt;&gt;</span><br><span class="line">    (</span><br><span class="line">        thermo</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>也就是说，<code>chemistryPtr_</code> 实际上是指向最底层的 <code>basicChemistryModel</code> 的指针，而 <code>basicChemistryModel</code> 中定义了 <code>solve</code> 等纯虚函数，这样就能解释的通了。</p><p><code>basicChemistryModel::New</code></p><p>template<class chemistrymodel=""><br>Foam::autoPtr<chemistrymodel>Foam::basicChemistryModel::New<br>(<br>typename ChemistryModel::reactionThermo&amp; thermo<br>)<br>{<br>IOdictionary chemistryDict<br>(<br>IOobject<br>(<br>thermo.phasePropertyName(“chemistryProperties”),<br>thermo.db().time().constant(),<br>thermo.db(),<br>IOobject::MUST_READ,<br>IOobject::NO_WRITE,<br>false<br>)<br>);</chemistrymodel></class></p><pre><code>if (!chemistryDict.isDict(&quot;chemistryType&quot;)){    FatalErrorInFunction        &lt;&lt; &quot;Template parameter based chemistry solver selection is no &quot;        &lt;&lt; &quot;longer supported. Please create a chemistryType dictionary&quot;        &lt;&lt; &quot;instead.&quot; &lt;&lt; endl &lt;&lt; endl &lt;&lt; &quot;For example, the entry:&quot; &lt;&lt; endl        &lt;&lt; &quot;    chemistrySolver ode&lt;StandardChemistryModel&lt;&quot;        &lt;&lt; &quot;rhoChemistryModel,sutherlandspecie&lt;janaf&lt;perfectGas&gt;,&quot;        &lt;&lt; &quot;sensibleInternalEnergy&gt;&gt;&quot; &lt;&lt; endl &lt;&lt; endl &lt;&lt; &quot;becomes:&quot; &lt;&lt; endl        &lt;&lt; &quot;    chemistryType&quot; &lt;&lt; endl &lt;&lt; &quot;    {&quot; &lt;&lt; endl        &lt;&lt; &quot;        solver ode;&quot; &lt;&lt; endl &lt;&lt; &quot;        method standard;&quot;        &lt;&lt; endl &lt;&lt; &quot;    }&quot; &lt;&lt; exit(FatalError);}const dictionary&amp; chemistryTypeDict =    chemistryDict.subDict(&quot;chemistryType&quot;);const word&amp; solverName(    chemistryTypeDict.found(&quot;solver&quot;)  ? chemistryTypeDict.lookup(&quot;solver&quot;)  : chemistryTypeDict.found(&quot;chemistrySolver&quot;)  ? chemistryTypeDict.lookup(&quot;chemistrySolver&quot;)  : chemistryTypeDict.lookup(&quot;solver&quot;) // error if neither entry is found);const word&amp; methodName(    chemistryTypeDict.lookupOrDefault&lt;word&gt;    (        &quot;method&quot;,        chemistryTypeDict.lookupOrDefault&lt;bool&gt;(&quot;TDAC&quot;, false)      ? &quot;TDAC&quot;      : &quot;standard&quot;    ));dictionary chemistryTypeDictNew;chemistryTypeDictNew.add(&quot;solver&quot;, solverName);chemistryTypeDictNew.add(&quot;method&quot;, methodName);Info&lt;&lt; &quot;Selecting chemistry solver &quot; &lt;&lt; chemistryTypeDictNew &lt;&lt; endl;typedef typename ChemistryModel::thermoConstructorTable cstrTableType;cstrTableType* cstrTable = ChemistryModel::thermoConstructorTablePtr_;const word chemSolverCompThermoName =    solverName + '&lt;' + methodName + '&lt;'  + ChemistryModel::reactionThermo::typeName + ','  + thermo.thermoName() + &quot;&gt;&gt;&quot;;typename cstrTableType::iterator cstrIter =    cstrTable-&gt;find(chemSolverCompThermoName);if (cstrIter == cstrTable-&gt;end()){    FatalErrorInFunction        &lt;&lt; &quot;Unknown &quot; &lt;&lt; typeName_() &lt;&lt; &quot; type &quot; &lt;&lt; solverName &lt;&lt; endl        &lt;&lt; endl;    const wordList names(cstrTable-&gt;toc());    wordList thisCmpts;    thisCmpts.append(word::null);    thisCmpts.append(word::null);    thisCmpts.append(ChemistryModel::reactionThermo::typeName);    thisCmpts.append(basicThermo::splitThermoName(thermo.thermoName(), 5));    List&lt;wordList&gt; validNames;    validNames.append(wordList(2, word::null));    validNames[0][0] = &quot;solver&quot;;    validNames[0][1] = &quot;method&quot;;    forAll(names, i)    {        const wordList cmpts(basicThermo::splitThermoName(names[i], 8));        bool isValid = true;        for (label i = 2; i &lt; cmpts.size() &amp;&amp; isValid; ++ i)        {            isValid = isValid &amp;&amp; cmpts[i] == thisCmpts[i];        }        if (isValid)        {            validNames.append(SubList&lt;word&gt;(cmpts, 2));        }    }    FatalErrorInFunction        &lt;&lt; &quot;All &quot; &lt;&lt; validNames[0][0] &lt;&lt; '/' &lt;&lt; validNames[0][1]        &lt;&lt; &quot; combinations for this thermodynamic model are:&quot;        &lt;&lt; endl &lt;&lt; endl;    printTable(validNames, FatalErrorInFunction);    FatalErrorInFunction &lt;&lt; endl;    List&lt;wordList&gt; validCmpts;    validCmpts.append(wordList(8, word::null));    validCmpts[0][0] = &quot;solver&quot;;    validCmpts[0][1] = &quot;method&quot;;    validCmpts[0][2] = &quot;reactionThermo&quot;;    validCmpts[0][3] = &quot;transport&quot;;    validCmpts[0][4] = &quot;thermo&quot;;    validCmpts[0][5] = &quot;equationOfState&quot;;    validCmpts[0][6] = &quot;specie&quot;;    validCmpts[0][7] = &quot;energy&quot;;    forAll(names, i)    {        validCmpts.append(basicThermo::splitThermoName(names[i], 8));    }    FatalErrorInFunction        &lt;&lt; &quot;All &quot; &lt;&lt; validCmpts[0][0] &lt;&lt; '/' &lt;&lt; validCmpts[0][1] &lt;&lt; '/'        &lt;&lt; validCmpts[0][2] &lt;&lt; &quot;/thermoPhysics combinations are:&quot;        &lt;&lt; endl &lt;&lt; endl;    printTable(validCmpts, FatalErrorInFunction);    FatalErrorInFunction &lt;&lt; exit(FatalError);}return autoPtr&lt;ChemistryModel&gt;(cstrIter()(thermo));</code></pre><p>}</p><p>因此，实际调用的是派生类 <code>StandardChemistryModel::solve(const scalarField&amp; deltaT)</code>。它返回的是实际干活的 solve 函数。</p><p>实际干活的 solve 函数：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>, <span class="title">class</span> <span class="title">ThermoType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">template</span>&lt;class DeltaTType&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:scalar Foam::StandardChemistryModel&lt;ReactionThermo, ThermoType&gt;::solve</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> DeltaTType&amp; deltaT</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    BasicChemistryModel&lt;ReactionThermo&gt;::correct();</span><br><span class="line"></span><br><span class="line">    scalar deltaTMin = great;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>-&gt;chemistry_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> deltaTMin;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">tmp&lt;volScalarField&gt; <span class="title">trho</span><span class="params">(<span class="keyword">this</span>-&gt;thermo().rho())</span></span>;</span><br><span class="line">    <span class="keyword">const</span> scalarField&amp; rho = trho();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalarField&amp; T = <span class="keyword">this</span>-&gt;thermo().T();</span><br><span class="line">    <span class="keyword">const</span> scalarField&amp; p = <span class="keyword">this</span>-&gt;thermo().p();</span><br><span class="line"></span><br><span class="line">    <span class="function">scalarField <span class="title">c0</span><span class="params">(nSpecie_)</span></span>;</span><br><span class="line"></span><br><span class="line">    forAll(rho, celli)</span><br><span class="line">    &#123;</span><br><span class="line">        scalar Ti = T[celli];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (Ti &gt; Treact_)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">const</span> scalar rhoi = rho[celli];</span><br><span class="line">            scalar pi = p[celli];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (label i=<span class="number">0</span>; i&lt;nSpecie_; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                c_[i] = rhoi*Y_[i][celli]/specieThermo_[i].W();</span><br><span class="line">                c0[i] = c_[i];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Initialise time progress</span></span><br><span class="line">            scalar timeLeft = deltaT[celli];</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Calculate the chemical source terms</span></span><br><span class="line">            <span class="keyword">while</span> (timeLeft &gt; small)</span><br><span class="line">            <span class="comment">//这里应该体现了 time split 算法，不对啊，这里只循环了一次啊。因为dt进入solve之后并没有修改！</span></span><br><span class="line">            <span class="comment">//这样的话，运行一次之后，timeLeft就等于0了！</span></span><br><span class="line">            <span class="comment">//上述表述适用于ode求解器，但是选用EulerImplicit的话，确实是在这里time split</span></span><br><span class="line">            <span class="comment">//因为EulerImplicit中会更新dt，这样的话，这个while循环就会不止执行一次</span></span><br><span class="line">            <span class="comment">//ode的time split体现在别处</span></span><br><span class="line">            &#123;</span><br><span class="line">                scalar dt = timeLeft;</span><br><span class="line">                <span class="keyword">this</span>-&gt;solve(pi, Ti, c_, celli, dt, <span class="keyword">this</span>-&gt;deltaTChem_[celli]);</span><br><span class="line">                timeLeft -= dt;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            deltaTMin = <span class="built_in">min</span>(<span class="keyword">this</span>-&gt;deltaTChem_[celli], deltaTMin);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">this</span>-&gt;deltaTChem_[celli] =</span><br><span class="line">                <span class="built_in">min</span>(<span class="keyword">this</span>-&gt;deltaTChem_[celli], <span class="keyword">this</span>-&gt;deltaTChemMax_);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (label i=<span class="number">0</span>; i&lt;nSpecie_; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                RR_[i][celli] =</span><br><span class="line">                    (c_[i] - c0[i])*specieThermo_[i].W()/deltaT[celli];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (label i=<span class="number">0</span>; i&lt;nSpecie_; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                RR_[i][celli] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> deltaTMin;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在其中，调用了 6 参数的 <code>solve</code> 函数。6 参数的 <code>solve</code> 函数在继承自 <code>StandardChemistryModel</code> 的 <code>chemistrySolver</code> 中被申明为纯虚函数，实际上在 <code>EulerImplicit</code> 和 <code>ode</code> 中重新定义。所以这里的 <code>reaction-&gt;correct()</code> 就相当于在这里求解化学反应！</p><p>但是化学反应怎么求解的，本文还没有涉及到。<br>下面以 <code>ode</code> 为例分析一下：<br><code>ode::solve</code> 传进来的数据有 压力、温度、摩尔浓度、celli、dt、deltaTChem_。</p><p><code>ode::solve</code></p><p>在这个函数中，只有一个 const 参数，其余的传进来的数，都被该函数修改了！不对啊，<code>deltaT</code> 没有被修改啊！<code>deltaT</code> 传进了 5 参数的 <code>ODESolver::solve</code> 的第二个参数，但这个参数是 <code>const</code> 啊。<br><code>subDeltaT</code> 被修改了。<br>p T c 肯定是被修改了的。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ChemistryModel</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:ode&lt;ChemistryModel&gt;::solve</span><br><span class="line">(</span><br><span class="line">    scalar&amp; p,</span><br><span class="line">    scalar&amp; T,</span><br><span class="line">    scalarField&amp; c,</span><br><span class="line">    <span class="keyword">const</span> label li,</span><br><span class="line">    scalar&amp; deltaT,</span><br><span class="line">    scalar&amp; subDeltaT</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Reset the size of the ODE system to the simplified size when mechanism</span></span><br><span class="line">    <span class="comment">// reduction is active</span></span><br><span class="line">    <span class="keyword">if</span> (odeSolver_-&gt;resize())</span><br><span class="line">    &#123;</span><br><span class="line">        odeSolver_-&gt;resizeField(cTp_);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> label nSpecie = <span class="keyword">this</span>-&gt;nSpecie();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Copy the concentration, T and P to the total solve-vector</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;nSpecie; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cTp_[i] = c[i];</span><br><span class="line">    &#125;</span><br><span class="line">    cTp_[nSpecie] = T;</span><br><span class="line">    cTp_[nSpecie+<span class="number">1</span>] = p;</span><br><span class="line"></span><br><span class="line">    odeSolver_-&gt;solve(<span class="number">0</span>, deltaT, cTp_, li, subDeltaT);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;nSpecie; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        c[i] = <span class="built_in">max</span>(<span class="number">0.0</span>, cTp_[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    T = cTp_[nSpecie];</span><br><span class="line">    p = cTp_[nSpecie+<span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ode::solve</code> 中又调用了 <code>ODESolver::solve</code></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ode 的 time split 体现在这里！！！</span><br><span class="line"></span><br><span class="line">void Foam::ODESolver::solve</span><br><span class="line">(</span><br><span class="line">    const scalar xStart,</span><br><span class="line">    const scalar xEnd,</span><br><span class="line">    scalarField&amp; y,</span><br><span class="line">    const label li,</span><br><span class="line">    scalar&amp; dxTry</span><br><span class="line">) const</span><br><span class="line">&#123;</span><br><span class="line">    stepState step(dxTry);</span><br><span class="line">    scalar x &#x3D; xStart;</span><br><span class="line"></span><br><span class="line">    for (label nStep&#x3D;0; nStep&lt;maxSteps_; nStep++)</span><br><span class="line">    &#x2F;&#x2F; 这里是最大循环次数，但是中间可能退出循环</span><br><span class="line">    &#x2F;&#x2F; maxSteps_(dict.lookupOrDefault&lt;scalar&gt;(&quot;maxSteps&quot;, 10000))</span><br><span class="line">    &#x2F;&#x2F; 设置于chemistryProperties&#x2F;odeCoeffs中，与relTol相同的位置</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F; Store previous iteration dxTry</span><br><span class="line">        scalar dxTry0 &#x3D; step.dxTry;</span><br><span class="line"></span><br><span class="line">        step.reject &#x3D; false;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; Check if this is a truncated step and set dxTry to integrate to xEnd</span><br><span class="line">        if ((x + step.dxTry - xEnd)*(x + step.dxTry - xStart) &gt; 0)</span><br><span class="line">        &#123;</span><br><span class="line">            step.last &#x3D; true;</span><br><span class="line">            step.dxTry &#x3D; xEnd - x;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; Integrate as far as possible up to step.dxTry</span><br><span class="line">        solve(x, y, li, step);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; Check if reached xEnd</span><br><span class="line">        if ((x - xEnd)*(xEnd - xStart) &gt;&#x3D; 0)</span><br><span class="line">        &#123;</span><br><span class="line">            if (nStep &gt; 0 &amp;&amp; step.last)</span><br><span class="line">            &#123;</span><br><span class="line">                step.dxTry &#x3D; dxTry0;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            dxTry &#x3D; step.dxTry;</span><br><span class="line"></span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        step.first &#x3D; false;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; If the step.dxTry was reject set step.prevReject</span><br><span class="line">        if (step.reject)</span><br><span class="line">        &#123;</span><br><span class="line">            step.prevReject &#x3D; true;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    FatalErrorInFunction</span><br><span class="line">        &lt;&lt; &quot;Integration steps greater than maximum &quot; &lt;&lt; maxSteps_ &lt;&lt; nl</span><br><span class="line">        &lt;&lt; &quot;    xStart &#x3D; &quot; &lt;&lt; xStart &lt;&lt; &quot;, xEnd &#x3D; &quot; &lt;&lt; xEnd</span><br><span class="line">        &lt;&lt; &quot;, x &#x3D; &quot; &lt;&lt; x &lt;&lt; &quot;, dxDid &#x3D; &quot; &lt;&lt; step.dxDid &lt;&lt; nl</span><br><span class="line">        &lt;&lt; &quot;    y &#x3D; &quot; &lt;&lt; y</span><br><span class="line">        &lt;&lt; exit(FatalError);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中又调用了 <code>solve(scalar&amp; x,scalarField&amp; y,const label li,stepState&amp; step)</code>，这个函数在 <code>ODESolver</code>和它的派生类 <code>seulex</code> 中都定义了，那么这里应该是调用的是派生类的。不信的话，用 debug 模式验证一下。我验证过了，确实调用的 <code>seulex::solve</code>。</p><p><code>seulex::solve</code></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> Foam::seulex::solve</span><br><span class="line">(</span><br><span class="line">    scalar&amp; x,</span><br><span class="line">    scalarField&amp; y,</span><br><span class="line">    <span class="keyword">const</span> label li,</span><br><span class="line">    stepState&amp; <span class="built_in">step</span></span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    temp_[<span class="number">0</span>] = great;</span><br><span class="line">    scalar dx = <span class="built_in">step</span>.dxTry;</span><br><span class="line">    y0_ = y;</span><br><span class="line">    dxOpt_[<span class="number">0</span>] = mag(<span class="number">0.1</span>*dx);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">step</span>.first || <span class="built_in">step</span>.prevReject)</span><br><span class="line">    &#123;</span><br><span class="line">        theta_ = <span class="number">2</span>*jacRedo_;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">step</span>.first)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">NOTE:</span> the first element of relTol_ and absTol_ are used here.</span></span><br><span class="line">        scalar logTol = -<span class="built_in">log10</span>(relTol_[<span class="number">0</span>] + absTol_[<span class="number">0</span>])*<span class="number">0.6</span> + <span class="number">0.5</span>;</span><br><span class="line">        kTarg_ = <span class="built_in">max</span>(<span class="number">1</span>, <span class="built_in">min</span>(kMaxx_ - <span class="number">1</span>, <span class="keyword">int</span>(logTol)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    forAll(scale_, i)</span><br><span class="line">    &#123;</span><br><span class="line">        scale_[i] = absTol_[i] + relTol_[i]*mag(y[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> jacUpdated = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (theta_ &gt; jacRedo_)</span><br><span class="line">    &#123;</span><br><span class="line">        odes_.jacobian(x, y, li, dfdx_, dfdy_);</span><br><span class="line">        jacUpdated = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> k;</span><br><span class="line">    scalar dxNew = mag(dx);</span><br><span class="line">    <span class="keyword">bool</span> firstk = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (firstk || <span class="built_in">step</span>.reject)</span><br><span class="line">    &#123;</span><br><span class="line">        dx = <span class="built_in">step</span>.forward ? dxNew : -dxNew;</span><br><span class="line">        firstk = <span class="literal">false</span>;</span><br><span class="line">        <span class="built_in">step</span>.reject = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (mag(dx) &lt;= mag(x)*sqr(small))</span><br><span class="line">        &#123;</span><br><span class="line">             WarningInFunction</span><br><span class="line">                 &lt;&lt; <span class="string">"step size underflow :"</span>  &lt;&lt; dx &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        scalar errOld = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (k=<span class="number">0</span>; k&lt;=kTarg_+<span class="number">1</span>; k++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">bool</span> success = seul(x, y0_, li, dx, k, ySequence_, scale_);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!success)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">step</span>.reject = <span class="literal">true</span>;</span><br><span class="line">                dxNew = mag(dx)*stepFactor5_;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (k == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                 y = ySequence_;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                forAll(ySequence_, i)</span><br><span class="line">                &#123;</span><br><span class="line">                    table_[k<span class="number">-1</span>][i] = ySequence_[i];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (k != <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                extrapolate(k, table_, y);</span><br><span class="line">                scalar err = <span class="number">0</span>;</span><br><span class="line">                forAll(scale_, i)</span><br><span class="line">                &#123;</span><br><span class="line">                    scale_[i] = absTol_[i] + relTol_[i]*mag(y0_[i]);</span><br><span class="line">                    err += sqr((y[i] - table_(<span class="number">0</span>, i))/scale_[i]);</span><br><span class="line">                &#125;</span><br><span class="line">                err = <span class="built_in">sqrt</span>(err/n_);</span><br><span class="line">                <span class="keyword">if</span> (err &gt; <span class="number">1</span>/small || (k &gt; <span class="number">1</span> &amp;&amp; err &gt;= errOld))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">step</span>.reject = <span class="literal">true</span>;</span><br><span class="line">                    dxNew = mag(dx)*stepFactor5_;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                errOld = <span class="built_in">min</span>(<span class="number">4</span>*err, <span class="number">1</span>);</span><br><span class="line">                scalar expo = <span class="number">1.0</span>/(k + <span class="number">1</span>);</span><br><span class="line">                scalar facmin = <span class="built_in">pow</span>(stepFactor3_, expo);</span><br><span class="line">                scalar fac;</span><br><span class="line">                <span class="keyword">if</span> (err == <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    fac = <span class="number">1</span>/facmin;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    fac = stepFactor2_/<span class="built_in">pow</span>(err/stepFactor1_, expo);</span><br><span class="line">                    fac = <span class="built_in">max</span>(facmin/stepFactor4_, <span class="built_in">min</span>(<span class="number">1</span>/facmin, fac));</span><br><span class="line">                &#125;</span><br><span class="line">                dxOpt_[k] = mag(dx*fac);</span><br><span class="line">                temp_[k] = cpu_[k]/dxOpt_[k];</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> ((<span class="built_in">step</span>.first || <span class="built_in">step</span>.last) &amp;&amp; err &lt;= <span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span></span><br><span class="line">                (</span><br><span class="line">                    k == kTarg_ - <span class="number">1</span></span><br><span class="line">                 &amp;&amp; !<span class="built_in">step</span>.prevReject</span><br><span class="line">                 &amp;&amp; !<span class="built_in">step</span>.first &amp;&amp; !<span class="built_in">step</span>.last</span><br><span class="line">                )</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (err &lt;= <span class="number">1</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (err &gt; nSeq_[kTarg_]*nSeq_[kTarg_ + <span class="number">1</span>]*<span class="number">4</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="built_in">step</span>.reject = <span class="literal">true</span>;</span><br><span class="line">                        kTarg_ = k;</span><br><span class="line">                        <span class="keyword">if</span> (kTarg_&gt;<span class="number">1</span> &amp;&amp; temp_[k<span class="number">-1</span>] &lt; kFactor1_*temp_[k])</span><br><span class="line">                        &#123;</span><br><span class="line">                            kTarg_--;</span><br><span class="line">                        &#125;</span><br><span class="line">                        dxNew = dxOpt_[kTarg_];</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (k == kTarg_)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (err &lt;= <span class="number">1</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (err &gt; nSeq_[k + <span class="number">1</span>]*<span class="number">2</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="built_in">step</span>.reject = <span class="literal">true</span>;</span><br><span class="line">                        <span class="keyword">if</span> (kTarg_&gt;<span class="number">1</span> &amp;&amp; temp_[k<span class="number">-1</span>] &lt; kFactor1_*temp_[k])</span><br><span class="line">                        &#123;</span><br><span class="line">                            kTarg_--;</span><br><span class="line">                        &#125;</span><br><span class="line">                        dxNew = dxOpt_[kTarg_];</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (k == kTarg_+<span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (err &gt; <span class="number">1</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="built_in">step</span>.reject = <span class="literal">true</span>;</span><br><span class="line">                        <span class="keyword">if</span></span><br><span class="line">                        (</span><br><span class="line">                            kTarg_ &gt; <span class="number">1</span></span><br><span class="line">                         &amp;&amp; temp_[kTarg_<span class="number">-1</span>] &lt; kFactor1_*temp_[kTarg_]</span><br><span class="line">                        )</span><br><span class="line">                        &#123;</span><br><span class="line">                            kTarg_--;</span><br><span class="line">                        &#125;</span><br><span class="line">                        dxNew = dxOpt_[kTarg_];</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">step</span>.reject)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">step</span>.prevReject = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (!jacUpdated)</span><br><span class="line">            &#123;</span><br><span class="line">                theta_ = <span class="number">2</span>*jacRedo_;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (theta_ &gt; jacRedo_ &amp;&amp; !jacUpdated)</span><br><span class="line">                &#123;</span><br><span class="line">                    odes_.jacobian(x, y, li, dfdx_, dfdy_);</span><br><span class="line">                    jacUpdated = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    jacUpdated = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">step</span>.dxDid = dx;</span><br><span class="line">    x += dx;</span><br><span class="line"></span><br><span class="line">    label kopt;</span><br><span class="line">    <span class="keyword">if</span> (k == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        kopt = <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (k &lt;= kTarg_)</span><br><span class="line">    &#123;</span><br><span class="line">        kopt=k;</span><br><span class="line">        <span class="keyword">if</span> (temp_[k<span class="number">-1</span>] &lt; kFactor1_*temp_[k])</span><br><span class="line">        &#123;</span><br><span class="line">            kopt = k - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (temp_[k] &lt; kFactor2_*temp_[k - <span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            kopt = <span class="built_in">min</span>(k + <span class="number">1</span>, kMaxx_ - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        kopt = k - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (k &gt; <span class="number">2</span> &amp;&amp; temp_[k<span class="number">-2</span>] &lt; kFactor1_*temp_[k - <span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            kopt = k - <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (temp_[k] &lt; kFactor2_*temp_[kopt])</span><br><span class="line">        &#123;</span><br><span class="line">            kopt = <span class="built_in">min</span>(k, kMaxx_ - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">step</span>.prevReject)</span><br><span class="line">    &#123;</span><br><span class="line">        kTarg_ = <span class="built_in">min</span>(kopt, k);</span><br><span class="line">        dxNew = <span class="built_in">min</span>(mag(dx), dxOpt_[kTarg_]);</span><br><span class="line">        <span class="built_in">step</span>.prevReject = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (kopt &lt;= k)</span><br><span class="line">        &#123;</span><br><span class="line">            dxNew = dxOpt_[kopt];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (k &lt; kTarg_ &amp;&amp; temp_[k] &lt; kFactor2_*temp_[k - <span class="number">1</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                dxNew = dxOpt_[k]*cpu_[kopt + <span class="number">1</span>]/cpu_[k];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                dxNew = dxOpt_[k]*cpu_[kopt]/cpu_[k];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        kTarg_ = kopt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">step</span>.dxTry = <span class="built_in">step</span>.forward ? dxNew : -dxNew;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中调用了 <code>ODESystem::jacobian(x, y, li, dfdx_, dfdy_)</code> 和 <code>seulex::seul</code>，还调用了 <code>seulex::extrapolate</code>。</p><p><code>seulex::seul</code> 中调用了 <code>ODESystem::derivatives(xnew, y0, li, dy_)</code>。</p><p>但是 <code>ODESystem</code> 中只定义了三个纯虚函数 <code>nEqns</code>， <code>derivatives</code>， <code>jacobian</code>。<code>nEqns</code> 定义于 <code>ODESolver</code>，因为在 <code>ODESolver</code> 中，申明了 <code>friend class ODESystem;</code>。另外两个函数都定义在 <code>StandardChemistryModel</code> 中，因为 <code>ODESystem</code> 是 <code>StandardChemistryModel</code> 的基类之一。</p><p><code>celli</code> 传给了 <code>li</code> 这个参数，最终哪里用到了？<br>可能出现在<br>ODE/ 排除<br>thermophysicalModels/ 没找到。。。</p><p><a href="https://github.com/OpenFOAM/OpenFOAM-8/commit/2d0f459ea5a33eafa6fe423d5ff6395c20a38635" target="_blank" rel="external nofollow noopener noreferrer">官方说明</a><br>chemistryModel, reactions, ODESolver: Added “li” argument to all functions which evaluate the reaction rate</p><p>In chemistryModel “li” is set to the current cell index but for other reacting<br>systems it should be set to the current index of the element for which the<br>reaction system is being evaluated.</p><p>In the ODESolver “li” is the current index of the element for which the ODE<br>system is being solved if there is a list of related systems being solved,<br>otherwise it can be set to 0.</p><p>这两个函数很重要，代码如下：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>, <span class="title">class</span> <span class="title">ThermoType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:StandardChemistryModel&lt;ReactionThermo, ThermoType&gt;::derivatives</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar time,</span><br><span class="line">    <span class="keyword">const</span> scalarField&amp; c,</span><br><span class="line">    <span class="keyword">const</span> label li,</span><br><span class="line">    scalarField&amp; dcdt</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> scalar T = c[nSpecie_];</span><br><span class="line">    <span class="keyword">const</span> scalar p = c[nSpecie_ + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    forAll(c_, i)</span><br><span class="line">    &#123;</span><br><span class="line">        c_[i] = <span class="built_in">max</span>(c[i], <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    omega(p, T, c_, li, dcdt);</span><br><span class="line">    <span class="comment">//dcdt在这里计算，事实上，还是调用的Reaction::omega</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Constant pressure</span></span><br><span class="line">    <span class="comment">// dT/dt = ...</span></span><br><span class="line">    scalar rho = <span class="number">0</span>;</span><br><span class="line">    scalar cSum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (label i = <span class="number">0</span>; i &lt; nSpecie_; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> scalar W = specieThermo_[i].W();</span><br><span class="line">        cSum += c_[i];</span><br><span class="line">        rho += W*c_[i];</span><br><span class="line">    &#125;</span><br><span class="line">    scalar cp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (label i=<span class="number">0</span>; i&lt;nSpecie_; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cp += c_[i]*specieThermo_[i].cp(p, T);</span><br><span class="line">    &#125;</span><br><span class="line">    cp /= rho;</span><br><span class="line"></span><br><span class="line">    scalar dT = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (label i = <span class="number">0</span>; i &lt; nSpecie_; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> scalar hi = specieThermo_[i].ha(p, T);</span><br><span class="line">        dT += hi*dcdt[i];</span><br><span class="line">    &#125;</span><br><span class="line">    dT /= rho*cp;</span><br><span class="line"></span><br><span class="line">    dcdt[nSpecie_] = -dT;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// dp/dt = ...</span></span><br><span class="line">    dcdt[nSpecie_ + <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>, <span class="title">class</span> <span class="title">ThermoType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:StandardChemistryModel&lt;ReactionThermo, ThermoType&gt;::jacobian</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar t,</span><br><span class="line">    <span class="keyword">const</span> scalarField&amp; c,</span><br><span class="line">    <span class="keyword">const</span> label li,</span><br><span class="line">    scalarField&amp; dcdt,</span><br><span class="line">    scalarSquareMatrix&amp; J</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> scalar T = c[nSpecie_];</span><br><span class="line">    <span class="keyword">const</span> scalar p = c[nSpecie_ + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    forAll(c_, i)</span><br><span class="line">    &#123;</span><br><span class="line">        c_[i] = <span class="built_in">max</span>(c[i], <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    J = Zero;</span><br><span class="line">    dcdt = Zero;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// To compute the species derivatives of the temperature term,</span></span><br><span class="line">    <span class="comment">// the enthalpies of the individual species is needed</span></span><br><span class="line">    <span class="function">scalarField <span class="title">hi</span><span class="params">(nSpecie_)</span></span>;</span><br><span class="line">    <span class="function">scalarField <span class="title">cpi</span><span class="params">(nSpecie_)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (label i = <span class="number">0</span>; i &lt; nSpecie_; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        hi[i] = specieThermo_[i].ha(p, T);</span><br><span class="line">        cpi[i] = specieThermo_[i].cp(p, T);</span><br><span class="line">    &#125;</span><br><span class="line">    scalar omegaI = <span class="number">0</span>;</span><br><span class="line">    List&lt;label&gt; dummy;</span><br><span class="line">    forAll(reactions_, ri)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> Reaction&lt;ThermoType&gt;&amp; R = reactions_[ri];</span><br><span class="line">        scalar kfwd, kbwd;</span><br><span class="line">        R.dwdc(p, T, c_, li, J, dcdt, omegaI, kfwd, kbwd, <span class="literal">false</span>, dummy);</span><br><span class="line">        <span class="comment">//原来真正的Jacobian-J和derivative-dcdt计算在src/thermophysicalModels/specie/reaction/Reactions/Reaction/Reaction.C里边！</span></span><br><span class="line">        <span class="comment">//这里dcdt其实和derivatives中计算的是一样的。不确定，需要验证一下。</span></span><br><span class="line">        R.dwdT(p, T, c_, li, omegaI, kfwd, kbwd, J, <span class="literal">false</span>, dummy, nSpecie_);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// The species derivatives of the temperature term are partially computed</span></span><br><span class="line">    <span class="comment">// while computing dwdc, they are completed hereunder:</span></span><br><span class="line">    scalar cpMean = <span class="number">0</span>;</span><br><span class="line">    scalar dcpdTMean = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (label i=<span class="number">0</span>; i&lt;nSpecie_; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cpMean += c_[i]*cpi[i]; <span class="comment">// J/(m^3 K)</span></span><br><span class="line">        dcpdTMean += c_[i]*specieThermo_[i].dcpdT(p, T);</span><br><span class="line">    &#125;</span><br><span class="line">    scalar dTdt = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">for</span> (label i=<span class="number">0</span>; i&lt;nSpecie_; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        dTdt += hi[i]*dcdt[i]; <span class="comment">// J/(m^3 s)</span></span><br><span class="line">    &#125;</span><br><span class="line">    dTdt /= -cpMean; <span class="comment">// K/s</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (label i = <span class="number">0</span>; i &lt; nSpecie_; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        J(nSpecie_, i) = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (label j = <span class="number">0</span>; j &lt; nSpecie_; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            J(nSpecie_, i) += hi[j]*J(j, i);</span><br><span class="line">        &#125;</span><br><span class="line">        J(nSpecie_, i) += cpi[i]*dTdt; <span class="comment">// J/(mol s)</span></span><br><span class="line">        J(nSpecie_, i) /= -cpMean;    <span class="comment">// K/s/(mol/m3)</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ddT of dTdt</span></span><br><span class="line">    J(nSpecie_, nSpecie_) = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (label i = <span class="number">0</span>; i &lt; nSpecie_; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        J(nSpecie_, nSpecie_) += cpi[i]*dcdt[i] + hi[i]*J(i, nSpecie_);</span><br><span class="line">    &#125;</span><br><span class="line">    J(nSpecie_, nSpecie_) += dTdt*dcpdTMean;</span><br><span class="line">    J(nSpecie_, nSpecie_) /= -cpMean;</span><br><span class="line">    J(nSpecie_, nSpecie_) += dTdt/T;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>OF 里的 ODE 是为了得到 deltaT 之后新的浓度 c，在给定当前的 c T p 的前提下。然后据此求解组分方程的源项：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (label i=<span class="number">0</span>; i&lt;nSpecie_; i++)</span><br><span class="line">&#123;</span><br><span class="line">    RR_[i][celli] =</span><br><span class="line">        (c_[i] - c0[i])*specieThermo_[i].W()/deltaT[celli];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>把 c T P 设为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Φ</mi></mrow><annotation encoding="application/x-tex">\Phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord">Φ</span></span></span></span>，现在是已知 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\Phi_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>，要求 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\Phi_{n+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.891661em;vertical-align:-.208331em"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span></span></span></span>。<br>我们可以根据化学反应来得到 dcdt 和 dTdt，即现在已知 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="normal">Φ</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="normal">Φ</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac></mstyle><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="normal">Φ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Phi&#x27;=\dfrac{\partial \Phi}{\partial t}=f(\Phi)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.751892em;vertical-align:0"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord">Φ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord">Φ</span><span class="mclose">)</span></span></span></span>，然后寻找合适的算法来求解 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\Phi_{n+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.891661em;vertical-align:-.208331em"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span></span></span></span>。<br>最简单的方法就是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Φ</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi mathvariant="normal">Φ</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="normal">Φ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Phi_{n+1}=\Phi_n + hf(\Phi)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.891661em;vertical-align:-.208331em"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord">Φ</span><span class="mclose">)</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="normal">Φ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(\Phi)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord">Φ</span><span class="mclose">)</span></span></span></span> 是斜率，h 是时间间隔。<br>那么现有先进的求解方法，应该也是基于这个思想。<br>比如 RK 方法，就是把时间间隔 h 分为若干小段。</p><h3 id="6-阶-rk"><a class="markdownIt-Anchor" href="#6-阶-rk"></a> 6 阶 RK</h3><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><msub><mi>c</mi><mn>2</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo>+</mo><msub><mi>c</mi><mn>3</mn></msub><msub><mi>k</mi><mn>3</mn></msub><mo>+</mo><msub><mi>c</mi><mn>4</mn></msub><msub><mi>k</mi><mn>4</mn></msub><mo>+</mo><msub><mi>c</mi><mn>5</mn></msub><msub><mi>k</mi><mn>5</mn></msub><mo>+</mo><msub><mi>c</mi><mn>6</mn></msub><msub><mi>k</mi><mn>6</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y_{n+1}=y_n+h(c_1k_1+c_2k_2+c_3k_3+c_4k_4+c_5k_5+c_6k_6)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.638891em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>d</mi><mi>y</mi><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">k_1=f(t_n,y_n)=dydt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>2</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><mi>h</mi><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>21</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k_2=f(t_n+a_2h,y_n+hb_{21}k_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">h</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>3</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo>+</mo><msub><mi>a</mi><mn>3</mn></msub><mi>h</mi><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>31</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>32</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k_3=f(t_n+a_3h,y_n+hb_{31}k_1+hb_{32}k_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">h</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>4</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo>+</mo><msub><mi>a</mi><mn>4</mn></msub><mi>h</mi><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>41</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>42</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>43</mn></msub><msub><mi>k</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k_4=f(t_n+a_4h,y_n+hb_{41}k_1+hb_{42}k_2+hb_{43}k_3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">h</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>5</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo>+</mo><msub><mi>a</mi><mn>5</mn></msub><mi>h</mi><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>51</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>52</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>53</mn></msub><msub><mi>k</mi><mn>3</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>54</mn></msub><msub><mi>k</mi><mn>4</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k_5=f(t_n+a_5h,y_n+hb_{51}k_1+hb_{52}k_2+hb_{53}k_3+hb_{54}k_4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">h</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>6</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mi>n</mi></msub><mo>+</mo><msub><mi>a</mi><mn>6</mn></msub><mi>h</mi><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>6</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>62</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>63</mn></msub><msub><mi>k</mi><mn>3</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>64</mn></msub><msub><mi>k</mi><mn>4</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>65</mn></msub><msub><mi>k</mi><mn>5</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k_6=f(t_n+a_6h,y_n+hb_{6}k_1+hb_{62}k_2+hb_{63}k_3+hb_{64}k_4+hb_{65}k_5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">h</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><a href="https://github.com/OpenFOAM/OpenFOAM-2.0.x/blob/master/src/ODE/ODESolvers/RK/RK.C" target="_blank" rel="external nofollow noopener noreferrer">OF-2.0.x</a> 的代码，对应公式中的量：</p><table><thead><tr><th>代码中的变量</th><th>公式中的变量</th></tr></thead><tbody><tr><td><code>ak2_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">k_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>ak3_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">k_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>ak4_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">k_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>ak5_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">k_5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>ak6_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>6</mn></msub></mrow><annotation encoding="application/x-tex">k_6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>y</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">y_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>yout</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">y_{n+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.638891em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>dydx</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">k_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>第一个 <code>yTemp_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>21</mn></msub><msub><mi>k</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">y_n+hb_{21}k_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>第二个 <code>yTemp_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>31</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>32</mn></msub><msub><mi>k</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">y_n+hb_{31}k_1+hb_{32}k_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>第三个 <code>yTemp_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>41</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>42</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>43</mn></msub><msub><mi>k</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">y_n+hb_{41}k_1+hb_{42}k_2+hb_{43}k_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>第四个 <code>yTemp_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>51</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>52</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>53</mn></msub><msub><mi>k</mi><mn>3</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>54</mn></msub><msub><mi>k</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">y_n+hb_{51}k_1+hb_{52}k_2+hb_{53}k_3+hb_{54}k_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td>第五个 <code>yTemp_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>61</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>62</mn></msub><msub><mi>k</mi><mn>2</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>63</mn></msub><msub><mi>k</mi><mn>3</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>64</mn></msub><msub><mi>k</mi><mn>4</mn></msub><mo>+</mo><mi>h</mi><msub><mi>b</mi><mn>65</mn></msub><msub><mi>k</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">y_n+hb_{61}k_1+hb_{62}k_2+hb_{63}k_3+hb_{64}k_4+hb_{65}k_5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr></tbody></table><p>代码中返回的是：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>k</mi><mn>1</mn></msub><mo>+</mo><msub><mi>c</mi><mn>3</mn></msub><msub><mi>k</mi><mn>3</mn></msub><mo>+</mo><msub><mi>c</mi><mn>4</mn></msub><msub><mi>k</mi><mn>4</mn></msub><mo>+</mo><msub><mi>c</mi><mn>6</mn></msub><msub><mi>k</mi><mn>6</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y_{n+1}=y_n+h(c_1k_1+c_3k_3+c_4k_4+c_6k_6)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.638891em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，只需要保证 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>∑</mo><msub><mi>c</mi><mi>k</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum c_k =1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-.25001em"></span><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span> 就行了。代码中刚好是相加为 1：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">RK::c1 = <span class="number">37.0</span>/<span class="number">378.0</span>, RK::c3 = <span class="number">250.0</span>/<span class="number">621.0</span>,</span><br><span class="line">RK::c4 = <span class="number">125.0</span>/<span class="number">594.0</span>, RK::c6 = <span class="number">512.0</span>/<span class="number">1771.0</span>,</span><br></pre></td></tr></table></figure><p>其中的 <code>dydx</code> 即 derivatives，但是没有用到 Jacobian？这个RK确实没有用到 Jacobian，但是其他的 ODE 求解器用到了。</p><h3 id="krr4"><a class="markdownIt-Anchor" href="#krr4"></a> KRR4</h3><p>已知 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>y</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y&#x27;=f(y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.946332em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="mclose">)</span></span></span></span>，我们这样得到 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mrow><mi>n</mi><mo>+</mo></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y_{n+1}=y_n+hf(y_{n+})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.638891em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.25833100000000003em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mtight">+</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>y</mi><mi>n</mi></msub><mo>+</mo><mi>h</mi><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle><msub><mi mathvariant="normal">∣</mi><msub><mi>y</mi><mi>n</mi></msub></msub><mo stretchy="false">(</mo><msub><mi>y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">y_{n+1}=y_n+h[f(y_n)+\dfrac{\partial f}{\partial y}|_{y_n}(y_{n+1}-y_n)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.638891em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.25188em;vertical-align:-.8804400000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.10764em">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285719em"><span style="top:-2.357em;margin-left:-.03588em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>y</mi><mi>h</mi></msub><mo>+</mo><mi>h</mi><mo stretchy="false">[</mo><mn>1</mn><mo>−</mo><mi>h</mi><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle><msup><mo stretchy="false">]</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>⋅</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y_{n+1}=y_h+h[1-h\dfrac{\partial f}{\partial y}]^{-1} \cdot f(y_n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.638891em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.25188em;vertical-align:-.8804400000000001em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.10764em">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>+</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>y</mi><mn>0</mn></msub><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>s</mi></msubsup><msub><mi>b</mi><mi>i</mi></msub><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y(x_0+h)=y_0+\sum_{i=1}^s b_ik_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-.29971000000000003em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.804292em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>γ</mi><mi>h</mi><mi>f</mi><mo stretchy="false">)</mo><msub><mi>k</mi><mi>i</mi></msub><mo>=</mo><mi>h</mi><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>α</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>k</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mi>h</mi><msup><mi>f</mi><mo mathvariant="normal">′</mo></msup><mo>⋅</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>k</mi><mi>j</mi></msub><mo separator="true">,</mo><mspace width="1em"><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><mi>s</mi></mspace></mrow><annotation encoding="application/x-tex">(1-\gamma h f) k_i = h f(y_0+\sum_{j=1}^{i-1}\alpha_{ij}k_j)+h f&#x27; \cdot \sum_{j=1}^{i-1}\gamma_{ij}k_j, \quad i=1,\cdots,s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.05556em">γ</span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.400382em;vertical-align:-.43581800000000004em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.964564em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.43581800000000004em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.0037em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.946332em;vertical-align:-.19444em"></span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.400382em;vertical-align:-.43581800000000004em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.964564em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.43581800000000004em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05556em">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05556em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8388800000000001em;vertical-align:-.19444em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault">s</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>k</mi><mi>j</mi></msub><mo>+</mo><mi>γ</mi><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">g_i=\sum_{j=1}^{i-1}\gamma_{ij}k_j+\gamma k_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.400382em;vertical-align:-.43581800000000004em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.964564em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.43581800000000004em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05556em">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05556em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.05556em">γ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>γ</mi><mi>h</mi><mo>−</mo><msup><mi>f</mi><mo mathvariant="normal">′</mo></msup><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>g</mi><mn>1</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1/\gamma h -f&#x27;)\cdot g_1=f(y_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:.05556em">γ</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>γ</mi><mi>h</mi><mo>−</mo><msup><mi>f</mi><mo mathvariant="normal">′</mo></msup><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>g</mi><mn>2</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo>+</mo><msub><mi>a</mi><mn>21</mn></msub><msub><mi>g</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>c</mi><mn>21</mn></msub><msub><mi>g</mi><mn>1</mn></msub><mi mathvariant="normal">/</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">(1/\gamma h -f&#x27;)\cdot g_2=f(y_0+a_{21}g_1)+c_{21}g_1/h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:.05556em">γ</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathdefault">h</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>γ</mi><mi>h</mi><mo>−</mo><msup><mi>f</mi><mo mathvariant="normal">′</mo></msup><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>g</mi><mn>3</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo>+</mo><msub><mi>a</mi><mn>31</mn></msub><msub><mi>g</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>32</mn></msub><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><msub><mi>c</mi><mn>31</mn></msub><msub><mi>g</mi><mn>1</mn></msub><mo>+</mo><msub><mi>c</mi><mn>32</mn></msub><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">(1/\gamma h -f&#x27;)\cdot g_3=f(y_0+a_{31}g_1+a_{32}g_2)+(c_{31}g_1+c_{32}g_2)/h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:.05556em">γ</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathdefault">h</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>γ</mi><mi>h</mi><mo>−</mo><msup><mi>f</mi><mo mathvariant="normal">′</mo></msup><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>g</mi><mn>4</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>0</mn></msub><mo>+</mo><msub><mi>a</mi><mn>41</mn></msub><msub><mi>g</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>42</mn></msub><msub><mi>g</mi><mn>2</mn></msub><mo>+</mo><msub><mi>a</mi><mn>43</mn></msub><msub><mi>g</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><msub><mi>c</mi><mn>41</mn></msub><msub><mi>g</mi><mn>1</mn></msub><mo>+</mo><msub><mi>c</mi><mn>42</mn></msub><msub><mi>g</mi><mn>2</mn></msub><mo>+</mo><msub><mi>c</mi><mn>43</mn></msub><msub><mi>g</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">(1/\gamma h -f&#x27;)\cdot g_4=f(y_0+a_{41}g_1+a_{42}g_2+a_{43}g_3)+(c_{41}g_1+c_{42}g_2+c_{43}g_3)/h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:.05556em">γ</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathdefault">h</span></span></span></span></p><p><a href="https://github.com/OpenFOAM/OpenFOAM-2.0.x/blob/master/src/ODE/ODESolvers/KRR4/KRR4.C" target="_blank" rel="external nofollow noopener noreferrer">OF-2.0.x</a> 的代码，对应公式中的量：</p><table><thead><tr><th>代码中的变量</th><th>公式中的变量</th></tr></thead><tbody><tr><td><code>dfdy_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>f</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">f&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.946332em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>dfdx_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\dfrac{\partial f}{\partial x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.10764em">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></td></tr><tr><td><code>g1_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>g</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">g_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>g2_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>g</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">g_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>g3_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>g</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">g_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>g4_</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>g</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">g_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>c21</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>21</mn></msub></mrow><annotation encoding="application/x-tex">c_{21}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>c31</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>31</mn></msub></mrow><annotation encoding="application/x-tex">c_{31}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>c32</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>32</mn></msub></mrow><annotation encoding="application/x-tex">c_{32}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>c41</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>41</mn></msub></mrow><annotation encoding="application/x-tex">c_{41}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>c42</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>42</mn></msub></mrow><annotation encoding="application/x-tex">c_{42}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>c43</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>43</mn></msub></mrow><annotation encoding="application/x-tex">c_{43}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>a21</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>21</mn></msub></mrow><annotation encoding="application/x-tex">a_{21}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>a31</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>31</mn></msub></mrow><annotation encoding="application/x-tex">a_{31}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>a32</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mn>32</mn></msub></mrow><annotation encoding="application/x-tex">a_{32}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>b1</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">b1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">b</span><span class="mord">1</span></span></span></span></td></tr><tr><td><code>b2</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">b2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">b</span><span class="mord">2</span></span></span></span></td></tr><tr><td><code>b3</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">b3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">b</span><span class="mord">3</span></span></span></span></td></tr><tr><td><code>b4</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">b4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">b</span><span class="mord">4</span></span></span></span></td></tr></tbody></table><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">KRR4::b1 = <span class="number">19.0</span>/<span class="number">9.0</span>, KRR4::b2 = <span class="number">1.0</span>/<span class="number">2.0</span>, KRR4::b3 = <span class="number">25.0</span>/<span class="number">108.0</span>,</span><br><span class="line">KRR4::b4 = <span class="number">125.0</span>/<span class="number">108.0</span>,</span><br></pre></td></tr></table></figure><p>b1+b2+b3+b4=4</p><h3 id="seulex"><a class="markdownIt-Anchor" href="#seulex"></a> seulex</h3><p><a href="https://github.com/OpenFOAM/OpenFOAM-dev/blob/master/src/ODE/ODESolvers/seulex/seulex.C" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM-dev</a></p><h2 id="化学-ode-求解理论"><a class="markdownIt-Anchor" href="#化学-ode-求解理论"></a> 化学 ODE 求解理论</h2><p>上边是代码追踪，下面来看一下化学 ODE 求解的理论知识。<br>待求解的量有：</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Φ</mi><mo>=</mo><msup><mrow><mo fence="true">{</mo><mi>T</mi><mo separator="true">,</mo><msub><mi>Y</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>Y</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>Y</mi><mrow><msub><mi>N</mi><mtext>sp</mtext></msub><mo>−</mo><mn>1</mn></mrow></msub><mo fence="true">}</mo></mrow><mtext>T</mtext></msup></mrow><annotation encoding="application/x-tex">\Phi = \left \lbrace T, Y_1, Y_2, \dotsc, Y_{N_{\text{sp}} - 1} \right \rbrace^{\text{T}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord">Φ</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.4312409999999998em;vertical-align:-.35001em"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">{</span></span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">…</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833100000000004em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.34731999999999996em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">}</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0812309999999998em"><span style="top:-3.3029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">T</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Y</mi><msub><mi>N</mi><mtext>sp</mtext></msub></msub><mo>=</mo><mn>1</mn><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><msub><mi>N</mi><mtext>sp</mtext></msub><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>Y</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">Y_{N_{\text{sp}}} = 1 - \sum_{k=1}^{N_{\text{sp}} - 1} Y_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.03065em;vertical-align:-.34731999999999996em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833100000000004em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.34731999999999996em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.321759em;vertical-align:-.30130799999999996em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.020451em"><span style="top:-2.398692em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.24212em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.30130799999999996em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></p><p>derivatives 即：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>=</mo><msubsup><mi mathvariant="normal">Φ</mi><mi>i</mi><mo mathvariant="normal">′</mo></msubsup><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="normal">Φ</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><msup><mrow><mo fence="true">{</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>T</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo separator="true">,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>Y</mi><mn>1</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo separator="true">,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>Y</mi><mn>2</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>Y</mi><mrow><msub><mi>N</mi><mtext>sp</mtext></msub><mo>−</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo fence="true">}</mo></mrow><mtext>T</mtext></msup></mrow><annotation encoding="application/x-tex">f = {\Phi_i&#x27;}=\frac{\partial \Phi}{\partial t} = \left \lbrace \frac{\partial T}{\partial t}, \frac{\partial Y_1}{\partial t}, \frac{\partial Y_2}{\partial t}, \dotsc, \frac{\partial Y_{N_{\text{sp}} - 1}}{\partial t} \right \rbrace^{\text{T}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-.247em"></span><span class="mord"><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8018919999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord">Φ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.631261em;vertical-align:-.95003em"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">{</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">…</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4317600000000001em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.73732em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833100000000004em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.34731999999999996em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">}</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.681231em"><span style="top:-3.9029000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">T</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>T</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mo>−</mo><mn>1</mn></mrow><mrow><mi>ρ</mi><msub><mi>c</mi><mi>p</mi></msub></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mtext>sp</mtext></msub></munderover><msub><mi>h</mi><mi>k</mi></msub><msub><mi>W</mi><mi>k</mi></msub><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\frac{\partial T}{\partial t} = \frac{-1}{\rho c_p} \sum_{k=1}^{N_{\text{sp}}} h_k W_k \dot{\omega}_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.2387690000000005em;vertical-align:-1.302113em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">−</span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.9366560000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.4083250000000005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>Y</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mi>ρ</mi></mfrac><msub><mi>W</mi><mi>k</mi></msub><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub><mspace width="1em"><mi>k</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>N</mi><mtext>sp</mtext></msub><mo>−</mo><mn>1</mn></mspace></mrow><annotation encoding="application/x-tex">\frac{\partial Y_k}{\partial t} = \frac{1}{\rho} W_k \dot{\omega}_k \quad k = 1, \dotsc, N_{\text{sp}} - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.20188em;vertical-align:-.8804400000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">…</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></span></p><p>Jacobian 矩阵：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="script">J</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>f</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi mathvariant="normal">Φ</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><msub><mi mathvariant="normal">Φ</mi><mi>i</mi></msub><mo>˙</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi mathvariant="normal">Φ</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\mathcal{J}_{i,j} = \frac{\partial f_i}{\partial \Phi_j} = \frac{\partial \dot{\Phi_i}}{\partial \Phi_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:.18472em">J</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.3435479999999997em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.10764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.569298em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5971899999999999em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9201900000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>展开为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup></mrow><mrow><mi mathvariant="normal">∂</mi><mi>T</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>Y</mi><mn>1</mn></msub></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>Y</mi><mrow><msub><mi>N</mi><mtext>sp</mtext></msub><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>Y</mi><mn>1</mn><mo mathvariant="normal">′</mo></msubsup></mrow><mrow><mi mathvariant="normal">∂</mi><mi>T</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>Y</mi><mn>1</mn><mo mathvariant="normal">′</mo></msubsup></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>Y</mi><mn>1</mn></msub></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>Y</mi><mn>1</mn><mo mathvariant="normal">′</mo></msubsup></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>Y</mi><mrow><msub><mi>N</mi><mtext>sp</mtext></msub><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>Y</mi><mrow><msub><mi>N</mi><mtext>sp</mtext></msub><mo>−</mo><mn>1</mn></mrow><mo mathvariant="normal">′</mo></msubsup></mrow><mrow><mi mathvariant="normal">∂</mi><mi>T</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>Y</mi><mrow><msub><mi>N</mi><mtext>sp</mtext></msub><mo>−</mo><mn>1</mn></mrow><mo mathvariant="normal">′</mo></msubsup></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>Y</mi><mn>1</mn></msub></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo>…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>Y</mi><mrow><msub><mi>N</mi><mtext>sp</mtext></msub><mo>−</mo><mn>1</mn></mrow><mo mathvariant="normal">′</mo></msubsup></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>Y</mi><mrow><msub><mi>N</mi><mtext>sp</mtext></msub><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac></mstyle></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\left[ \begin{array}{cccc} \dfrac{\partial {T&#x27;}}{\partial T} &amp; \dfrac{\partial {T&#x27;}}{\partial Y_1} &amp; \ldots &amp; \dfrac{\partial {T&#x27;}}{\partial Y_{N_{\text{sp}} - 1}} \\ \dfrac{\partial {Y_1&#x27;}}{\partial T} &amp; \dfrac{\partial {Y_1&#x27;}}{\partial Y_1} &amp; \ldots &amp; \dfrac{\partial {Y_1&#x27;}}{\partial Y_{N_{\text{sp}} - 1}} \\ \vdots &amp; &amp; \ddots &amp; \vdots \\ \dfrac{\partial {Y}&#x27;_{N_{\text{sp}} - 1}}{\partial T} &amp; \dfrac{\partial {Y}&#x27;_{N_{\text{sp}} - 1}}{\partial Y_1} &amp; \ldots &amp; \dfrac{\partial {Y}&#x27;_{N_{\text{sp}} - 1}}{\partial Y_{N_{\text{sp}} - 1}} \end{array} \right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9.432287em;vertical-align:-4.4661435em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.758975em"><span style="top:.45004499999999903em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-.7049550000000009em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-1.3059550000000009em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-1.9069550000000008em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-2.507955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.108955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.709955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.310955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.911955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-5.512955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-6.758975em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.250064999999999em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.9661435em"><span style="top:-7.2247515em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.428892em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-4.7625395em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.428892em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-2.4518920000000004em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.24810799999999997em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.2292194999999997em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0;border-top-width:1.5em;bottom:0"></span></span></span></span><span style="top:-.25467649999999975em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6145429999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.862651em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-2.424669em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.472651em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.4661435em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.9661435em"><span style="top:-7.151794499999999em"><span class="pstrut" style="height:3.614543em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.428892em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-4.6895825em"><span class="pstrut" style="height:3.614543em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.428892em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-2.4518920000000004em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.24810799999999997em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.1562624999999995em"><span class="pstrut" style="height:3.614543em"></span><span class="mord"></span></span><span style="top:-.1817194999999996em"><span class="pstrut" style="height:3.614543em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6145429999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.862651em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-2.424669em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.472651em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.4661435em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.9661435em"><span style="top:-7.151794499999999em"><span class="pstrut" style="height:3.614543em"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:-4.6895825em"><span class="pstrut" style="height:3.614543em"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:-2.1562624999999995em"><span class="pstrut" style="height:3.614543em"></span><span class="mord"><span class="minner">⋱</span></span></span><span style="top:-.1817194999999996em"><span class="pstrut" style="height:3.614543em"></span><span class="mord"><span class="minner">…</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.4661435em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.9661435em"><span style="top:-7.2247515em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.428892em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833100000000004em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.34731999999999996em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.03332em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-4.7625395em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.428892em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833100000000004em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.34731999999999996em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-2.4518920000000004em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.24810799999999997em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.03332em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.2292194999999997em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0;border-top-width:1.5em;bottom:0"></span></span></span></span><span style="top:-.25467649999999975em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6145429999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833100000000004em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.34731999999999996em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.862651em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-2.424669em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.10903em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.472651em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.03332em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.4661435em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.758975em"><span style="top:.45004499999999903em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-.7049550000000009em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-1.3059550000000009em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-1.9069550000000008em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-2.507955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.108955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.709955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.310955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.911955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-5.512955000000001em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-6.758975em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.250064999999999em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p><code>laminar</code> 中的函数 <code>Qdot()</code> 最初的纯虚函数定义于<code>combustionModel</code>，在 <code>laminar</code> 实际定义，返回值是 <code>this-&gt;chemistryPtr_-&gt;Qdot()</code>。因此跳转到了 <code>BasicChemistryModel</code> 类中，和上边的 <code>solve</code> 一样，它也是 <code>basicChemistryModel</code> 的纯虚函数，实际定义于 <code>StandardChemistryModel</code>，返回值是一个 <code>tmp&lt;Foam::volScalarField&gt;</code>，实际计算如下：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">forAll(Y_, i)</span><br><span class="line">&#123;</span><br><span class="line">    forAll(Qdot, celli)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> scalar hi = specieThermo_[i].Hc();</span><br><span class="line">        Qdot[celli] -= hi*RR_[i][celli];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中，<code>Hc()</code> 是该组分的化学焓（英文是 chemical enthalpy，又叫 formation enthalpy），公式是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Δ</mi><msubsup><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow><mn>0</mn></msubsup></mrow><annotation encoding="application/x-tex">\Delta h^0_{f,k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2333239999999999em;vertical-align:-.4192159999999999em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.4168920000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4192159999999999em"><span></span></span></span></span></span></span></span></span></span>，它的计算见 <a href="https://cpp.openfoam.org/v3/a10297_source.html" target="_blank" rel="external nofollow noopener noreferrer">janafThermoI.H</a>。另一篇博文正好给出了<a href="../hEqn/" target="_blank" style="target-new:tab">燃烧反应能量方程</a>，其中显焓输运方程的反应源项，就是这里的 <code>Qdot</code>。</p><p>函数 <code>R(volScalarField&amp; Y)</code> 的返回值是 <code>tmp&lt;Foam::fvScalarMatrix&gt;</code>，我对 <code>matrix</code> 不太熟悉，这个矩阵应该是由此组成：<code>this-&gt;chemistryPtr_-&gt;RR(specieI)</code>。又来到了 BasicChemistryModel 类中，照旧，纯虚函数定义于 <code>basicChemistryModel</code>，实际定义于 <code>StandardChemistryModel</code>（在 StandardChemistryModelI.H 中定义），返回值是 <code>RR_</code>，它的类型是 <code>PtrList&lt;volScalarField::Internal&gt;</code>，代码中的描述是 List of reaction rate per specie [kg/m3/s]。</p><p>总结起来，就是在 solver 中，定义一个燃烧的对象：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">autoPtr&lt;CombustionModel&lt;psiReactionThermo&gt;&gt; reaction</span><br><span class="line">(</span><br><span class="line">    CombustionModel&lt;psiReactionThermo&gt;::New(thermo, turbulence())</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>然后在燃烧模型 <code>ChemistryCombustion</code> 里边，有一个化学模型的指针（Protected data，只能它自己或其派生类能够访问，它的对象不能访问）</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">autoPtr&lt;BasicChemistryModel&lt;ReactionThermo&gt;&gt; chemistryPtr_</span><br></pre></td></tr></table></figure><p>所有关于化学的使用，都是通过它调用。比如求解化学反应方程，就是 <code>reaction-&gt;correct()</code>。而这个 <code>correct</code> 函数的关键内容是</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>-&gt;chemistryPtr_-&gt;solve(<span class="keyword">this</span>-&gt;mesh().time().deltaTValue());</span><br></pre></td></tr></table></figure><p>调用了化学模型里边的 <code>solve</code> 函数。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:ChemistryCombustion&lt;ReactionThermo&gt;::ChemistryCombustion</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; modelType,</span><br><span class="line">    ReactionThermo&amp; thermo,</span><br><span class="line">    <span class="keyword">const</span> compressibleTurbulenceModel&amp; turb,</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; combustionProperties</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    CombustionModel&lt;ReactionThermo&gt;</span><br><span class="line">    (</span><br><span class="line">        modelType,</span><br><span class="line">        thermo,</span><br><span class="line">        turb,</span><br><span class="line">        combustionProperties</span><br><span class="line">    ),</span><br><span class="line">    chemistryPtr_(BasicChemistryModel&lt;ReactionThermo&gt;::New(thermo))</span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure><p>燃烧模型的构造函数里边，创建了化学模块的对象，传入了 <code>thermo</code>。</p><p>三个函数完整定义</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:combustionModels::laminar&lt;ReactionThermo&gt;::correct()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;active())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (integrateReactionRate_)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (fv::localEulerDdt::enabled(<span class="keyword">this</span>-&gt;mesh()))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">const</span> scalarField&amp; rDeltaT =</span><br><span class="line">                    fv::localEulerDdt::localRDeltaT(<span class="keyword">this</span>-&gt;mesh());</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;coeffs().found(<span class="string">"maxIntegrationTime"</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                    scalar maxIntegrationTime</span><br><span class="line">                    (</span><br><span class="line">                        readScalar(<span class="keyword">this</span>-&gt;coeffs().lookup(<span class="string">"maxIntegrationTime"</span>))</span><br><span class="line">                    );</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;solve</span><br><span class="line">                    (</span><br><span class="line">                        <span class="built_in">min</span>(<span class="number">1.0</span>/rDeltaT, maxIntegrationTime)()</span><br><span class="line">                    );</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;solve((<span class="number">1.0</span>/rDeltaT)());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;solve(<span class="keyword">this</span>-&gt;mesh().time().deltaTValue());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;calculate();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:tmp&lt;Foam::fvScalarMatrix&gt;</span><br><span class="line">Foam::combustionModels::laminar&lt;ReactionThermo&gt;::R(volScalarField&amp; Y) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">tmp&lt;fvScalarMatrix&gt; <span class="title">tSu</span><span class="params">(<span class="keyword">new</span> fvScalarMatrix(Y, dimMass/dimTime))</span></span>;</span><br><span class="line"></span><br><span class="line">    fvScalarMatrix&amp; Su = tSu.ref();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;active())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> label specieI =</span><br><span class="line">            <span class="keyword">this</span>-&gt;thermo().composition().species()[Y.member()];</span><br><span class="line"></span><br><span class="line">        Su += <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;RR(specieI);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> tSu;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:tmp&lt;Foam::volScalarField&gt;</span><br><span class="line">Foam::combustionModels::laminar&lt;ReactionThermo&gt;::Qdot() <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    tmp&lt;volScalarField&gt; tQdot</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">new</span> volScalarField</span><br><span class="line">        (</span><br><span class="line">            IOobject</span><br><span class="line">            (</span><br><span class="line">                <span class="keyword">this</span>-&gt;thermo().phasePropertyName(typeName + <span class="string">":Qdot"</span>),</span><br><span class="line">                <span class="keyword">this</span>-&gt;mesh().time().timeName(),</span><br><span class="line">                <span class="keyword">this</span>-&gt;mesh(),</span><br><span class="line">                IOobject::NO_READ,</span><br><span class="line">                IOobject::NO_WRITE,</span><br><span class="line">                <span class="literal">false</span></span><br><span class="line">            ),</span><br><span class="line">            <span class="keyword">this</span>-&gt;mesh(),</span><br><span class="line">            dimensionedScalar(<span class="string">"Qdot"</span>, dimEnergy/dimVolume/dimTime, <span class="number">0.0</span>)</span><br><span class="line">        )</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;active())</span><br><span class="line">    &#123;</span><br><span class="line">        tQdot.ref() = <span class="keyword">this</span>-&gt;chemistryPtr_-&gt;Qdot();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> tQdot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="rts-2"><a class="markdownIt-Anchor" href="#rts-2"></a> RTS</h2><h3 id="declareruntimeselectiontable-2"><a class="markdownIt-Anchor" href="#declareruntimeselectiontable-2"></a> declareRunTimeSelectionTable</h3><p>首先在源代码中全局搜索发现 <code>declareRunTimeSelectionTable</code> 函数在 <code>CombustionModel.H</code> 中被调用。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">declareRunTimeSelectionTable</span><br><span class="line">(</span><br><span class="line">    autoPtr,</span><br><span class="line">    CombustionModel,</span><br><span class="line">    dictionary,</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">word</span>&amp; modelType,</span><br><span class="line">        ReactionThermo&amp; thermo,</span><br><span class="line">        <span class="keyword">const</span> compressibleTurbulenceModel&amp; turb,</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">word</span>&amp; combustionProperties</span><br><span class="line">    ),</span><br><span class="line">    (modelType, thermo, turb, combustionProperties)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>而这个函数定义于 <code>\src\OpenFOAM\db\runTimeSelection\construction\runTimeSelectionTables.H</code> 中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> declareRunTimeSelectionTable(autoPtr,baseType,argNames,argList,parList)\</span></span><br><span class="line">    <span class="keyword">typedef</span> autoPtr&lt;baseType&gt; (*argNames##ConstructorPtr)argList;              \</span><br><span class="line">    <span class="keyword">typedef</span> HashTable&lt;argNames##ConstructorPtr, <span class="keyword">word</span>, <span class="built_in">string</span>::hash&gt;            \</span><br><span class="line">        argNames##ConstructorTable;                                            \</span><br><span class="line">    <span class="keyword">static</span> argNames##ConstructorTable* argNames##ConstructorTablePtr_;         \</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> construct##argNames##ConstructorTables();                      \</span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">baseType</span>##<span class="title">Type</span>&gt;                                             \</span></span><br><span class="line"><span class="class">    <span class="title">class</span> <span class="title">add</span>##<span class="title">argNames</span>##<span class="title">ConstructorToTable</span>                                    \</span></span><br><span class="line"><span class="class">    &#123;</span>                                                                          \</span><br><span class="line">    <span class="keyword">public</span>:                                                                    \</span><br><span class="line">        <span class="keyword">static</span> autoPtr&lt;baseType&gt; New argList                                   \</span><br><span class="line">        &#123;                                                                      \</span><br><span class="line">            <span class="keyword">return</span> autoPtr&lt;baseType&gt;(<span class="keyword">new</span> baseType##Type parList);              \</span><br><span class="line">        &#125;                                                                      \</span><br><span class="line">                                                                               \</span><br><span class="line">        add##argNames##ConstructorToTable                                      \</span><br><span class="line">        (                                                                      \</span><br><span class="line">            <span class="keyword">const</span> <span class="keyword">word</span>&amp; lookup = baseType##Type::typeName                      \</span><br><span class="line">        )                                                                      \</span><br><span class="line">        &#123;                                                                      \</span><br><span class="line">            construct##argNames##ConstructorTables();                          \</span><br><span class="line">            argNames##ConstructorTablePtr_-&gt;insert(lookup, New);               \</span><br><span class="line">        &#125;                                                                      \</span><br><span class="line">    &#125;;                                                                         \</span><br></pre></td></tr></table></figure><ul><li>定义一个函数指针，这样定义的结果是， <code>dictionaryConstructorPtr</code> 代表一个指向参数为 <code>argList</code>，返回类型为 <code>autoPtr&lt; baseType&gt;</code> 的函数指针。</li><li>将一个 key 和 value 分别为 <code>word</code> 和 <code>dictionaryConstructorPtr</code> 的 <code>HashTable</code> 重命名为 <code>argNames##ConstructorTable</code>，即 <code>dictionaryConstructorTable</code>，并创建了一个以它为类型的指针 <code>argNames##ConstructorTablePtr_</code>，即 <strong><code>dictionaryConstructorTablePtr_</code></strong>。</li><li>申明一个类：<code>add##argNames##ConstructorToTable</code>，即 <code>adddictionaryConstructorToTable</code>，它需要模板 <code>baseType##Type</code>，其中的 <code>baseType</code> 是 <code>CombustionModel</code>。</li><li>类中定义了 <code>New</code> 函数，<code>argList</code> 是其形参列表，<code>parList</code> 是返回的 <code>baseType##Type</code> 的构造函数的形参列表。注意，这里调用了<strong>基类的构造函数</strong>！！！</li><li>但是如果我们在派生类中创建这个 add 类的对象的话，它的模板则是派生类，就是说 New 函数的返回值是指向派生类对象基类指针。</li><li>在 <code>add##argNames##ConstructorToTable</code> 的构造函数中，向 <strong><code>dictionaryConstructorTablePtr_</code></strong> 中 <code>insert</code> 了一组 key and value：<br>key 是 <code>typeName</code>，vaule 是 返回 <em>基类 <code>autoPtr</code></em> 的 <code>New</code> 函数。</li></ul><h3 id="definetemplateruntimeselectiontable-2"><a class="markdownIt-Anchor" href="#definetemplateruntimeselectiontable-2"></a> defineTemplateRunTimeSelectionTable</h3><p><code>defineTemplateRunTimeSelectionTable</code> 函数被发现调用于 <code>makeCombustionTypes.H</code> 中的 <code>makeCombustion</code> 函数中。<br>而 <code>makeCombustion</code> 函数在 <code>CombustionModels.C</code> 中被调用：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">makeCombustion(psiReactionThermo);</span><br></pre></td></tr></table></figure><p>具体看看这个函数：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> makeCombustion(Comp)                                                   \</span></span><br><span class="line">                                                                               \</span><br><span class="line">    <span class="keyword">typedef</span> CombustionModel&lt;Comp&gt; CombustionModel##Comp;                       \</span><br><span class="line">                                                                               \</span><br><span class="line">    defineTemplateTypeNameAndDebugWithName                                     \</span><br><span class="line">    (                                                                          \</span><br><span class="line">        CombustionModel##Comp,                                                 \</span><br><span class="line">        (                                                                      \</span><br><span class="line">            <span class="keyword">word</span>(CombustionModel##Comp::typeName_()) + <span class="string">"&lt;"</span> + Comp::typeName    \</span><br><span class="line">          + <span class="string">"&gt;"</span>                                                                \</span><br><span class="line">        ).c_str(),                                                             \</span><br><span class="line">        <span class="number">0</span>                                                                      \</span><br><span class="line">    );                                                                         \</span><br><span class="line">                                                                               \</span><br><span class="line">    defineTemplateRunTimeSelectionTable                                        \</span><br><span class="line">    (                                                                          \</span><br><span class="line">        CombustionModel##Comp,                                                 \</span><br><span class="line">        dictionary                                                             \</span><br><span class="line">    );</span><br></pre></td></tr></table></figure><p>首先 <code>defineTemplateTypeNameAndDebugWithName</code> 函数创建了一个 <code>word</code> 名字是 <code>typeName</code> 值是 <code>Name</code>，即 <code>laminar&lt;psiReactionThermo&gt;</code>。</p><p>其次是调用 <code>defineTemplateRunTimeSelectionTable</code> 函数，它定义于 <code>\src\OpenFOAM\db\runTimeSelection\construction\runTimeSelectionTables.H</code> 中。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> defineTemplateRunTimeSelectionTable(baseType,argNames)                 \</span></span><br><span class="line">    defineRunTimeSelectionTablePtr(baseType,argNames);                         \</span><br><span class="line">    defineRunTimeSelectionTableConstructor(baseType,argNames);                 \</span><br><span class="line">    defineRunTimeSelectionTableDestructor(baseType,argNames)</span><br></pre></td></tr></table></figure><p>这里的 <code>baseType</code> 是 <code>CombustionModel##psiReactionThermo</code>，<code>argNames</code> 是 <code>dictionary</code>。<br>包括三个宏函数，第一个函数定义了一个类型为 <code>dictionary##ConstructorTable</code> （即 HashTable 的别名）的名字为 <code>dictionary##ConstructorTablePtr_</code> 的空指针。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> defineRunTimeSelectionTablePtr(baseType,argNames)                      \</span></span><br><span class="line">    baseType::argNames##ConstructorTable*                                      \</span><br><span class="line">        baseType::argNames##ConstructorTablePtr_ = <span class="literal">nullptr</span></span><br></pre></td></tr></table></figure><p>第二个函数定义了一个函数，名为 <code>constructdictionaryConstructorTables()</code>，作用是创建了一个类型为 <code>dictionaryConstructorTable</code>，名字为 <code>dictionaryConstructorTablePtr_</code> 的对象。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> defineRunTimeSelectionTableConstructor(baseType,argNames)              \</span></span><br><span class="line">    <span class="keyword">void</span> baseType::construct##argNames##ConstructorTables()                    \</span><br><span class="line">    &#123;                                                                          \</span><br><span class="line">            baseType::argNames##ConstructorTablePtr_                           \</span><br><span class="line">                = <span class="keyword">new</span> baseType::argNames##ConstructorTable;                    \</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>第三个函数定义了一个函数（后来在 <code>add##argNames##ConstructorToTable</code> 的析构函数中被调用），名字是 <code>destroydictionaryConstructorTables()</code>。</p><h3 id="创建对象-2"><a class="markdownIt-Anchor" href="#创建对象-2"></a> 创建对象</h3><p>我们在创建燃烧模型的对象时（<code>createFields.H</code>）是这样的：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt; <span class="string">"Creating reaction model\n"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">autoPtr&lt;CombustionModel&lt;psiReactionThermo&gt;&gt; reaction</span><br><span class="line">(</span><br><span class="line">    CombustionModel&lt;psiReactionThermo&gt;::New(thermo, turbulence())</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>调用的是 <code>CombustionModel</code> 中的 <code>New</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//- Selector</span></span><br><span class="line"><span class="keyword">static</span> autoPtr&lt;CombustionModel&gt; New</span><br><span class="line">(</span><br><span class="line">    ReactionThermo&amp; thermo,</span><br><span class="line">    <span class="keyword">const</span> compressibleTurbulenceModel&amp; turb,</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; combustionProperties=combustionPropertiesName <span class="comment">//默认值是 combustionPropertiesName</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>定义于它的 C 文件中，返回类型是 <code>autoPtr&lt;CombustionModel&gt;</code>，<code>CombustionModel</code> 需要一个模板，我们给它的是 <code>psiReactionThermo</code>。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ReactionThermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:autoPtr&lt;Foam::CombustionModel&lt;ReactionThermo&gt;&gt;</span><br><span class="line">Foam::CombustionModel&lt;ReactionThermo&gt;::New</span><br><span class="line">(</span><br><span class="line">    ReactionThermo&amp; thermo,</span><br><span class="line">    <span class="keyword">const</span> compressibleTurbulenceModel&amp; turb,</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; combustionProperties</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">        combustionModel::New&lt;CombustionModel&lt;ReactionThermo&gt;&gt;</span><br><span class="line">        <span class="comment">// 这里发现这个 New 调用时需要给它模板，我们给的就是 CombustionModel&lt;psiReactionThermo&gt;</span></span><br><span class="line">        (</span><br><span class="line">            thermo,</span><br><span class="line">            turb,</span><br><span class="line">            combustionProperties</span><br><span class="line">        );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用了它的基类 combustionModel（但没有在 C 文件中定义）的 New 函数：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Selectors</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//- Generic New for each of the related chemistry model</span></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CombustionModel</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="title">static</span> <span class="title">autoPtr</span>&lt;CombustionModel&gt; <span class="title">New</span></span></span><br><span class="line"><span class="class">    (</span></span><br><span class="line"><span class="class">        <span class="title">typename</span> <span class="title">CombustionModel</span>:</span>:reactionThermo&amp; thermo,</span><br><span class="line">        <span class="keyword">const</span> compressibleTurbulenceModel&amp; turb,</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">word</span>&amp; combustionProperties</span><br><span class="line">    );</span><br></pre></td></tr></table></figure><p>上边这个 New 函数发现是在 <code>combustionModelTemplates.C</code> 中定义的。<br>这里的 <code>CombustionModel</code> 就是 <code>CombustionModel</code>，<code>reactionThermo</code> 是它的模板 <code>ReactionThermo</code>，我们在这里指定它为 <code>psiReactionThermo</code>。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CombustionModel</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:autoPtr&lt;CombustionModel&gt; Foam::combustionModel::New</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">typename</span> CombustionModel::reactionThermo&amp; thermo,</span><br><span class="line">    <span class="keyword">const</span> compressibleTurbulenceModel&amp; turb,</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; combustionProperties</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">word</span> <span class="title">combModelName</span><span class="params">(<span class="string">"none"</span>)</span></span>;</span><br><span class="line">    IOdictionary(combIO).lookup(<span class="string">"combustionModel"</span>) &gt;&gt; combModelName;</span><br><span class="line">    Info&lt;&lt; <span class="string">"Selecting combustion model "</span> &lt;&lt; combModelName &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// 字典 combustionProperties 里写的那个名字，如 laminar</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">typename</span> CombustionModel::dictionaryConstructorTable cstrTableType;</span><br><span class="line"><span class="comment">//这是在 declareRunTimeSelectionTable 中的那个 HashTable</span></span><br><span class="line">    cstrTableType* cstrTable = CombustionModel::dictionaryConstructorTablePtr_;</span><br><span class="line"><span class="comment">//dictionaryConstructorTablePtr_ 在 declareRunTimeSelectionTable 申明过</span></span><br><span class="line"><span class="comment">// 并且在 constructdictionaryConstructorTables() 这个函数中分派了实际指向的对象。</span></span><br><span class="line"><span class="comment">//这个函数申明于 declareRunTimeSelectionTable，定义于 defineTemplateRunTimeSelectionTable</span></span><br><span class="line"><span class="comment">//而这个函数又在 adddictionaryConstructorToTable 的构造函数中被调用</span></span><br><span class="line"><span class="comment">//adddictionaryConstructorToTable，即 add##argNames##ConstructorToTable 在 declareRunTimeSelectionTable 中定义</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span> compCombModelName =</span><br><span class="line">        combModelName + <span class="string">'&lt;'</span> + CombustionModel::reactionThermo::typeName + <span class="string">'&gt;'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span> thermoCombModelName =</span><br><span class="line">        combModelName + <span class="string">'&lt;'</span> + CombustionModel::reactionThermo::typeName + <span class="string">','</span></span><br><span class="line">      + thermo.thermoName() + <span class="string">'&gt;'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">typename</span> cstrTableType::iterator compCstrIter =</span><br><span class="line">        cstrTable-&gt;<span class="built_in">find</span>(compCombModelName);</span><br><span class="line"><span class="comment">//在哈希表中查询，key 是 laminar&lt;psiReactionThermo&gt; ，返回值是  返回指向基类autoPtr的New函数</span></span><br><span class="line">    <span class="keyword">typename</span> cstrTableType::iterator thermoCstrIter =</span><br><span class="line">        cstrTable-&gt;<span class="built_in">find</span>(thermoCombModelName);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> autoPtr&lt;CombustionModel&gt;</span><br><span class="line">    (</span><br><span class="line">        thermoCstrIter != cstrTable-&gt;<span class="built_in">end</span>()</span><br><span class="line">      ? thermoCstrIter()(combModelName, thermo, turb, combustionProperties)</span><br><span class="line">      : compCstrIter()(combModelName, thermo, turb, combustionProperties)</span><br><span class="line">      <span class="comment">//modeltype 从这里由 combModelName 传入！！！如 laminar</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>里边用到了一个类：<code>CombustionModel::dictionaryConstructorTable</code>，它是在 <code>declareRunTimeSelectionTable</code> 中定义的，就是那个哈希表的别名。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> HashTable&lt;argNames##ConstructorPtr, <span class="keyword">word</span>, <span class="built_in">string</span>::hash&gt;</span><br><span class="line">    argNames##ConstructorTable; <span class="comment">//argNames 是 dictionary</span></span><br></pre></td></tr></table></figure><p>因为是在 <code>CombustionModel.H</code> 中调用的 <code>declareRunTimeSelectionTable</code>，于是 <code>CombustionModel::dictionaryConstructorTable</code> 就被定义好了。</p><h3 id="laminarsc-2"><a class="markdownIt-Anchor" href="#laminarsc-2"></a> laminars.C</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">makeCombustionTypes(laminar, psiReactionThermo);</span><br></pre></td></tr></table></figure><p>而这个函数定义于 makeCombustionTypes.H：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> makeCombustionTypes(CombModel, Comp)                                   \</span></span><br><span class="line">                                                                               \</span><br><span class="line">    <span class="keyword">typedef</span> combustionModels::CombModel&lt;Comp&gt; CombModel##Comp;                 \</span><br><span class="line">                                                                               \</span><br><span class="line">    defineTemplateTypeNameAndDebugWithName                                     \</span><br><span class="line">    (                                                                          \</span><br><span class="line">        CombModel##Comp,                                                       \</span><br><span class="line">        (                                                                      \</span><br><span class="line">            <span class="keyword">word</span>(CombModel##Comp::typeName_()) + <span class="string">"&lt;"</span> + Comp::typeName + <span class="string">"&gt;"</span>    \</span><br><span class="line">        ).c_str(),                                                             \</span><br><span class="line">        <span class="number">0</span>                                                                      \</span><br><span class="line">    );                                                                         \</span><br><span class="line">                                                                               \</span><br><span class="line">    CombustionModel&lt;Comp&gt;::                                                    \</span><br><span class="line">        add#<span class="meta">#dictionary##ConstructorToTable<span class="meta-string">&lt;CombModel##Comp&gt;                   \</span></span></span><br><span class="line">        add##CombModel##Comp#<span class="meta">#dictionary##ConstructorTo##CombustionModel##Comp\</span></span><br><span class="line">##Table_;</span><br><span class="line"><span class="comment">//这句话的作用和 addToRunTimeSelectionTable 一致，都是创建一个 add 类的对象，创建它的同时，将返回 指向派生类对象的基类指针 的 New 函数插进了 HashTable，即 dictionaryConstructorTable。后续就是在这个里边 find 我们在字典文件中指定的派生类。</span></span><br></pre></td></tr></table></figure><p>CombModel 是 laminar，Comp 是 psiReactionThermo<br>将 <code>combustionModels::laminar&lt;psiReactionThermo&gt;</code> 重命名为 <code>laminar##psiReactionThermo</code>。<br>在 <code>CombustionModel&lt;psiReactionThermo&gt;</code> 的命名空间下，<br>创建了类型为 <code>adddictionaryConstructorToTable&lt;laminar##psiReactionThermo&gt;</code> 的对象。于是在这里调用了 <code>adddictionaryConstructorToTable</code> 的构造函数！！！倒退至前边所述，这个构造函数中调用了 <code>constructdictionaryConstructorTables()</code>，作用是给 <code>dictionaryConstructorTablePtr_</code> new 一个对象，类型是 <code>dictionaryConstructorTable</code> ，即 <code>HashTable</code>。并且构造函数中还向该<code>dictionaryConstructorTablePtr_</code> insert 了 New 函数：<br>这个函数 <code>new</code> 了一个对象，并将其绑定至基类的指针，该对象的类型是 <code>baseType##Type</code>，即 <code>add</code> 这个类的模板的类型，而我们在这里给它的模板是 laminar##psiReactionThermo。就是说，我们在派生类中创建add这个类的对象时，同时向哈希表中插入了一组key and value，即派生类的typeName和返回指向派生类对象的基类指针的New函数！</p><h3 id="总结-2"><a class="markdownIt-Anchor" href="#总结-2"></a> 总结</h3><p><code>declareRunTimeSelectionTable</code> 创建了一个哈希表的指针 <code>argNames##ConstructorTablePtr_</code>，但是没有给它分配对象。只有当创建第一个 <code>add##argNames##ConstructorToTable&lt;baseType##Type&gt;</code> 对象时，才会 <code>new</code> 一个<code>baseType::argNames##ConstructorTable</code> 对象给它指向。这是这个函数的功能：<code>construct##argNames##ConstructorTables</code>（申明于 <code>declareRunTimeSelectionTable(autoPtr,baseType,argNames,argList,parList)</code>，定义于<code>defineRunTimeSelectionTableConstructor(baseType,argNames)</code>）。<br>此外，创建每个 <code>add##argNames##ConstructorToTable&lt;baseType##Type&gt;</code> 对象时，都会调用它的构造函数，该构造函数数向 <code>argNames##ConstructorTablePtr_</code> 插入一组 key and value：<code>baseType##Type::typeName</code> 和 <code>New</code> 函数。<br>说起这个 <code>New</code> 函数，那就大有来头，它返回基类指针，但是指向的对象类型是 <code>baseType##Type</code>，即<code>add##argNames##ConstructorToTable&lt;baseType##Type&gt;</code> 这个类的模板。<br>我们经常在派生类中创建一个 <code>add</code> 的对象，如：<code>laminars.C</code> 中的 <code>makeCombustionTypes</code> 中的：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CombustionModel&lt;Comp&gt;::add##dictionary##ConstructorToTable&lt;CombModel##Comp&gt;</span><br><span class="line">        add##CombModel##Comp##dictionary##ConstructorTo##CombustionModel##Comp##Table_;</span><br></pre></td></tr></table></figure><p>模板是 <code>laminar##psiReactionThermo</code>，即往哈希表中插入的 <code>New</code> 函数，返回值是基类指针，指向的是 <code>laminar##psiReactionThermo</code> 的对象</p>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> thermophysicalModels </tag>
            
            <tag> RTS </tag>
            
            <tag> combustionModels </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>编译报错总结</title>
      <link href="/compile/"/>
      <url>/compile/</url>
      
        <content type="html"><![CDATA[<p>OpenFOAM 编译报错集锦</p><p>===</p><p style="font-family:verdana;color:#fff;font-size:20px;text-align:left">下边这个 `T` 是一个 `const` 引用，但我这里要给它赋值，所以报错。</p><p style="font-family:verdana;color:#fff;font-size:20px;text-align:left">solution：`thermo` 库有两个版本的 `T()`，使用非 `const` 那个即可，即在 `solver` 中定义 `T` 时，使用 `volScalarField& T = thermo.T();`</p><h1 id="-0-"><a class="markdownIt-Anchor" href="#-0-"></a><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">YEEqn.H:<span class="number">86</span>:<span class="number">6</span>: error: </span><br><span class="line">passing ‘<span class="keyword">const</span> volScalarField </span><br><span class="line">&#123;aka <span class="keyword">const</span> GeometricField&lt;<span class="keyword">double</span>, fvPatchField, volMesh&gt;&#125;’ </span><br><span class="line">as ‘<span class="keyword">this</span>’ argument discards qualifiers [-fpermissive]</span><br><span class="line"></span><br><span class="line">     T=G;</span><br></pre></td></tr></table></figure></h1><p style="font-family:verdana;color:#fff;font-size:20px;text-align:left">这里 `radiation` 是一个 `autoPtr`，而我要把它转换类型它的派生类。</p><p style="font-family:verdana;color:#fff;font-size:20px;text-align:left">solution：在 `radiation` 后边加一个 `()` 即可。`autoPtr` 加括号返回正常的指针。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">YEEqn.H:<span class="number">85</span>:<span class="number">61</span>: error: </span><br><span class="line">cannot <span class="keyword">dynamic_cast</span> ‘radiation’ </span><br><span class="line">(of type ‘class autoPtr&lt;radiation::radiationModel&gt;’) </span><br><span class="line">to type ‘<span class="keyword">const</span> <span class="class"><span class="keyword">class</span> <span class="title">radiation</span>:</span>:fvDOM&amp;’ </span><br><span class="line">(source type is <span class="keyword">not</span> polymorphic)</span><br><span class="line"></span><br><span class="line"> T=<span class="built_in">pow</span>(<span class="keyword">dynamic_cast</span>&lt;<span class="keyword">const</span> radiation::fvDOM &amp;&gt;(radiation).G()/<span class="number">4</span>,<span class="number">0.25</span>);</span><br></pre></td></tr></table></figure>===<p style="font-family:verdana;color:#fff;font-size:20px;text-align:left">库中函数只申明，没有定义，就会出现这个错误。</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">undefined reference to 'Foam::functionName()'</span><br></pre></td></tr></table></figure>===<p style="font-family:verdana;color:#fff;font-size:20px;text-align:left">这里的 `R(Yi)` 是 ``tmp,fvMatrix,scalar,,``，不能和 `volScalarField`（或者 `scalar`） 相乘。</p><p style="font-family:verdana;color:#fff;font-size:20px;text-align:left">solution：很简单，`scalar` 放前边就行了。。。即：`efficiency_/TF_*reaction->R(Yi)`。因为 `scalar*fvMatrix` 是允许的！！！</p><h1 id="-3-"><a class="markdownIt-Anchor" href="#-3-"></a><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">YEqn.H(<span class="number">30</span>): error: no <span class="keyword">operator</span> <span class="string">"*"</span> matches these operands</span><br><span class="line">In file included from reactingFoam.C(<span class="number">76</span>):</span><br><span class="line">operand types are: </span><br><span class="line">Foam::tmp&lt;Foam::fvMatrix&lt;Foam::scalar&gt;&gt; * Foam::volScalarField </span><br><span class="line">In file included from reactingFoam.C(<span class="number">76</span>):</span><br><span class="line"></span><br><span class="line">reaction-&gt;R(Yi)*efficiency_/TF_</span><br></pre></td></tr></table></figure></h1><p style="font-family:verdana;color:#fff;font-size:20px;text-align:left">因为 ``timeSteps_`` 是基类中的 ``private`` 变量，而私有变量只能基类自己内部使用。</p><p style="font-family:verdana;color:#fff;font-size:20px;text-align:left">solution：我是这样做的：在基类中，将这个变量从 ``private`` 改成 ``protected``。</p><h1 id="-4-"><a class="markdownIt-Anchor" href="#-4-"></a><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">lnInclude/TDACCCMChemistryModel.C(<span class="number">709</span>): error #<span class="number">308</span>: member </span><br><span class="line"><span class="string">"TDACChemistryModel&lt;ReactionThermo, ThermoType&gt;::timeSteps_ </span></span><br><span class="line"><span class="string">[with ReactionThermo=psiReactionThermo, ThermoType=gasHThermoPhysics]"</span> </span><br><span class="line">(declared at <span class="built_in">line</span> <span class="number">90</span> of <span class="string">"lnInclude/TDACChemistryModel.H"</span>) is inaccessible</span><br><span class="line">      </span><br><span class="line"><span class="keyword">this</span>-&gt;timeSteps_++;</span><br></pre></td></tr></table></figure></h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">WMspray/WMspray.C(<span class="number">299</span>): error: <span class="keyword">dynamic_cast</span> cannot cast away <span class="keyword">const</span> </span><br><span class="line"><span class="keyword">or</span> other type qualifiers   </span><br><span class="line">basicSprayCloud&amp; spray_ = <span class="keyword">dynamic_cast</span>&lt; basicSprayCloud&amp;&gt;(<span class="keyword">this</span>-&gt;mesh()</span><br><span class="line">.objectRegistry::lookupObject&lt;sprayCloud&gt;(Foam::sprayCloud::typeName));</span><br></pre></td></tr></table></figure><p style="font-family:verdana;color:#fff;font-size:20px;text-align:left">代码改为以下即可，因为 ``lookupObject`` 得到的对象是 ``const``。``lookupObjectRef`` 得到的才是可以修改的。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">basicSprayCloud&amp; spray_ = <span class="keyword">dynamic_cast</span>&lt; basicSprayCloud&amp;&gt;(<span class="keyword">this</span>-&gt;mesh()</span><br><span class="line">.objectRegistry::lookupObjectRef&lt;sprayCloud&gt;(Foam::sprayCloud::typeName));</span><br></pre></td></tr></table></figure>===<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">~/OpenFOAM/OpenFOAM<span class="number">-2.3</span>.x/src/finiteVolume/lnInclude/cyclicAMIFvPatch.H(<span class="number">39</span>): </span><br><span class="line">catastrophic error: cannot <span class="built_in">open</span> source file <span class="string">"cyclicAMILduInterface.H"</span>  </span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cyclicAMILduInterface.H"</span></span></span><br></pre></td></tr></table></figure><p style="font-family:verdana;color:#fff;font-size:20px;text-align:left">这是因为旧版本的代码在 OF23x 中编译，解决方法是在 EXE_INC 中加入 ``-I$(LIB_SRC)/meshTools/lnInclude``。</p>===<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Post.C(<span class="number">70</span>): error: name followed by <span class="string">"::"</span> must be a <span class="class"><span class="keyword">class</span> <span class="title">or</span> <span class="title">namespace</span> <span class="title">name</span></span></span><br></pre></td></tr></table></figure><p style="font-family:verdana;color:#fff;font-size:20px;text-align:left">这是因为没有 include 双冒号后边类的头文件。</p>===<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">findMax.C(<span class="number">212</span>): error: ABC is <span class="keyword">not</span> a <span class="keyword">template</span></span><br></pre></td></tr></table></figure><p style="font-family:verdana;color:#fff;font-size:20px;text-align:left">需要 include ``ABC`` 的头文件，如果已经 include 了它的头文件，依然出现这个错误。那么检查 ``ABC`` 是否处于另一个命名空间里边。</p>===<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">findMax.C(<span class="number">235</span>): error: the operand of a runtime <span class="keyword">dynamic_cast</span> must have a </span><br><span class="line">polymorphic <span class="class"><span class="keyword">class</span> <span class="title">type</span>  <span class="title">dynamic_cast</span>&lt;const ABC&amp; &gt;(<span class="title">objectName</span>).<span class="title">functionName</span>()</span></span><br></pre></td></tr></table></figure><p style="font-family:verdana;color:#fff;font-size:20px;text-align:left">可能是因为 ``objectName`` 是 ``autoPtr``，需要在它后边加 ``()``。</p>===]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>dynLES</title>
      <link href="/dynLES/"/>
      <url>/dynLES/</url>
      
        <content type="html"><![CDATA[<p>动态 SGS 模型</p><a id="more"></a><h1 id="输运方程"><a class="markdownIt-Anchor" href="#输运方程"></a> 输运方程</h1><p>可压缩流动的N-S方程如下：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ρ</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><msub><mi>u</mi><mi>j</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>p</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>σ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><mi>ρ</mi><msub><mi>f</mi><mi>i</mi></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{l} \frac{\partial \rho }{\partial t} + \frac{\partial \rho {u_i}}{\partial {x_i}} = 0\\ \frac{\partial \rho u_i} {\partial t} + \frac{\partial \rho u_iu_j} {\partial x_j} = - \frac{\partial p}{\partial x_i} + \frac{\partial \sigma _{ij}} {\partial x_j} + \rho f_i \end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.9130640000000003em;vertical-align:-1.2065320000000002em"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7065320000000002em"><span style="top:-3.7743160000000002em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9322159999999999em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mathdefault mtight">ρ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9322159999999999em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.44509999999999994em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">0</span></span></span><span style="top:-2.335788em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9322159999999999em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.993428em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.50732em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5423199999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9322159999999999em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.44509999999999994em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.993428em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.50732em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:-.03588em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5423199999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.10764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2065320000000002em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span></span></span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>σ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>2</mn><mi>μ</mi><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mi>μ</mi><mo stretchy="false">(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>k</mi></msub></mrow></mfrac><mo stretchy="false">)</mo><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mtext> </mtext><mo separator="true">,</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>j</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma _{ij} = 2\mu S_{ij} - \frac{2}{3}\mu (\frac{\partial u_k} {\partial x_k}) \delta _{ij}\ ,S_{ij} = \frac{1}{2}(\frac{\partial u_i}{\partial x_j} + \frac{\partial u_j}{\partial x_i})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord">2</span><span class="mord mathdefault">μ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.3528279999999997em;vertical-align:-.4508599999999999em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">μ</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9019679999999999em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3487714285714287em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15122857142857138em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.41586em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3487714285714287em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15122857142857138em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4508599999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.4385279999999998em;vertical-align:-.5423199999999999em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8962079999999999em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.4101em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5423199999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.4385279999999998em;vertical-align:-.44509999999999994em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.993428em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.50732em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.44509999999999994em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span>。</p><p>对N-S方程进行雷诺平均，并引入Favre平均 ：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><msub><mi>f</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo>=</mo><mfrac><mover accent="true"><mrow><mi>ρ</mi><msub><mi>f</mi><mi>i</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover></mfrac></mrow><annotation encoding="application/x-tex">\widetilde {f_i} = \frac {\overline {\rho f_i} } {\bar \rho }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.14888em;vertical-align:-.19444em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.95444em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.10764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.69444em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.5848239999999998em;vertical-align:-.481108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.103716em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mathdefault mtight">ρ</span></span><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="accent-body" style="left:-.16666em"><span class="mtight">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord overline mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.93944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:-.10764em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span><span style="top:-3.84144em"><span class="pstrut" style="height:3em"></span><span class="overline-line mtight" style="border-bottom-width:.049em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.481108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，可以得到：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo stretchy="false">(</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>p</mi><mo>ˉ</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><msub><mi>σ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>f</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><mo>−</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><mrow><msubsup><mi>u</mi><mi>i</mi><mo mathvariant="normal">′</mo></msubsup><msubsup><mi>u</mi><mi>j</mi><mo mathvariant="normal">′</mo></msubsup></mrow><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{l} \frac{\partial \bar \rho }{\partial t} + \frac{\partial \bar \rho \widetilde {u_i}}{\partial x_i} = 0\\ \frac{\partial }{\partial t}(\bar \rho \widetilde {u_i}) + \frac{\partial \bar \rho \widetilde {u_i}\widetilde {u_j}}{\partial x_j} = - \frac{\partial \bar p}{\partial x_i} + \frac{\partial \widetilde {\sigma _{ij}}}{\partial x_j} + \bar \rho \widetilde {f_i} + \frac{\partial }{\partial x_j}( - \bar \rho \widetilde {u&#x27;_iu&#x27;_j}) \end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.9393279999999997em;vertical-align:-1.2196639999999999em"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7196639999999999em"><span style="top:-3.80714em"><span class="pstrut" style="height:3.019692em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9322159999999999em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mathdefault mtight">ρ</span></span><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="accent-body" style="left:-.16666em"><span class="mtight">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9322159999999999em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mathdefault mtight">ρ</span></span><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="accent-body" style="left:-.16666em"><span class="mtight">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.13056em"><span class="pstrut" style="height:2.7em"></span><span class="mtight" style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.44509999999999994em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">0</span></span></span><span style="top:-2.3423480000000003em"><span class="pstrut" style="height:3.019692em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8801079999999999em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.993428em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.50732em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mathdefault mtight">ρ</span></span><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="accent-body" style="left:-.16666em"><span class="mtight">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.13056em"><span class="pstrut" style="height:2.7em"></span><span class="mtight" style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.13056em"><span class="pstrut" style="height:2.7em"></span><span class="mtight" style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5423199999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9322159999999999em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mathdefault mtight">p</span></span><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="accent-body" style="left:-.16666em"><span class="mtight">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.44509999999999994em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.993428em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.50732em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:-.03588em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.13056em"><span class="pstrut" style="height:2.7em"></span><span class="mtight" style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5423199999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.95444em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.10764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.69444em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8801079999999999em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5423199999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord">−</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.019692em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.27686399999999994em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.733692em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2196639999999999em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span></span></span></span></span></span></span></p><p>其中，</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><msub><mi>σ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mo>=</mo><mn>2</mn><mi>μ</mi><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mi>μ</mi><mover accent="true"><msub><mi>S</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo stretchy="true">~</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo separator="true">,</mo><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\widetilde {\sigma _{ij}} = 2\mu \widetilde {S_{ij}} - \frac{2}{3}\mu \widetilde {S_{kk}}{\delta _{ij}}{\rm{ , }}\widetilde {S_{ij}} = \frac{1}{2}(\frac{\partial \widetilde {u_i}}{\partial {x_j}} + \frac{\partial \widetilde {u_j}}{\partial x_i})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9766680000000001em;vertical-align:-.286108em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.229438em;vertical-align:-.286108em"></span><span class="mord">2</span><span class="mord mathdefault">μ</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">μ</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mpunct">,</span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><msub><mi>u</mi><mi>i</mi></msub><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">~</mo></mover><mo>=</mo><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover><mo>−</mo><mo stretchy="false">(</mo><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover><mo>−</mo><mover accent="true"><mrow><msub><mi>u</mi><mi>i</mi></msub><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\widetilde {u_iu_j} = \widetilde {u_i}\widetilde {u_j} - (\widetilde {u_i}\widetilde {u_j} - \widetilde {u_iu_j})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.002668em;vertical-align:-.286108em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.71656em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.9766680000000001em;vertical-align:-.286108em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.71656em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>LES的动量方程为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo stretchy="false">(</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>p</mi><mo>ˉ</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><msub><mi>σ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>f</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo>−</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo stretchy="false">(</mo><mover accent="true"><mrow><msub><mi>u</mi><mi>i</mi></msub><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">~</mo></mover><mo>−</mo><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{\partial }{\partial t}(\bar \rho \widetilde {u_i}) + \frac{\partial \bar \rho \widetilde {u_i}\widetilde {u_j}}{\partial {x_j}} = - \frac{\partial \bar p}{\partial x_i} + \frac{\partial \widetilde {\sigma _{ij}}}{\partial x_j} + \bar \rho \widetilde {f_i} - \frac{\partial }{\partial x_j}\bar \rho (\widetilde {u_iu_j} - \widetilde {u_i}\widetilde {u_j})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">p</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.14888em;vertical-align:-.19444em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.95444em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.10764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.69444em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.71656em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>定义亚格子应力为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo stretchy="false">(</mo><mover accent="true"><mrow><msub><mi>u</mi><mi>i</mi></msub><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">~</mo></mover><mo>−</mo><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\tau _{ij} = \bar \rho (\widetilde {u_iu_j} - \widetilde {u_i}\widetilde {u_j})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.71656em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span>。</p><p>这样，动量方程就变为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo stretchy="false">(</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>p</mi><mo>ˉ</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><msub><mi>σ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>f</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial }{\partial t}(\bar \rho \widetilde {u_i}) + \frac{\partial \bar \rho \widetilde {u_i}\widetilde {u_j}}{\partial x_j} = - \frac{\partial \bar p}{\partial x_i} + \frac{\partial \widetilde {\sigma _{ij}}}{\partial x_j} + \bar \rho \widetilde {f_i} - \frac{\partial \tau _{ij}}{\partial x_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">p</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.14888em;vertical-align:-.19444em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.95444em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.10764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.69444em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><a href="https://journals.ametsoc.org/doi/abs/10.1175/1520-0493(1963)091%3C0099:GCEWTP%3E2.3.CO;2" target="_blank" rel="external nofollow noopener noreferrer">Smagorinsky</a>模型：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mi>S</mi><mi>m</mi><mi>a</mi><mi>g</mi></mrow></msubsup><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><msubsup><mi>τ</mi><mrow><mi>k</mi><mi>k</mi></mrow><mrow><mi>S</mi><mi>m</mi><mi>a</mi><mi>g</mi></mrow></msubsup><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo>−</mo><mn>2</mn><msub><mi>μ</mi><mrow><mi>S</mi><mi>G</mi><mi>S</mi></mrow></msub><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover></mrow><annotation encoding="application/x-tex">\tau _{ij}^{Smag} - \frac{1}{3}\tau _{kk}^{Smag}{\delta _{ij}} = - 2{\mu _{SGS}}\widetilde {S_{ij}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.372211em;vertical-align:-.412972em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.959239em"><span style="top:-2.4231360000000004em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span style="top:-3.1809080000000005em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05764em">S</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.412972em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9592389999999998em"><span style="top:-2.3986920000000005em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-3.180908em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05764em">S</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.3013079999999999em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.229438em;vertical-align:-.286108em"></span><span class="mord">−</span><span class="mord">2</span><span class="mord"><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05764em">S</span><span class="mord mathdefault mtight">G</span><span class="mord mathdefault mtight" style="margin-right:.05764em">S</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>μ</mi><mrow><mi>S</mi><mi>G</mi><mi>S</mi></mrow></msub><mo>=</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mrow><mo stretchy="false">(</mo><msub><mi>C</mi><mi>s</mi></msub><mover accent="true"><mi mathvariant="normal">Δ</mi><mo>ˉ</mo></mover><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mi mathvariant="normal">∣</mi><mover accent="true"><mi>S</mi><mo stretchy="true">~</mo></mover><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">{\mu _{SGS}} = \bar \rho {({C_s}\bar \Delta )^2}|\widetilde S|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05764em">S</span><span class="mord mathdefault mtight">G</span><span class="mord mathdefault mtight" style="margin-right:.05764em">S</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.19333em;vertical-align:-.25em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8201099999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord">Δ</span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.25em">ˉ</span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em">S</span></span><span class="svg-align" style="width:calc(100% - .16668em);margin-left:.16668em;top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span><span class="mord">∣</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><mover accent="true"><mi>S</mi><mo stretchy="true">~</mo></mover><mi mathvariant="normal">∣</mi><mo>=</mo><msqrt><mrow><mn>2</mn><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover></mrow></msqrt></mrow><annotation encoding="application/x-tex">|\widetilde S| = \sqrt {2\widetilde {S_{ij}}\widetilde {S_{ij}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.19333em;vertical-align:-.25em"></span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em">S</span></span><span class="svg-align" style="width:calc(100% - .16668em);margin-left:.16668em;top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.84em;vertical-align:-.526389em"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.313611em"><span class="svg-align" style="top:-3.8em"><span class="pstrut" style="height:3.8em"></span><span class="mord" style="padding-left:1em"><span class="mord">2</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span style="top:-3.273611em"><span class="pstrut" style="height:3.8em"></span><span class="hide-tail" style="min-width:1.02em;height:1.8800000000000001em"><svg width="400em" height="1.8800000000000001em" viewbox="0 0 400000 1944" preserveaspectratio="xMinYMin slice"><path d="M1001,80H400000v40H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5c53.7,-170.3,84.5,-266.8,92.5,-289.5c4,-6.7,10,-10,18,-10zM1001 80H400000v40H1013z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.526389em"><span></span></span></span></span></span></span></span></span>。</p><p><a href="https://aip.scitation.org/doi/abs/10.1063/1.865552" target="_blank" rel="external nofollow noopener noreferrer">Yoshizawa.1986</a>对其进行了可压缩修正，我们称之为可压 Smagorinsky 模型：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><msub><mi>τ</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo>−</mo><mn>2</mn><mstyle mathcolor="red"><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo stretchy="false">(</mo><msub><mi>C</mi><mi>s</mi></msub><mover accent="true"><mi mathvariant="normal">Δ</mi><mo>ˉ</mo></mover><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mi mathvariant="normal">∣</mi><mover accent="true"><mi>S</mi><mo stretchy="true">~</mo></mover><mi mathvariant="normal">∣</mi></mstyle><mo stretchy="false">(</mo><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mover accent="true"><msub><mi>S</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo stretchy="true">~</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>C</mi><mi>s</mi><mn>2</mn></msubsup><msub><mi>α</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>τ</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo>=</mo><msub><mi>C</mi><mi>I</mi></msub><mn>2</mn><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><msup><mover accent="true"><mi mathvariant="normal">Δ</mi><mo>ˉ</mo></mover><mn>2</mn></msup><mi mathvariant="normal">∣</mi><mover accent="true"><mi>S</mi><mo stretchy="true">~</mo></mover><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup><mo>=</mo><msub><mi>C</mi><mi>I</mi></msub><mi>α</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{l} \tau _{ij} - \frac{1}{3}\tau _{kk}\delta _{ij} = - 2\textcolor{red}{\bar \rho (C_s{\bar \Delta })^2 |\widetilde S|}(\widetilde {S_{ij}} - \frac{1}{3}\widetilde {S_{kk}}\delta _{ij}) = C_s^2\alpha _{ij}\\ \tau _{kk} = C_I 2\bar \rho {\bar \Delta }^2|\widetilde S{|^2} = {C_I}\alpha \end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.687448em;vertical-align:-1.093724em"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.593724em"><span style="top:-3.6745119999999996em"><span class="pstrut" style="height:3.0241179999999996em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord">2</span><span class="mord accent" style="color:red"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="color:red">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em"><span style="color:red">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mopen" style="color:red">(</span><span class="mord" style="color:red"><span class="mord mathdefault" style="margin-right:.07153em;color:red">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight" style="color:red"><span class="mord mathdefault mtight" style="color:red">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord" style="color:red"><span class="mord accent" style="color:red"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8201099999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord" style="color:red">Δ</span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.25em"><span style="color:red">ˉ</span></span></span></span></span></span></span></span><span class="mclose" style="color:red"><span class="mclose" style="color:red">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight" style="color:red"><span class="mord mtight" style="color:red">2</span></span></span></span></span></span></span></span><span class="mord" style="color:red">∣</span><span class="mord accent" style="color:red"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em;color:red">S</span></span><span class="svg-align" style="width:calc(100% - .16668em);margin-left:.16668em;top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="color:red;height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span><span class="mord" style="color:red">∣</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.4530000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.0037em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-2.2903939999999996em"><span class="pstrut" style="height:3.0241179999999996em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.07847em">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">2</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8201099999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord">Δ</span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.25em">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0241179999999999em"><span style="top:-3.27301em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em">S</span></span><span class="svg-align" style="width:calc(100% - .16668em);margin-left:.16668em;top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.07847em">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.0037em">α</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.093724em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span></span></span></span></span></span></span></p><p>其中， <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mi>s</mi></msub><mo>=</mo><mn>0.16</mn><mrow></mrow><mo separator="true">,</mo><mrow></mrow><msub><mi>C</mi><mi>I</mi></msub><mo>=</mo><mn>0.09</mn><mrow></mrow><mo separator="true">,</mo><mrow></mrow><mi mathvariant="normal">∣</mi><mover accent="true"><mi>S</mi><mo stretchy="true">~</mo></mover><mi mathvariant="normal">∣</mi><mo>=</mo><msqrt><mrow><mn>2</mn><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover></mrow></msqrt></mrow><annotation encoding="application/x-tex">{C_s} = 0.16{\rm{ }},{\rm{ }}{C_I} = 0.09{\rm{ }},{\rm{ }}|\widetilde S| = \sqrt {2\widetilde {S_{ij}}\widetilde {S_{ij}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8777699999999999em;vertical-align:-.19444em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">6</span><span class="mord"><span class="mord"><span class="mord"></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord"><span class="mord"></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.07847em">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.19333em;vertical-align:-.25em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">9</span><span class="mord"><span class="mord"><span class="mord"></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord"><span class="mord"></span></span></span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em">S</span></span><span class="svg-align" style="width:calc(100% - .16668em);margin-left:.16668em;top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.84em;vertical-align:-.526389em"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.313611em"><span class="svg-align" style="top:-3.8em"><span class="pstrut" style="height:3.8em"></span><span class="mord" style="padding-left:1em"><span class="mord">2</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span style="top:-3.273611em"><span class="pstrut" style="height:3.8em"></span><span class="hide-tail" style="min-width:1.02em;height:1.8800000000000001em"><svg width="400em" height="1.8800000000000001em" viewbox="0 0 400000 1944" preserveaspectratio="xMinYMin slice"><path d="M1001,80H400000v40H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5c53.7,-170.3,84.5,-266.8,92.5,-289.5c4,-6.7,10,-10,18,-10zM1001 80H400000v40H1013z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.526389em"><span></span></span></span></span></span></span></span></span>。<br>1991 年，<a href="https://aip.scitation.org/doi/abs/10.1063/1.857955" target="_blank" rel="external nofollow noopener noreferrer">Germano</a> 提出了动态 Smagorinsky 模型，该模型通过局部自相似假设，将两个不同尺度的亚格子应力模型联系起来，得到在计算过程中动态决定模型系数的方法。动态大涡模型的过程中，引入了二次滤波，称为检验滤波（test filter），检验滤波的滤波宽度为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi mathvariant="normal">Δ</mi><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">\widehat \Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.92333em;vertical-align:0"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.92333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord">Δ</span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span></span></span></span>，比一次滤波的滤波宽度要大，一般为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi mathvariant="normal">Δ</mi><mo stretchy="true">^</mo></mover><mo>=</mo><mn>2</mn><mover accent="true"><mi mathvariant="normal">Δ</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\widehat \Delta = 2\bar \Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.92333em;vertical-align:0"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.92333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord">Δ</span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8201099999999999em;vertical-align:0"></span><span class="mord">2</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8201099999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord">Δ</span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.25em">ˉ</span></span></span></span></span></span></span></span></span> 。但是 Germano 提出的动态模型是基于不可压流体的，这里我们采用<a href="https://aip.scitation.org/doi/abs/10.1063/1.858164" target="_blank" rel="external nofollow noopener noreferrer">Moin.1991</a>提出的可压动态 SGS 模型。对一次滤波之后的动量方程进行检验滤波，得到如下方程：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo stretchy="false">(</mo><mover accent="true"><mrow><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover></mrow><mo stretchy="true">^</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mrow><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mo stretchy="true">^</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mover accent="true"><mi>p</mi><mo>ˉ</mo></mover><mo stretchy="true">^</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mover accent="true"><msub><mi>σ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mo stretchy="true">^</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><mover accent="true"><mrow><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>f</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover></mrow><mo stretchy="true">^</mo></mover><mo>−</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mover accent="true"><mrow><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo stretchy="false">(</mo><mover accent="true"><mrow><msub><mi>u</mi><mi>i</mi></msub><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">~</mo></mover><mo>−</mo><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo></mrow><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">\frac{\partial }{\partial t}(\widehat {\bar \rho \widetilde {u_i}}) + \frac{\partial \widehat {\bar \rho \widetilde {u_i}\widetilde {u_j}}}{\partial x_j} = - \frac{\partial \widehat {\bar p}}{\partial x_i} + \frac{\partial \widehat {\widetilde {\sigma _{ij}}}}{\partial x_j} + \widehat {\bar \rho \widetilde {f_i}} - \frac{\partial }{\partial x_j}\widehat {\bar \rho (\widetilde {u_iu_j} - \widetilde {u_i}\widetilde {u_j})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.69056em"><span class="pstrut" style="height:3em"></span><span style="height:.3em"><svg width="100%" height="0.3em" viewbox="0 0 2364 300" preserveaspectratio="none"><path d="M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.6396680000000003em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6675600000000002em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.69056em"><span class="pstrut" style="height:3em"></span><span style="height:.3em"><svg width="100%" height="0.3em" viewbox="0 0 2364 300" preserveaspectratio="none"><path d="M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.32078em;vertical-align:-.8360000000000001em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4847799999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8077799999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">p</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.56778em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.579668em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.60756em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.93056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.69056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.44888em;vertical-align:-.19444em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.25444em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.95444em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.10764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.69444em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.95444em"><span class="pstrut" style="height:3em"></span><span style="height:.3em"><svg width="100%" height="0.3em" viewbox="0 0 2364 300" preserveaspectratio="none"><path d="M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.17em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.71656em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="svg-align" style="top:-3.75em"><span class="pstrut" style="height:3em"></span><span style="height:.42em"><svg width="100%" height="0.42em" viewbox="0 0 2364 420" preserveaspectratio="none"><path d="M1181 0h2l1171 296c6 0 10 5 10 11l-2 23c-1 6-5 10-11 10h-1L1182 67 15 340h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></p><p>根据 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo>=</mo><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\bar \rho \widetilde {u_i} = \overline {\rho {u_i}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.885em;vertical-align:-.19444em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.825em;vertical-align:-.19444em"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><mrow><msub><mi>u</mi><mi>i</mi></msub><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">~</mo></mover><mo>=</mo><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\bar \rho \widetilde {u_iu_j} = \overline {\rho {u_i}{u_j}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.002668em;vertical-align:-.286108em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.71656em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.916668em;vertical-align:-.286108em"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span> ，我们得到：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo stretchy="false">(</mo><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><mfrac><mrow><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover></mrow><mover accent="true"><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo stretchy="true">^</mo></mover></mfrac><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mover accent="true"><mi>p</mi><mo>ˉ</mo></mover><mo stretchy="true">^</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mover accent="true"><msub><mi>σ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mo stretchy="true">^</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><mover accent="true"><mrow><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>f</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover></mrow><mo stretchy="true">^</mo></mover><mo>−</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover><menclose notation="downdiagonalstrike"><mrow><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mover accent="true"><mrow><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mo stretchy="true">^</mo></mover></mrow></menclose><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><mfrac><mover accent="true"><mrow><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover></mrow><mo stretchy="true">^</mo></mover><mover accent="true"><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo stretchy="true">^</mo></mover></mfrac><mo stretchy="false">)</mo><menclose notation="downdiagonalstrike"><mrow><mo>−</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mover accent="true"><mrow><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mo stretchy="true">^</mo></mover></mrow></menclose></mrow><annotation encoding="application/x-tex">\frac{\partial } {\partial t} (\widehat{\overline{\rho {u_i}}}) +\frac{\partial } {\partial {x_j}} (\frac{\widehat{\overline{\rho u_i}}\widehat{\overline{\rho u_i}}}{\widehat{\bar\rho}}) = - \frac{\partial \widehat{\bar p}} {\partial x_i} + \frac{\partial \widehat{\widetilde{\sigma_{ij}}}} {\partial x_j} + \widehat{\bar\rho \widetilde{f_i}} - \frac{\partial } {\partial x_j} \widehat{\overline{\rho u_iu_j}} \bcancel{+\frac{\partial }{\partial {x_j}}\widehat{\bar\rho \widetilde{u_i}\widetilde{u_j}}} + \frac{\partial } {\partial x_j} (\frac{\widehat{\overline{\rho u_i}\widehat{\overline{\rho u_j}}}} {\widehat{\bar\rho }}) \bcancel{-\frac{\partial }{\partial x_j}\widehat{\bar{\rho }\widetilde{u_i}\widetilde{u_j}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.87056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.63056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.519668em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5475599999999998em"><span style="top:-2.30222em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8077799999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.56778em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.87056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.63056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.87056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.63056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.89222em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.32078em;vertical-align:-.8360000000000001em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4847799999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8077799999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">p</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.56778em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.579668em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.60756em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.93056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.69056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.44888em;vertical-align:-.19444em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.25444em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.95444em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.10764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.69444em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.95444em"><span class="pstrut" style="height:3em"></span><span style="height:.3em"><svg width="100%" height="0.3em" viewbox="0 0 2364 300" preserveaspectratio="none"><path d="M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.87056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.63056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mord cancel-lap"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714400000000002em"><span style="top:-4.343548em"><span class="pstrut" style="height:4.343548em"></span><span class="mord cancel-pad"><span class="mord">+</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.69056em"><span class="pstrut" style="height:3em"></span><span style="height:.3em"><svg width="100%" height="0.3em" viewbox="0 0 2364 300" preserveaspectratio="none"><path d="M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.37144em"><span class="pstrut" style="height:4.343548em"></span><span style="height:2.343548em"><svg width="100%" height="2.343548em"><line x1="0" y1="0" x2="100%" y2="100%" stroke-width="0.046em"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.819668em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.84756em"><span style="top:-2.47278em"><span class="pstrut" style="height:3.17056em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8077799999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.56778em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span style="top:-3.40056em"><span class="pstrut" style="height:3.17056em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.84756em"><span class="pstrut" style="height:3.17056em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.17056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.87056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.63056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.8705600000000002em"><span class="pstrut" style="height:3em"></span><span style="height:.3em"><svg width="100%" height="0.3em" viewbox="0 0 2364 300" preserveaspectratio="none"><path d="M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.89222em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mord cancel-lap"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714400000000002em"><span style="top:-4.343548em"><span class="pstrut" style="height:4.343548em"></span><span class="mord cancel-pad"><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.69056em"><span class="pstrut" style="height:3em"></span><span style="height:.3em"><svg width="100%" height="0.3em" viewbox="0 0 2364 300" preserveaspectratio="none"><path d="M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.37144em"><span class="pstrut" style="height:4.343548em"></span><span style="height:2.343548em"><svg width="100%" height="2.343548em"><line x1="0" y1="0" x2="100%" y2="100%" stroke-width="0.046em"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo stretchy="false">(</mo><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><mfrac><mrow><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover></mrow><mover accent="true"><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo stretchy="true">^</mo></mover></mfrac><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mover accent="true"><mi>p</mi><mo>ˉ</mo></mover><mo stretchy="true">^</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mover accent="true"><msub><mi>σ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mo stretchy="true">^</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><mover accent="true"><mrow><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>f</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover></mrow><mo stretchy="true">^</mo></mover><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial }{\partial t} (\widehat{\overline{\rho {u_i}}})+\frac{\partial }{\partial {x_j}}(\frac{\widehat{\overline{\rho u_i}}\widehat{\overline{\rho {u_i}}}}{\widehat{\bar{\rho }}})=-\frac{\partial \widehat{\bar{p}}}{\partial x_i}+\frac{\partial \widehat{\widetilde{\sigma_{ij}}}}{\partial x_j}+\widehat{\bar{\rho }\widetilde{f_i}}-\frac{\partial T_{ij}}{\partial x_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.87056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.63056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.519668em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5475599999999998em"><span style="top:-2.30222em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8077799999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.56778em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.87056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.63056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.87056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.63056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.89222em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.32078em;vertical-align:-.8360000000000001em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4847799999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8077799999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">p</span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.56778em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.579668em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.60756em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.93056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.69056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.44888em;vertical-align:-.19444em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.25444em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.95444em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.10764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.69444em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.95444em"><span class="pstrut" style="height:3em"></span><span style="height:.3em"><svg width="100%" height="0.3em" viewbox="0 0 2364 300" preserveaspectratio="none"><path d="M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover><mo>−</mo><mfrac><mrow><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover></mrow><mover accent="true"><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo stretchy="true">^</mo></mover></mfrac></mrow><annotation encoding="application/x-tex">T_{ij}= \widehat{\overline{\rho u_iu_j}} - \frac{\widehat{\overline{\rho u_i}}\widehat{\overline{\rho u_j}}} {\widehat{\bar\rho }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.156668em;vertical-align:-.286108em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.87056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.63056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.43978em;vertical-align:-.89222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.54756em"><span style="top:-2.30222em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8077799999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.56778em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.87056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.63056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.87056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.63056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.89222em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">T_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 是两次滤波之后的亚格子应力。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>L</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mover accent="true"><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">^</mo></mover><mo>=</mo><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover><mo>−</mo><mfrac><mrow><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover></mrow><mover accent="true"><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo stretchy="true">^</mo></mover></mfrac><mo>−</mo><mo stretchy="false">(</mo><mover accent="true"><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo stretchy="true">^</mo></mover><mover accent="true"><mrow><msub><mi>u</mi><mi>i</mi></msub><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">~</mo></mover><mo>−</mo><mover accent="true"><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo stretchy="true">^</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo>~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo>~</mo></mover><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> </mtext><mo>=</mo><menclose notation="downdiagonalstrike"><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover></menclose><mo>−</mo><mfrac><mrow><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover></mrow><mover accent="true"><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo stretchy="true">^</mo></mover></mfrac><menclose notation="downdiagonalstrike"><mrow><mo>−</mo><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover></mrow></menclose><mo>+</mo><mfrac><mover accent="true"><mrow><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">‾</mo></mover></mrow><mo stretchy="true">^</mo></mover><mover accent="true"><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo>^</mo></mover></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> </mtext><mo>=</mo><mfrac><mover accent="true"><mrow><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">‾</mo></mover></mrow><mo stretchy="true">^</mo></mover><mover accent="true"><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo>^</mo></mover></mfrac><mo>−</mo><mfrac><mrow><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover></mrow><mover accent="true"><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo stretchy="true">^</mo></mover></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> </mtext><mo>=</mo><mover accent="true"><mrow><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mo stretchy="true">^</mo></mover><mo>−</mo><mfrac><mrow><mover accent="true"><mrow><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover></mrow><mo stretchy="true">^</mo></mover><mover accent="true"><mrow><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mo stretchy="true">^</mo></mover></mrow><mover accent="true"><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo stretchy="true">^</mo></mover></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{l} L_{ij}=T_{ij}-\widehat {\tau _{ij}}=\widehat{\overline{\rho {u_i}{u_j}}}-\frac{\widehat{\overline{\rho {u_i}}} \widehat{\overline{\rho u_j}}}{\widehat{\bar{\rho }}} -(\widehat{\bar\rho }\widetilde{u_iu_j} -\widehat{\bar\rho } \tilde{u_i}\tilde{u_j})\\ \text{ }=\bcancel{\widehat{\overline{\rho {u_i}u_j}}}-\frac{\widehat{\overline{\rho {u_i}}}\widehat{\overline{\rho u_j}}}{\widehat{\bar{\rho }}}\bcancel{-\widehat{\overline{\rho {u_{i}}{u_j}}}}+\frac{\widehat{\overline{\rho u_i}\overline{\rho {u_j}}}}{\hat{\bar{\rho }}}\\\text{ }=\frac{\widehat{\overline{\rho {u_{i}}}\overline{\rho u_j}}}{\hat{\bar{\rho }}}-\frac{\widehat{\overline{\rho {u_{i}}}}\widehat{\overline{\rho {u_{j}}}}}{\widehat{\bar{\rho }}}\\\text{ }=\widehat{\bar{\rho }\widetilde{u_{i}}\widetilde{u_{j}}}-\frac{\widehat{\bar{\rho }\widetilde{u_i}}\widehat{\bar{\rho }\widetilde{u_j}}}{\widehat{\bar{\rho }}} \end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.80838em;vertical-align:-3.1541899999999994em"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.65419em"><span style="top:-5.70669em"><span class="pstrut" style="height:3.2007120000000002em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.67056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.87056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.63056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.148212em"><span style="top:-2.6245540000000003em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8077799999999999em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span></span></span><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="accent-body" style="left:-.16666em"><span class="mtight">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.26778em"><span class="pstrut" style="height:2.7em"></span><span class="mtight" style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.50732em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9155600000000002em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mtight"><span class="mord overline mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6755600000000002em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.57756em"><span class="pstrut" style="height:3em"></span><span class="overline-line mtight" style="border-bottom-width:.049em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.67556em"><span class="pstrut" style="height:3em"></span><span class="mtight" style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9155600000000002em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mtight"><span class="mord overline mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6755600000000002em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span><span style="top:-3.57756em"><span class="pstrut" style="height:3em"></span><span class="overline-line mtight" style="border-bottom-width:.049em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.67556em"><span class="pstrut" style="height:3em"></span><span class="mtight" style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5115539999999998em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8077799999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.56778em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.71656em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8077799999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.56778em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6678599999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.35em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.25em">~</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6678599999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.35em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.25em">~</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-4.004924em"><span class="pstrut" style="height:3.2007120000000002em"></span><span class="mord"><span class="mord text"><span class="mord"> </span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord cancel-lap"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.87056em"><span style="top:-3.156668em"><span class="pstrut" style="height:3.156668em"></span><span class="mord cancel-pad"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.87056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.63056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-2.87056em"><span class="pstrut" style="height:3.156668em"></span><span style="height:1.156668em"><svg width="100%" height="1.156668em"><line x1="0" y1="0" x2="100%" y2="100%" stroke-width="0.046em"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.28610800000000003em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.148212em"><span style="top:-2.6245540000000003em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8077799999999999em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span></span></span><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="accent-body" style="left:-.16666em"><span class="mtight">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.26778em"><span class="pstrut" style="height:2.7em"></span><span class="mtight" style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.50732em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9155600000000002em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mtight"><span class="mord overline mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6755600000000002em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.57756em"><span class="pstrut" style="height:3em"></span><span class="overline-line mtight" style="border-bottom-width:.049em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.67556em"><span class="pstrut" style="height:3em"></span><span class="mtight" style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9155600000000002em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mtight"><span class="mord overline mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6755600000000002em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span><span style="top:-3.57756em"><span class="pstrut" style="height:3em"></span><span class="overline-line mtight" style="border-bottom-width:.049em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.67556em"><span class="pstrut" style="height:3em"></span><span class="mtight" style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5115539999999998em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord cancel-lap"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.87056em"><span style="top:-3.156668em"><span class="pstrut" style="height:3.156668em"></span><span class="mord cancel-pad"><span class="mord">−</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.87056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.63056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-2.87056em"><span class="pstrut" style="height:3.156668em"></span><span style="height:1.156668em"><svg width="100%" height="1.156668em"><line x1="0" y1="0" x2="100%" y2="100%" stroke-width="0.046em"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.28610800000000003em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.190212em"><span style="top:-2.6081460000000005em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8312199999999998em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span></span></span><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="accent-body" style="left:-.16666em"><span class="mtight">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span style="top:-2.83678em"><span class="pstrut" style="height:2.7em"></span><span class="accent-body" style="left:-.25em"><span class="mtight">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.50732em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9755600000000002em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mtight"><span class="mord overline mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6755600000000002em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span><span style="top:-3.57756em"><span class="pstrut" style="height:3em"></span><span class="overline-line mtight" style="border-bottom-width:.049em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord overline mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6755600000000002em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.57756em"><span class="pstrut" style="height:3em"></span><span class="overline-line mtight" style="border-bottom-width:.049em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.67556em"><span class="pstrut" style="height:3em"></span><span class="mtight" style="height:.3em"><svg width="100%" height="0.3em" viewbox="0 0 2364 300" preserveaspectratio="none"><path d="M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5279619999999998em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.2867500000000005em"><span class="pstrut" style="height:3.2007120000000002em"></span><span class="mord"><span class="mord text"><span class="mord"> </span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.190212em"><span style="top:-2.6081460000000005em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8312199999999998em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span></span></span><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="accent-body" style="left:-.16666em"><span class="mtight">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span style="top:-2.83678em"><span class="pstrut" style="height:2.7em"></span><span class="accent-body" style="left:-.25em"><span class="mtight">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.50732em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9755600000000002em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mtight"><span class="mord overline mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6755600000000002em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.57756em"><span class="pstrut" style="height:3em"></span><span class="overline-line mtight" style="border-bottom-width:.049em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord overline mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6755600000000002em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span><span style="top:-3.57756em"><span class="pstrut" style="height:3em"></span><span class="overline-line mtight" style="border-bottom-width:.049em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.67556em"><span class="pstrut" style="height:3em"></span><span class="mtight" style="height:.3em"><svg width="100%" height="0.3em" viewbox="0 0 2364 300" preserveaspectratio="none"><path d="M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5279619999999998em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.148212em"><span style="top:-2.6245540000000003em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8077799999999999em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span></span></span><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="accent-body" style="left:-.16666em"><span class="mtight">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.26778em"><span class="pstrut" style="height:2.7em"></span><span class="mtight" style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.50732em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9155600000000002em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mtight"><span class="mord overline mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6755600000000002em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.57756em"><span class="pstrut" style="height:3em"></span><span class="overline-line mtight" style="border-bottom-width:.049em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.67556em"><span class="pstrut" style="height:3em"></span><span class="mtight" style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9155600000000002em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mtight"><span class="mord overline mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6755600000000002em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.57756em"><span class="pstrut" style="height:3em"></span><span class="overline-line mtight" style="border-bottom-width:.049em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.67556em"><span class="pstrut" style="height:3em"></span><span class="mtight" style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5115539999999998em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-.5580760000000007em"><span class="pstrut" style="height:3.2007120000000002em"></span><span class="mord"><span class="mord text"><span class="mord"> </span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.69056em"><span class="pstrut" style="height:3em"></span><span style="height:.3em"><svg width="100%" height="0.3em" viewbox="0 0 2364 300" preserveaspectratio="none"><path d="M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.200712em"><span style="top:-2.6245540000000003em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8077799999999999em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span></span></span><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="accent-body" style="left:-.16666em"><span class="mtight">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.26778em"><span class="pstrut" style="height:2.7em"></span><span class="mtight" style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.50732em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9905600000000001em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span></span></span><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="accent-body" style="left:-.16666em"><span class="mtight">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.13056em"><span class="pstrut" style="height:2.7em"></span><span class="mtight" style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.3905600000000002em"><span class="pstrut" style="height:2.7em"></span><span class="mtight" style="height:.3em"><svg width="100%" height="0.3em" viewbox="0 0 2364 300" preserveaspectratio="none"><path d="M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9905600000000001em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span></span></span><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="accent-body" style="left:-.16666em"><span class="mtight">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.13056em"><span class="pstrut" style="height:2.7em"></span><span class="mtight" style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.3905600000000002em"><span class="pstrut" style="height:2.7em"></span><span class="mtight" style="height:.3em"><svg width="100%" height="0.3em" viewbox="0 0 2364 300" preserveaspectratio="none"><path d="M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5115539999999998em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.1541899999999994em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span></span></span></span></span></span></span></p><p>这就是所谓的 Leonard 应力，上次称为 Germano 恒等式？</p><p>分别对 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">\widehat{\tau_{ij}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9566680000000001em;vertical-align:-.286108em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.67056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">T_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 采用可压 Smagorinsky 模型：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">^</mo></mover><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mover accent="true"><msub><mi>τ</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo stretchy="true">^</mo></mover><mo>=</mo><msubsup><mi>C</mi><mi>s</mi><mn>2</mn></msubsup><mover accent="true"><msub><mi>α</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">^</mo></mover><mspace linebreak="newline"></mspace><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><msub><mi>T</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo>−</mo><msubsup><mi>C</mi><mi>s</mi><mn>2</mn></msubsup><mn>2</mn><mover accent="true"><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo stretchy="true">^</mo></mover><msup><mover accent="true"><mi mathvariant="normal">Δ</mi><mo stretchy="true">^</mo></mover><mn>2</mn></msup><mi mathvariant="normal">∣</mi><mover accent="true"><mi>S</mi><mo>¨</mo></mover><mi mathvariant="normal">∣</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>S</mi><mo>¨</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><msub><mover accent="true"><mi>S</mi><mo>¨</mo></mover><mrow><mi>k</mi><mi>k</mi></mrow></msub><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>C</mi><mi>s</mi><mn>2</mn></msubsup><msub><mi>β</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mspace linebreak="newline"></mspace><mi>w</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>e</mi><mo>:</mo><mover accent="true"><mi>f</mi><mo>¨</mo></mover><mo>=</mo><mfrac><mover accent="true"><mover accent="true"><mrow><mi>ρ</mi><mi>f</mi></mrow><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover><mover accent="true"><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo stretchy="true">^</mo></mover></mfrac><mspace linebreak="newline"></mspace><msub><mi>α</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo>−</mo><mn>2</mn><mstyle mathcolor="red"><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><msup><mover accent="true"><mi mathvariant="normal">Δ</mi><mo>ˉ</mo></mover><mn>2</mn></msup><mi mathvariant="normal">∣</mi><mover accent="true"><mi>S</mi><mo stretchy="true">~</mo></mover><mi mathvariant="normal">∣</mi></mstyle><mo stretchy="false">(</mo><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mover accent="true"><msub><mi>S</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo stretchy="true">~</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msub><mi>β</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo>−</mo><mn>2</mn><mover accent="true"><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo stretchy="true">^</mo></mover><msup><mover accent="true"><mi mathvariant="normal">Δ</mi><mo stretchy="true">^</mo></mover><mn>2</mn></msup><mi mathvariant="normal">∣</mi><mover accent="true"><mi>S</mi><mo>¨</mo></mover><mi mathvariant="normal">∣</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>S</mi><mo>¨</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><msub><mover accent="true"><mi>S</mi><mo>¨</mo></mover><mrow><mi>k</mi><mi>k</mi></mrow></msub><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\widehat {\tau_{ij}}-\frac{1}{3}\widehat{\tau_{kk}}=C_s^2\widehat{\alpha_{ij}} \\ T_{ij}-\frac{1}{3} {T_{kk}}\delta_{ij}=-C_s^22\widehat{\bar\rho} \widehat \Delta^2|\ddot S|(\ddot S_{ij}-\frac{1}{3}\ddot S_{kk}\delta_{ij})=C_s^2\beta_{ij}\\ where: \ddot f=\frac{\widehat{\overline{\rho f}}}{\widehat{\bar\rho}}\\ \alpha_{ij} =- 2\textcolor{red}{\bar \rho {\bar \Delta }^2 |\widetilde S|}(\widetilde {S_{ij}} - \frac{1}{3}\widetilde {S_{kk}}\delta _{ij})\\ \beta_{ij}=-2\widehat{\bar\rho} \widehat \Delta^2|\ddot S|(\ddot S_{ij}-\frac{1}{3}\ddot S_{kk}\delta_{ij})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9566680000000001em;vertical-align:-.286108em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.67056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6705599999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.150216em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-2.4530000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.67056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.0037em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.209438em;vertical-align:-.286108em"></span><span class="mord">−</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-2.4530000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mord">2</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8077799999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.56778em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.92333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord">Δ</span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9201900000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em">S</span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">¨</span></span></span></span></span></span><span class="mord">∣</span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9201900000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em">S</span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">¨</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9201900000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em">S</span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">¨</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.150216em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-2.4530000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05278em">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05278em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.02691em">w</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.12574em;vertical-align:-.19444em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9313em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span></span><span style="top:-3.26344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.08332999999999999em">¨</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.70366em;vertical-align:-.89222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8114400000000002em"><span style="top:-2.4366600000000003em"><span class="pstrut" style="height:3.13444em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8077799999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.56778em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span style="top:-3.36444em"><span class="pstrut" style="height:3.13444em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.81144em"><span class="pstrut" style="height:3.13444em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1344400000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.89444em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord mathdefault" style="margin-right:.10764em">f</span></span></span><span style="top:-3.81444em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.8944400000000003em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.89222em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.0037em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.310226em;vertical-align:-.286108em"></span><span class="mord">−</span><span class="mord">2</span><span class="mord accent" style="color:red"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="color:red">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em"><span style="color:red">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord" style="color:red"><span class="mord" style="color:red"><span class="mord accent" style="color:red"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8201099999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord" style="color:red">Δ</span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.25em"><span style="color:red">ˉ</span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0241179999999999em"><span style="top:-3.27301em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight" style="color:red"><span class="mord mtight" style="color:red">2</span></span></span></span></span></span></span></span><span class="mord" style="color:red">∣</span><span class="mord accent" style="color:red"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em;color:red">S</span></span><span class="svg-align" style="width:calc(100% - .16668em);margin-left:.16668em;top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="color:red;height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span><span class="mord" style="color:red">∣</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05278em">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05278em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.209438em;vertical-align:-.286108em"></span><span class="mord">−</span><span class="mord">2</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8077799999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.56778em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.92333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord">Δ</span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9201900000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em">S</span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">¨</span></span></span></span></span></span><span class="mord">∣</span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9201900000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em">S</span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">¨</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9201900000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em">S</span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">¨</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>由 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mover accent="true"><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">L_{ij} = T_{ij} - \widehat {\tau _{ij}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.9566680000000001em;vertical-align:-.286108em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.67056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span>，我们可以得到：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mover accent="true"><msub><mi>L</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo stretchy="true">^</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msubsup><mi>C</mi><mi>s</mi><mn>2</mn></msubsup><msub><mi>β</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><msubsup><mi>C</mi><mi>s</mi><mn>2</mn></msubsup><mover accent="true"><msub><mi>α</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">^</mo></mover><mo>=</mo><msubsup><mi>C</mi><mi>s</mi><mn>2</mn></msubsup><msub><mi>M</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mspace linebreak="newline"></mspace><mi>w</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>e</mi><mo>:</mo><msub><mi>M</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>β</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mover accent="true"><msub><mi>α</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">{L_{ij}} - \frac{1}{3}\widehat {L_{kk}}{\delta _{ij}} = C_s^2{\beta _{ij}} - C_s^2\widehat {\alpha _{ij}} = C_s^2{M_{ij}}\\ where: M_{ij}=\beta_{ij}-\widehat {\alpha _{ij}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.92333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.150216em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-2.4530000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05278em">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05278em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.150216em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-2.4530000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.67056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.0037em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.150216em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-2.4530000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.02691em">w</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05278em">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05278em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.9566680000000001em;vertical-align:-.286108em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.67056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.0037em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></p><p>方程组是超定的，因此上式应该看作是在某种平均意义上成立。</p><p><a href="https://link.springer.com/article/10.1007/PL00020896" target="_blank" rel="external nofollow noopener noreferrer">Martín.2000</a>采用<a href="https://aip.scitation.org/doi/10.1063/1.858280" target="_blank" rel="external nofollow noopener noreferrer">Lilly.1992</a>提出的最小二乘法，使式（15）的误差最小化，同时采用对均匀方向平均的形式：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>C</mi><mi>s</mi><mn>2</mn></msubsup><mo>=</mo><mfrac><mrow><mo fence="true">⟨</mo><mrow><msub><mi>L</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>M</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mo fence="true">⟩</mo></mrow><mrow><mo fence="true">⟨</mo><mrow><msub><mi>M</mi><mrow><mi>k</mi><mi>l</mi></mrow></msub><msub><mi>M</mi><mrow><mi>k</mi><mi>l</mi></mrow></msub></mrow><mo fence="true">⟩</mo></mrow></mfrac><mtext> </mtext><mo separator="true">,</mo><mtext> </mtext><msub><mi>C</mi><mi>I</mi></msub><mo>=</mo><mfrac><mrow><mo fence="true">⟨</mo><msub><mi>L</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo fence="true">⟩</mo></mrow><mrow><mo fence="true">⟨</mo><mrow><mi>β</mi><mo>−</mo><mover accent="true"><mi>α</mi><mo stretchy="true">^</mo></mover></mrow><mo fence="true">⟩</mo></mrow></mfrac><mtext> </mtext><mo separator="true">,</mo><mtext> </mtext><mi>β</mi><mo>=</mo><mn>2</mn><msup><mover accent="true"><mi mathvariant="normal">Δ</mi><mo stretchy="true">^</mo></mover><mn>2</mn></msup><mover accent="true"><mover accent="true"><mi>ρ</mi><mo stretchy="true">‾</mo></mover><mo stretchy="true">^</mo></mover><mi mathvariant="normal">∣</mi><mover accent="true"><mi>S</mi><mo>¨</mo></mover><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">C_s^2 = \frac{\left\langle {L_{ij}{M_{ij}}} \right\rangle }{\left\langle {M_{kl}{M_{kl}}} \right\rangle }{\text{ }},{\text{ }}{C_I} = \frac{\left\langle {L_{kk}} \right\rangle }{\left\langle {\beta - \widehat \alpha } \right\rangle }{\text{ }},{\text{ }}\beta = 2{\widehat \Delta ^2}\widehat {\overline \rho }|\ddot S|^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1111079999999998em;vertical-align:-.247em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-2.4530000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-.936em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0">⟨</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.01968em">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.01968em">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">⟩</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0">⟨</span><span class="mord"><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">⟩</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord text"><span class="mord"> </span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord text"><span class="mord"> </span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.07847em">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-.936em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0">⟨</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05278em">β</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.67056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.0037em">α</span></span><span class="svg-align" style="width:calc(100% - .05556em);margin-left:.05556em;top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">⟩</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0">⟨</span><span class="mord"><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">⟩</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord text"><span class="mord"> </span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord text"><span class="mord"> </span></span></span><span class="mord mathdefault" style="margin-right:.05278em">β</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.17333em;vertical-align:-.25em"></span><span class="mord">2</span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.92333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord">Δ</span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.87056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.63056em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9201900000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em">S</span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">¨</span></span></span></span></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p><p>这就是可压 Smagorinsky 模型中需要的。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><msub><mi>τ</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo>−</mo><mn>2</mn><mstyle mathcolor="red"><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo stretchy="false">(</mo><msub><mi>C</mi><mi>s</mi></msub><mover accent="true"><mi mathvariant="normal">Δ</mi><mo>ˉ</mo></mover><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mi mathvariant="normal">∣</mi><mover accent="true"><mi>S</mi><mo stretchy="true">~</mo></mover><mi mathvariant="normal">∣</mi></mstyle><mo stretchy="false">(</mo><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mover accent="true"><msub><mi>S</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo stretchy="true">~</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>C</mi><mi>s</mi><mn>2</mn></msubsup><msub><mi>α</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>τ</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo>=</mo><msub><mi>C</mi><mi>I</mi></msub><mn>2</mn><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><msup><mover accent="true"><mi mathvariant="normal">Δ</mi><mo>ˉ</mo></mover><mn>2</mn></msup><mi mathvariant="normal">∣</mi><mover accent="true"><mi>S</mi><mo stretchy="true">~</mo></mover><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup><mo>=</mo><msub><mi>C</mi><mi>I</mi></msub><mi>α</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{l} \tau _{ij} - \frac{1}{3}\tau _{kk}\delta _{ij} = - 2\textcolor{red}{\bar \rho (C_s{\bar \Delta })^2 |\widetilde S|}(\widetilde {S_{ij}} - \frac{1}{3}\widetilde {S_{kk}}\delta _{ij}) = C_s^2\alpha _{ij}\\ \tau _{kk} = C_I 2\bar \rho {\bar \Delta }^2|\widetilde S{|^2} = {C_I}\alpha \end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.687448em;vertical-align:-1.093724em"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.593724em"><span style="top:-3.6745119999999996em"><span class="pstrut" style="height:3.0241179999999996em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord">2</span><span class="mord accent" style="color:red"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="color:red">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em"><span style="color:red">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mopen" style="color:red">(</span><span class="mord" style="color:red"><span class="mord mathdefault" style="margin-right:.07153em;color:red">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight" style="color:red"><span class="mord mathdefault mtight" style="color:red">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord" style="color:red"><span class="mord accent" style="color:red"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8201099999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord" style="color:red">Δ</span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.25em"><span style="color:red">ˉ</span></span></span></span></span></span></span></span><span class="mclose" style="color:red"><span class="mclose" style="color:red">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight" style="color:red"><span class="mord mtight" style="color:red">2</span></span></span></span></span></span></span></span><span class="mord" style="color:red">∣</span><span class="mord accent" style="color:red"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em;color:red">S</span></span><span class="svg-align" style="width:calc(100% - .16668em);margin-left:.16668em;top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="color:red;height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span><span class="mord" style="color:red">∣</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.4530000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.0037em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-2.2903939999999996em"><span class="pstrut" style="height:3.0241179999999996em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.07847em">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">2</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8201099999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord">Δ</span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.25em">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0241179999999999em"><span style="top:-3.27301em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em">S</span></span><span class="svg-align" style="width:calc(100% - .16668em);margin-left:.16668em;top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.07847em">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.0037em">α</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.093724em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span></span></span></span></span></span></span></p><p>滤波宽度比 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi mathvariant="normal">Δ</mi><mo stretchy="true">^</mo></mover><mi mathvariant="normal">/</mi><mover accent="true"><mi mathvariant="normal">Δ</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\widehat \Delta /\overline \Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.17333em;vertical-align:-.25em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.92333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord">Δ</span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.24em"><svg width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span><span class="mord">/</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8833300000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord">Δ</span></span><span style="top:-3.80333em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span></span></span></span> 是动态模型中唯一需要给定的参数。</p>]]></content>
      
      
      <categories>
          
          <category> turbulence modelling </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LES </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>燃烧反应中的能量方程</title>
      <link href="/hEqn/"/>
      <url>/hEqn/</url>
      
        <content type="html"><![CDATA[<p>不同形式的能量方程，关于反应放热源项，绝对焓输运返方程无此源项，显焓输运方程的源项是生成焓乘以反应速率，温度输运方程的源项是绝对焓乘以反应速率。</p><a id="more"></a><h1 id="绝对焓的输运方程"><a class="markdownIt-Anchor" href="#绝对焓的输运方程"></a> 绝对焓的输运方程：</h1><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ρ</mi><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><mi>h</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>D</mi><mi>p</mi></mrow><mrow><mi>D</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi>J</mi><mo>+</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial \rho h}{\partial t}+\frac{\rho u_i h}{\partial x_i}=\frac{D p}{D t}+\nabla\cdot J+\tau_{ij}\frac{\partial u_i}{\partial x_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">ρ</span><span class="mord mathdefault">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.0463299999999998em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.76666em;vertical-align:-.08333em"></span><span class="mord mathdefault" style="margin-right:.09618em">J</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>J</mi><mo>=</mo><mi>k</mi><mi mathvariant="normal">∇</mi><mi>T</mi><mo>−</mo><mi>ρ</mi><mo>∑</mo><msub><mi>h</mi><mi>s</mi></msub><msub><mi>V</mi><mi>k</mi></msub><msub><mi>Y</mi><mi>k</mi></msub><mo>−</mo><mi>ρ</mi><mo>∑</mo><mi mathvariant="normal">Δ</mi><msubsup><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow><mn>0</mn></msubsup><msub><mi>V</mi><mi>k</mi></msub><msub><mi>Y</mi><mi>k</mi></msub><mo>=</mo><msub><mi>J</mi><mi>s</mi></msub><mo>−</mo><mi>ρ</mi><mo>∑</mo><mi mathvariant="normal">Δ</mi><msubsup><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow><mn>0</mn></msubsup><msub><mi>V</mi><mi>k</mi></msub><msub><mi>Y</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">J=k\nabla T-\rho\sum h_sV_kY_k-\rho\sum\Delta h_{f,k}^0 V_kY_k=J_s-\rho\sum\Delta h_{f,k}^0 V_kY_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.09618em">J</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.77777em;vertical-align:-.08333em"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mord">∇</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-.25001em"></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.2333239999999999em;vertical-align:-.4192159999999999em"></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.4168920000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4192159999999999em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.09618em">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.09618em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.2333239999999999em;vertical-align:-.4192159999999999em"></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.4168920000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4192159999999999em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><br>即 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>J</mi><mi>s</mi></msub><mo>=</mo><mi>k</mi><mi mathvariant="normal">∇</mi><mi>T</mi><mo>−</mo><mi>ρ</mi><mo>∑</mo><msub><mi>h</mi><mi>s</mi></msub><msub><mi>V</mi><mi>k</mi></msub><msub><mi>Y</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">J_s=k\nabla T-\rho\sum h_sV_kY_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.09618em">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.09618em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.77777em;vertical-align:-.08333em"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mord">∇</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-.25001em"></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.09618em">J</span></span></span></span><br>显焓 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>s</mi></msub><mo>=</mo><mi>h</mi><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mrow><mi mathvariant="normal">Δ</mi><msubsup><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow><mn>0</mn></msubsup><msub><mi>Y</mi><mi>k</mi></msub></mrow></mrow><annotation encoding="application/x-tex">h_s=h-\sum_{k = 1}^N {\Delta h_{f,k}^0{Y_k}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.77777em;vertical-align:-.08333em"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.4004469999999998em;vertical-align:-.4192159999999999em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.981231em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.4168920000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4192159999999999em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></span> 代入绝对焓的输运方程，得到：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∂</mi><mi>ρ</mi><mfrac><mrow><msub><mi>h</mi><mi>s</mi></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><mi mathvariant="normal">Δ</mi><msubsup><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow><mn>0</mn></msubsup><msub><mi>Y</mi><mi>k</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∂</mi><mfrac><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="false">(</mo><msub><mi>h</mi><mi>s</mi></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><mi mathvariant="normal">Δ</mi><msubsup><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow><mn>0</mn></msubsup><msub><mi>Y</mi><mi>k</mi></msub></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>D</mi><mi>p</mi></mrow><mrow><mi>D</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi>J</mi><mo>+</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\partial\rho\frac{ h_s+\sum_{k = 1}^N {\Delta h_{f,k}^0{Y_k}}}{\partial t}+\partial\frac{\rho u_i (h_s+\sum_{k = 1}^N {\Delta h_{f,k}^0{Y_k}})}{\partial x_i} =\frac{D p}{ D t}+\nabla\cdot J+\tau_{ij}\frac{\partial u_i}{\partial x_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.476447em;vertical-align:-.686em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.790447em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.809216em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.981231em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.4168920000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4192159999999999em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.6264469999999998em;vertical-align:-.8360000000000001em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.790447em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.809216em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.981231em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.4168920000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4192159999999999em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.0463299999999998em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.76666em;vertical-align:-.08333em"></span><span class="mord mathdefault" style="margin-right:.09618em">J</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>移项，得到：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ρ</mi><msub><mi>h</mi><mi>s</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∂</mi><mfrac><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><msub><mi>h</mi><mi>s</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mfrac><mrow><mi>D</mi><mi>p</mi></mrow><mrow><mi>D</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi>J</mi><mo>+</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>−</mo><mi mathvariant="normal">∂</mi><mi>ρ</mi><mfrac><mrow><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mrow><mi mathvariant="normal">Δ</mi><msubsup><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow><mn>0</mn></msubsup><msub><mi>Y</mi><mi>k</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>−</mo><mi mathvariant="normal">∂</mi><mfrac><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mrow><mi mathvariant="normal">Δ</mi><msubsup><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow><mn>0</mn></msubsup><msub><mi>Y</mi><mi>k</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mfrac><mrow><mi>D</mi><mi>p</mi></mrow><mrow><mi>D</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><msub><mi>J</mi><mi>s</mi></msub><mo>+</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>−</mo><mi mathvariant="normal">∂</mi><mi>ρ</mi><mfrac><mrow><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mrow><mi mathvariant="normal">Δ</mi><msubsup><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow><mn>0</mn></msubsup><msub><mi>Y</mi><mi>k</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>−</mo><mi mathvariant="normal">∂</mi><mfrac><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mrow><mi mathvariant="normal">Δ</mi><msubsup><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow><mn>0</mn></msubsup><msub><mi>Y</mi><mi>k</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>−</mo><mi mathvariant="normal">∂</mi><mfrac><mrow><mo stretchy="false">(</mo><mi>ρ</mi><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mrow><mi mathvariant="normal">Δ</mi><msubsup><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow><mn>0</mn></msubsup><msub><mi>V</mi><mrow><mi>k</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub><msub><mi>Y</mi><mi>k</mi></msub></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mfrac><mrow><mi>D</mi><mi>p</mi></mrow><mrow><mi>D</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><msub><mi>J</mi><mi>s</mi></msub><mo>+</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>−</mo><mo>∑</mo><mi mathvariant="normal">Δ</mi><msubsup><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow><mn>0</mn></msubsup><mo stretchy="false">[</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ρ</mi><msub><mi>Y</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∂</mi><mfrac><mrow><mi>ρ</mi><mo stretchy="false">(</mo><msub><mi>u</mi><mi>i</mi></msub><mo>+</mo><msub><mi>V</mi><mrow><mi>k</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub><mo stretchy="false">)</mo><msub><mi>Y</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mfrac><mrow><mi>D</mi><mi>p</mi></mrow><mrow><mi>D</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><msub><mi>J</mi><mi>s</mi></msub><mo>+</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>−</mo><mo>∑</mo><mi mathvariant="normal">Δ</mi><msubsup><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow><mn>0</mn></msubsup><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mfrac><mrow><mi>D</mi><mi>p</mi></mrow><mrow><mi>D</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><msub><mi>J</mi><mi>s</mi></msub><mo>+</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>T</mi></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{ll} &amp;\frac{\partial \rho h_s}{\partial t}+\partial\frac{\rho u_i h_s}{\partial x_i}\\ &amp;= \frac{D p}{ D t}+\nabla\cdot J + \tau_{ij}\frac{\partial u_i}{\partial x_j} - \partial\rho\frac{\sum_{k = 1}^N {\Delta h_{f,k}^0{Y_k}}}{\partial t} -\partial\frac{\rho u_i\sum_{k = 1}^N {\Delta h_{f,k}^0{Y_k}}}{\partial x_i}\\ &amp;= \frac{D p}{ D t}+\nabla\cdot J_s+\tau_{ij}\frac{\partial u_i}{\partial x_j}-\partial\rho\frac{\sum_{k = 1}^N {\Delta h_{f,k}^0{Y_k}}}{\partial t}-\partial\frac{\rho u_i\sum_{k = 1}^N {\Delta h_{f,k}^0{Y_k}}}{\partial x_i} -\partial\frac{(\rho\sum_{k = 1}^N{\Delta h_{f,k}^0V_{k,i}{Y_k}})}{\partial x_i}\\ &amp;= \frac{D p}{ D t}+\nabla\cdot J_s+\tau_{ij}\frac{\partial u_i}{\partial x_j}-\sum\Delta h_{f,k}^0[\frac{\partial\rho Y_k}{\partial t}+\partial\frac{\rho(u_i+V_{k,i})Y_k}{\partial x_i}]\\ &amp;= \frac{D p}{ D t}+\nabla\cdot J_s+\tau_{ij}\frac{\partial u_i}{\partial x_j}-\sum\Delta h_{f,k}^0\dot\omega_k\\ &amp;=\frac{D p}{ D t}+\nabla\cdot J_s+\tau_{ij}\frac{\partial u_i}{\partial x_j}+\dot\omega_T \end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9.477444em;vertical-align:-4.488721999999999em"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.988722000000001em"><span style="top:-7.307291000000001em"><span class="pstrut" style="height:3.250785em"></span><span class="mord"></span></span><span style="top:-5.611406000000001em"><span class="pstrut" style="height:3.250785em"></span><span class="mord"></span></span><span style="top:-3.818301000000001em"><span class="pstrut" style="height:3.250785em"></span><span class="mord"></span></span><span style="top:-2.2379010000000013em"><span class="pstrut" style="height:3.250785em"></span><span class="mord"></span></span><span style="top:-.7711420000000004em"><span class="pstrut" style="height:3.250785em"></span><span class="mord"></span></span><span style="top:.6956169999999993em"><span class="pstrut" style="height:3.250785em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.488721999999999em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.988722000000001em"><span style="top:-7.307291000000001em"><span class="pstrut" style="height:3.250785em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9322159999999999em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285719em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9322159999999999em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285719em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.44509999999999994em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-5.611406000000001em"><span class="pstrut" style="height:3.250785em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.924439em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord mathdefault" style="margin-right:.09618em">J</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8962079999999999em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.4101em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5423199999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.250785em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.60742em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9190928571428572em"><span style="top:-2.1785614285714283em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.32143857142857146em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mord mtight"><span class="mord mtight">Δ</span><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8913142857142857em"><span style="top:-2.214em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.42488571428571426em"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3487714285714287em;margin-left:-.22222em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15122857142857138em"><span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.250785em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.60742em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9190928571428572em"><span style="top:-2.1785614285714283em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.32143857142857146em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mord mtight"><span class="mord mtight">Δ</span><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8913142857142857em"><span style="top:-2.214em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.42488571428571426em"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3487714285714287em;margin-left:-.22222em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15122857142857138em"><span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.44509999999999994em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.818301000000001em"><span class="pstrut" style="height:3.250785em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.924439em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.09618em">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.09618em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8962079999999999em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.4101em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5423199999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.250785em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.60742em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9190928571428572em"><span style="top:-2.1785614285714283em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.32143857142857146em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mord mtight"><span class="mord mtight">Δ</span><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8913142857142857em"><span style="top:-2.214em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.42488571428571426em"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3487714285714287em;margin-left:-.22222em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15122857142857138em"><span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.250785em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.60742em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9190928571428572em"><span style="top:-2.1785614285714283em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.32143857142857146em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mord mtight"><span class="mord mtight">Δ</span><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8913142857142857em"><span style="top:-2.214em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.42488571428571426em"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3487714285714287em;margin-left:-.22222em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15122857142857138em"><span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.44509999999999994em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.250785em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.60742em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">ρ</span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9190928571428572em"><span style="top:-2.1785614285714283em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.32143857142857146em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mord mtight"><span class="mord mtight">Δ</span><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8913142857142857em"><span style="top:-2.214em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.42488571428571426em"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3487714285714287em;margin-left:-.22222em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29011428571428566em"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3487714285714287em;margin-left:-.22222em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15122857142857138em"><span></span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.44509999999999994em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.2379010000000013em"><span class="pstrut" style="height:3.250785em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.924439em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.09618em">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.09618em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8962079999999999em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.4101em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5423199999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.4168920000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4192159999999999em"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9322159999999999em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3487714285714287em;margin-left:-.22222em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15122857142857138em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.03808em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.51308em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3487714285714287em;margin-left:-.22222em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29011428571428566em"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3487714285714287em;margin-left:-.22222em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15122857142857138em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.44509999999999994em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">]</span></span></span><span style="top:-.7711420000000004em"><span class="pstrut" style="height:3.250785em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.924439em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.09618em">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.09618em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8962079999999999em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.4101em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5423199999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.4168920000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4192159999999999em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:.6956169999999993em"><span class="pstrut" style="height:3.250785em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.924439em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.09618em">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.09618em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8962079999999999em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.4101em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5423199999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.488721999999999em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span></span></span></span></span></span></span></p><p>其中：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>D</mi><mi>p</mi></mrow><mrow><mi>D</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>p</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><msub><mi>u</mi><mi>i</mi></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>p</mi></mrow><msub><mi>x</mi><mi>i</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\dfrac{D p}{D t}=\dfrac{\partial p}{\partial t}+u_i\dfrac{\partial p}{x_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0463299999999998em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>上边推导的最后一步，是由组分的输运方程得到的：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ρ</mi><msub><mi>Y</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∂</mi><mfrac><mrow><mi>ρ</mi><mo stretchy="false">(</mo><msub><mi>u</mi><mi>i</mi></msub><mo>+</mo><msub><mi>V</mi><mrow><mi>k</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub><mo stretchy="false">)</mo><msub><mi>Y</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\frac{\partial\rho Y_k}{\partial t}+\partial\frac{\rho(u_i+V_{k,i})Y_k}{\partial x_i}=\dot\omega_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.263em;vertical-align:-.8360000000000001em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.81786em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>T</mi></msub><mo>=</mo><mo>−</mo><mo>∑</mo><mi mathvariant="normal">Δ</mi><msubsup><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow><mn>0</mn></msubsup><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\dot\omega_T=-\sum\Delta h_{f,k}^0\dot\omega_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.81786em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.2333239999999999em;vertical-align:-.4192159999999999em"></span><span class="mord">−</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.4168920000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4192159999999999em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 这一项是燃烧热。</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Δ</mi><msubsup><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow><mn>0</mn></msubsup></mrow><annotation encoding="application/x-tex">\Delta h_{f,k}^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2333239999999999em;vertical-align:-.4192159999999999em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.4168920000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4192159999999999em"><span></span></span></span></span></span></span></span></span></span> 是组分 k 的化学焓（chemical），也叫生成焓（formation）。</p><p>viscous heating source term: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\tau_{ij}\frac{\partial u_i}{\partial x_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4385279999999998em;vertical-align:-.5423199999999999em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8962079999999999em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.4101em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5423199999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 这一项是粘性热。</p><h1 id="显焓的输运方程"><a class="markdownIt-Anchor" href="#显焓的输运方程"></a> 显焓的输运方程：</h1><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ρ</mi><msub><mi>h</mi><mi>s</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∂</mi><mfrac><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><msub><mi>h</mi><mi>s</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>D</mi><mi>p</mi></mrow><mrow><mi>D</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><msub><mi>J</mi><mi>s</mi></msub><mo>+</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\frac{\partial \rho h_s}{\partial t}+\partial\frac{\rho u_i h_s}{\partial x_i} =\frac{D p}{ D t}+\nabla\cdot J_s+\tau_{ij}\frac{\partial u_i}{\partial x_j}+\dot\omega_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.0463299999999998em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.09618em">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.09618em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.81786em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>J</mi><mi>s</mi></msub><mo>=</mo><mi>k</mi><mi mathvariant="normal">∇</mi><mi>T</mi><mo>−</mo><mi>ρ</mi><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>h</mi><mi>s</mi></msub><msub><mi>V</mi><mi>k</mi></msub><msub><mi>Y</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">J_s=k\nabla T-\rho\sum_{k = 1}^N h_sV_kY_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.09618em">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.09618em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.77777em;vertical-align:-.08333em"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mord">∇</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ρ</mi><msub><mi>h</mi><mi>s</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∂</mi><mfrac><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><msub><mi>h</mi><mi>s</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>D</mi><mi>p</mi></mrow><mrow><mi>D</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mo stretchy="false">(</mo><mi>k</mi><mi mathvariant="normal">∇</mi><mi>T</mi><mo>−</mo><mi>ρ</mi><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>h</mi><mi>s</mi></msub><msub><mi>V</mi><mi>k</mi></msub><msub><mi>Y</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\frac{\partial \rho h_s}{\partial t}+\partial\frac{\rho u_i h_s}{\partial x_i} =\frac{D p}{ D t}+\nabla\cdot (k\nabla T-\rho\sum_{k = 1}^N h_sV_kY_k)+\tau_{ij}\frac{\partial u_i}{\partial x_j}+\dot\omega_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.0463299999999998em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mord">∇</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.81786em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ρ</mi><msub><mi>h</mi><mi>s</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∂</mi><mfrac><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><msub><mi>h</mi><mi>s</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>D</mi><mi>p</mi></mrow><mrow><mi>D</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><mi>k</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>T</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">)</mo><mo>−</mo><mi mathvariant="normal">∂</mi><mfrac><mrow><mi>ρ</mi><mo>∑</mo><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><msub><mi>V</mi><mrow><mi>k</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub><msub><mi>Y</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>+</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\frac{\partial \rho h_s}{\partial t}+\partial\frac{\rho u_i h_s}{\partial x_i} = \frac{D p}{ D t} + \frac{\partial}{\partial x_i}(k\frac{\partial T}{\partial x_i})-\partial\frac{\rho\sum h_{s,k}V_{k,i}Y_k}{\partial x_i} +\tau_{ij}\frac{\partial u_i}{\partial x_j}+\dot\omega_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.0463299999999998em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.263em;vertical-align:-.8360000000000001em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.81786em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∂</mi><mfrac><mrow><mi>ρ</mi><mo>∑</mo><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><msub><mi>V</mi><mrow><mi>k</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub><msub><mi>Y</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\partial\frac{\rho\sum h_{s,k}V_{k,i}Y_k}{\partial x_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.48318em;vertical-align:-.44509999999999994em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.03808em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.51308em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mop op-symbol small-op mtight" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3487714285714287em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29011428571428566em"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3487714285714287em;margin-left:-.22222em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29011428571428566em"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3487714285714287em;margin-left:-.22222em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15122857142857138em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.44509999999999994em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 经常被视为0<br>所以显焓的输运方程：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ρ</mi><msub><mi>h</mi><mi>s</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∂</mi><mfrac><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><msub><mi>h</mi><mi>s</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>D</mi><mi>p</mi></mrow><mrow><mi>D</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><mi>κ</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>T</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">)</mo><mo>+</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\frac{\partial \rho h_s}{\partial t}+\partial\frac{\rho u_i h_s}{\partial x_i} = \frac{D p}{ Dt} + \frac{\partial}{\partial x_i}(\kappa\frac{\partial T}{\partial x_i}) +\tau_{ij}\frac{\partial u_i}{\partial x_j}+\dot\omega_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.0463299999999998em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathdefault">κ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.81786em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>κ</mi></mrow><annotation encoding="application/x-tex">\kappa</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">κ</span></span></span></span> 就是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">λ</span></span></span></span>，导热系数。<br>由于温度和焓的关系： <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi><mo>=</mo><mfrac><mi>λ</mi><msub><mi>C</mi><mi>p</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\alpha=\frac{\lambda}{C_p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.0037em">α</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.4224279999999998em;vertical-align:-.5423199999999999em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8801079999999999em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.07153em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">λ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5423199999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>， 代入上式，得：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ρ</mi><msub><mi>h</mi><mi>s</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∂</mi><mfrac><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><msub><mi>h</mi><mi>s</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>D</mi><mi>p</mi></mrow><mrow><mi>D</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><mi>α</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mi>s</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">)</mo><mo>+</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\frac{\partial \rho h_s}{\partial t}+\partial\frac{\rho u_i h_s}{\partial x_i} = \frac{D p}{ D t} + \frac{\partial}{\partial x_i}(\alpha\frac{\partial h_s}{\partial x_i}) +\tau_{ij}\frac{\partial u_i}{\partial x_j}+\dot\omega_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.0463299999999998em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.0037em">α</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.81786em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><h1 id="温度的输运方程"><a class="markdownIt-Anchor" href="#温度的输运方程"></a> 温度的输运方程:</h1><p>显焓的输运方程：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ρ</mi><mfrac><mrow><mi>d</mi><msub><mi>h</mi><mi>s</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ρ</mi><msub><mi>h</mi><mi>s</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∂</mi><mfrac><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><msub><mi>h</mi><mi>s</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>D</mi><mi>p</mi></mrow><mrow><mi>D</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><mi>k</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>T</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">)</mo><mo>−</mo><mi mathvariant="normal">∂</mi><mfrac><mrow><mi>ρ</mi><mo>∑</mo><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><msub><mi>V</mi><mrow><mi>k</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub><msub><mi>Y</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>+</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\rho\frac{d h_s}{dt}=\frac{\partial \rho h_s}{\partial t}+\partial\frac{\rho u_i h_s}{\partial x_i} = \frac{D p}{ D t} + \frac{\partial}{\partial x_i}(k\frac{\partial T}{\partial x_i})-\partial\frac{\rho\sum h_{s,k}V_{k,i}Y_k}{\partial x_i} +\tau_{ij}\frac{\partial u_i}{\partial x_j}+\dot\omega_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.0463299999999998em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.263em;vertical-align:-.8360000000000001em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.81786em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>s</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>Y</mi><mi>k</mi></msub><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">h_s=\sum_{k = 1}^N Y_k{h_{s,k}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>代入显焓输运方程得到：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ρ</mi><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>Y</mi><mi>k</mi></msub><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>D</mi><mi>p</mi></mrow><mrow><mi>D</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><mi>k</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>T</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">)</mo><mo>−</mo><mi mathvariant="normal">∂</mi><mfrac><mrow><mi>ρ</mi><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><msub><mi>V</mi><mrow><mi>k</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub><msub><mi>Y</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>+</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\rho\frac{d }{dt}\sum_{k = 1}^N Y_k{h_{s,k}} = \frac{D p}{ D t} + \frac{\partial}{\partial x_i}(k\frac{\partial T}{\partial x_i})-\partial\frac{\rho\sum_{k = 1}^N h_{s,k}V_{k,i}Y_k}{\partial x_i} +\tau_{ij}\frac{\partial u_i}{\partial x_j}+\dot\omega_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.0463299999999998em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.5069410000000003em;vertical-align:-.8360000000000001em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.670941em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.6897100000000003em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.981231em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.81786em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p>方程第一项：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ρ</mi><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>k</mi></msub><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mi>ρ</mi><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo stretchy="false">(</mo><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><msub><mi>Y</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>ρ</mi><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo stretchy="false">(</mo><msub><mi>Y</mi><mi>k</mi></msub><mfrac><mrow><mi>d</mi><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo stretchy="false">)</mo><mo>+</mo><mi>ρ</mi><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mfrac><mrow><mi>d</mi><msub><mi>Y</mi><mi>k</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\rho\frac{d }{dt}\sum_{k = 1}^N (Y_k{h_{s,k}})=\rho\sum_{k = 1}^N \frac{d}{dt}(h_{s,k}Y_k)=\rho\sum_{k = 1}^N (Y_k\frac{dh_{s,k}}{dt})+\rho\sum_{k = 1}^N h_{s,k}\frac{dY_k}{dt}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>将 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mo>=</mo><msubsup><mo>∫</mo><mrow><mi>T</mi><mn>0</mn></mrow><mi>T</mi></msubsup><msub><mi>C</mi><mrow><mi>p</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mi>d</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">h_{s,k}=\int_{T0}^TC_{p,k}dT</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.392051em;vertical-align:-.35582em"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:.19445em;position:relative;top:-.0005599999999999772em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.036231em"><span style="top:-2.34418em;margin-left:-.19445em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2579000000000002em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35582em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span> 代入上式，得到：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><mi>ρ</mi><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>Y</mi><mi>k</mi></msub><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><msubsup><mo>∫</mo><mrow><mi>T</mi><mn>0</mn></mrow><mi>T</mi></msubsup><msub><mi>C</mi><mrow><mi>p</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mi>d</mi><mi>T</mi><mo>+</mo><mi>ρ</mi><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mfrac><mrow><mi>d</mi><msub><mi>Y</mi><mi>k</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>ρ</mi><mfrac><mrow><mi>d</mi><msubsup><mo>∫</mo><mrow><mi>T</mi><mn>0</mn></mrow><mi>T</mi></msubsup><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>Y</mi><mi>k</mi></msub><msub><mi>C</mi><mrow><mi>p</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mi>d</mi><mi>T</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi>ρ</mi><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mfrac><mrow><mi>d</mi><msub><mi>Y</mi><mi>k</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">=\rho\sum_{k = 1}^N Y_k\frac{d}{dt}\int_{T0}^TC_{p,k}dT+\rho\sum_{k = 1}^N h_{s,k}\frac{dY_k}{dt}=\rho\frac{d\int_{T0}^T\sum_{k = 1}^N Y_kC_{p,k}dT}{dt}+\rho\sum_{k = 1}^N h_{s,k}\frac{dY_k}{dt}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:.44445em;position:relative;top:-.0011249999999999316em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5912310000000005em"><span style="top:-1.7880500000000001em;margin-left:-.44445em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.812900000000001em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.9119499999999999em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.468051em;vertical-align:-.686em"></span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.782051em"><span style="top:-2.350231em"><span class="pstrut" style="height:3.036231em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.266231em"><span class="pstrut" style="height:3.036231em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.782051em"><span class="pstrut" style="height:3.036231em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:.19445em;position:relative;top:-.0005599999999999772em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.036231em"><span style="top:-2.34418em;margin-left:-.19445em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2579000000000002em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35582em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.981231em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>又有 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mi>p</mi></msub><mo>=</mo><mo>∑</mo><msub><mi>Y</mi><mi>k</mi></msub><msub><mi>C</mi><mrow><mi>p</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_p=\sum Y_k{C_{p,k}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></span>， 因此：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><mi>ρ</mi><mfrac><mrow><mi>d</mi><msubsup><mo>∫</mo><mrow><mi>T</mi><mn>0</mn></mrow><mi>T</mi></msubsup><msub><mi>C</mi><mi>p</mi></msub><mi>d</mi><mi>T</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi>ρ</mi><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mfrac><mrow><mi>d</mi><msub><mi>Y</mi><mi>k</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>ρ</mi><msub><mi>C</mi><mi>p</mi></msub><mfrac><mrow><mi>d</mi><mi>T</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi>ρ</mi><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mfrac><mrow><mi>d</mi><msub><mi>Y</mi><mi>k</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">=\rho\frac{d\int_{T0}^TC_pdT}{dt}+\rho\sum_{k = 1}^N h_{s,k}\frac{dY_k}{dt}=\rho C_p\frac{dT}{dt}+\rho\sum_{k = 1}^N h_{s,k}\frac{dY_k}{dt}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.468051em;vertical-align:-.686em"></span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.782051em"><span style="top:-2.350231em"><span class="pstrut" style="height:3.036231em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.266231em"><span class="pstrut" style="height:3.036231em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.782051em"><span class="pstrut" style="height:3.036231em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:.19445em;position:relative;top:-.0005599999999999772em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.036231em"><span style="top:-2.34418em;margin-left:-.19445em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2579000000000002em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35582em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>接下来呢？</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ρ</mi><msub><mi>C</mi><mi>p</mi></msub><mfrac><mrow><mi>d</mi><mi>T</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi>ρ</mi><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mfrac><mrow><mi>d</mi><msub><mi>Y</mi><mi>k</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>p</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><mi>k</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>T</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">)</mo><mo>−</mo><mi mathvariant="normal">∂</mi><mfrac><mrow><mi>ρ</mi><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><msub><mi>V</mi><mrow><mi>k</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub><msub><mi>Y</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>+</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\rho C_p\frac{dT}{dt}+\rho\sum_{k = 1}^N h_{s,k}\frac{dY_k}{dt}=\frac{\partial p}{ \partial t} + \frac{\partial}{\partial x_i}(k\frac{\partial T}{\partial x_i})-\partial\frac{\rho\sum_{k = 1}^N h_{s,k}V_{k,i}Y_k}{\partial x_i} +\tau_{ij}\frac{\partial u_i}{\partial x_j}+\dot\omega_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.5069410000000003em;vertical-align:-.8360000000000001em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.670941em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.6897100000000003em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.981231em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.81786em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p>把组分输运方程： <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ρ</mi><mfrac><mrow><mi>d</mi><msub><mi>Y</mi><mi>k</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mi>ρ</mi><msub><mi>V</mi><mrow><mi>k</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub><msub><mi>Y</mi><mi>k</mi></msub><mo>+</mo><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\rho\frac{dY_k}{dt}=-\frac{\partial}{\partial x_i}\rho V_{k,i}Y_k+\dot\omega_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2469679999999999em;vertical-align:-.345em"></span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9019679999999999em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.41586em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3487714285714287em;margin-left:-.22222em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15122857142857138em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.325208em;vertical-align:-.44509999999999994em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8801079999999999em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.44509999999999994em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.81786em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 代入上式左边第二项，得到：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ρ</mi><msub><mi>C</mi><mi>p</mi></msub><mfrac><mrow><mi>d</mi><mi>T</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>p</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><mi>k</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>T</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">)</mo><mo>+</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\rho C_p\frac{dT}{dt}+\sum_{k = 1}^N h_{s,k}\dot\omega_k=\frac{\partial p}{ \partial t} + \frac{\partial}{\partial x_i}(k\frac{\partial T}{\partial x_i}) +\tau_{ij}\frac{\partial u_i}{\partial x_j}+\dot\omega_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.81786em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p>移项，得：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ρ</mi><msub><mi>C</mi><mi>p</mi></msub><mfrac><mrow><mi>d</mi><mi>T</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>D</mi><mi>p</mi></mrow><mrow><mi>D</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><mi>κ</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>T</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">)</mo><mo>+</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><msubsup><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>T</mi><mo mathvariant="normal">′</mo></msubsup></mrow><annotation encoding="application/x-tex">\rho C_p\frac{dT}{dt}=\frac{D p}{ D t}+\frac{\partial}{\partial x_i}(\kappa\frac{\partial T}{\partial x_i}) +\tau_{ij}\frac{\partial u_i}{\partial x_j}+\dot\omega&#x27;_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.0463299999999998em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathdefault">κ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-.247em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8018919999999999em"><span style="top:-2.4530000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>T</mi><mo mathvariant="normal">′</mo></msubsup><mo>=</mo><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>T</mi></msub><mo>−</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi mathvariant="normal">Δ</mi><msub><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub><mo>−</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>h</mi><mi>k</mi></msub><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\dot\omega^\prime_T =\dot\omega_T-\sum_{k = 1}^N h_{s,k}\dot\omega_k =-\sum_{k = 1}^N\Delta h_{f,k}\dot\omega_k-\sum_{k = 1}^N h_{s,k}\dot\omega_k =-\sum_{k = 1}^N h_k\dot \omega_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-.247em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8018919999999999em"><span style="top:-2.4530000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.81786em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mord">−</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mord">−</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\dot\omega_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.81786em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>T</mi><mo mathvariant="normal">′</mo></msubsup></mrow><annotation encoding="application/x-tex">\dot\omega^\prime_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.027223em;vertical-align:-.275331em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-2.424669em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.275331em"><span></span></span></span></span></span></span></span></span></span> 的关系，来自 Poinsot 的书：<br>These two terms are both called heat release so that different authors use the same term for different quantities. They differ by a small amount due to the contribution of sensible enthalpy terms <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">h_{s,k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> . Section 1.2.2 shows that they are equal when the heat capacities <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>p</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{p,k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> are supposed equal for all species.</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>T</mi><mo mathvariant="normal">′</mo></msubsup><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>h</mi><mi>k</mi></msub><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub><mo>−</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi mathvariant="normal">Δ</mi><msubsup><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow><mn>0</mn></msubsup><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub><mo>=</mo><mo>−</mo><msub><mi>h</mi><mi>s</mi></msub><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub><mo>−</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi mathvariant="normal">Δ</mi><msubsup><mi>h</mi><mrow><mi>f</mi><mo separator="true">,</mo><mi>k</mi></mrow><mn>0</mn></msubsup><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub><mo>=</mo><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>T</mi></msub><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\dot\omega^\prime_T=-\sum_{k = 1}^N h_k\dot\omega_k=-\sum_{k = 1}^N h_{s,k}\dot\omega_k-\sum_{k = 1}^N\Delta h_{f,k}^0\dot\omega_k=-h_s\sum_{k = 1}^N\dot\omega_k-\sum_{k = 1}^N \Delta h_{f,k}^0\dot\omega_k=\dot\omega_T\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-.247em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8018919999999999em"><span style="top:-2.4530000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mord">−</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mord">−</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.864108em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mord">−</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.864108em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.81786em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace newline"></span></span></span></span></p><p>because <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mo>=</mo><msubsup><mo>∫</mo><msub><mi>T</mi><mn>0</mn></msub><mi>T</mi></msubsup><msub><mi>C</mi><mrow><mi>p</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mi>d</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">h_{s,k}=\int_{T_0}^T C_{p,k}dT</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.4921509999999998em;vertical-align:-.45592em"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:.19445em;position:relative;top:-.0005599999999999772em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.036231em"><span style="top:-2.34418em;margin-left:-.19445em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31731428571428577em"><span style="top:-2.357em;margin-left:-.13889em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.2579000000000002em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.45592em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span>.</p><p>if <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>p</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{p,k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> are supposed equal for all species, then so do <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">h_{s,k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>, then <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msub><mi>h</mi><mrow><mi>s</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub><mo>=</mo><msub><mi>h</mi><mi>s</mi></msub><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\sum_{k = 1}^N h_{s,k}\dot\omega_k=h_s\sum_{k = 1}^N \dot\omega_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2809409999999999em;vertical-align:-.29971000000000003em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.981231em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.2809409999999999em;vertical-align:-.29971000000000003em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.981231em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sum_{k = 1}^N\dot\omega_k =0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2809409999999999em;vertical-align:-.29971000000000003em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.981231em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span></span></span></span>, therefore <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>s</mi></msub><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>k</mi></msub><mtext> </mtext><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">h_s\sum_{k = 1}^N \dot\omega_k\ =0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2809409999999999em;vertical-align:-.29971000000000003em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.981231em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mspace"> </span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span></span></span></span></p><h1 id="reactingfoam-中的能量方程"><a class="markdownIt-Anchor" href="#reactingfoam-中的能量方程"></a> reactingFoam 中的能量方程</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">fvScalarMatrix EEqn</span><br><span class="line">(</span><br><span class="line">    fvm::ddt(rho, he) + mvConvection-&gt;fvmDiv(phi, he)</span><br><span class="line">  + fvc::ddt(rho, K) + fvc::div(phi, K)</span><br><span class="line">  + (</span><br><span class="line">        he.name() &#x3D;&#x3D; &quot;e&quot;</span><br><span class="line">      ? fvc::div</span><br><span class="line">        (</span><br><span class="line">            fvc::absolute(phi&#x2F;fvc::interpolate(rho), U),</span><br><span class="line">            p,</span><br><span class="line">            &quot;div(phiv,p)&quot;</span><br><span class="line">        )</span><br><span class="line">      : -dpdt</span><br><span class="line">    )</span><br><span class="line">  - fvm::laplacian(turbulence-&gt;alphaEff(), he)</span><br><span class="line"> &#x3D;&#x3D;</span><br><span class="line">    Qdot</span><br><span class="line">  + fvOptions(rho, he)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>其中 <code>Qdot = reaction-&gt;Qdot();</code>，然后在燃烧模型中：<code>Qdot.ref() = this-&gt;chemistryPtr_-&gt;Qdot();</code>。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">template&lt;class ReactionThermo, class ThermoType&gt;</span><br><span class="line">Foam::tmp&lt;Foam::volScalarField&gt;</span><br><span class="line">Foam::StandardChemistryModel&lt;ReactionThermo, ThermoType&gt;::Qdot() const</span><br><span class="line">&#123;</span><br><span class="line">    tmp&lt;volScalarField&gt; tQdot</span><br><span class="line">    (</span><br><span class="line">        new volScalarField</span><br><span class="line">        (</span><br><span class="line">            IOobject</span><br><span class="line">            (</span><br><span class="line">                ......</span><br><span class="line">            ),</span><br><span class="line">            this-&gt;mesh_,</span><br><span class="line">            dimensionedScalar(&quot;zero&quot;, dimEnergy&#x2F;dimVolume&#x2F;dimTime, 0)</span><br><span class="line">        )</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    if (this-&gt;chemistry_)</span><br><span class="line">    &#123;</span><br><span class="line">        scalarField&amp; Qdot &#x3D; tQdot.ref();</span><br><span class="line"></span><br><span class="line">        forAll(Y_, i)</span><br><span class="line">        &#123;</span><br><span class="line">            forAll(Qdot, celli)</span><br><span class="line">            &#123;</span><br><span class="line">                const scalar hi &#x3D; specieThermo_[i].Hc();</span><br><span class="line">                Qdot[celli] -&#x3D; hi*RR_[i][celli];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return tQdot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>动能输运方程：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ρ</mi><mi>K</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∂</mi><mfrac><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><mi>K</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><msub><mi>u</mi><mi>j</mi></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>σ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial \rho K}{\partial t}+\partial\frac{\rho u_i K}{\partial x_i}=u_j\frac{\partial \sigma_{ij}}{\partial x_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">ρ</span><span class="mord mathdefault" style="margin-right:.07153em">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.1963299999999997em;vertical-align:-.8360000000000001em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.07153em">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>动能 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><msub><mi>u</mi><mi>k</mi></msub><msub><mi>u</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">K=\dfrac{1}{2}u_ku_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.07153em">K</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>。</p><p>显焓+动能的输运方程推导如下，动能方程右边这一项可以表示为</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>u</mi><mi>j</mi></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>σ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><msub><mi>u</mi><mi>j</mi></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>−</mo><msub><mi>u</mi><mi>i</mi></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>p</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">u_j\dfrac{\partial \sigma_{ij}}{\partial x_i}=u_j\dfrac{\partial \tau_{ij}}{\partial x_i}-u_i\dfrac{\partial p}{\partial x_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>显焓方程中的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi>D</mi><mi>p</mi></mrow><mrow><mi>D</mi><mi>t</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>p</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac></mstyle><mo>+</mo><msub><mi>u</mi><mi>i</mi></msub><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>p</mi></mrow><msub><mi>x</mi><mi>i</mi></msub></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\dfrac{D p}{D t}=\dfrac{\partial p}{\partial t}+u_i\dfrac{\partial p}{x_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0463299999999998em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，这里的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>u</mi><mi>i</mi></msub><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>p</mi></mrow><msub><mi>x</mi><mi>i</mi></msub></mfrac></mstyle></mrow><annotation encoding="application/x-tex">u_i\dfrac{\partial p}{x_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 一正一负抵消了。</p><p>因此显焓+动能的输运方程：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ρ</mi><msub><mi>h</mi><mi>s</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∂</mi><mfrac><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><msub><mi>h</mi><mi>s</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ρ</mi><mi>K</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi mathvariant="normal">∂</mi><mfrac><mrow><mi>ρ</mi><msub><mi>u</mi><mi>i</mi></msub><mi>K</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>p</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><mi>α</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mi>s</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><msub><mover accent="true"><mi>ω</mi><mo>˙</mo></mover><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\frac{\partial \rho h_s}{\partial t}+\partial\frac{\rho u_i h_s}{\partial x_i} +\frac{\partial \rho K}{\partial t}+\partial\frac{\rho u_i K}{\partial x_i} = \frac{\partial p}{ \partial t} + \frac{\partial}{\partial x_i}(\alpha\frac{\partial h_s}{\partial x_i}) +\frac{\partial \tau_{ij} u_i}{\partial x_j}+\dot\omega_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">ρ</span><span class="mord mathdefault" style="margin-right:.07153em">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.1963299999999997em;vertical-align:-.8360000000000001em"></span><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.07153em">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.0037em">α</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.81786em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">ω</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p>OF 代码中被忽略的部分是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial \tau_{ij} u_i}{\partial x_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.535748em;vertical-align:-.5423199999999999em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.993428em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.50732em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:.05556em">∂</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:-.1132em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5423199999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>。</p>]]></content>
      
      
      <categories>
          
          <category> combustion </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hEqn </tag>
            
            <tag> Energy equations </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RANS vs LES</title>
      <link href="/RANS_LES/"/>
      <url>/RANS_LES/</url>
      
        <content type="html"><![CDATA[<p>RANS&amp;LES</p><a id="more"></a><h1 id="rans"><a class="markdownIt-Anchor" href="#rans"></a> RANS</h1><p>速度输运方程：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo stretchy="false">(</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{ \partial }{ \partial t }( \bar\rho\widetilde{u_i} ) + \frac{ \partial\bar\rho\widetilde{u_i}\widetilde{u_j} }{ \partial x_j } = \frac{ \partial \overline \sigma _{ij} }{ \partial x_j } + \frac{ \partial }{ \partial x_j}( \Gamma_{ij} )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>雷诺应力：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo>−</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><mrow><msubsup><mi>u</mi><mi>i</mi><mo mathvariant="normal">′</mo></msubsup><msubsup><mi>u</mi><mi>j</mi><mo mathvariant="normal">′</mo></msubsup></mrow><mo stretchy="true">~</mo></mover></mrow><annotation encoding="application/x-tex">\Gamma_{ij}=-\bar\rho\widetilde{u_i&#x27;u_j&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.432664em;vertical-align:-.4129719999999999em"></span><span class="mord">−</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.019692em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.27686399999999994em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.733692em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span></span></span></span></span></p><p>湍动能：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mover accent="true"><mrow><msubsup><mi>u</mi><mi>i</mi><mo mathvariant="normal">′</mo></msubsup><msubsup><mi>u</mi><mi>i</mi><mo mathvariant="normal">′</mo></msubsup></mrow><mo stretchy="true">~</mo></mover><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>τ</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub><mi mathvariant="normal">/</mi><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">k=\frac{1}{2}\widetilde{u_i&#x27;u_i&#x27;}=-\frac{1}{2}\tau_{ii}/\bar\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.019692em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.27686399999999994em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.27686399999999994em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.733692em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.27686399999999994em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span></span></p><p>Boussinesq 假设：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><msub><mi mathvariant="normal">Γ</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>2</mn><msub><mi>μ</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mover accent="true"><msub><mi>S</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo stretchy="true">~</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Gamma_{ij}-\frac{1}{3}\Gamma_{kk}\delta_{ij}=2\mu_t(\widetilde{S_{ij}}-\frac{1}{3}\widetilde{S_{kk}}\delta_{ij})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.229438em;vertical-align:-.286108em"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><h1 id="les"><a class="markdownIt-Anchor" href="#les"></a> LES</h1><p>速度输运方程：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo stretchy="false">(</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>−</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{ \partial }{ \partial t }( \bar\rho\widetilde{u_i} ) + \frac{ \partial\bar\rho\widetilde{u_i}\widetilde{u_j} }{ \partial x_j } = \frac{ \partial \overline \sigma _{ij} }{ \partial x_j } - \frac{ \partial }{ \partial x_j}( \Gamma_{ij} )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>亚格子应力：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mo stretchy="false">(</mo><mover accent="true"><mrow><msub><mi>u</mi><mi>i</mi></msub><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">~</mo></mover><mo>−</mo><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Gamma_{ij}=\bar\rho(\widetilde{u_iu_j}-\widetilde{u_i}\widetilde{u_j})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.71656em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>亚格子湍动能：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><mover accent="true"><mrow><msub><mi>u</mi><mi>i</mi></msub><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">~</mo></mover><mo>−</mo><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mfrac><msub><mi>τ</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover></mfrac></mrow><annotation encoding="application/x-tex">k=\frac{1}{2}(\widetilde{u_iu_j}-\widetilde{u_i}\widetilde{u_j})=\frac{1}{2}\frac{\tau_{ii}}{\bar\rho}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.71656em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.20188em;vertical-align:-.8804400000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>Boussinesq 假设：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><msub><mi mathvariant="normal">Γ</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo>−</mo><mn>2</mn><msub><mi>μ</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mover accent="true"><msub><mi>S</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo stretchy="true">~</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Gamma_{ij}-\frac{1}{3}\Gamma_{kk}\delta_{ij}=-2\mu_t(\widetilde{S_{ij}}-\frac{1}{3}\widetilde{S_{kk}}\delta_{ij})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.229438em;vertical-align:-.286108em"></span><span class="mord">−</span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><h1 id="rans-vs-les"><a class="markdownIt-Anchor" href="#rans-vs-les"></a> RANS .vs. LES</h1><p>RANS 中平均的平均相当于只进行了一遍平均。所以在 RANS 中有：脉动的平均 = 0。<br>但是 LES 过滤之后再过滤，并不相当于一次过滤。因此 LES 中并没有类似的结论。<br>RANS 中还有：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><msub><mi>u</mi><mi>i</mi></msub><msub><mi>u</mi><mi>j</mi></msub></mrow><mo stretchy="true">~</mo></mover><mo>=</mo><mover accent="true"><mrow><mo stretchy="false">(</mo><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo>+</mo><msubsup><mi>u</mi><mi>i</mi><mo mathvariant="normal">′</mo></msubsup><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover><mo>+</mo><msubsup><mi>u</mi><mi>j</mi><mo mathvariant="normal">′</mo></msubsup><mo stretchy="false">)</mo></mrow><mo stretchy="true">~</mo></mover><mo>=</mo><mover accent="true"><mrow><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover><mo>+</mo><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><msubsup><mi>u</mi><mi>j</mi><mo mathvariant="normal">′</mo></msubsup><mo>+</mo><msubsup><mi>u</mi><mi>i</mi><mo mathvariant="normal">′</mo></msubsup><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover><mo>+</mo><msubsup><mi>u</mi><mi>i</mi><mo mathvariant="normal">′</mo></msubsup><msubsup><mi>u</mi><mi>j</mi><mo mathvariant="normal">′</mo></msubsup></mrow><mo stretchy="true">~</mo></mover><mo>=</mo><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover><mo>+</mo><mover accent="true"><mrow><msubsup><mi>u</mi><mi>i</mi><mo mathvariant="normal">′</mo></msubsup><msubsup><mi>u</mi><mi>j</mi><mo mathvariant="normal">′</mo></msubsup></mrow><mo stretchy="true">~</mo></mover></mrow><annotation encoding="application/x-tex">\widetilde{u_iu_j}=\widetilde{(\widetilde{u_i}+u_i&#x27;)(\widetilde{u_j}+u_j&#x27;)}= \widetilde{ \widetilde{u_i}\widetilde{u_j}+\widetilde{u_i}u_j&#x27;+u_i&#x27;\widetilde{u_j}+u_i&#x27;u_j&#x27; }= \widetilde{u_i}\widetilde{u_j}+\widetilde{u_i&#x27;u_j&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.002668em;vertical-align:-.286108em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.71656em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.502972em;vertical-align:-.4129719999999999em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.09em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.27686399999999994em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="svg-align" style="top:-3.75em"><span class="pstrut" style="height:3em"></span><span style="height:.34em"><svg width="100%" height="0.34em" viewbox="0 0 2340 312" preserveaspectratio="none"><path d="M786 58C457 58 32 177.487 13 177.487c-6 0-10-3.345-11-10.035L.15 143c-1-7 3-12 10-13l22-6.7C381.2 35 637.15 0 807.15 0c337 0 409 177 744 177 328 0 754-127 773-127 5 0 10 3 11 9l1 14.794c1 7.805-3 13.38-9 14.495l-20.7 5.574c-366.85 99.79-607.3 139.372-776.3 139.372-338 0-409 -175.236-744-175.236z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.486664em;vertical-align:-.4129719999999999em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.073692em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.27686399999999994em"><span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.27686399999999994em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.733692em"><span class="pstrut" style="height:3em"></span><span style="height:.34em"><svg width="100%" height="0.34em" viewbox="0 0 2340 312" preserveaspectratio="none"><path d="M786 58C457 58 32 177.487 13 177.487c-6 0-10-3.345-11-10.035L.15 143c-1-7 3-12 10-13l22-6.7C381.2 35 637.15 0 807.15 0c337 0 409 177 744 177 328 0 754-127 773-127 5 0 10 3 11 9l1 14.794c1 7.805-3 13.38-9 14.495l-20.7 5.574c-366.85 99.79-607.3 139.372-776.3 139.372-338 0-409 -175.236-744-175.236z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.9766680000000001em;vertical-align:-.286108em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.432664em;vertical-align:-.4129719999999999em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.019692em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.27686399999999994em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.733692em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span></span></span></span></span></p><p>但是在 LES 中，却推导不出这样的结果。</p>]]></content>
      
      
      <categories>
          
          <category> turbulence modelling </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RANS </tag>
            
            <tag> LES </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>alpha 和 alphat 的计算</title>
      <link href="/alpha/"/>
      <url>/alpha/</url>
      
        <content type="html"><![CDATA[<p>alpha 和 alphat 的计算</p><a id="more"></a><h1 id="背景知识"><a class="markdownIt-Anchor" href="#背景知识"></a> 背景知识</h1><ul><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ν</mi></mrow><annotation encoding="application/x-tex">\nu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.06366em">ν</span></span></span></span> 运动粘度 kinematic viscosity 单位是 [m^2/s]</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault">μ</span></span></span></span> 动力粘度 dynamic viscosity 单位是 [kg/(m*s)]</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.0037em">α</span></span></span></span> 焓的扩散系数 Thermal diffusivity of enthalpy 单位同 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault">μ</span></span></span></span>，即 [kg/(m*s)] ，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi><mo>=</mo><mfrac><mi>λ</mi><msub><mi>C</mi><mi>p</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\alpha=\frac{\lambda}{C_p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.0037em">α</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.4224279999999998em;vertical-align:-.5423199999999999em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8801079999999999em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.07153em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">λ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5423199999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>κ</mi></mrow><annotation encoding="application/x-tex">\kappa</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">κ</span></span></span></span>（OF中用这个） 即 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">λ</span></span></span></span>（某些文献用这个） 导热系数（温度的扩散系数） Thermal conductivity [W/(m*K)]</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mi>r</mi></msub><mo>=</mo><mfrac><mi>ν</mi><msub><mi>D</mi><mi>t</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">P_r=\frac{\nu}{D_t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.140492em;vertical-align:-.44509999999999994em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.695392em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.29634285714285713em"><span style="top:-2.357em;margin-left:-.02778em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.06366em">ν</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.44509999999999994em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 动量扩散系数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ν</mi></mrow><annotation encoding="application/x-tex">\nu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.06366em">ν</span></span></span></span> 和 热扩散系数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">D_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 之比 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mi>t</mi></msub><mo>=</mo><mfrac><mi>λ</mi><mrow><mi>ρ</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">D_t=\frac{\lambda}{\rho C_p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.4224279999999998em;vertical-align:-.5423199999999999em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8801079999999999em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.07153em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">λ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5423199999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，这里是指焓的扩散系数。因此<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mi>r</mi></msub><mo>=</mo><mfrac><mi>ν</mi><msub><mi>D</mi><mi>t</mi></msub></mfrac><mo>=</mo><mfrac><mi>ν</mi><mrow><mi>λ</mi><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mi>ρ</mi><msub><mi>C</mi><mi>p</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mfrac><mi>μ</mi><mrow><mi>λ</mi><mi mathvariant="normal">/</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mi>μ</mi><mi>α</mi></mfrac></mrow><annotation encoding="application/x-tex">P_r=\frac{\nu}{D_t}=\frac{\nu}{\lambda/(\rho C_p)}=\frac{\mu}{\lambda /C_p}=\frac{\mu}{\alpha}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.140492em;vertical-align:-.44509999999999994em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.695392em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.29634285714285713em"><span style="top:-2.357em;margin-left:-.02778em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.06366em">ν</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.44509999999999994em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.237712em;vertical-align:-.5423199999999999em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.695392em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">λ</span><span class="mord mtight">/</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.07153em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.06366em">ν</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5423199999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.28982em;vertical-align:-.5423199999999999em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7475em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">λ</span><span class="mord mtight">/</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.07153em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">μ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5423199999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.0925em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7475em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.0037em">α</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.446108em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">μ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mi>e</mi></msub><mo>=</mo><mfrac><msub><mi>D</mi><mi>t</mi></msub><msub><mi>D</mi><mi>k</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">L_e=\frac{D_t}{D_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.3392909999999998em;vertical-align:-.4508599999999999em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8884309999999999em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3487714285714287em;margin-left:-.02778em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15122857142857138em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.4101em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.29634285714285713em"><span style="top:-2.357em;margin-left:-.02778em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4508599999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 热扩散速度<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">D_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 和 质量扩散系数 之比</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>c</mi></msub><mo>=</mo><mfrac><mi>ν</mi><msub><mi>D</mi><mi>k</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">S_c=\frac{\nu}{D_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.146252em;vertical-align:-.4508599999999999em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.695392em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3448em"><span style="top:-2.3487714285714287em;margin-left:-.02778em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15122857142857138em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.06366em">ν</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4508599999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 动量扩散系数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ν</mi></mrow><annotation encoding="application/x-tex">\nu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.06366em">ν</span></span></span></span> 和 质量扩散系数 之比<br>假设 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mi>r</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">P_r=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>，可以得到 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>λ</mi><mo>=</mo><mi>μ</mi><msub><mi>C</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\lambda=\mu C_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">λ</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord mathdefault">μ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>，又有 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi><mo>=</mo><mi>μ</mi></mrow><annotation encoding="application/x-tex">\alpha=\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.0037em">α</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault">μ</span></span></span></span><br>假设 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mi>e</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">L_e=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>，可以得到 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mi>k</mi></msub><mo>=</mo><mfrac><mi>λ</mi><mrow><mi>ρ</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">D_k=\frac{\lambda}{\rho C_p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.4224279999999998em;vertical-align:-.5423199999999999em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8801079999999999em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285716em"><span style="top:-2.357em;margin-left:-.07153em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2818857142857143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">λ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.5423199999999999em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><br>假设 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>c</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">S_c=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>，可以得到 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mi>k</mi></msub><mo>=</mo><mi>ν</mi></mrow><annotation encoding="application/x-tex">D_k=\nu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.06366em">ν</span></span></span></span></li></ul><h2 id="of定义"><a class="markdownIt-Anchor" href="#of定义"></a> OF定义</h2><p><code>moleWeight_</code> 可以由函数 <code>W()</code> 获取，单位是 [kg/kmol]<br><code>cp</code> 单位是 [J/(kmol<em>K)]<br><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mi>p</mi></msub><mo>=</mo><mfrac><mrow><mi>c</mi><mi>v</mi></mrow><mi>W</mi></mfrac></mrow><annotation encoding="application/x-tex">C_p=\frac{cv}{W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.040392em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.695392em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">W</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight" style="margin-right:.03588em">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 单位是 [J/(kg</em>K)]，这是教材上的一般用法。<br><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">h_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 单位是 [J/kmol]<br><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">H_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.08125em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 单位是 [J/kg]</p><h1 id="alpha-和-alphat-的计算"><a class="markdownIt-Anchor" href="#alpha-和-alphat-的计算"></a> alpha 和 alphat 的计算</h1><p>本文代码几乎全部在 <code>/src/thermophysicalModels</code> 文件夹下。</p><p>代码在 <a href="https://cpp.openfoam.org/v3/a09892_source.html" target="_blank" rel="external nofollow noopener noreferrer">/basic/psiThermo/hePsiThermo.C</a> 中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">forAll(TCells, celli)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">typename</span> MixtureType::thermoType&amp; mixture_ =</span><br><span class="line">        <span class="keyword">this</span>-&gt;cellMixture(celli);</span><br><span class="line">    TCells[celli] = mixture_.THE</span><br><span class="line">    (</span><br><span class="line">        hCells[celli],</span><br><span class="line">        pCells[celli],</span><br><span class="line">        TCells[celli]</span><br><span class="line">    );</span><br><span class="line">    psiCells[celli] = mixture_.psi(pCells[celli], TCells[celli]);</span><br><span class="line">    muCells[celli] = mixture_.mu(pCells[celli], TCells[celli]);</span><br><span class="line">    alphaCells[celli] = mixture_.alphah(pCells[celli], TCells[celli]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://cpp.openfoam.org/v3/a10311_source.html" target="_blank" rel="external nofollow noopener noreferrer">/specie/transport/sutherland/sutherlandTransportI.H</a></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Thermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Foam</span>:</span>:scalar Foam::sutherlandTransport&lt;Thermo&gt;::alphah</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar p,</span><br><span class="line">    <span class="keyword">const</span> scalar T</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> kappa(p, T)/<span class="keyword">this</span>-&gt;Cp(p, T);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://cpp.openfoam.org/v3/a10648_source.html" target="_blank" rel="external nofollow noopener noreferrer">RASModel.H</a></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">virtual</span> tmp&lt;volScalarField&gt; <span class="title">alphaEff</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> thermo().alphaEff(alphat());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://cpp.openfoam.org/v3/a09887_source.html" target="_blank" rel="external nofollow noopener noreferrer">heThermo.C</a></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">BasicThermo</span>, <span class="title">class</span> <span class="title">MixtureType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:tmp&lt;Foam::volScalarField&gt;</span><br><span class="line">Foam::heThermo&lt;BasicThermo, MixtureType&gt;::alphaEff</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> volScalarField&amp; alphat</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">tmp&lt;Foam::volScalarField&gt; <span class="title">alphaEff</span><span class="params">(<span class="keyword">this</span>-&gt;CpByCpv()*(<span class="keyword">this</span>-&gt;alpha_ + alphat))</span></span>;</span><br><span class="line">    alphaEff().rename(<span class="string">"alphaEff"</span>);</span><br><span class="line">    <span class="keyword">return</span> alphaEff;</span><br><span class="line">&#125;</span><br><span class="line">其中理想气体的 CpByCpv 等于 <span class="number">1</span></span><br></pre></td></tr></table></figure><p>这里的 <code>alpha_</code> 是层流的，另外<code>alpha()</code>函数会返回<code>alpha_</code>，通过修改<code>aloha()</code>函数也能更新<code>alpha_</code>。</p><p><code>alphat()</code>在哪里计算？</p><p>[EddyDiffusivity.C]</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">BasicTurbulenceModel</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:EddyDiffusivity&lt;BasicTurbulenceModel&gt;::correctNut()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Read Prt if provided</span></span><br><span class="line">    Prt_ = dimensioned&lt;scalar&gt;::lookupOrDefault</span><br><span class="line">    (</span><br><span class="line">        <span class="string">"Prt"</span>,</span><br><span class="line">        <span class="keyword">this</span>-&gt;coeffDict(),</span><br><span class="line">        <span class="number">1.0</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    alphat_ = <span class="keyword">this</span>-&gt;rho_*<span class="keyword">this</span>-&gt;nut()/Prt_;</span><br><span class="line">    alphat_.correctBoundaryConditions();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> thermophysicalModels </tag>
            
            <tag> alpha </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 qtcreator 对 OpenFOAM 代码 debug</title>
      <link href="/qtcreator/"/>
      <url>/qtcreator/</url>
      
        <content type="html"><![CDATA[<p>使用 qtcreator 对 OpenFOAM 代码 debug</p><a id="more"></a><ol><li><p>安装 qtcreator(ubuntu版本终端下：sudo apt install qtcreator)</p></li><li><p>在 debug 模式下编译 OpenFOAM(举例：版本OpenFOAM41）。</p><ul><li>修改 <code>HOME</code> 目录下的 <code>.bashrc</code>，如果你的 <code>OF</code> 是直接在 <code>.bashrc</code> 里边 <code>source</code> 的，那么修改它为 <code>alias</code> 的方式，然后添加一条 <code>debug</code> 模式的 <code>alias</code>，最终的样子是这样的：</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">alias of41='source \$HOME/OpenFOAM/OpenFOAM-4.1/etc/bashrc'</span><br><span class="line">alias of41Debug='source \$HOME/OpenFOAM/OpenFOAM-4.1/etc/bashrc WM_COMPILE_OPTION=Debug'</span><br></pre></td></tr></table></figure><ul><li>然后激活 of41Debug，并使用 Allwmake 编译 OpenFOAM 即可。</li></ul></li><li><p>配置 qtcreator 项目</p><ul><li>首先 New Project，如下图所示，导入已有的代码（求解器或者库）。<br><img src="/album/QT1.PNG" alt=""></li><li>这里导入的是 sprayFoam 求解器，也可以选择 \src\thermophysicalModels，或者 \src\thermophysicalModels\basic。<br><img src="/album/QT2.PNG" alt=""></li><li>OF 的代码后缀是大写，这里需要修改 filter，如图在末尾添加 <code>*.H;*.C</code>。<br><img src="/album/QT3.PNG" alt=""></li><li>接下来配置 Projects，先删除默认的 make all 这个 Make 选项，接着参考下列图片配置。只有求解器代码需要这些配置，库不需要。<br><img src="/album/QT4.PNG" alt=""><br><img src="/album/QT5.PNG" alt=""><br><img src="/album/QT6.PNG" alt=""></li></ul></li><li><p>最后开始 debug！如果打开了多个 Projects， 切换到求解器这个项目，然后点击 debug 按钮即可。<br>简单用法：F5 是 continue，F10 是下一个语句。<br><img src="/album/QT7.PNG" alt=""></p></li><li><p>WSL中使用qtcreator需要图形界面的支持：</p><ul><li><code>echo &quot;export DISPLAY=:0.0&quot; &gt;&gt; ~/.bashrc</code></li><li>安装 Xming 或者 VcxXsrv 或者 VNC viewer</li></ul></li><li><p>记得现在终端激活 debug 版本的 OpenFOAM 之后，再输入 qtcreator 打开。</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> using </category>
          
      </categories>
      
      
        <tags>
            
            <tag> debug </tag>
            
            <tag> qtcreator </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM 热物理库深度解析</title>
      <link href="/thermodynamicLIB/"/>
      <url>/thermodynamicLIB/</url>
      
        <content type="html"><![CDATA[<p>本帖描述 OpenFOAM 热物理库的宏观框架。但作者水平有限，有些地方理解还不到位。希望各位指正！</p><a id="more"></a><h1 id="of-7"><a class="markdownIt-Anchor" href="#of-7"></a> OF-7</h1><h2 id="uml-类图"><a class="markdownIt-Anchor" href="#uml-类图"></a> UML 类图</h2><p>下图是热物理库部分类的 UML 类图。欲获取更佳阅读体验，可以右键在新标签页打开该图。</p><details><summary>OF-7 UML</summary><img src="http://www.plantuml.com/plantuml/svg/hHhRZXH5z7s_eWB9P1O6WgypwoQmxh8a88ITI8YQJMrFpNPht-pkcNLTIOWOBah45wCGI3J1I4mG4tq0bFWpEmiy-GlMjRkgkwgxQv0NjkgSEdNkb-fPS7oOfY2DaUCXiBS0yB_DJN0XyQOmGs04CuZNTFlOJfICG0W3nDUf0tsOWClgCeZyIyZRThDDGUmS2hPG0iQJqCcyA4m5mQCENcI0aErGkjr5GBSObDExfDszhDszcEzUMLZWCYrzVcmKxOJ7G8oICNAoqp3jWmqAMs325u0bjh-yryWwlp1nesxS6-fuMJS1Lc8JPAC2Y5FFJERSobG6Of4BIGgnFu8X70zTb0HH7wn-Ce54aFFZZGpRboj0GbagOIpNkmJdPUX7EvizC7IntSd_JXG4KSXnd0YDnoUJ1Eu20b-9LyX6MeLY8YgmXG78pLfNeBpe8Omx5SPSiM2ce_3QX2jnthKp-JeqGb8ZnEasUW_nVnIctfQFLiFCXNwyMxW4Yuoqty-epK4V37TZL3rm_FYox1i4Z_x1tQQClyIWRQ87kvRdW3oXT1Vt4fHDaX0SSWyDhfHqD-qoZJFo7S2uxXNIWZt0ZpFGSQflC5mSW3AjKxk47Z0H19pY1s51ywqobVLLEmASAMfG3LD38psNK3nXfZZ49DqU85HFKBBOwhAzwWok6585Splsg5TK4m2twbhPgdao0DqnPRpNPVJw_IDhYz9Yj3OQoclV2xniKNRf5e5FSnymP4OpR1i60QmvoVp31CUMCe5MKpF8VE5f8yI9ZI3NJCyrS-7giqRD0MHcpgmYP2Q8p7nl6o4aEjQ9ZmzF03qyxQwdlHeuh3-F3RTQ2uSLUDvS515LXDg4xFWm70qJ6APnb6JbQAjYL39dNR4zcP8Isxv41XEZSZ-6SMms2ixfBdGLC9QS2R45KyyvvtsAqn5YN1_DSBOOeR42KXOadGmm2GKXLnpRdVYPjn85SHIYCECuofKw14bjKORx7pHI57UO6si8SR4IoOw3pdffjhGLHVuoW5XzKzxR7hwG9HGqZVmDgeqr3_cZPT7irgcTYFakAMg7p1mVMjJfJ8TPqQ3SWyY2TSHA3NCY6rbdq0lJhjnnCtJ2QVK0qqNNXrl8vuYUfWSgjDSHHnIiQUIDS9kGdTIHKr7EXD2CPB16Xum1CZzrU2fVCfo0sNbsjwVGRC9jGxUYy3ONcAo4Ox36NTHuOlEC9euKm9xMSHKKhSCg67f7nO6o_zVF-q-_FlZXoSldJrxTlJUxyUBWkz-B9CKCZS5KeV_-VJl67GHU0fQ5k6Az99j07uYPqEkgJWdU1YUqcBWJv9XolsZ4djfWuyfYWvrQOJjj9Tom8RjgnSHf6-IJDiYu9bbWip9bSO1NBlb4_G4onnleYt1JdJqFiq1RiRIxT9xILF-y7QTHmu9KIs2fG6je5KGYb0w8yl0EnkDOmIIZ9R700W6xgH7XlSXlheIl_hdx-iRjsM_tzf_Tsdz-_TMVZrxVk3ExUHt7_-oh7myUN9iz-sFsu8QS38kREi11liybLt8ksTTL8_bi33F7NOEEC5YNRdWzcSuOWvleaBkmh3cLth0tDoibEXOSQSpPaUqfgfkOecLJYt6Q5je4mH7NvSYZreB9RcTnOE9z6sLd8nmYR4-nWfgUT3U_pr4-7D39DAYlLvWrp52uBKAejBO9djBHzc73kQTCfXvHZz8pIllSmxaglCzGsGJ2P1SfBr4eCx7SxxCZmZPADrU-NLXQsZVOM-QFwbnfVB6cgrg6aop2hEg1N0Ozi68WYgLaoJwGsm5c6mLXIO8NfiaJHZNlxZzz_FBUbmUthXxSlrLk9x2BdJbVU7Mf4r96C6cdQNQOtVc2fAkRtx_wwH6xdVGdBYin6NXzxGNfLRW1fJQEdPOxEOoVqlwAKoxtVR5s7mprs_H-3jhOyN0g0QDurEBHNLI-olMYbHO8-kuqBdNIjSX3FR86hGqrAdBTzMaLcoLPvOoahN8SKGtoe6piN0jfS69reYJ1teC9LbgCB8WhOoJfDunD33cGbh4LGQfdohfoaOuLlLvTLCzBcNdwC3HipxvRgPiagx3QcbgJQL24bc77GjdamOazlBunnnAfERXUYIsuPbyOvhfcQdFDTDvhsCDh-vl4G-ryCiLMGiNJ-IzY3yOsbuadvhakl6GNgcnoQiyTVn2qvuiUN1sFkzeKOya0eSFgwpmgeYSB4ktlBXtKt9qFW-KFB6D_uer4Yu6xi0IbzDDOtgQUYqQuKQGjae9Bsn5fPwzr_TQ97axqvR4YAaQiLiQvAjv5DzBR7621CuZ1hUiG-TXjPUbWOk7QmKJZrzYUalAbtmgadcAXVDtKBfQwD7nkSw2511CEmBGabs8jfgpzsVr71uyVifwubHD8lOLjNo4OadHYoP2bQmmi_SB69opzWVv-GfXPyGGnmfKzGjtVQnL3WftgQ8Ex2sN0m-uvK8umvJGVpBsRV6jPM32yMxae_wWl3saLiRGdJbKcAW5Saa0ze1tlsaMEYuhuQCw5-0BoEmBvmdw__23TKVGaUluZcUkb-IE9ekjvoAe3XPOu_Ta3-sxuhlIh9t56kIpBNmtmt-9zVh4OKIgfO_RmbzVN7irkNhS8sUeu87WXLhXYDqFK76qS9fedW8OneWq1pKXOos3UFmrQ8RUN1hwfD70EQPoMwP7EBgXn2cfD1O06JilZZBLeAt5BqV0GOqzyshu4AQDEgp6daPtAl3A7TYmaA8qrBKSQQvukjUT86MJiXvZ_QO2n75w09G_woSLoQW6LhYOlt58flr1gSAKTLiBpfR6AD_mQZ7M2q7ScFiRZBtowYdLm_-hiss_sdrxTV_hhN7qcfdtbFm00"></details><h1 id="求解器中创建对象"><a class="markdownIt-Anchor" href="#求解器中创建对象"></a> 求解器中创建对象</h1><p><code>solver</code> 中的 <code>creatFields.H</code> 中：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">autoPtr&lt;psiReactionThermo&gt; pThermo(psiReactionThermo::New(mesh));</span><br><span class="line">psiReactionThermo&amp; thermo &#x3D; pThermo();</span><br></pre></td></tr></table></figure><p>创建 <code>thermo</code>，在 <code>reactingFoam</code> 自带算例中，创建的是 <code>hePsiThermo</code> 的对象，但是这里 thermo 是基类 <code>psiReactionThermo</code> 的引用，即只能使用 <code>psiReactionThermo</code> 这一继承链的方法。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">basicSpecieMixture&amp; composition &#x3D; thermo.composition();</span><br></pre></td></tr></table></figure><p>创建 <code>composition</code>，是指系统中的混合物。可以调用继承链中 <code>mixture</code> 这一分支的方法。</p><p>燃烧类的求解器中，一般都没有对单个组分进行操作，这些操作都在热物理库里边进行。</p><p><code>multiComponentMixture</code> 类中的私有数据 <code>speciesData_</code> 的类型是 <code>PtrList&lt;sutherlandTransport&lt;species::thermo&lt;janafThermo&lt;perfectGas&lt;specie&gt;&gt;,sensibleEnthalpy&gt;&gt;&gt;</code>，它是组分的 <code>list</code>，可以用它获取组分的所有信息。solver 中可以通过 <code>multiComponentMixture</code> （<code>solver</code> 中<code>composition</code> 的类型是 <code>basicSpecieMixture</code>，需要强制转换成 <code>multiComponentMixture</code> 才行 ） 的 <code>speciesData()</code> 或者 <code>getLocalThermo(speciei)</code> 这两个函数来调用。如：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dynamic_cast&lt;const multiComponentMixture&lt;gasHThermoPhysics&gt;&amp;&gt;(composition).speciesData()[speciei].rho(p,T)</span><br></pre></td></tr></table></figure><p>也可以通过 <code>multiComponentMixture</code> 的派生类 <code>reactingMixture</code> 来调用。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dynamic_cast&lt;const reactingMixture&lt;gasHThermoPhysics&gt;&amp;&gt;(composition).speciesData()[speciei].rho(p,T)</span><br></pre></td></tr></table></figure><p>也可以通过派生类的派生类 <code>SpecieMixture</code> 来调用。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dynamic_cast&lt;const SpecieMixture&lt;reactingMixture&lt;gasHThermoPhysics&gt;&gt;&amp;&gt;(composition).speciesData()[speciei].rho(p,T)</span><br></pre></td></tr></table></figure><p>上述操作说明可以使用组分列表调用单个组分的函数（即 <code>sutherlandTransport&lt;species::thermo&lt;janafThermo&lt;perfectGas&lt;specie&gt;&gt;,sensibleEnthalpy&gt;&gt;</code> 继承链中的任何函数），如 <code>speciesData_[i].rho(p, T)</code>，这里的 <code>rho(p,T)</code> 来自于 <code>perfectGas</code> 类。</p><p>也可以在求解器中重新构造组分列表：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">autoPtr&lt;psiReactionThermo&gt; <span class="title">pThermo</span><span class="params">(psiReactionThermo::New(mesh))</span></span>;</span><br><span class="line">psiReactionThermo&amp; thermo = pThermo();</span><br><span class="line"></span><br><span class="line">basicSpecieMixture&amp; composition = thermo.composition();</span><br><span class="line">PtrList&lt;volScalarField&gt;&amp; Y = composition.Y();</span><br><span class="line"></span><br><span class="line"><span class="function">PtrList&lt;gasHThermoPhysics&gt; <span class="title">specieData</span><span class="params">(Y.<span class="built_in">size</span>())</span></span>;</span><br><span class="line">forAll(specieData, i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//对于每个组分，通过 thermo 调用 Lib 中的 speciesData_ 来构造 solver 中的 specieData</span></span><br><span class="line">    specieData.<span class="built_in">set</span></span><br><span class="line">    (</span><br><span class="line">        i,</span><br><span class="line">        <span class="keyword">new</span> gasHThermoPhysics</span><br><span class="line">        (</span><br><span class="line">            <span class="keyword">dynamic_cast</span>&lt;<span class="keyword">const</span> reactingMixture&lt;gasHThermoPhysics&gt;&amp;&gt;</span><br><span class="line">                (thermo).speciesData()[i]</span><br><span class="line">        )</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 每个网格构造一个 mixture,这个 mixture 相当于 multiComponentMixture 中的私有数据 mixture_。</span></span><br><span class="line"><span class="comment">// 它是混合物等效成的一个组分，和单个组分同一类型，即 `gasHThermoPhysics`。</span></span><br><span class="line">forAll(T, celli)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">gasHThermoPhysics <span class="title">mixture</span><span class="params">(<span class="number">0.</span>*specieData[<span class="number">0</span>])</span></span>;</span><br><span class="line">    forAll(Y, speciei)</span><br><span class="line">    &#123;</span><br><span class="line">        mixture += Y[speciei][celli]*specieData[speciei];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>gasHThermoPhysics</code> 是 <code>sutherlandTransport&lt;species::thermo&lt;janafThermo&lt;perfectGas&lt;specie&gt;&gt;,sensibleEnthalpy&gt;&gt;</code> 的别名，它是单个组分的类型。<br>事实上，<code>multiComponentMixture</code> 类中的函数 <code>cellMixture</code> 函数可以用于获取 <code>mixture_</code>。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ThermoType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">const</span> <span class="title">ThermoType</span>&amp; <span class="title">Foam</span>:</span>:multiComponentMixture&lt;ThermoType&gt;::cellMixture</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> label celli</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    mixture_ = Y_[<span class="number">0</span>][celli]*speciesData_[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (label n=<span class="number">1</span>; n&lt;Y_.<span class="built_in">size</span>(); n++)</span><br><span class="line">    &#123;</span><br><span class="line">        mixture_ += Y_[n][celli]*speciesData_[n];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> mixture_;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用方法参考 hePsiThermo.C</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> scalarField&amp; hCells = <span class="keyword">this</span>-&gt;he_;</span><br><span class="line"><span class="keyword">const</span> scalarField&amp; pCells = <span class="keyword">this</span>-&gt;p_;</span><br><span class="line"></span><br><span class="line">scalarField&amp; TCells = <span class="keyword">this</span>-&gt;T_.primitiveFieldRef();</span><br><span class="line">scalarField&amp; psiCells = <span class="keyword">this</span>-&gt;psi_.primitiveFieldRef();</span><br><span class="line">scalarField&amp; muCells = <span class="keyword">this</span>-&gt;mu_.primitiveFieldRef();</span><br><span class="line">scalarField&amp; alphaCells = <span class="keyword">this</span>-&gt;alpha_.primitiveFieldRef();</span><br><span class="line"></span><br><span class="line">forAll(TCells, celli)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">typename</span> MixtureType::thermoType&amp; mixture_ =</span><br><span class="line">        <span class="keyword">this</span>-&gt;cellMixture(celli);</span><br><span class="line"></span><br><span class="line">    TCells[celli] = mixture_.THE</span><br><span class="line">    (</span><br><span class="line">        hCells[celli],</span><br><span class="line">        pCells[celli],</span><br><span class="line">        TCells[celli]</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    psiCells[celli] = mixture_.psi(pCells[celli], TCells[celli]);</span><br><span class="line"></span><br><span class="line">    muCells[celli] = mixture_.mu(pCells[celli], TCells[celli]);</span><br><span class="line">    alphaCells[celli] = mixture_.alphah(pCells[celli], TCells[celli]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="rts-选择热物理模型"><a class="markdownIt-Anchor" href="#rts-选择热物理模型"></a> RTS 选择热物理模型</h1><h2 id="从字典文件的设置开始"><a class="markdownIt-Anchor" href="#从字典文件的设置开始"></a> 从字典文件的设置开始</h2><p>下面介绍我们是如何从 <code>thermophysicalProperties</code> 字典文件中的下列设置构建对象的：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">thermoType</span><br><span class="line">&#123;</span><br><span class="line">    type            hePsiThermo;</span><br><span class="line">    mixture         reactingMixture;</span><br><span class="line">    transport       sutherland;</span><br><span class="line">    thermo          janaf;</span><br><span class="line">    energy          sensibleEnthalpy;</span><br><span class="line">    equationOfState perfectGas;</span><br><span class="line">    specie          specie;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>solver 中创建模型：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">autoPtr&lt;psiReactionThermo&gt; pThermo(psiReactionThermo::New(mesh));</span><br></pre></td></tr></table></figure><p>这个函数定义于 psiReactionThermo：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Foam::autoPtr&lt;Foam::psiReactionThermo&gt; Foam::psiReactionThermo::New</span><br><span class="line">(</span><br><span class="line">    const fvMesh&amp; mesh,</span><br><span class="line">    const word&amp; phaseName</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    return basicThermo::New&lt;psiReactionThermo&gt;(mesh, phaseName);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>它调用了basicThermo 中的 New 函数：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Thermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:autoPtr&lt;Thermo&gt; Foam::basicThermo::New(<span class="keyword">const</span> fvMesh&amp; mesh,<span class="keyword">const</span> <span class="keyword">word</span>&amp; phaseName)</span><br><span class="line">&#123;</span><br><span class="line">    thermoDict---thermophysicalProperties</span><br><span class="line">    <span class="keyword">typename</span> Thermo::fvMeshConstructorTable::iterator cstrIter =</span><br><span class="line">        lookupThermo&lt;Thermo, <span class="keyword">typename</span> Thermo::fvMeshConstructorTable&gt;</span><br><span class="line">        (</span><br><span class="line">            thermoDict,</span><br><span class="line">            Thermo::fvMeshConstructorTablePtr_</span><br><span class="line">        );</span><br><span class="line"><span class="comment">//fvMeshConstructorTablePtr_</span></span><br><span class="line"><span class="comment">//这个是在 runTimeSelectionTables.H 的 declareRunTimeSelectionTable 函数中定义的。</span></span><br><span class="line">    <span class="keyword">return</span> autoPtr&lt;Thermo&gt;(cstrIter()(mesh, phaseName));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用了 2 参数的 lookupThermo：<br><a href="https://cpp.openfoam.org/v3/a09872_source.html" target="_blank" rel="external nofollow noopener noreferrer">basicThermoTemplates.C</a> 中的 <code>lookupThermo</code> 函数：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">template&lt;class Thermo, class Table&gt;</span><br><span class="line">typename Table::iterator Foam::basicThermo::lookupThermo</span><br><span class="line">(</span><br><span class="line">    const dictionary&amp; thermoDict,</span><br><span class="line">    Table* tablePtr    &#x2F;&#x2F;即 fvMeshConstructorTablePtr_，它是哈希表add类型的一个指针，typeName和模型都存放在这里</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    const word thermoTypeName</span><br><span class="line">    (</span><br><span class="line">    word(thermoTypeDict.lookup(&quot;type&quot;)) + &#39;&lt;&#39;</span><br><span class="line">    + word(thermoTypeDict.lookup(&quot;mixture&quot;)) + &#39;&lt;&#39;</span><br><span class="line">    + word(thermoTypeDict.lookup(&quot;transport&quot;)) + &#39;&lt;&#39;</span><br><span class="line">    + word(thermoTypeDict.lookup(&quot;thermo&quot;)) + &#39;&lt;&#39;</span><br><span class="line">    + word(thermoTypeDict.lookup(&quot;equationOfState&quot;)) + &#39;&lt;&#39;</span><br><span class="line">    + word(thermoTypeDict.lookup(&quot;specie&quot;)) + &quot;&gt;&gt;,&quot;</span><br><span class="line">    + word(thermoTypeDict.lookup(&quot;energy&quot;)) + &quot;&gt;&gt;&gt;&quot;</span><br><span class="line">    );</span><br><span class="line">&#x2F;&#x2F;通过字典文件读入的数据，构造 thermoTypeName: &#x2F;&#x2F;hePsiThermo&lt;reactingMixture&lt;sutherland&lt;janaf&lt;perfectGas&lt;specie&gt;&gt;,sensibleEnthalpy&gt;&gt;&gt;</span><br><span class="line">&#x2F;&#x2F;注意这里并不是类名，而是省略版</span><br><span class="line"></span><br><span class="line">    return lookupThermo&lt;Thermo, Table&gt;</span><br><span class="line">    (</span><br><span class="line">    thermoTypeDict,</span><br><span class="line">    tablePtr,</span><br><span class="line">    nCmpt,</span><br><span class="line">    cmptNames,</span><br><span class="line">    thermoTypeName</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后返回值是调用 5 个参数的 <code>lookupThermo</code> 函数：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">template&lt;class Thermo, class Table&gt;</span><br><span class="line">typename Table::iterator Foam::basicThermo::lookupThermo</span><br><span class="line">(</span><br><span class="line">    const dictionary&amp; thermoTypeDict,</span><br><span class="line">    Table* tablePtr,</span><br><span class="line">    const int nCmpt,</span><br><span class="line">    const char* cmptNames[],</span><br><span class="line">    const word&amp; thermoTypeName</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F; Lookup the thermo package</span><br><span class="line">    typename Table::iterator cstrIter &#x3D; tablePtr-&gt;find(thermoTypeName);</span><br><span class="line">    return cstrIter;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;上述步骤是根据字典文件在备选库中选择我们需要的组合，那么备选库是怎么形成的呢？</span><br></pre></td></tr></table></figure><p>第一个 <code>lookupThermo</code> 函数的作用是，将 <code>thermophysicalProperties</code> 字典文件中的设置翻译成：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hePsiThermo&lt;reactingMixture&lt;sutherland&lt;janaf&lt;perfectGas&lt;specie&gt;&gt;,sensibleEnthalpy&gt;&gt;&gt;</span><br></pre></td></tr></table></figure><p>但该字符串并不是最终的 <code>class</code>，比如 <code>janaf</code>，实际上类名是 <code>janafThermo</code>。</p><p>第二个 <code>lookupThermo</code> 函数的作用就是，根据该字符串，在 <code>RTS</code> 库中找到我们选择的类。<br>那么上面提到的省略版字符串，怎么和 <code>RTS</code> 库中的组合匹配的呢？下面来看 <code>RTS</code> 库的生成过程。</p><h1 id="rts-库的生成"><a class="markdownIt-Anchor" href="#rts-库的生成"></a> RTS 库的生成</h1><p>按照<a href="http://xiaopingqiu.github.io/2016/03/12/RTS1/" target="_blank" rel="external nofollow noopener noreferrer">Giskard 博客</a>提到的 <code>RTS</code> 流程：</p><blockquote><ol><li>基类类体里调用 <code>TypeName</code> 和 <code>declareRunTimeSelectionTable</code> 两个函数，类体外面调用 <code>defineTypeNameAndDebug</code> 和 <code>defineRunTimeSelectionTable</code> 两个函数。</li><li>基类中需要一个静态 <code>New</code> 函数作为 <code>selector</code>。</li><li>派生类类体中需要调用 <code>TypeName</code> 函数，类体外调用 <code>defineRunTimeSelectionTable</code> 和 <code>addToRunTimeSelectionTable</code> 两个宏函数。</li></ol></blockquote><p>我们发现：<code>makeReactionThermo.H</code> 中有两个重要函数：<code>defineThermoPhysicsReactionThermo</code> 和 <code>makeThermoPhysicsReactionThermos</code>。</p><p>下面一一介绍：</p><h2 id="definethermophysicsreactionthermo"><a class="markdownIt-Anchor" href="#definethermophysicsreactionthermo"></a> defineThermoPhysicsReactionThermo</h2><p>其中的 <code>defineThermoPhysicsReactionThermo</code>, 这个函数通过一组形参列表得到 <code>CThermo##Mixture##ThermoPhys</code>，然后再转换成一串简化的字符串。这里的形参列表就是实例化所需要提供的各种类，对应<code>(psiReactionThermo,hePsiThermo,reactingMixture,sutherlandTransport)</code>。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> defineThermoPhysicsReactionThermo(BaseReactionThermo,CThermo,Mixture,ThermoPhys) \</span></span><br><span class="line">    <span class="keyword">typedef</span> CThermo<span class="comment">//hePsiThermo                                                         \</span></span><br><span class="line">    &lt;                                                                                    \</span><br><span class="line">        BaseReactionThermo,<span class="comment">//psiReactionThermo                                           \</span></span><br><span class="line">        SpecieMixture                                                                    \</span><br><span class="line">        &lt;                                                                                \</span><br><span class="line">            Mixture<span class="comment">//reactingMixture                                                     \</span></span><br><span class="line">            &lt;                                                                            \</span><br><span class="line">                ThermoPhys<span class="comment">//sutherlandTransport                                          \</span></span><br><span class="line">            &gt;                                                                            \</span><br><span class="line">        &gt;                                                                                \</span><br><span class="line">    &gt; CThermo##Mixture##ThermoPhys;                                                      \</span><br><span class="line">                                                                                         \</span><br><span class="line">    defineTemplateTypeNameAndDebugWithName                                               \</span><br><span class="line">    (                                                                                    \</span><br><span class="line">        CThermo##Mixture##ThermoPhys,                                                    \</span><br><span class="line">        (#CThermo<span class="string">"&lt;"</span> + Mixture&lt;ThermoPhys&gt;::typeName() + <span class="string">"&gt;"</span>).c_str(),                   \</span><br><span class="line">        <span class="number">0</span>                                                                                \</span><br><span class="line">    )</span><br><span class="line"><span class="comment">//作用：把尖括号表示的类变成字符串 CThermo##Mixture##ThermoPhys，然后再变成简化的尖括号。</span></span><br></pre></td></tr></table></figure><p>如：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">hePsiThermo</span><br><span class="line">&lt;</span><br><span class="line">psiReactionThermo,</span><br><span class="line">    SpecieMixture</span><br><span class="line">    &lt;</span><br><span class="line">        reactingMixture</span><br><span class="line">        &lt;</span><br><span class="line">            sutherlandTransport</span><br><span class="line">            &lt;</span><br><span class="line">                species::thermo</span><br><span class="line">                &lt;</span><br><span class="line">                    janafThermo&lt;perfectGas&lt;specie&gt;&gt;,sensibleEnthalpy</span><br><span class="line">                &gt;</span><br><span class="line">            &gt;</span><br><span class="line">        &gt;</span><br><span class="line">    &gt;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><p>变成 <code>RTS</code> 库中保存的字符串：<br><code>hePsiThermo&lt;reactingMixture&lt;sutherland&lt;janaf&lt;perfectGas&lt;specie&gt;&gt;,sensibleEnthalpy&gt;&gt;&gt;</code><br>隐藏了一些信息，如 <code>psiReactionThermo</code>和 <code>SpecieMixture</code> 。</p><p>具体过程：<br><code>typeName()</code> 依次调用 <code>reactingMixture</code>，<code>sutherlandTransport</code>, <code>species::thermo</code>, <code>janafThermo</code>, <code>sensibleEnthalpy</code>, <code>perfectGas</code>, <code>specie</code> 的 <code>typeName()</code>。返回值依次是：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;reactingMixture&lt;&quot; + ThermoType::typeName() + &#39;&gt;&#39;</span><br><span class="line">sutherland&lt;&quot; + Thermo::typeName() + &#39;&gt;&#39;</span><br><span class="line">Thermo::typeName() + &#39;,&#39; + Type&lt;thermo&lt;Thermo, Type&gt;&gt;::typeName()</span><br><span class="line">&quot;janaf&lt;&quot; + EquationOfState::typeName() + &#39;&gt;&#39;</span><br><span class="line">&quot;sensibleEnthalpy&quot;</span><br><span class="line">&quot;perfectGas&lt;&quot; + word(Specie::typeName_()) + &#39;&gt;&#39;</span><br></pre></td></tr></table></figure><p>最底层的 <code>specie</code> 类只有一个 <code>ClassName(&quot;specie&quot;)</code>;<br>我们找到一个文件<code>className.H</code> 中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ClassName(TypeNameString)                             \</span></span><br><span class="line">ClassNameNoDebug(TypeNameString);                         \</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> debug</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ClassNameNoDebug(TypeNameString)                      \</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">typeName_</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> TypeNameString; &#125; \</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> ::Foam::<span class="keyword">word</span> typeName</span><br></pre></td></tr></table></figure><p>所以这里的意义就在于用简化版的字符串表示完整的类型。而简化版的字符串则是读取 thermophysicalProperties 之后稍作处理得到的。（在前面的2 参数的 lookupThermo 中）</p><h2 id="makethermophysicsreactionthermos"><a class="markdownIt-Anchor" href="#makethermophysicsreactionthermos"></a> makeThermoPhysicsReactionThermos</h2><p>定义如下：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> makeThermoPhysicsReactionThermos(BaseThermo,BaseReactionThermo,CThermo,Mixture,ThermoPhys)</span></span><br><span class="line"><span class="comment">// 定义于 makeReactionThermo.H</span></span><br><span class="line">    defineThermoPhysicsReactionThermo(BaseReactionThermo,CThermo,Mixture,ThermoPhys);</span><br><span class="line"></span><br><span class="line">    addThermoPhysicsThermo(basicThermo, CThermo##Mixture##ThermoPhys);</span><br><span class="line">    addThermoPhysicsThermo(fluidThermo, CThermo##Mixture##ThermoPhys);</span><br><span class="line">    addThermoPhysicsThermo(BaseThermo, CThermo##Mixture##ThermoPhys);</span><br><span class="line">    addThermoPhysicsThermo(BaseReactionThermo, CThermo##Mixture##ThermoPhys)</span><br></pre></td></tr></table></figure><p>调用了上边的 <code>defineThermoPhysicsReactionThermo</code> 用于创建 <code>RTS</code> 中的 <code>typeName</code>，调用了 <code>addThermoPhysicsThermo</code>（位于 <code>makeThermo.H</code>）, 用于写入到 <code>RTS</code> 哈希表。<br><code>makeThermoPhysicsReactionThermos</code> 函数的形参：<code>(BaseThermo,BaseReactionThermo,CThermo,Mixture,ThermoPhys)</code>，这是实例化需要提供的所有信息。<br>比如其中的一种组合：<code>makeThermoPhysicsReactionThermos(psiThermo,psiReactionThermo,hePsiThermo,reactingMixture,gasHThermoPhysics)</code>（所有的组合在 <a href="https://github.com/OpenFOAM/OpenFOAM-dev/blob/master/src/thermophysicalModels/reactionThermo/psiReactionThermo/psiReactionThermos.C" target="_blank" rel="external nofollow noopener noreferrer"><code>psiReactionThermos.C</code></a> 中列出）。</p><p>这里调用 4 个 addThermoPhysicsThermo 函数是为何？假定先分析第一个 addThermoPhysicsThermo 函数：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> addThermoPhysicsThermo(BaseThermo_,CThermoMixtureThermoPhys_) <span class="comment">//定义于makeThermo.H</span></span></span><br><span class="line">    addToRunTimeSelectionTable</span><br><span class="line">    (</span><br><span class="line">        BaseThermo_,<span class="comment">//基类名</span></span><br><span class="line">        CThermoMixtureThermoPhys_,<span class="comment">//派生类名</span></span><br><span class="line">        fvMesh</span><br><span class="line">    );</span><br></pre></td></tr></table></figure><p><code>BaseThermo_</code> 是 <code>basicThermo</code>，<code>CThermoMixtureThermoPhys_</code> 是<code>hePsiThermo##reactingMixture##gasHThermoPhysics</code>。</p><p>这里的 <code>addToRunTimeSelectionTable</code> 函数定义于 <code>addToRunTimeSelectionTable.H</code> 中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> addToRunTimeSelectionTable(baseType,thisType,argNames)</span></span><br><span class="line">    baseType::add##argNames##ConstructorToTable&lt;thisType&gt;</span><br><span class="line">        add##thisType##argNames##ConstructorTo##baseType##Table_</span><br></pre></td></tr></table></figure><p><code>addfvMeshConstructorToTable</code> 这个类是在 <code>runTimeSelectionTables.H</code> 文件中的 <code>declareRunTimeSelectionTable</code> 宏函数中定义的。</p><p>所以 <code>addThermoPhysicsThermo</code> 中创建了一个 <code>baseType::addfvMeshConstructorToTable&lt;thisType&gt;</code> 类的对象 <code>add##thisType##fvMesh##ConstructorTo##baseType##Table_</code>，而该对象构造时会往哈希表中插入键和值，即派生类的名字和 New 函数，此函数返回指向派生类对象的基类指针。<br>这里的基类 <code>baseType</code> 是 <code>basicThermo</code>，派生类 <code>thisType</code> 是 <code>hePsiThermo##reactingMixture##gasHThermoPhysics</code>，这里是省略版。</p><h1 id="of-8"><a class="markdownIt-Anchor" href="#of-8"></a> OF-8</h1><p>OF-8 去除了 <code>reactingMixture</code> 这个类！<br>它的成员 <code>speciesComposition_</code> 移至 <code>multiComponentMixture</code> 中。<br>另外 <code>multiComponentMixture</code> 还新增了 <code>readSpeciesData</code> 和 <code>readSpeciesComposition</code> 这两个函数，用于初始化 <code>specieThermos_</code> 和 <code>speciesComposition_</code>。</p><p>之前（OF-7）化学反应的信息是保存在 <code>reactingMixture</code> 中，然后复制到 <code>StandardChemistryModel</code>中的 <code>reactions_</code><br>现在（OF-8）是直接保存在 <code>StandardChemistryModel</code> 中的 <code>reactions_</code>。</p><p>化学反应的信息在 <code>StandardChemistryModel</code> 中，以前（OF-7）是</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> PtrList&lt;Reaction&lt;ThermoType&gt;&gt;&amp; reactions_;</span><br></pre></td></tr></table></figure><p>以前（OF-7）是下面这样，调用的是复制构造函数，因为所有的化学反应的信息都包含在 <code>reactingMixture</code> 中！</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">reactions_</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">dynamic_cast</span>&lt;<span class="keyword">const</span> reactingMixture&lt;ThermoType&gt;&amp;&gt;(<span class="keyword">this</span>-&gt;thermo())</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>现在（OF-8）是</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> ReactionList&lt;ThermoType&gt; reactions_;</span><br></pre></td></tr></table></figure><p>现在在 <code>StandardChemistryModel</code> 中是这样构造：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">reactions_</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">dynamic_cast</span>&lt;<span class="keyword">const</span> multiComponentMixture&lt;ThermoType&gt;&amp;&gt;</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">this</span>-&gt;thermo()</span><br><span class="line">    ).species(),</span><br><span class="line">    specieThermo_,</span><br><span class="line">    <span class="keyword">this</span>-&gt;mesh(),</span><br><span class="line">    *<span class="keyword">this</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>调用的是这个构造函数：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//- Construct from thermo list, objectRegistry and dictionary</span></span><br><span class="line">ReactionList</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> speciesTable&amp; species,</span><br><span class="line">    <span class="keyword">const</span> PtrList&lt;ThermoType&gt;&amp; speciesThermo,</span><br><span class="line">    <span class="keyword">const</span> objectRegistry&amp; ob,</span><br><span class="line">    <span class="keyword">const</span> dictionary&amp; dict</span><br><span class="line">);basicThermo</span><br></pre></td></tr></table></figure><p>下图是热物理库部分类的 UML 类图。欲获取更佳阅读体验，可以右键在新标签页打开该图。</p><details><summary>OF-8 UML</summary><img src="http://www.plantuml.com/plantuml/svg/nHhRRjp6zTdvYa4222jtPTXvAR1I1TYoP3ckQyDQL4Wl44Rah3WnR-KCrnPS0qPT-D86JL-ADeO3j42A6WNI56WVdBH1VqQhs4_zXSw5NCuCXrmELq3z82zvpfmpvphdd240m0iX8O2aoCC8F7W7o7y71-1sXgUG8k132jbp2LcxbsG-Y664gbV4Wo7Cm8UrDr4IxYDy5D03XV1D51sY34posACuYOb2_3iUUwQ0irWHF0QhGBoQ8nI4zvi07pO1xgY0X_nF8VF6pzVyv5wy1bAKJP17hq4o0di2nh6aVYhOXWHjFkWe4Q6GOa-o1eT94W8SUqcKPeWGV1WYy3qmWI51RGj8uWL9nbxMSALiMP0CqY4ODuY-smRSIjkWswrBfmFG0jvB1rA8ufcXQi-DwwRzrgK4j-tsH-rQkCcaCH24brIMhppb8nZ3oJX0MPICmFRFSiYjVckonood-8o2jM4WQTvpEpyCcMsDEDFz0CSKn5i9cap80VE2xywnw76AV3G1E_W-yh-F2TsG4Wtdw9kC1FjnESlWSOVmBfKS9lSEc3e25htyV-QoKH9NQ1LDm56sqeAR3O6Hgi5RTZ1Di0-y07bthyTfJgyoi1dKQr8h5OyL-PiCJ0ClYaufROWZJ0TDpi5rqPHMX88QWL9hDN1zzweEEw0h6Ysn2Of5FjcEQG33zDWjpdTXAvIqGYTDyk-rBRj6g6yprrKa_09F4Q0iTa1Ea0ycIGO-W5voY65iiP-_bVfZQ_YQQgc2MAP_CXfH4Q9W1COibgnhBbpOLAEPeueVLQoRIpOaWkif8SvM5AFiwFW7ulHxa26QPp5uDtXt_Q4LEsx3AqrVPbIvgnKWHHwgsVidCNW02YeIVA5qcNLW8Ndbc9C5pNI1XV0b2wdTRLSgnVPAhxJG73SJ3IJTYyrqnupm7AiWBlweBj3cHgPlw1Y5Qmo5kstQAgwhPagMvgP9M7jNdGuHl7-TnOijmHQEjsDnl7cw1uF9C1sEBmu7SfUZqVcTLUN1t_77whF8cAj3fKhnCJoA4y9sHSewnJ4NIv5m7E8OIUSEa0o34aTnQ4jcAQ17C8fW2xpqtMQCtUqMuBKMsEKMc9Us08Es3GUa3UYLsNVTWBGcxG2rGRrf6nIrKaQjHybHYoZMXSnfMF64GtoOuJnYeGg5vnJ1wX-p_CSzhlAZWjYD5aOtsannmsi3tcT04rPuR8aISvHXR9539FQrJOeYLbL2bdCGNpn56U4IjHKeFA7j5Za9D5KRB6_jaeL8S36XRJBONeW36t6M4zM_uVdZmsEx6UP8NkE1R-JZAb7d_4q8Ot-SmPYaIKOjkRgEP3lA5nJFbmalcHsANHXwHJKNvPVOqal3A7-V_V_-gacQ-RylK0TggongGvugorR9nqA_C6F58l-zwbOFHtcRyk_2D6qDSbO11J2mckSG4kpTnFU5Hynj8zxAnhg0LIQfmtHB99IrPwn4D3JxNk48OyYRxEAXWefMYPzRcu0db6arpNZlDiq4T9g4UqAU7On2VrCPRtGQOgZyLygdMgKiZaxsYa8S4yscSWKtgdMDtFL0Oc5xor09kLBYcuZ2_mYYbtLoDVZr63PWDAXhXOzYZFsqeTRsfQ9m34aYX8Se1DYal0Yz8_MQvZkoMM0nvYyd__hpoUjVd_xXos-__lBDfozcJxyv_TtVjSYJUcKOOi___VV7AQlAs6DnhbHxnndDOLWUD_lOy05MV5riGcQjMdTaFbKgiBLEmRg6HcajO9m8L6tgKZnTrbVLdXDBel9pNMpkrsLzrOqliL-ov7w9-txXClk5I-uNEk-N7NvBiNHPhvseIt5r9A6VrFeoDyPM4ZhdwkJNpl7g_8_oaEAj94gJ6CLKAG6i036FiLHgyzwx7EJ80i9AOwF2x5JPbKUNigp8z_8DAotEhPN3s5r80d7kRyY9hC3R3b74-6-MwuZO4i6yV138Z403nBAYsbcKKu5JxGn4KiOkE3_aGuLpzM61LjYSiuhFIr5fJo9cjFNAKvRWLtdzMHo8pI8gr1HOAz5XIw4bdWxCiR6ijfCiOoNZJUOREvdi9bbT9fImkAgpA695TuIob2b7ShgNh3zyvvnU89gQACcfMh2IrDn1cVgz-S-dRvz-FFlRYvEldfzy_UJDFr-zVVh9xDaJLd3CVlN7qyyUpxxwn-opfuPWbK2idK1XMCI9LaVnzmsbfheyXTGBTg1Nnlb0lC1bRo9fJHYy0otEalded19BBZeTrptLY7NT77EFEyn75LzKlKDu5lVXkiUkQXIKIIDFYQnnOVqmZdrql-vigW2g6nb5dDtJVbmW_NIzc63QSodBmMj0IyiZKFpGqwY6iw6WQFbpxdQsV7_o-ejlN_pozFcZqvVFc-hW1SMTK_6mfTz05aNxtEOAhVLk_AUE_ATT-JiSyKuxA5fr6plX5TTlAUwij-FcQ4HvsQq1dtto2vvodlt-pPzUISi3tj84icAWuEtZRtXxKzVGd8BQNB4bHFHM5GDTFs3S214CA-ZUFSpq0VpKfmTMILe6vhNMCKoIktbwAzlYUyroZnOcdqnl8XAiW8ZzBPEB5y3ilBYnCHCMbv6VAo10Lv8yzfavU6WHfOMse5nXAZ7GNBv642DsRd-krdNhxPBGEbDCYZ8ghwJCBpI6m6gb-OtKzLl9uKTChQFHKPRagQ0XrrMuok7LaQkH-HJV78tggmr-1wlrkxJY8gEYKrgsoBYbKM_pKD8S89siMdKdR4NI45D9eYO7dRyUQhVyKKfNw_b8BLrO3h15lz1THNLWpM-MJr3Q4CjFJ-muIYIPDOg8BaNFYmO52vCnCLTqIE9ci0QeGNNsyKw01guvMhzNwPQa0qjTmxr7LZ-a7wt5HqnDMkAc7EAk7D93EUGCbKFwAmUwAGUwAmVsK0uyG-N0pignRjzpgqpuZLPvotuc-zS9BXPYN9yvDzX-h9p2ProUBgFn7jNeKknILtxfiWpbFRqZq_9oVpnSpDOUlA9SRFGEIqKl5sZi_Wy5VST97N9ZM2vgiMGrtZC_Zfc4EVRDHa9vQMya16Toq5JEivAhwqrSKqIdbeYs-aBQaYIgUknEK1Q89YCVXHGoiClPmRzZTJMj_ER5oR3LPp9z0tJVZU5-JxUDSZS-_FAw5wCu7xH5Bp5mUyRxzcJI8-JvgcLi9S9uU_xPW3NbKVV4K56i9qJQbYwK9A1yWK-mcIpchxhD78p6dwq-M6y2Hda5OqIL12Qd5Ug4QlRorUaNdylXLjTfbTBLz6Xeb9qfkdBVcMEUMdTFKev1x1x0rRVufJDeBdEd-2JCuZeww46DTNr6oR-bKUVkrhPI6HQqBjOxKo52mmLOWEQV5Xl3rveKraLNR1Ex4hwXG8UWQNBRuMjHuKiunbIRDtMEnW1fmOXzPPIr9JsKwwtUXQyw7lVy7exFV5HPHoFrqoCnKzUCLSujpjC04ylSGjgo3sLzBcBGjoMUsUT_UVlurUpP4xSuhyykIfvSyG-TPnxjgnSFFpeDAnRrhbs9k1_6GVrZB8VXHQTXGwTzMHQvQyGoJ32_2dOOFdGQ5fo1vM1FotdTpn8n5K0TXWnkf1pDoZhzNf9kfTqbPUszqV8wJX7S6uskJSQuXyAcVJNc9eynPEW-OEYrk_tkVFQrc_SbPmkzvWfzPWhTvmbd85rZE-CcDITZRLZS6YkjXN9ednfPYpDtNkCfLT_jUfkal9JLtlnngOAl-Zmz3ncgLlQf0v_YOl_bezblVtFo-j79wx_sRL4aYuV_0m00"></details>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> thermophysicalModels </tag>
            
            <tag> RTS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM 如何从焓得到温度</title>
      <link href="/T_calculate/"/>
      <url>/T_calculate/</url>
      
        <content type="html"><![CDATA[<p>OpenFOAM 是如何从焓得到温度的</p><a id="more"></a><p>在 solver 中，求解完 h（单位是 J/Kg）的方程之后，调用 <code>thermo.correct();</code> 该函数位于 <a href="https://github.com/OpenFOAM/OpenFOAM-dev/blob/master/src/thermophysicalModels/basic/psiThermo/hePsiThermo.C" target="_blank" rel="external nofollow noopener noreferrer">hePsiThermo.C</a>的 <code>correct()</code> 函数中，调用了 <code>calculate()</code>，<code>calculate()</code> 大致内容如下：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> scalarField&amp; hCells = <span class="keyword">this</span>-&gt;he_;</span><br><span class="line"><span class="keyword">const</span> scalarField&amp; pCells = <span class="keyword">this</span>-&gt;p_;</span><br><span class="line">scalarField&amp; TCells = <span class="keyword">this</span>-&gt;T_.primitiveFieldRef();</span><br><span class="line"></span><br><span class="line">    TCells[celli] = mixture_.THE</span><br><span class="line">    (</span><br><span class="line">        hCells[celli],</span><br><span class="line">        pCells[celli],</span><br><span class="line">        TCells[celli]</span><br><span class="line">    );</span><br></pre></td></tr></table></figure><p><code>THE(h,p,T)</code> 函数在 <a href="https://github.com/OpenFOAM/OpenFOAM-dev/blob/master/src/thermophysicalModels/specie/thermo/thermo/thermoI.H" target="_blank" rel="external nofollow noopener noreferrer">thermoI.H</a></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> Foam::scalar Foam::species::thermo&lt;Thermo, Type&gt;::THE</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar he,</span><br><span class="line">    <span class="keyword">const</span> scalar p,</span><br><span class="line">    <span class="keyword">const</span> scalar T0</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> Type&lt;thermo&lt;Thermo, Type&gt;&gt;::THE(*<span class="keyword">this</span>, he, p, T0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>THE(*this, he, p, T0)</code> 函数在 <a href="https://github.com/OpenFOAM/OpenFOAM-dev/blob/master/src/thermophysicalModels/specie/thermo/sensibleEnthalpy/sensibleEnthalpy.H" target="_blank" rel="external nofollow noopener noreferrer">sensibleEnthalpy.H</a></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">scalar THE</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> Thermo&amp; thermo,</span><br><span class="line">    <span class="keyword">const</span> scalar h,</span><br><span class="line">    <span class="keyword">const</span> scalar p,</span><br><span class="line">    <span class="keyword">const</span> scalar T0</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> thermo.THs(h, p, T0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>THs(h, p, T0) 函数在 <a href="https://github.com/OpenFOAM/OpenFOAM-dev/blob/master/src/thermophysicalModels/specie/thermo/thermo/thermoI.H" target="_blank" rel="external nofollow noopener noreferrer">thermoI.H</a></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> Foam::scalar Foam::species::thermo&lt;Thermo, Type&gt;::THs</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar hs,</span><br><span class="line">    <span class="keyword">const</span> scalar p,</span><br><span class="line">    <span class="keyword">const</span> scalar T0</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> T</span><br><span class="line">    (</span><br><span class="line">        hs,</span><br><span class="line">        p,</span><br><span class="line">        T0,</span><br><span class="line">        &amp;thermo&lt;Thermo, Type&gt;::Hs,</span><br><span class="line">        &amp;thermo&lt;Thermo, Type&gt;::Cp,</span><br><span class="line">        &amp;thermo&lt;Thermo, Type&gt;::limit</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>T(···) 函数在 <a href="https://github.com/OpenFOAM/OpenFOAM-dev/blob/master/src/thermophysicalModels/specie/thermo/thermo/thermoI.H" target="_blank" rel="external nofollow noopener noreferrer">thermoI.H</a></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> Foam::scalar Foam::species::thermo&lt;Thermo, Type&gt;::T</span><br><span class="line">(</span><br><span class="line">    scalar f,</span><br><span class="line">    scalar p,</span><br><span class="line">    scalar T0,</span><br><span class="line">    scalar (thermo&lt;Thermo, Type&gt;::*F)(<span class="keyword">const</span> scalar, <span class="keyword">const</span> scalar) <span class="keyword">const</span>,</span><br><span class="line">    scalar (thermo&lt;Thermo, Type&gt;::*dFdT)(<span class="keyword">const</span> scalar, <span class="keyword">const</span> scalar) <span class="keyword">const</span>,</span><br><span class="line">    scalar (thermo&lt;Thermo, Type&gt;::*limit)(<span class="keyword">const</span> scalar) <span class="keyword">const</span></span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (T0 &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        FatalErrorInFunction</span><br><span class="line">            &lt;&lt; <span class="string">"Negative initial temperature T0: "</span> &lt;&lt; T0</span><br><span class="line">            &lt;&lt; <span class="built_in">abort</span>(FatalError);</span><br><span class="line">    &#125;</span><br><span class="line">    scalar Test = T0;</span><br><span class="line">    scalar Tnew = T0;</span><br><span class="line">    scalar Ttol = T0*tol_;</span><br><span class="line">    <span class="keyword">int</span>    iter = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        Test = Tnew;</span><br><span class="line">        Tnew =</span><br><span class="line">            (<span class="keyword">this</span>-&gt;*limit)</span><br><span class="line">            (Test - ((<span class="keyword">this</span>-&gt;*F)(p, Test) - f)/(<span class="keyword">this</span>-&gt;*dFdT)(p, Test));</span><br><span class="line">        <span class="keyword">if</span> (iter++ &gt; maxIter_)</span><br><span class="line">        &#123;</span><br><span class="line">            FatalErrorInFunction</span><br><span class="line">                &lt;&lt; <span class="string">"Maximum number of iterations exceeded: "</span> &lt;&lt; maxIter_</span><br><span class="line">                &lt;&lt; <span class="built_in">abort</span>(FatalError);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">while</span> (mag(Tnew - Test) &gt; Ttol);</span><br><span class="line">    <span class="keyword">return</span> Tnew;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上边的 F 是 Hs 函数（单位是 J/Kg），dFdT 是 Cp 函数，f 是输运方程求解得到的每个网格的 hs（单位是 J/Kg），Test 是 Told。</p><p>为了通过焓求温度，利用牛顿迭代法求解 Hs(p_old,T) - hs =0 ，令 f(x) = Hs(p_old,T) - hs，则：<br><code>T_new = T_old - [ Hs(p_old,T_old) - hs（输运方程得到的）]/Cp(p_old,T_old)</code></p><p>由 Ha 求 T 呢？也是<br><code>T_new = T_old - [ Ha(p_old,T_old) - ha（输运方程得到的）]/Cp(p_old,T_old)</code></p><p>上边用到了 Hs(p,T) 和 Cp(p,T) 函数，位于 <a href="https://github.com/OpenFOAM/OpenFOAM-dev/blob/master/src/thermophysicalModels/specie/thermo/janaf/janafThermoI.H" target="_blank" rel="external nofollow noopener noreferrer">janafThermoI.H</a></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> Foam::scalar Foam::janafThermo&lt;EquationOfState&gt;::Ha</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar p,</span><br><span class="line">    <span class="keyword">const</span> scalar T</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> coeffArray&amp; a = coeffs(T);</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">    (</span><br><span class="line">        ((((a[<span class="number">4</span>]/<span class="number">5.0</span>*T + a[<span class="number">3</span>]/<span class="number">4.0</span>)*T + a[<span class="number">2</span>]/<span class="number">3.0</span>)*T + a[<span class="number">1</span>]/<span class="number">2.0</span>)*T + a[<span class="number">0</span>])*T</span><br><span class="line">      + a[<span class="number">5</span>]</span><br><span class="line">    ) + EquationOfState::H(p, T);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> Foam::scalar Foam::janafThermo&lt;EquationOfState&gt;::Hs</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar p,</span><br><span class="line">    <span class="keyword">const</span> scalar T</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> Ha(p, T) - Hc();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> Foam::scalar Foam::janafThermo&lt;EquationOfState&gt;::Hc() <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> coeffArray&amp; a = lowCpCoeffs_;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">    (</span><br><span class="line">        (</span><br><span class="line">            (((a[<span class="number">4</span>]/<span class="number">5.0</span>*Tstd + a[<span class="number">3</span>]/<span class="number">4.0</span>)*Tstd + a[<span class="number">2</span>]/<span class="number">3.0</span>)*Tstd + a[<span class="number">1</span>]/<span class="number">2.0</span>)*Tstd</span><br><span class="line">          + a[<span class="number">0</span>]</span><br><span class="line">        )*Tstd + a[<span class="number">5</span>]</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> Foam::scalar Foam::janafThermo&lt;EquationOfState&gt;::Cp</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar p,</span><br><span class="line">    <span class="keyword">const</span> scalar T</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> coeffArray&amp; a = coeffs(T);</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">        ((((a[<span class="number">4</span>]*T + a[<span class="number">3</span>])*T + a[<span class="number">2</span>])*T + a[<span class="number">1</span>])*T + a[<span class="number">0</span>])</span><br><span class="line">      + EquationOfState::Cp(p, T);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中 EquationOfState::Cp(p, T) 来自 <a href="https://github.com/OpenFOAM/OpenFOAM-dev/blob/master/src/thermophysicalModels/specie/equationOfState/perfectGas/perfectGasI.H" target="_blank" rel="external nofollow noopener noreferrer">perfectGasI.H</a></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">inline</span> Foam::scalar Foam::perfectGas&lt;Specie&gt;::Cp(scalar p, scalar T) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上边 <a href="https://github.com/OpenFOAM/OpenFOAM-dev/blob/master/src/thermophysicalModels/specie/thermo/janaf/janafThermoI.H" target="_blank" rel="external nofollow noopener noreferrer">janafThermoI.H</a> 还用到了机理 therm.dat 文件的系数，但是是经过转换的系数：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="keyword">const</span> <span class="keyword">typename</span> Foam::janafThermo&lt;EquationOfState&gt;::coeffArray&amp;</span><br><span class="line">Foam::janafThermo&lt;EquationOfState&gt;::coeffs</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar T</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (T &lt; Tcommon_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> lowCpCoeffs_;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> highCpCoeffs_;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Convert coefficients to mass-basis</span></span><br><span class="line"><span class="keyword">for</span> (label coefLabel=<span class="number">0</span>; coefLabel&lt;nCoeffs_; coefLabel++)</span><br><span class="line">&#123;</span><br><span class="line">    highCpCoeffs_[coefLabel] *= <span class="keyword">this</span>-&gt;R();</span><br><span class="line">    lowCpCoeffs_[coefLabel] *= <span class="keyword">this</span>-&gt;R();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>意思就是，系数从 therm.dat 读取进来，先乘一个 R()， 再拿来使用的。</p><p>还有一个 HE 函数，忘了有什么用了。。。位于 <a href="https://github.com/OpenFOAM/OpenFOAM-dev/blob/master/src/thermophysicalModels/specie/thermo/sensibleEnthalpy/sensibleEnthalpy.H" target="_blank" rel="external nofollow noopener noreferrer">sensibleEnthalpy.H</a></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">scalar HE</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> Thermo&amp; thermo,</span><br><span class="line">    <span class="keyword">const</span> scalar p,</span><br><span class="line">    <span class="keyword">const</span> scalar T</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> thermo.Hs(p, T);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>另外 <a href="https://github.com/OpenFOAM/OpenFOAM-dev/blob/master/src/thermophysicalModels/specie/thermo/thermo/thermoI.H" target="_blank" rel="external nofollow noopener noreferrer">thermoI.H</a> 中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> Foam::scalar</span><br><span class="line">Foam::species::thermo&lt;Thermo, Type&gt;::HE(<span class="keyword">const</span> scalar p, <span class="keyword">const</span> scalar T) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> Type&lt;thermo&lt;Thermo, Type&gt;&gt;::HE(*<span class="keyword">this</span>, p, T);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> Foam::scalar</span><br><span class="line">Foam::species::thermo&lt;Thermo, Type&gt;::he(<span class="keyword">const</span> scalar p, <span class="keyword">const</span> scalar T) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>-&gt;HE(p, T)*<span class="keyword">this</span>-&gt;W();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可能是一般调用的是抽象出来的 <code>HE(p,T) 或 he(p,T)</code> 函数，最终实际调用的是 Hs(p, T) 或 Es 或 Ha 或 Ea（根据能量形式自动选择）。<br>小写单位是 [J/kmol]，大写单位是 [J/kg]。输运方程中求解的量也是 [J/kg]。</p>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> thermophysicalModels </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++ primer 阅读笔记</title>
      <link href="/CppPrimer/"/>
      <url>/CppPrimer/</url>
      
        <content type="html"><![CDATA[<p>C++ primer阅读笔记</p><a id="more"></a><ol><li><code>++val</code> 和 <code>val=val+1</code> 等效。</li><li><code>tmp</code> 指针后边加括号，返回的是它所指的对象。</li><li>成员函数的调用方法：<code>对象.函数()</code>，<code>引用.函数()</code> 或<code>指针-&gt;函数</code> <code>.</code>称为点操作符，函数名后边必须加括号，括号里边是实参列表，可以为空，也可以是另一个对象。</li><li>无符号类型 <code>unsigned</code></li><li><code>std::cout</code> 中的 <code>::</code> 是作用域操作符，一个命名空间后边接一个对象名。</li><li>初始化分两种：直接初始化和复制初始化。<ul><li>直接初始化： <code>int ival(1024);</code></li><li>复制初始化： <code>int ival=1024;</code></li></ul></li><li>定义如何进行初始化的成员函数称为构造函数，构造函数可以有多个，每个构造接受不同数目或者类型的参数。 此外，如果定义某个类的变量时没有提供初始化式，则使用默认构造函数。如果没有默认构造函数，则必须提供显式的初始化式。</li><li>对象可以用任意复杂的表达式（包括函数的返回值）来初始化:</li></ol><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">double</span> salary = <span class="number">99.99</span>, wage(salary + <span class="number">0.01</span>) ;          </span><br><span class="line"><span class="keyword">double</span> sale = sum(price,discount);</span><br></pre></td></tr></table></figure><ol start="11"><li>变量一定要初始化。</li><li>变量的定义（definition）用于为变量分配存储空间，还可以为变量指定初始值。在一个程序中，变量有且只有一个定义。</li><li>声明（declaration）用于向程序表明变量的类型和名字。定义也是声明：当定义变量时我们声明了它的类型和名字。可以通过使用extern关键字声明变量名而不定义它。不定义变量的声明包括对象名、对象类型和对象类型前的关键字extern</li><li><code>extern int i; // 声明但没有定义</code></li><li><code>int i; //声明并且定义了</code></li><li>变量可以申明多次，但只能定义一次。</li><li>例外，只有当 <code>extern</code> 声明位于函数外部时，才可以含有初始化式。 <code>extern double pi = 3.14</code> ( 声明并且定义了 )</li><li>变量必须且仅能定义一次，在使用变量前必须定义或声明变量。</li><li>多个文件共享一个变量，在一个文件中定义，其他文件中声明。</li><li>常量定义 <code>const int zuff = 512;</code></li><li>因为常量在定义后就不能修改，所以定义时必须初始化。</li><li>非 <code>const</code> 变量默认为 <code>extern</code>。要使 <code>const</code> 变量能够在其他的文件中访问，必须在定义它时显式地指定它为 <code>extern</code></li><li><code>int ival = 1024;</code></li><li><code>int &amp;refval = ival;</code></li><li>引用必须用与该引用同类型的对象初始化。</li><li>引用与被引用指向同一地址</li><li><code>const</code> 引用是指向 <code>const</code> 对象的引用，如下：<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">const int ival &#x3D; 1024;</span><br><span class="line">const int &amp;refval  &#x3D; ival;</span><br></pre></td></tr></table></figure></li><li><code>const</code> 对象不能有非 <code>const</code> 引用，如 <code>Int &amp;ref2 = ival</code> 是错误的！</li><li><code>const</code> 引用可以初始化为不同类型的对象或者初始化为右值。如：</li><li><code>int i = 42; const int &amp;r = 42; const int &amp;r2 = r + i;</code><br>上边的这两种初始化对于非const引用却是不合法的。</li><li><code>typedef</code> 用于给类型起别名，如 <code>typedef double wage</code> 表示 wage 就是 double 类型的别名，可以用来定义对象</li><li>类 通过构造函数初始化数据成员</li><li>struct 也可以定义类</li><li>默认情况下，struct 的成员是 pubic，而 class 的成员是 private</li><li>头文件不能包含定义，只能有声明，但有三个例外：头文件可以定义类，值在编译时就已知的 const 对象和 inline 函数。</li><li>argc 是程序的参数数量，包含程序名本身</li><li>argv[] 指向命令行的每个字符</li><li>vector 是类模板， <code>vector&lt;int&gt; ival;</code> 类型放在尖括号中</li><li>双冒号（::）用法<ul><li>表示“域操作符”<br>例：声明了一个类 A，类 A 里声明了一个成员函数void f()，但没有在类的声明里给出f的定义，那么在类外定义 f 时，就要写成void A::f()，表示这个 f()函数是类A的成员函数</li></ul></li><li>c++ 中冒号（:）和双冒号（::）的用法 构造函数后边有一个冒号，那是初始化列表区</li><li>指针定义： <code>int a = 1; int *b = &amp;a;</code> * 是解引用操作符，&amp; 是取地址操作符。</li><li>指针本身是地址，* 加指针表示该存储在该地址的对象</li><li>指向 const 的指针，很明显，我们不能通过指针来修改这一数据，但我们可以改变指针所指对象啊。const double *ptr 这个特性可用作函数形参，防止在函数中修改这一变量。const double pi = 3.14; const double *ptr = π</li><li>const 指针： <code>int err = 0; int *const cur = &amp;err;</code> 只能指向这个对象，不能指其他人。必须在定义时初始化</li><li>指向 const 对象的 const 指针，既不能指向它处，也不能修改值。</li><li>函数的形参，如果是普通变量时，是按值传递的，即把实参复制一遍给形参。当使用指针或引用时，即为按址传递，但这样可能不安全（实参有被篡改的风险），所以有了const引用（或指向const的指针）的形参，这样既能按址传递，又能保护实参不被修改。 意思就是，我把实参传过去，只是让它起一些作用，我并不希望修改实参。所以就用const引用。</li><li>使用 const 引用形参有一个好处，即传递给他的实参既可以是 const 类型也可以是非 const 类型。而非 const 引用形参，只能传递给他非 const 实参，字面值常量也不允许传递给他，产生右值的表达式也不能传递给他。</li><li><ul><li>迭代器表示 vector 索引。相当于数组名加下标</li></ul></li><li>对于多维数组，ia[3][4] 表示三行四列，ia[2] 表示最后一行</li><li>可以将 a[3][2] 看成是一个具有 3 个元素的一维数组，因此 a.size()=3</li><li>通过引用传递数组，<code>return_type function(int (&amp;arr)[10]) { body }</code></li><li>返回引用的函数 在函数名前加 &amp;，最前边加上 const 表示返回值不可被修改。即，函数返回值不能当做左值，不能被赋值。</li><li>函数不能仅通过返回类型不同来重载</li><li><a href="http://www.cnblogs.com/yc_sunniwell/archive/2010/07/14/1777416.html" target="_blank" rel="external nofollow noopener noreferrer">C/C++ 中 const 关键字详解</a></li><li>常成员函数： <code>类名::fun(形参) const</code> 又名 const 成员函数，const 成员函数不能修改调用该函数的对象。</li><li>C++ 不允许在常量对象上调用成员函数，除非成员函数本身也被声明为常量。</li><li>当存在同名同参数和返回值的常量函数和非常量函数时，具体调用哪个函数是根据调用对象是常量对像还是非常量对象来决定的。常量对象调用常量成员；非常量对象调用非常量的成员。</li><li>对于非引用形参，const 和非 const 不可以重载。而对于引用或指针形参，const 和非 const 可以重载。<br>对于指针，说的是指向 const 对象的指针，并不是说 const 指针。对于引用，就是 const 引用，即指向 const 的引用。举例：<code>const 类型 &amp;或*</code></li><li>const 位于函数前中后，哪个可以重载？ 后！常量函数和非常量函数可以重载 中，也可以，不过需要引用形参</li><li>• const 在函数后面，保证函数不会修改调用对象。这是常量函数。<br>• const 在函数前面，用于当函数返回值是引用时，不能使用返回的引用来直接修改它指向的结构。<br>• const 在形数表中时，保证既能按引用传递，又不会改变实参原来的值。</li><li>带有默认实参的函数，调用它时，可以省略一个实参。重载的时候，这个默认参数可以不考虑，相当于这个参数不存在。</li><li>对于 const 引用形参的函数，它既可以用 const 实参来调用，也可以用非 const 实参来调用。但同时也存在非 const 形参的函数（即 const 形参和非const形参重载）时，非const实参优先调用非const形参的函数。</li><li>当形参以副本传递时，不能基于形参是否为 const 来实现来重载。就是说非引用形参</li><li>函数的形参可以是指向函数的指针。</li><li>类型转换 <code>static_cast&lt;int&gt;(2.56)</code> 将 2.56 转换成 int 型</li><li>C 风格的强制类型转换(Type Cast)很简单，不管什么类型的转换统统是：<code>TYPE b = (TYPE)a;</code></li><li><a href="http://www.cnblogs.com/goodhacker/archive/2011/07/20/2111996.html" target="_blank" rel="external nofollow noopener noreferrer">C++ 风格的类型转换</a></li><li>在类内部定义的成员函数，自动作为 inline 函数。</li><li>类外定义的函数，在前边加上 inline 就行，类内声明的时候，可以不加 inline。声明和定义，随便加一个 inline 就行。</li><li>const 指针：始终指向某个对象 int *const cur = &amp;err;<br>PS：指向 const 的指针： const int * abc = &amp;var;</li><li>const 引用：指向 const 的引用 const int &amp;refval = ival;</li><li>对于引用或指针形参，const 和非 const 可以重载。这里指的是是否指向 const 对象。</li><li>const函数和非 const 函数也可以重载。</li><li>调用类的成员使用点操作符，对于指针，使用-&gt;操作符。</li><li>定义默认构造函数的时候，如果其中有些成员数据的类型自身有默认构造函数，可以不初始化它，这样调用这个数据的默认构造函数。</li><li>构造函数不能声明为 const，因为他的作用本来就是给新建的对象赋初值，而 const 成员函数不能修改调用它的对象。</li><li>默认构造函数可以在冒号之后初始化，也可以在函数体内初始化。</li><li>但是有些成员，必须在冒号后，即初始化列表中初始化。这些成员是：没有默认构造函数的类型的成员，以及 const 或引用类型的成员。</li><li>构造函数冒号之后，函数体之前，那些变量应该都已经分配内存了，所以引用必须确定引用的对象是谁，const 也必须确定，没有默认构造函数的类型，也必须初始化。那些可以默认初始化的类型，随便都行，比如 int 之类的。</li><li>构造函数初始化的顺序是按类中定义的顺序，不管你在初始化中怎样的顺序。</li><li>逗号操作符从左至右计算每个表达式的值，并返回最右边操作数的值。有什么意义呢？</li><li>在基类中定义 virtual 函数，表示这个函数希望在派生类中重新定义。那么为什么要在基类中出现呢？基类不定义，派生类定义，这样不行吗？用于多态啊</li><li>基类希望派生类继承的函数不能定义为虚函数。</li><li>通过基类的引用（或指针）调用虚函数时，发生动态绑定。基类的引用既可以指向基类对象，也可以指向派生类对象，动态绑定表示运行时，被调用的函数根据引用指向的对象的实际类型来决定。</li><li>除了构造函数之外，任意非 static 成员函数都可以是虚函数。</li><li>private 成员只能由基类的成员和友元访问。派生类对基类 的public和private成员的访问权限同其他代码一样，并不是继承者就可以随意访问，它也无法使用基类的private成员。但有些成员需要派生类访问，所以有了protected。</li><li>protected 相当于给了派生类特权，可以访问基类的某些成员。</li><li>派生类只能通过派生类对象访问基类的 protected 成员，不能访问基类对象的 protected 成员。</li><li>基类提供给派生类的接口包括protected和public</li><li>派生 class classname:access_label base_class 可以指定多个基类.</li><li>派生类中虚函数的声明必须与基类中的定义方式完全一致。但有一个例外，返回对基类的引用的虚函数，派生类中的对应函数既可以返回对派生类的引用，也可以返回对基类的引用。</li><li>派生类定义虚函数时，可以加 virtual，也可以不加。虚函数不管继承多少次，永远是虚函数。</li><li>因为每个派生类对象都包含基类部分，所以可将基类类型的引用绑定到派生类对象的基类部分，也可以用指向基类的指针指向派生类对象。</li><li>任何可以在基类对象上执行的操作也可以通过派生类对象使用。</li><li>如果调用非虚函数，则无论实际对象是什么类型，都执行基类类型所定义的函数；虚函数则根据对象类型来判断。</li><li>使用 class 定义派生类默认具有 private 继承，使用 struct 定义派生类默认具有 public 继承。</li><li>友元可以访问类的 private 和 protected 成员。友元关系不能继承，基类的友元对派生类来说就是普通人一样。</li><li>如果基类和派生类都需要访问另一个类，则那个类必须将访问权限授予 基类和每一个派生类。</li><li>static 成员，相当于整个类的公有变量。对于他的所有派生类也一样，基类和派生类共享 static 成员。</li><li>因为派生类对象也是基类对象，所以存在从派生类引用到基类引用的自动转换，即，可以将派生类对象的引用转换为基类子对象的引用，对指针也类似。</li><li>但是，没有从基类引用到派生类引用的转换。</li><li>虽然一般可以使用派生类的对象对基类对象进行初始化或赋值，但，没有从派生类对象到基类对象的直接转换。只能通过引用或指针。</li><li>当一个函数的形参是基类引用时，可以将派生类对象当做实参，这样的话，形参引用直接绑定到派生类对象上。对象未被复制。</li><li>当一个函数的形参是基类对象时，可以将派生类对象当做实参，这样的话，派生类对象的基类部分复制到形参。</li><li>用派生类对象对基类对象进行初始化或赋值时，实际调用的是基类的复制构造函数和复制操作符，只是这些函数本应该传入一个基类对象，实际上传入的是派生类对象。</li><li>用派生类对象调用基类的复制构造函数或赋值操作符时，将发生下列步骤：</li><li>将派生类对象转换为基类引用，这仅仅意味着将一个基类引用绑定到派生类对象。</li><li>将该引用作为实参传给复制构造函数或赋值操作符。</li><li>那些操作符使用派生类的基类部分分别对调用构造函数或赋值的基类对象的成员进行初始化或赋值。</li><li>一旦操作符执行完毕，对象即为基类对象。它包含派生类的基类部分的副本，但实参的派生类部分被忽略。</li><li>当构造、复制、赋值和撤销派生类对象时，也会构造、复制、赋值和撤销这些基类子对象。</li><li>某些类需要只希望派生类使用的特殊构造函数，这样的构造函数应该定义为 protected。</li><li>派生类的构造函数受继承关系的影响，每个派生类构造函数除了初始化自己的数据成员之外，还要初始化基类。基类部分可以由默认构造函数初始化。</li><li>内置类型，无法默认初始化。</li><li>如果派生类构造函数没有定义基类成员，则自动调用基类默认构造函数，并且是先调用基类构造函数，然后运行派生类构造函数的初始化列表，最后再运行函数体。</li><li>也可以在派生类构造函数中显式指定基类的构造函数。</li><li>在基类构造函数或析构函数中，将派生类对象当做基类对象对待。这会影响动态绑定。</li><li>arugument 实参 parameter 形参</li><li>在普通的非 const 成员函数中，this 的类型是一个指向类类型的 const 指针。可以改变this 所指向的值，但不能改变 this 所保存的地址。<br>在 const 成员函数中，this 的类型是一个指向 const 类类型对象的 const 指针。既不能改变 this 所指向的对象，也不能改变 this 所保存的地址。<br>AAA</li></ol>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linux 命令收藏</title>
      <link href="/linuxLearning/"/>
      <url>/linuxLearning/</url>
      
        <content type="html"><![CDATA[<p>一些很有用的命令</p><a id="more"></a><h1 id="大杀器-sed"><a class="markdownIt-Anchor" href="#大杀器-sed"></a> 大杀器 sed</h1><blockquote><p>sed 用法：<br>d 删除<br>a 在下一行新增<br>i 在上一行插入<br>c 以行为单位的取代<br>-i 直接修改文件<br>-r ???</p></blockquote><ul><li>替换<br><code>sed -r -i 's/被替换字符/替换后的字符/g' fileName</code><br>如果被替换的字符串中包含空格，？？？<br>如果被替换的字符串中 有变量，把最外层的单引号改成双引号，如<br><code>sed -r &quot;s/160.268/$var/g&quot; fileName</code></li><li>替换多行</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">##C list</span></span></span><br><span class="line">python&lt;&lt;EOF</span><br><span class="line">import numpy as np</span><br><span class="line">x=np.linspace(0,1,51)</span><br><span class="line">y=x*x</span><br><span class="line">f = open("Clist", 'w+')  </span><br><span class="line">for y in y:</span><br><span class="line">    print&gt;&gt;f,y</span><br><span class="line">EOF</span><br><span class="line">abc=`awk '&#123;print $1&#125;' Clist|tr "\n" "#"` # 将换行符替换成“#”，将abc缩为一行。</span><br><span class="line">sed -i -e '&#123;:begin;  /)/! &#123; $! &#123; N; b begin &#125;; &#125;; s/C_param\n(.*)/C_param\n(\n'$&#123;abc&#125;')/; &#125;;' ./file</span><br><span class="line"><span class="meta">#</span><span class="bash"> 将C_param下面的括号中的所有行，替换成abc。</span></span><br><span class="line">sed -i 's/#/\n/g' ./fileName #将“#”替换成换行符，就是将abc还原成了一个多行数据。</span><br></pre></td></tr></table></figure><pre><code>这里用python先生成一个数组，然后输出到文件，然后读取这个文件，读取出来是一列数据，我打算将这一列数据替换掉某个文件中的一列其它数据。</code></pre><ul><li>删除行<br><code>sed -i '1d' fileName</code> 删除第一行<br><code>sed -i '$d' fileName</code> 删除最后一行<br><code>sed '/^\s*$/d' fileName</code> 删除空行<br><code>awk '!a[$0]++' fileName</code> 删除重复行<br><code>sed -i 1,35d fileName</code> 删除1-35行<br><code>sed -i 1~2d fileName</code> 从第一行开始,每2行删除一行，即删除1··3··5··7··行。</li><li>删除字符串<br>删除字符串，即把它替换成空。<br><code>sed -r -i 's/欲删除字符串//g' fileName</code></li><li>删除文件中含特定字符串 abc 的行<br>   <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sed -e &#39;&#x2F;abc&#x2F;d&#39; fileName &gt;fileName_NEW</span><br><span class="line">#这个操作好像不能使用 -i ，只能把结果重定向到一个新的文件</span><br><span class="line">sed -e &#39;&#x2F;abc&#x2F;d&#39; fileName &gt;fileName</span><br><span class="line">#这样是不对的，生成的 fileName 是一个空文件</span><br></pre></td></tr></table></figure></li><li>修改文件中包含某个字符串的那一行（适合在脚本中修改 OpenFOAM的参数设置）<br><a href="https://blog.csdn.net/u010312436/article/details/48376725" target="_blank" rel="external nofollow noopener noreferrer">参考</a><br>比如：</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PBS -N caseName</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PBS -l nodes=2:ppn=10</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PBS -j oe</span></span><br><span class="line"><span class="meta">#</span><span class="bash">PBS -l walltime=150:30:00</span></span><br><span class="line">cd $PBS_O_WORKDIR</span><br><span class="line">NP=`cat $PBS_NODEFILE|wc -l`</span><br><span class="line"></span><br><span class="line">n=`grep -n "numberOfSubdomains" system/decomposeParDict | awk -F':' '&#123;print $1&#125;'` </span><br><span class="line">sed -i "$[n]c numberOfSubdomains $NP;" system/decomposeParDict</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这里表示修改第 n 行，c 表示修改某一行</span></span><br><span class="line"></span><br><span class="line">blockMesh</span><br><span class="line">decomposePar -force</span><br><span class="line">mpirun -np $NP -hostfile $PBS_NODEFILE reactingFoam -parallel 2&gt;&amp;1 | tee run.log</span><br></pre></td></tr></table></figure><p>这里的 NP 就是所使用的核心数（这里等于 20），每次修改脚本的 <code>nodes=2:ppn=10</code> 这一行后，就可以不管下边的设置了，关键是不需要修改 decomposeParDict 文件了！因为有时候会忘记改这个参数。</p><h1 id="大杀器-awk"><a class="markdownIt-Anchor" href="#大杀器-awk"></a> 大杀器 awk</h1><p>基本用法： <code>awk -F &quot;用于分隔的符号或者字符串&quot; '{print $分隔后你需要的列号}'</code><br>awk 提取某一列字符,如：</p><pre>stp <font size="4" color="red"><b>=</b></font>     1    dt <font size="4" color="red"><b>=</b></font> 1.00e-09 s    ord <font size="4" color="red"><b>=</b></font> 1    time <font size="4" color="red"><b>=</b></font> <font size="4" color="green"><b>1e-06 msT_max</b></font> <font size="4" color="red"><b>=</b></font>  897.7 KT_st <font size="4" color="red"><b>=</b></font>  875.1 K</pre><p>一个 log 文件，格式的每一行如上所示，现在需要提取 time 和 T_max 到一个新的文件，代码如下：</p><pre>grep stp log | awk -F "<font size="4" color="red"><b>=</b></font>" '{print $5}'|awk -F "<font size="4" color="red"><b>ms</b></font>" '{print $1}' >timegrep stp log | awk -F "<font size="4" color="red"><b>=</b></font>" '{print $6}'|awk -F "<font size="4" color="red"><b>K</b></font>" '{print $1}' >temppaste time temp | awk '{print $1"\t"$2}' >ignition.txt</pre><p>解释，grep 是获取 log 文件中含有 stp 的所有行，awk 的主要功能是对列操作，这里按“等于”号将每一行分隔为若干列，然后取第 5 列，即第四个等于号和第五个等于号之间的字符串<code>1e-06 ms T_max</code>，然后将<code>1e-06 ms T_max</code>按ms分为两列，取第 1 列，即我们需要的“时间”。<br>第二行代码亦如此，获取到<code>T_max</code>，输出到temp文件。<code>&gt;</code>大于号表示输出到文件，若该文件不存在，创建之；若存在，里边内容会被清空。如果使用两个大于号，则不同，<code>&gt;&gt;</code>表示输出到文件，但是是在文件末尾添加新写进去的内容。<br>第三行表示将time文件和temp文件合并成一个，time作为第一列，temp作为第二列。</p><p>列数为变量时如何使用：<br><code>awk -v N=274 '{ print $N}' fileName</code><br>获取第274列数据。</p><h1 id="排序"><a class="markdownIt-Anchor" href="#排序"></a> 排序</h1><pre><code>sort -g # 可以对科学计数法进行从小到大排序逆序：sort -g -r</code></pre><h1 id="循环-自增操作"><a class="markdownIt-Anchor" href="#循环-自增操作"></a> 循环、自增操作</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">for i in `seq 1 100`  </span><br><span class="line">do  </span><br><span class="line">    echo $i  </span><br><span class="line">done</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">files=`ls Pre*`</span><br><span class="line">for file in $files</span><br><span class="line">do  </span><br><span class="line">    echo $file</span><br><span class="line">done</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">transients=`ls *tout.kg|awk -F "t" '&#123;print $2&#125;'|awk -F "ms" '&#123;print $1&#125;'|sort -g`</span><br><span class="line">x=10000</span><br><span class="line">for transient in $transients; do</span><br><span class="line">    mv *"$transient"ms.tout.kg chi$x</span><br><span class="line">    x=`expr $x + 1`#自增</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>break跳出循环。<br>continue命令与break命令类似，只有一点差别，它不会跳出所有循环，仅仅跳出当前循环。</p><h1 id="判断大小"><a class="markdownIt-Anchor" href="#判断大小"></a> 判断大小</h1><p>推荐第三种！</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">if [ $T -lt 1200 ]; then  </span><br><span class="line">语句块</span><br><span class="line">fi</span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果 T 小于1200，这里只使用于整数间的比较</span></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">if [ `expr $T \&lt; $T_ext` -eq 1 ]; then </span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果 T 小于 T_ext</span></span><br><span class="line"><span class="meta">#</span><span class="bash">不支持科学计数法，默认<span class="keyword">if</span>成立，可能会出现 bug</span></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">if [ $(echo "$chi &gt; $chi_ignition" | bc) -eq 1 ]; then </span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果 chi 大于 chi_ignition</span></span><br><span class="line"><span class="meta">#</span><span class="bash">不支持科学计数法，默认 <span class="keyword">if</span> 不成立，即跳过科学计数</span></span><br></pre></td></tr></table></figure><p>PS：科学计数法转十进制：<br>方法1： <code>printf &quot;%f\n&quot; 3.1188622400e+06</code><br>方法2： <code>echo 3.1188622400e+06 | awk '{printf(&quot;%f\n&quot;,$0)}'</code></p><h1 id="删除所有文件except-some-file"><a class="markdownIt-Anchor" href="#删除所有文件except-some-file"></a> 删除所有文件，except some file</h1><p><code>find ./ -name '[^C][^1][^2]*' | xargs rm -rf</code> #删除除了 <code>C12</code> 开头以外的其它文件</p><h1 id="数组"><a class="markdownIt-Anchor" href="#数组"></a> 数组</h1><p><code>index</code> 从 0 开始<br><code>${abc[i]}</code> 表示数组 <code>abc</code> 的第 <code>i</code> 个分量</p><h1 id="实数运算"><a class="markdownIt-Anchor" href="#实数运算"></a> 实数运算</h1><h2 id="整数的加减乘除"><a class="markdownIt-Anchor" href="#整数的加减乘除"></a> 整数的加减乘除：</h2><p>方法一：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">b&#x3D;$((5*5+5-6&#x2F;2))</span><br><span class="line">echo $b</span><br><span class="line">输出：27</span><br></pre></td></tr></table></figure><p>方法二：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">i&#x3D;5</span><br><span class="line">c&#x3D;&#96;expr $i &#x2F; 2&#96;</span><br><span class="line">echo $c</span><br><span class="line">输出：2，可以看出，这里不支持小数</span><br><span class="line">PS: 操作符号两边要有空格，这里的“&#x2F;”也可以是“+”“－”“*”，*不行！</span><br></pre></td></tr></table></figure><h2 id="小数点位数"><a class="markdownIt-Anchor" href="#小数点位数"></a> 小数点位数</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">time=0.00015</span><br><span class="line">time=$(printf "%.4f" `echo "$time + 0.0001"|bc`)</span><br><span class="line">echo $time</span><br></pre></td></tr></table></figure><p>输出：0.0002<br>保留4位小数，后边直接截断，不进行四舍五入。</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">time=0.00015</span><br><span class="line">time=$(echo $time 0.0001 | awk '&#123; printf "%0.4f\n" ,$1+$2&#125;')#time+0.0001</span><br><span class="line">echo $time</span><br></pre></td></tr></table></figure><p>输出：0.0003<br>四舍五入，保留4位小数。</p><h2 id="浮点数的加减乘除"><a class="markdownIt-Anchor" href="#浮点数的加减乘除"></a> 浮点数的加减乘除：</h2><p>方法一：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">c=$(echo "5.01-4*2.0"|bc)</span><br><span class="line">echo $c</span><br><span class="line">输出：-2.99</span><br></pre></td></tr></table></figure><p>例外：<code>c=$(echo &quot;1/1000&quot;|bc)</code>输出为0，因为它是小于1的小数。如何才能正确输出小数呢？</p><p>方法二：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c&#x3D;$(awk &#39;BEGIN&#123;print 7.01*5-4.01 &#125;&#39;)</span><br><span class="line">echo $c</span><br><span class="line">输出：31.04</span><br><span class="line">c&#x3D;$(awk &#39;BEGIN&#123;print 1&#x2F;1000 &#125;&#39;)</span><br><span class="line">echo $c</span><br><span class="line">输出：0.001</span><br></pre></td></tr></table></figure><p>例外：我想输出从 0 到 1 之间的等间距小数</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">for i in &#96;seq 0 10&#96; </span><br><span class="line">do</span><br><span class="line">c&#x3D;$(awk &#39;BEGIN&#123;print $i&#x2F;10 &#125;&#39;)</span><br><span class="line">echo $c </span><br><span class="line">done</span><br><span class="line">输出 11 个 0</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">for i in &#96;seq 1 10&#96; </span><br><span class="line">do</span><br><span class="line">    c&#x3D;$(printf &quot;%.4f&quot; &#96;echo &quot;$i &#x2F; 10&quot;|bc&#96;)</span><br><span class="line">    echo $c </span><br><span class="line">done</span><br><span class="line">依然输出一堆 0.0000，只有最后一个是1.0000</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">for i in &#96;seq 1 10&#96; </span><br><span class="line">do</span><br><span class="line">    c&#x3D;$(echo $i 10 | awk &#39;&#123; printf &quot;%0.4f\n&quot; ,$1&#x2F;$2&#125;&#39;)</span><br><span class="line">    echo $c </span><br><span class="line">done</span><br><span class="line">这个才是正常输出的。</span><br></pre></td></tr></table></figure><h1 id="修改文件名"><a class="markdownIt-Anchor" href="#修改文件名"></a> 修改文件名</h1><h2 id="先来点简单的操作"><a class="markdownIt-Anchor" href="#先来点简单的操作"></a> 先来点简单的操作</h2><p>增加后缀</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find  . -type f -exec mv '&#123;&#125;' '&#123;&#125;'.old \;</span><br></pre></td></tr></table></figure><p>增加前缀</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">for files in $(ls *.png)</span><br><span class="line">    do mv $files "pic."$files</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>去除前缀<br>？？？<br>去除后缀<br>？？？<br><a href="http://www.tracholar.top/2018/06/10/remove-a-fixed-prefix-suffix-from-a-string-in-bash/" target="_blank" rel="external nofollow noopener noreferrer">网址</a></p><h2 id="再来点高级的"><a class="markdownIt-Anchor" href="#再来点高级的"></a> 再来点高级的</h2><p>将文件名拆分，然后重组，如：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ls fileName | sed -r -n 's/(.*)分隔字符(.*)/mv &amp; 替换后的字符\1\2/e'</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这里表示将原文件名按‘分隔字符’拆分为两部分，分别由(.*)对应，也对应 \1 和 \2。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 后边的部分即为新文件名，可以添加任意字符在\1 \2的任何位置，也可以不要 \2，即删去“分隔字符”及其后边的部分。</span></span><br></pre></td></tr></table></figure><p>举例：</p><pre>ls chi* | sed -r -n 's/.*tf(.*)/mv & \1/e' # 分隔为 tf 之后部分，全部保留，即保留 tf 后边的字符串# 原文件名：chi23.0769tf<font size="4" color="red">0363to0900Tst2227.kg</font># 操作后：0363to0900Tst2227.kg#  .* 加不加括号的区别在于，加括号后，才计入分隔的部分中;# 如果不加括号，仅仅表示中间还有若干字符，但是不计入分隔后的部分。ls chi* | sed -r -n 's/(.*)tf.*/mv & \1/e' # 分隔为 tf 之前部分，全部保留，即删去 tf 以及后边的所有字符串。# 原文件名：<font size="4" color="red">chi23.0769</font>tf0363to0900Tst2227.kg# 操作后：chi23.0769ls chi* | sed -r -n 's/(.*)tf.*.kg(.*)/mv & \1\2/e' # 分隔为 tf 之前，和 .kg 之后# 这里分隔后，\1表示chi23.0769，即前边那个(.*)对应的部分，\2表示'AAA'，即后边那个(.*)对应的部分。# 原文件名：<font size="4" color="red">chi23.0769</font>tf0363to0900Tst2227.kg<font size="4" color="red">AAA</font># 操作后：chi23.0769AAAls chi* | sed -r -n 's/(.*)tf(.*).kg(.*)/mv & \1\2\3/e' # tf 和 .kg 把原文件名分隔为三部分，全部保留。# 原文件名：<font size="4" color="red">chi23.0769</font>tf<font size="4" color="red">0363to0900Tst2227</font>.kg<font size="4" color="red">BBB</font># 操作后：chi23.07690363to0900Tst2227BBB</pre>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM 如何更新混合物的属性</title>
      <link href="/mixture/"/>
      <url>/mixture/</url>
      
        <content type="html"><![CDATA[<p>OpenFOAM 如何更新混合物的属性</p><a id="more"></a><p>本文代码全部在 <code>/src/thermophysicalModels</code> 文件夹下。</p><p>温度更新于 <a href="https://cpp.openfoam.org/v3/a09892_source.html" target="_blank" rel="external nofollow noopener noreferrer">/basic/psiThermo/hePsiThermo.C</a> 中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">forAll(TCells, celli)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">typename</span> MixtureType::thermoType&amp; mixture_ =</span><br><span class="line">        <span class="keyword">this</span>-&gt;cellMixture(celli);</span><br><span class="line">    TCells[celli] = mixture_.THE</span><br><span class="line">    (</span><br><span class="line">        hCells[celli],</span><br><span class="line">        pCells[celli],</span><br><span class="line">        TCells[celli]</span><br><span class="line">    );</span><br><span class="line">    psiCells[celli] = mixture_.psi(pCells[celli], TCells[celli]);</span><br><span class="line">    muCells[celli] = mixture_.mu(pCells[celli], TCells[celli]);</span><br><span class="line">    alphaCells[celli] = mixture_.alphah(pCells[celli], TCells[celli]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li><p>第一步： <code>mixture_ = this-&gt;cellMixture(celli);</code> 先通过质量分数加权得到 <code>mixture</code> 的值，<code>mixture</code> 相当于一个特殊的 <code>specie</code>。</p></li><li><p>第二步：使用 <code>THE</code> 这个函数用焓更新温度，这个过程比较复杂，<a href="../T_calculate/" target="_blank" style="target-new:tab">见本站另一篇博文</a>。</p></li><li><p>第三步：计算 <code>psi</code>，函数见 <a href="https://cpp.openfoam.org/v3/a10228_source.html" target="_blank" rel="external nofollow noopener noreferrer">specie/equationOfState/perfectGasI.H</a>：<code>return 1.0/(this-&gt;R()*T);</code><br>其中 R() 在<code>specie\specie</code> 计算: <code>return RR/molWeight_;</code> <code>R()</code> 的单位是 <code>[J/(kg K)]</code>。这里的 <code>molWeight_</code> 是 <code>mixture</code> 的值，<code>W()</code> 也能返回 <code>molWeight_</code>，单位是<code>[kg/kmol]</code>。<br><code>RR</code> 的位置更加隐蔽。首先给出结果：<code>RR=1000*R=8314.47J/(kmol·k)</code>。详细代码挖掘见本文末尾。</p></li><li><p>第四步：计算 <code>mu</code>，见 <a href="https://cpp.openfoam.org/v3/a10311_source.html" target="_blank" rel="external nofollow noopener noreferrer">/specie/transport/sutherland/sutherlandTransportI.H</a>，<code>return As_*::sqrt(T)/(1.0 + Ts_/T);</code></p></li><li><p>第五步：计算 <code>alpha[kg/m/s]</code>，同样见 <a href="https://cpp.openfoam.org/v3/a10311_source.html" target="_blank" rel="external nofollow noopener noreferrer">/specie/transport/sutherland/sutherlandTransportI.H</a>，<code>return kappa(p,T) /Cp(p,T)</code> 这里的 <code>kappa</code> 就是导热系数，我们所说的 <code>lamda</code>。</p></li></ol><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">alphah---Thermal diffusivity of enthalpy [kg/ms]    在Sutherland中计算</span><br><span class="line">kappa----Thermal conductivity [W/mK]              也在Sutherland中计算</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Thermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Foam</span>:</span>:scalar Foam::sutherlandTransport&lt;Thermo&gt;::kappa</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar p, <span class="keyword">const</span> scalar T</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    scalar Cv_ = <span class="keyword">this</span>-&gt;Cv(p, T);</span><br><span class="line">    <span class="keyword">return</span> mu(p, T)*Cv_*(<span class="number">1.32</span> + <span class="number">1.77</span>*<span class="keyword">this</span>-&gt;R()/Cv_);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Thermo</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Foam</span>:</span>:scalar Foam::sutherlandTransport&lt;Thermo&gt;::alphah</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar p,</span><br><span class="line">    <span class="keyword">const</span> scalar T</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> kappa(p, T)/<span class="keyword">this</span>-&gt;Cp(p, T);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//thermI.H 中：</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Thermo</span>, <span class="title">template</span>&lt;class&gt; <span class="title">class</span> <span class="title">Type</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Foam</span>:</span>:scalar</span><br><span class="line">Foam::species::thermo&lt;Thermo, Type&gt;::Cpv(<span class="keyword">const</span> scalar p, <span class="keyword">const</span> scalar T)</span><br><span class="line"><span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> Type&lt;thermo&lt;Thermo, Type&gt;&gt;::Cpv(*<span class="keyword">this</span>, p, T);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//单位：</span></span><br><span class="line"><span class="comment">//- Heat capacity at constant volume [J/kg/K]</span></span><br><span class="line"><span class="comment">//virtual tmp&lt;volScalarField&gt; Cv() const = 0;</span></span><br><span class="line"><span class="comment">//大写是[J/kg/K]，小写是[J/kmol/K]???</span></span><br><span class="line"><span class="comment">//Cv = cv(p, T)/this-&gt;W()</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">//cpv(或者Cpv)：当能量是焓的形式，cpv = cp，若能量是内能形式，cpv = cv</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//那么 mixture 的 Cp(p, T) 又是如何计算的？</span></span><br><span class="line"><span class="comment">//单个组分的 Cp 计算见 [janafThermoI.H](https://cpp.openfoam.org/v3/a10297_source.html)，使用机理文件 therm.dat 中的系数计算得到。</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">EquationOfState</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Foam</span>:</span>:scalar Foam::janafThermo&lt;EquationOfState&gt;::Cp</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar p,</span><br><span class="line">    <span class="keyword">const</span> scalar T</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> coeffArray&amp; a = coeffs(T);</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">        ((((a[<span class="number">4</span>]*T + a[<span class="number">3</span>])*T + a[<span class="number">2</span>])*T + a[<span class="number">1</span>])*T + a[<span class="number">0</span>])</span><br><span class="line">      + EquationOfState::Cp(p, T);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//SpecieMixture.C 中：</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">MixtureType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:scalar Foam::SpecieMixture&lt;MixtureType&gt;::Cp</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> label speciei,</span><br><span class="line">    <span class="keyword">const</span> scalar p,</span><br><span class="line">    <span class="keyword">const</span> scalar T</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>-&gt;getLocalThermo(speciei).Cp(p, T);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后，什么是 mixture 的加权平均？<br>见 <a href="https://cpp.openfoam.org/v3/a10140_source.html" target="_blank" rel="external nofollow noopener noreferrer">\reactionThermo\mixtures\multiComponentMixture\multiComponentMixture.C</a></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ThermoType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">const</span> <span class="title">ThermoType</span>&amp; <span class="title">Foam</span>:</span>:multiComponentMixture&lt;ThermoType&gt;::cellMixture</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> label celli</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    mixture_ = Y_[<span class="number">0</span>][celli]*speciesData_[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span> (label n=<span class="number">1</span>; n&lt;Y_.<span class="built_in">size</span>(); n++)</span><br><span class="line">    &#123;</span><br><span class="line">        mixture_ += Y_[n][celli]*speciesData_[n];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> mixture_;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>mixture_ = sum( Y[i] * speciesData[i])</code> i 从 1 到组分个数</p><p>就是说混合物，是每个组分按照质量分数加权得到的。<br><code>speciesData_</code> 包括哪些数据？ <code>PtrList&lt;ThermoType&gt; speciesData_;</code><br><code>speciesData_</code> 是由所有组分的元素组成的一个 <code>list</code>。<br>这里的 <code>ThermoType</code> 是指<code>sutherlandTransport&lt;species::thermo&lt;janafThermo&lt;perfectGas&lt;specie&gt;&gt;,sensibleEnthalpy&gt;&gt;</code>。<br><code>sutherlandTransport</code> 继承自 <code>species::thermo</code>。<br><code>species::thermo</code> 继承自 <code>janafThermo + sensibleEnthalpy</code>。<br><code>janafThermo</code> 继承自 <code>perfectGas</code>。<br><code>perfectGas</code> 继承自 <code>specie</code>。<br>此外，<code>sensibleEnthalpy</code> 继承自 <code>species::thermo</code>。<br><code>sensibleEnthalpy&lt; species::thermo&lt;janafThermo&lt;perfectGas&lt;specie&gt;&gt;,sensibleEnthalpy&gt; &gt;</code><br><code>species</code> 是命名空间。<br>另外，它还有一个别名，见 <a href="https://cpp.openfoam.org/v3/a10233_source.html" target="_blank" rel="external nofollow noopener noreferrer">thermoPhysicsTypes.H</a>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span></span><br><span class="line">sutherlandTransport</span><br><span class="line">&lt;</span><br><span class="line">    species::thermo</span><br><span class="line">    &lt;</span><br><span class="line">        janafThermo</span><br><span class="line">        &lt;</span><br><span class="line">            perfectGas&lt;specie&gt;</span><br><span class="line">        &gt;,</span><br><span class="line">        sensibleEnthalpy</span><br><span class="line">    &gt;</span><br><span class="line">&gt; gasHThermoPhysics;</span><br><span class="line"><span class="comment">//即 typedef sutherlandTransport&lt;species::thermo&lt;janafThermo&lt;perfectGas&lt;specie&gt;&gt;,sensibleEnthalpy&gt;&gt; gasHThermoPhysics;</span></span><br></pre></td></tr></table></figure><p>同样，<code>mixture_</code> 也是这个类型，说明混合物在这里相当于一个组分，代表所有组分的一个组分。质量分数加权，就是把单个组分的所有信息都加权一遍！如下图所示的所有信息。包括：<code>Y_ moleWeight_ name_ Tcommon_ Thigh_ Tlow_ highCpCoeffs_ lowCpCoeffs_ As_ Ts_</code>。</p><ul><li><code>As_</code> <code>Ts_</code> 是由 <code>suterlandTransport</code> 提供的；</li><li><code>Tcommon_</code> <code>Thigh_</code> <code>Tlow_</code> <code>highCpCoeffs_</code> <code>lowCpCoeffs_</code> 是由 <code>janafThermo</code> 提供的；therm.dat 文件中，每个组分有 14（或者 15，最后一个没用）参数，依次是高温的 7 个系数和低温的 7 个系数。但并不是 <code>highCpCoeffs_</code> ，还需要 <code>*R()</code>，即 <code>*RR/moleWeight_</code> 才成为 <code>highCpCoeffs_</code> 。<code>RR=8314.47 J/(kmol·k)</code>，<code>moleWeight</code> 单位是 g/mol（亦即 kg/kmol）。</li><li><code>Y_</code> <code>moleWeight_</code> <code>name_</code> 是由 <code>Foam::specie</code> 提供的。</li></ul><p><img src="/album/mixture.PNG" alt=""></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">EquationOfState</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">void</span> <span class="title">Foam</span>:</span>:janafThermo&lt;EquationOfState&gt;::<span class="keyword">operator</span>+=</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> janafThermo&lt;EquationOfState&gt;&amp; jt</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    scalar Y1 = <span class="keyword">this</span>-&gt;Y();</span><br><span class="line"></span><br><span class="line">    EquationOfState::<span class="keyword">operator</span>+=(jt);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mag(<span class="keyword">this</span>-&gt;Y()) &gt; small)</span><br><span class="line">    &#123;</span><br><span class="line">        Y1 /= <span class="keyword">this</span>-&gt;Y();</span><br><span class="line">        <span class="keyword">const</span> scalar Y2 = jt.Y()/<span class="keyword">this</span>-&gt;Y();</span><br><span class="line"></span><br><span class="line">        Tlow_ = <span class="built_in">max</span>(Tlow_, jt.Tlow_);</span><br><span class="line">        Thigh_ = <span class="built_in">min</span>(Thigh_, jt.Thigh_);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span></span><br><span class="line">        (</span><br><span class="line">            janafThermo&lt;EquationOfState&gt;::debug</span><br><span class="line">         &amp;&amp; notEqual(Tcommon_, jt.Tcommon_)</span><br><span class="line">        )</span><br><span class="line">        &#123;</span><br><span class="line">            FatalErrorInFunction</span><br><span class="line">                &lt;&lt; <span class="string">"Tcommon "</span> &lt;&lt; Tcommon_ &lt;&lt; <span class="string">" for "</span></span><br><span class="line">                &lt;&lt; (<span class="keyword">this</span>-&gt;name().<span class="built_in">size</span>() ? <span class="keyword">this</span>-&gt;name() : <span class="string">"others"</span>)</span><br><span class="line">                &lt;&lt; <span class="string">" != "</span> &lt;&lt; jt.Tcommon_ &lt;&lt; <span class="string">" for "</span></span><br><span class="line">                &lt;&lt; (jt.name().<span class="built_in">size</span>() ? jt.name() : <span class="string">"others"</span>)</span><br><span class="line">                &lt;&lt; <span class="built_in">exit</span>(FatalError);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span></span><br><span class="line">        (</span><br><span class="line">            label coefLabel=<span class="number">0</span>;</span><br><span class="line">            coefLabel&lt;janafThermo&lt;EquationOfState&gt;::nCoeffs_;</span><br><span class="line">            coefLabel++</span><br><span class="line">        )</span><br><span class="line">        &#123;</span><br><span class="line">            highCpCoeffs_[coefLabel] =</span><br><span class="line">                Y1*highCpCoeffs_[coefLabel]</span><br><span class="line">              + Y2*jt.highCpCoeffs_[coefLabel];</span><br><span class="line"></span><br><span class="line">            lowCpCoeffs_[coefLabel] =</span><br><span class="line">                Y1*lowCpCoeffs_[coefLabel]</span><br><span class="line">              + Y2*jt.lowCpCoeffs_[coefLabel];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上边这段代码说明，机理文件中的thermo文件，中间那个温度一定要保持一致，不然会有问题。不过这个只有在debug模式才会提示。</p><h1 id="rr-代码挖掘"><a class="markdownIt-Anchor" href="#rr-代码挖掘"></a> RR 代码挖掘：</h1><p>定义在\src\OpenFOAM\global\constants\thermodynamic\thermodynamicConstants.C<br><code>const scalar RR = 1e3*physicoChemical::R.value();</code></p><p>R 的定义在 \src\OpenFOAM\global\constants\physicoChemical\physicoChemicalConstants.C</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">defineDimensionedConstantWithDefault</span><br><span class="line">(</span><br><span class="line">    physicoChemical::group,</span><br><span class="line">    physicoChemical::R,</span><br><span class="line">    dimensionedScalar</span><br><span class="line">    (</span><br><span class="line">        <span class="string">"R"</span>,</span><br><span class="line">        physicoChemical::NA*physicoChemical::k</span><br><span class="line">    ),</span><br><span class="line">    constantphysicoChemicalR,</span><br><span class="line">    <span class="string">"R"</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>k 见 \etc\controlDict:</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">physicoChemical</span><br><span class="line">&#123;</span><br><span class="line">    mu              mu [<span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>] <span class="number">1.66054e-27</span>;</span><br><span class="line">    k               k [<span class="number">1</span> <span class="number">2</span> <span class="number">-2</span> <span class="number">-1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>] <span class="number">1.38065e-23</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>另外这个文件还定义了 Pstd=1e5，Tstd=298.15。<br>NA 见 \src\OpenFOAM\global\constants\fundamental\fundamentalConstants.C</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">defineDimensionedConstantWithDefault</span><br><span class="line">(</span><br><span class="line">    physicoChemical::group,</span><br><span class="line">    physicoChemical::NA,</span><br><span class="line">    Foam::dimensionedScalar</span><br><span class="line">    (</span><br><span class="line">        <span class="string">"NA"</span>,</span><br><span class="line">        dimensionSet(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">-1</span>), <span class="comment">//Foam::dimless/Foam::dimMoles,</span></span><br><span class="line">        <span class="number">6.0221417930e+23</span></span><br><span class="line">    ),</span><br><span class="line">    constantphysicoChemicalNA,</span><br><span class="line">    <span class="string">"NA"</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>至此，<code>R=NA*k=6.0221417930e+23*1.38065e-23=8.31447J/(mol·k)</code>，<code>RR=1000*R=8314.47J/(kmol·k)</code></p>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> thermophysicalModels </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>化学反应机理下载网址收藏</title>
      <link href="/mechanisms/"/>
      <url>/mechanisms/</url>
      
        <content type="html"><![CDATA[<p>化学反应机理下载网址收藏</p><a id="more"></a><h1 id="soot-detailed-chemical-kinetics"><a class="markdownIt-Anchor" href="#soot-detailed-chemical-kinetics"></a> <a href="http://combustion.berkeley.edu/soot/" target="_blank" rel="external nofollow noopener noreferrer">soot detailed chemical kinetics</a></h1><ul><li>C2 oxidation - with aromatics up to pyrene (Wang and Frenklach, 1997)</li><li>C2 oxidation - a modified version of the above (Appel, Bockhorn, and Frenklach, 2000)</li></ul><h1 id="llnl"><a class="markdownIt-Anchor" href="#llnl"></a> <a href="https://combustion.llnl.gov/archived-mechanisms/" target="_blank" rel="external nofollow noopener noreferrer">LLNL</a></h1><ul><li>Ethanol</li><li>Hydrogen</li><li>Alkanes<ul><li>C8-C16 n-Alkanes</li><li>n -Heptane, Detailed Mechanism Version 2</li><li>Heptane, Reduced Mechanism</li><li>iso-Octane, Version 2</li></ul></li><li>Cycloalkanes<ul><li>Methylcyclohexane</li></ul></li><li>Surrogates<ul><li>Primary Reference Fuels iso-Octane / n-Heptane Mixture</li></ul></li></ul><h1 id="gri"><a class="markdownIt-Anchor" href="#gri"></a> GRI</h1><ul><li><a href="http://combustion.berkeley.edu/gri-mech/version30/text30.html" target="_blank" rel="external nofollow noopener noreferrer">GRI 3.0</a></li><li><a href="http://combustion.berkeley.edu/gri-mech/new21/version21/text21.html" target="_blank" rel="external nofollow noopener noreferrer">GRI 2.11</a></li><li><a href="http://combustion.berkeley.edu/gri-mech/new21/version12/text12.html" target="_blank" rel="external nofollow noopener noreferrer">GRI 1.2</a></li><li><a href="http://combustion.berkeley.edu/drm/" target="_blank" rel="external nofollow noopener noreferrer">based on GRI 1.2</a></li><li><a href="http://firebrand.me.berkeley.edu/griredu.html" target="_blank" rel="external nofollow noopener noreferrer">based on GRI 1.2</a></li></ul><h1 id="wang-hai"><a class="markdownIt-Anchor" href="#wang-hai"></a> <a href="http://ignis.usc.edu/Mechanisms/Model%20release.html" target="_blank" rel="external nofollow noopener noreferrer">Wang Hai</a></h1><ul><li>JetSurF – A Jet Surrogate Fuel Model</li><li>USC Mech Version II: High-Temperature Combustion Reaction Model of H2/CO/C1-C4 Compounds*</li><li>An Optimized Reaction Model of H2/CO Combustion</li><li>Reaction Mechanism of 1,3-Butadiene Oxidation at High Temperatures</li><li>An Optimized Reaction Model of C1-C3 Combustion</li><li>Reaction Mechanism of C3 Fuel Combustion</li><li>A Comprehensive Reaction Model of Ethylene and Acetylene Combustion</li><li>PAH Formation and Growth in Laminar Premixed Ethylene and Acetylene Flames</li></ul><h1 id="xiaoqing-you-and-hai-wang"><a class="markdownIt-Anchor" href="#xiaoqing-you-and-hai-wang"></a> <a href="http://ignis.usc.edu/Jet_Fuel_MechI.html" target="_blank" rel="external nofollow noopener noreferrer">Xiaoqing You and Hai Wang</a></h1><ul><li>n-dodecane</li><li>n-heptane</li></ul><h1 id="tianfeng-lu"><a class="markdownIt-Anchor" href="#tianfeng-lu"></a> <a href="http://spark.engr.uconn.edu/mechs/mechs.htm" target="_blank" rel="external nofollow noopener noreferrer">Tianfeng Lu</a></h1><ul><li>methane</li><li>ethylene</li><li>methane-ethylene-NO</li><li>ethanol</li><li>DME</li><li>n-heptane, iso-octane, PRF</li><li>n-dodecane</li><li>biodiesel</li></ul><h1 id="erc"><a class="markdownIt-Anchor" href="#erc"></a> <a href="https://erc.wisc.edu/chemical-reaction-mechanisms/" target="_blank" rel="external nofollow noopener noreferrer">ERC</a></h1><ul><li>n-heptane</li><li>n-heptane/n-butanol/PAH</li><li>ERC-MultiChem+Bio</li><li>n-heptane/toluene/PAH</li><li>Reduced PRF</li><li>Reduced PRF-methanol-ethanol-DTBP</li><li>Reduced n-dodecane-PAH</li></ul><h1 id="pitsch"><a class="markdownIt-Anchor" href="#pitsch"></a> <a href="http://web.stanford.edu/group/pitsch/" target="_blank" rel="external nofollow noopener noreferrer">pitsch</a></h1><ul><li>n-heptane</li><li>iso-octane</li><li>PRF</li></ul><h1 id="pitsch2"><a class="markdownIt-Anchor" href="#pitsch2"></a> <a href="http://www.itv.rwth-aachen.de/downloads/verschiedenes/" target="_blank" rel="external nofollow noopener noreferrer">pitsch2</a></h1><ul><li>code：Red-Mech-Code</li><li>n-Heptane</li><li>PRF-Ethanol</li><li>A Surrogate Fuel for Kerosene: N-Dekan/Trimethylbenzol (n-decane/Trimethylbenzol)</li></ul><h1 id="catalyst"><a class="markdownIt-Anchor" href="#catalyst"></a> <a href="http://www.detchem.com/mechanisms.html" target="_blank" rel="external nofollow noopener noreferrer">catalyst</a></h1><h1 id="nist"><a class="markdownIt-Anchor" href="#nist"></a> <a href="http://www.nist.gov/srd/" target="_blank" rel="external nofollow noopener noreferrer">NIST</a></h1><h1 id="四川大学"><a class="markdownIt-Anchor" href="#四川大学"></a> <a href="http://ccg.scu.edu.cn/mechanism/" target="_blank" rel="external nofollow noopener noreferrer">四川大学</a></h1><ul><li>Alkane<br>n-heptane、iso-octane、n-decane、n-dodecane</li><li>Naphthenic<br>正丙基环己烷、甲基环己烷</li><li>航空煤油<br>石油基工程燃料、国外航空煤油、国产RP3</li></ul><h1 id="krithika-narayanaswamy"><a class="markdownIt-Anchor" href="#krithika-narayanaswamy"></a> <a href="http://krithikasivaram.github.io/" target="_blank" rel="external nofollow noopener noreferrer">Krithika Narayanaswamy</a></h1><ul><li>biodiesel surrogate</li><li>jet fuel surrogates</li><li>methylcyclohexane</li><li>n-dodecane(275 Species)</li></ul><h1 id="polimi"><a class="markdownIt-Anchor" href="#polimi"></a> <a href="http://creckmodeling.chem.polimi.it/menu-kinetics" target="_blank" rel="external nofollow noopener noreferrer">polimi</a></h1><h1 id="c3-combustion-chemistry-centre"><a class="markdownIt-Anchor" href="#c3-combustion-chemistry-centre"></a> <a href="http://c3.nuigalway.ie/combustionchemistrycentre/mechanismdownloads/" target="_blank" rel="external nofollow noopener noreferrer">C3-Combustion Chemistry Centre</a></h1><ul><li>Hydrogen and Syngas<ul><li>Hydrogen (2004)</li><li>Hydrogen and Syngas (2013)</li><li>Syngas/NOx (2017)</li></ul></li><li>Alkanes<ul><li>Natural Gas to/including nC5 (2010)</li><li>Natural gas (2006/07)</li><li>Natural gas to/including C5 (2007/08)</li><li>Natural gas to/including nC5 (2010)</li><li>C1_C2_C3 mixtures volume histories</li><li>C1_C3 mixtures volume histories</li><li>CH4/DME 2014</li><li>Butane</li><li>Pentane isomers</li><li>n-Hexane</li><li>n-Heptane</li></ul></li><li>Alkenes<ul><li>Propene</li><li>1-butene</li><li>2-butene</li><li>Isobutene</li><li>Di-isobutylene</li></ul></li><li>Alcohols<ul><li>Methanol</li><li>Ethanol 2014</li><li>Ethanol/DME 2018</li><li>Propanol</li><li>Bio-butanol</li></ul></li><li>Esters<ul><li>Methyl butanoate</li><li>Ethyl propanoate</li></ul></li><li>Ethers<ul><li>EME, DEE, MTBE and ETBE (Ethers)</li><li>CH4/DME 2014</li></ul></li><li>Furans<ul><li>Furan, 2-Methyllfuran and 2,5-Dimethylfuran</li></ul></li><li>Ketones<ul><li>Acetone</li><li>3-Pentanone</li></ul></li><li>AramcoMech1.3 (2013)</li><li>AramcoMech2.0 (2016)</li><li>AramcoMech3.0 (2018)</li></ul><h1 id="先进燃烧与能源研究中心"><a class="markdownIt-Anchor" href="#先进燃烧与能源研究中心"></a> <a href="http://flame.nsrl.ustc.edu.cn/database/?data=model" target="_blank" rel="external nofollow noopener noreferrer">先进燃烧与能源研究中心</a></h1><ul><li>Butanol C4H9OH</li><li>Butane C4H10</li></ul><h1 id="cerfacs"><a class="markdownIt-Anchor" href="#cerfacs"></a> <a href="https://www.cerfacs.fr/cantera" target="_blank" rel="external nofollow noopener noreferrer">cerfacs</a></h1><ul><li>Hydrogen</li><li>Methane</li><li>Ethylene</li><li>Propane</li><li>Iso-octane</li><li>Kerosene</li><li>IFP fuel combustion</li><li>Pyrolysis gases combustion</li><li>Ethane/water cracking</li></ul><h1 id="kaust"><a class="markdownIt-Anchor" href="#kaust"></a> <a href="https://ccrc.kaust.edu.sa/aramco/Pages/ckm.aspx" target="_blank" rel="external nofollow noopener noreferrer">kaust</a></h1><h1 id="uc-san-diego"><a class="markdownIt-Anchor" href="#uc-san-diego"></a> <a href="http://web.eng.ucsd.edu/mae/groups/combustion/mechanism.html" target="_blank" rel="external nofollow noopener noreferrer">UC San Diego</a></h1><h1 id="repositories"><a class="markdownIt-Anchor" href="#repositories"></a> Repositories</h1><ul><li><a href="https://github.com/ZhangYanTJU/chemicalMechanisms" target="_blank" rel="external nofollow noopener noreferrer">ZhangYanTJU</a></li><li><a href="https://github.com/jiweiqi/CollectionOfMechanisms" target="_blank" rel="external nofollow noopener noreferrer">Weiqi Ji</a></li><li><a href="https://gitlab.multiscale.utah.edu/common/ChemicalMechanisms/tree/master" target="_blank" rel="external nofollow noopener noreferrer">James Sutherland</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> combustion </category>
          
      </categories>
      
      
        <tags>
            
            <tag> chemical mechanisms </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM 中使用 chemkin 机理注意事项</title>
      <link href="/chemkin/"/>
      <url>/chemkin/</url>
      
        <content type="html"><![CDATA[<p>chemkin 格式的机理在 OpenFOAM 中使用须知</p><a id="more"></a><ol><li>首先，全部转化为大写。</li><li>如果计算液态燃料，需要使用燃料的物性，那么燃料名字必须和OF的物性库中的名字一致。比如：NC7H16 全部改成 C7H16，chem 和 thermo 都要改。</li><li>thermo 文件中，改成 C7H16 的那一行，错位了，修正一下。</li><li>热物性中，最后一列是 1 2 3 4，如果前边有其它数，需要删掉。</li><li>热物性第一行，THERMO 要改成 THERMO ALL。</li><li>thermophysicalProperties 中，不要选用 new format</li><li>在 Linux 下，使用 dos2unix，转化格式。</li><li>运行一遍算例，如果仍有错误，按错误提示修改。</li><li>如果没有格式错误，后边计算组分的时候，第一步就报错，检查一下机理里边 TROE 后边的 4 个数，看有没有 0 ，若有，改成 1E-30。<br>报错信息：<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">#<span class="number">3</span>  Foam::ReversibleReaction&lt;Foam::Reaction, Foam::sutherlandTransport&lt;Foam::species::thermo&lt;Foam::janafThermo&lt;Foam::perfectGas&lt;Foam::specie&gt; &gt;, Foam::sensibleEnthalpy&gt; &gt;, Foam::FallOffReactionRate&lt;Foam::ArrheniusReactionRate, Foam::TroeFallOffFunction&gt; &gt;::kf(<span class="keyword">double</span>, <span class="keyword">double</span>, Foam::Field&lt;<span class="keyword">double</span>&gt; <span class="keyword">const</span>&amp;) <span class="keyword">const</span></span><br><span class="line">#<span class="number">4</span>  Foam::Reaction&lt;Foam::sutherlandTransport&lt;Foam::species::thermo&lt;Foam::janafThermo&lt;Foam::perfectGas&lt;Foam::specie&gt; &gt;, Foam::sensibleEnthalpy&gt; &gt; &gt;::omega(<span class="keyword">double</span>, <span class="keyword">double</span>, Foam::Field&lt;<span class="keyword">double</span>&gt; <span class="keyword">const</span>&amp;, <span class="keyword">double</span>&amp;, <span class="keyword">double</span>&amp;, <span class="keyword">int</span>&amp;, <span class="keyword">double</span>&amp;, <span class="keyword">double</span>&amp;, <span class="keyword">int</span>&amp;) <span class="keyword">const</span></span><br><span class="line">#<span class="number">5</span>  Foam::Reaction&lt;Foam::sutherlandTransport&lt;Foam::species::thermo&lt;Foam::janafThermo&lt;Foam::perfectGas&lt;Foam::specie&gt; &gt;, Foam::sensibleEnthalpy&gt; &gt; &gt;::dwdc(<span class="keyword">double</span>, <span class="keyword">double</span>, Foam::Field&lt;<span class="keyword">double</span>&gt; <span class="keyword">const</span>&amp;, Foam::SquareMatrix&lt;<span class="keyword">double</span>&gt;&amp;, Foam::Field&lt;<span class="keyword">double</span>&gt;&amp;, <span class="keyword">double</span>&amp;, <span class="keyword">double</span>&amp;, <span class="keyword">double</span>&amp;, <span class="keyword">bool</span>, Foam::List&lt;<span class="keyword">int</span>&gt; <span class="keyword">const</span>&amp;) <span class="keyword">const</span></span><br><span class="line">#<span class="number">6</span>  Foam::StandardChemistryModel&lt;Foam::psiReactionThermo, Foam::sutherlandTransport&lt;Foam::species::thermo&lt;Foam::janafThermo&lt;Foam::perfectGas&lt;Foam::specie&gt; &gt;, Foam::sensibleEnthalpy&gt; &gt; &gt;::jacobian(<span class="keyword">double</span>, Foam::Field&lt;<span class="keyword">double</span>&gt; <span class="keyword">const</span>&amp;, Foam::Field&lt;<span class="keyword">double</span>&gt;&amp;, Foam::SquareMatrix&lt;<span class="keyword">double</span>&gt;&amp;) <span class="keyword">const</span></span><br><span class="line">#<span class="number">7</span>  Foam::seulex::solve(<span class="keyword">double</span>&amp;, Foam::Field&lt;<span class="keyword">double</span>&gt;&amp;, Foam::ODESolver::stepState&amp;) <span class="keyword">const</span></span><br><span class="line">#<span class="number">8</span>  Foam::ODESolver::solve(<span class="keyword">double</span>, <span class="keyword">double</span>, Foam::Field&lt;<span class="keyword">double</span>&gt;&amp;, <span class="keyword">double</span>&amp;) <span class="keyword">const</span></span><br><span class="line">#<span class="number">9</span>  Foam::ode&lt;Foam::StandardChemistryModel&lt;Foam::psiReactionThermo, Foam::sutherlandTransport&lt;Foam::species::thermo&lt;Foam::janafThermo&lt;Foam::perfectGas&lt;Foam::specie&gt; &gt;, Foam::sensibleEnthalpy&gt; &gt; &gt; &gt;::solve(Foam::Field&lt;<span class="keyword">double</span>&gt;&amp;, <span class="keyword">double</span>&amp;, <span class="keyword">double</span>&amp;, <span class="keyword">double</span>&amp;, <span class="keyword">double</span>&amp;) <span class="keyword">const</span></span><br><span class="line">#<span class="number">10</span>  <span class="keyword">double</span> Foam::StandardChemistryModel&lt;Foam::psiReactionThermo, Foam::sutherlandTransport&lt;Foam::species::thermo&lt;Foam::janafThermo&lt;Foam::perfectGas&lt;Foam::specie&gt; &gt;, Foam::sensibleEnthalpy&gt; &gt; &gt;::solve&lt;Foam::UniformField&lt;<span class="keyword">double</span>&gt; &gt;(Foam::UniformField&lt;<span class="keyword">double</span>&gt; <span class="keyword">const</span>&amp;)</span><br><span class="line">#<span class="number">11</span>  Foam::StandardChemistryModel&lt;Foam::psiReactionThermo, Foam::sutherlandTransport&lt;Foam::species::thermo&lt;Foam::janafThermo&lt;Foam::perfectGas&lt;Foam::specie&gt; &gt;, Foam::sensibleEnthalpy&gt; &gt; &gt;::solve(<span class="keyword">double</span>)</span><br><span class="line">#<span class="number">12</span>  Foam::combustionModels::laminar&lt;Foam::psiReactionThermo&gt;::correct()</span><br></pre></td></tr></table></figure></li><li>如果发散（最大迭代数溢出），把 therm.dat 文件中每个组分的 temperature range(主要是 T common) 改成一致就可以了。<a href="https://www.cfd-online.com/Forums/openfoam-solving/59816-foam-fatal-error-maximum-number-iterations-exceeded-2.html" target="_blank" rel="external nofollow noopener noreferrer">解决方案来自 CFD-Online</a> 可以使用 chemkin 中的 Utility/FitData 功能来修正 temperature range。</li></ol><p>OpenFOAM 中，组分必须以字母开头，并且可以出现下列特殊符号：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">+</span><br><span class="line">-</span><br><span class="line">_</span><br><span class="line">*</span><br><span class="line">我</span><br><span class="line">、</span><br><span class="line">。</span><br></pre></td></tr></table></figure><p>不能出现的符号：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;</span><br></pre></td></tr></table></figure><p>一个正确的机理文件（删减版）示范：<br>chem.inp 文件（这是一个甲烷的机理，<a href="../sources/chem.inp">完整版</a>，<a href="http://combustion.berkeley.edu/drm/" target="_blank" rel="external nofollow noopener noreferrer">机理来源</a>）：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ELEMENTS                                                                        </span><br><span class="line">O  H  C  N  AR                                                                  </span><br><span class="line">END                                                                             </span><br><span class="line">SPECIES                                                                         </span><br><span class="line">H2      O2                                                                                       </span><br><span class="line">END                                                                             </span><br><span class="line">REACTIONS                                                                                </span><br><span class="line">O+HO2&lt;&#x3D;&gt;OH+O2                            2.000E+13    0.000      0.00           </span><br><span class="line">END</span><br></pre></td></tr></table></figure><p>therm.dat 文件（<a href="../sources/therm.dat">完整版</a>）：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">THERMO ALL</span><br><span class="line">   200.000  1000.000  5000.000</span><br><span class="line">O                 L 1&#x2F;90O   1   00   00   00G   200.000  3500.000  1000.0      1</span><br><span class="line"> 2.56942078E+00-8.59741137E-05 4.19484589E-08-1.00177799E-11 1.22833691E-15    2</span><br><span class="line"> 2.92175791E+04 4.78433864E+00 3.16826710E+00-3.27931884E-03 6.64306396E-06    3</span><br><span class="line">-6.12806624E-09 2.11265971E-12 2.91222592E+04 2.05193346E+00 6.72540300E+03    4</span><br><span class="line">END</span><br></pre></td></tr></table></figure><p>请严格按照这个示范文件来修改你的机理文件。</p><p>比如 therm.dat 文件的第二行中的三个数字，它们所在的列数区间是有严格限制的。</p><blockquote><p>在第二行的 1－30 列上给出低温、常温、高温三个温度范围，每个数字均匀分布在 10 列位置上。</p></blockquote><p>再如这两个文件中的 <code>END</code> 一定不要漏掉。</p><p>最后，我创建了一个化学机理仓库，所有的格式都是修改过的，绝大部分都能在 OpenFOAM 中直接使用：<br><a href="https://github.com/ZhangYanTJU/chemicalMechanisms" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/ZhangYanTJU/chemicalMechanisms</a></p><p>也欢迎您贡献修改好的机理，方便后人使用。</p>]]></content>
      
      
      <categories>
          
          <category> using </category>
          
      </categories>
      
      
        <tags>
            
            <tag> chemkin </tag>
            
            <tag> chemical mechanisms </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>markdown 学习笔记</title>
      <link href="/markdownLearning/"/>
      <url>/markdownLearning/</url>
      
        <content type="html"><![CDATA[<p>markdown 学习笔记</p><a id="more"></a><h1 id="标题"><a class="markdownIt-Anchor" href="#标题"></a> 标题</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 一级标题</span><br><span class="line">## 二级标题</span><br><span class="line">### 三级标题</span><br><span class="line">#### 四级标题</span><br><span class="line">##### 五级标题</span><br></pre></td></tr></table></figure><p>效果：</p><h1 id="一级标题"><a class="markdownIt-Anchor" href="#一级标题"></a> 一级标题</h1><h2 id="二级标题"><a class="markdownIt-Anchor" href="#二级标题"></a> 二级标题</h2><h3 id="三级标题"><a class="markdownIt-Anchor" href="#三级标题"></a> 三级标题</h3><h4 id="四级标题"><a class="markdownIt-Anchor" href="#四级标题"></a> 四级标题</h4><h5 id="五级标题"><a class="markdownIt-Anchor" href="#五级标题"></a> 五级标题</h5><h1 id="列表"><a class="markdownIt-Anchor" href="#列表"></a> 列表</h1><h2 id="无序列表"><a class="markdownIt-Anchor" href="#无序列表"></a> 无序列表</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">- 文本1</span><br><span class="line">- 文本2</span><br><span class="line">- 文本3</span><br></pre></td></tr></table></figure><p>效果：</p><ul><li>文本1</li><li>文本2</li><li>文本3</li></ul><h2 id="有序列表"><a class="markdownIt-Anchor" href="#有序列表"></a> 有序列表</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1. 文本1</span><br><span class="line">2. 文本2</span><br><span class="line">3. 文本3</span><br></pre></td></tr></table></figure><p>效果：</p><ol><li>文本1</li><li>文本2</li><li>文本3</li></ol><h1 id="链接"><a class="markdownIt-Anchor" href="#链接"></a> 链接</h1><p><code>[简书](http://www.jianshu.com)</code></p><p>效果：<br><a href="http://www.jianshu.com" target="_blank" rel="external nofollow noopener noreferrer">简书</a></p><h1 id="图片"><a class="markdownIt-Anchor" href="#图片"></a> 图片</h1><p><code>![](http://upload-images.jianshu.io/upload_images/259-0ad0d0bfc1c608b6.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)</code></p><p>效果：<br><img src="http://upload-images.jianshu.io/upload_images/259-0ad0d0bfc1c608b6.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><h1 id="引用"><a class="markdownIt-Anchor" href="#引用"></a> 引用</h1><p><code>&gt; 文字</code><br>效果：</p><blockquote><p>文字</p></blockquote><h1 id="粗体和斜体"><a class="markdownIt-Anchor" href="#粗体和斜体"></a> 粗体和斜体</h1><p>用两个 * 包含一段文本就是粗体的语法，用一个 * 包含一段文本就是斜体的语法。例如：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">*一盏灯*， 一片昏黄；**一简书**， 一杯淡茶。 守着那一份淡定， 品读属于自己的寂寞。 保持淡定， 才能欣赏到最美丽的风景！ 保持淡定， 人生从此不再寂寞。</span><br></pre></td></tr></table></figure><p>效果：<br><em>一盏灯</em>， 一片昏黄；<strong>一简书</strong>， 一杯淡茶。 守着那一份淡定， 品读属于自己的寂寞。 保持淡定， 才能欣赏到最美丽的风景！ 保持淡定， 人生从此不再寂寞。</p><h1 id="代码块"><a class="markdownIt-Anchor" href="#代码块"></a> 代码块</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#96; &#96; &#96;</span><br><span class="line">int c++;</span><br><span class="line">&#96; &#96; &#96;</span><br><span class="line">去掉 &#96; 之间的空格</span><br></pre></td></tr></table></figure><p>效果：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">int c++;</span><br></pre></td></tr></table></figure><p>pre 代码块内的操作 <b>表示加粗</b></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;pre&gt;</span><br><span class="line">int main(void) &#123;</span><br><span class="line">    &lt;b&gt;return 0;&lt;&#x2F;b&gt;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;pre&gt;</span><br></pre></td></tr></table></figure><p>效果：</p><pre>int main(void) {    <b>return 0;</b>}</pre><p>参考资料：<br><a href="https://www.jianshu.com/p/q81RER" target="_blank" rel="external nofollow noopener noreferrer">https://www.jianshu.com/p/q81RER</a></p><h1 id="公式"><a class="markdownIt-Anchor" href="#公式"></a> 公式</h1><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>x</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>x</mi><mn>2</mn></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>y</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>y</mi><mn>2</mn></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>z</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>z</mi><mn>2</mn></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{matrix} 1 &amp; x &amp; x^2 \\\\ 1 &amp; y &amp; y^2 \\\\ 1 &amp; z &amp; z^2 \\\\ \end{matrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.200000000000001em;vertical-align:-3.35em"></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.850000000000001em"><span style="top:-6.010000000000001em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-4.810000000000001em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-3.6100000000000003em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-1.2100000000000002em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-.009999999999999953em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.35em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.850000000000001em"><span style="top:-6.010000000000001em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-3.6100000000000003em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-1.2100000000000002em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.850000000000001em"><span style="top:-6.010000000000001em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.6100000000000003em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-1.2100000000000002em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.04398em">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em"><span></span></span></span></span></span></span></span></span></span></span></span></p><h1 id="toggle"><a class="markdownIt-Anchor" href="#toggle"></a> toggle</h1><details><summary>Click to expand!</summary><h2 id="heading"><a class="markdownIt-Anchor" href="#heading"></a> Heading</h2><ol><li>A numbered</li><li>list<ul><li>With some</li><li>Sub bullets</li></ul><ul><li>Sub bullets</li></ul></li></ol></details><p>代码如下：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># A collapsible section with markdown</span><br><span class="line"></span><br><span class="line">&lt;details&gt;</span><br><span class="line">&lt;summary&gt;Click to expand!&lt;&#x2F;summary&gt;</span><br><span class="line"></span><br><span class="line">  ## Heading</span><br><span class="line">  1. A numbered</span><br><span class="line">  2. list</span><br><span class="line">     * With some</span><br><span class="line">     * Sub bullets</span><br><span class="line">&lt;&#x2F;details&gt;</span><br></pre></td></tr></table></figure><p><strong>NB:</strong> Make sure you have an <strong>empty line</strong> after the closing <code>&lt;/summary&gt;</code> tag.</p><p><strong>NB</strong>: Make sure you have an <strong>empty line</strong> after the closing <code>&lt;/details&gt;</code> tag if you have multiple collapsible sections.</p><p>参考：<a href="https://gist.github.com/pierrejoubert73/902cc94d79424356a8d20be2b382e1ab" target="_blank" rel="external nofollow noopener noreferrer">https://gist.github.com/pierrejoubert73/902cc94d79424356a8d20be2b382e1ab</a></p>]]></content>
      
      
      <categories>
          
          <category> markdown </category>
          
      </categories>
      
      
        <tags>
            
            <tag> markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenFOAM 中使用 functionObject</title>
      <link href="/functionObject/"/>
      <url>/functionObject/</url>
      
        <content type="html"><![CDATA[<p>使用 functionObject 进行后处理</p><a id="more"></a><p>In OpenFOAM, functionObjects are code snippets that can be loaded into any solver during run-time. This enables each solver to be coupled with some additional functionality, that is independent from the flow model. All functionObjects have to be included in system/controlDict like the following:</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    &lt;name&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        type &lt;type&gt;;</span><br><span class="line">        functionObjectLibs (<span class="string">"&lt;lib&gt;"</span>);</span><br><span class="line">        writeControl timeStep;</span><br><span class="line">        outputInterval <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// Specific parameters for the functionObject</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="使用方法"><a class="markdownIt-Anchor" href="#使用方法"></a> 使用方法</h1><h2 id="大概是-of-40-以前的版本"><a class="markdownIt-Anchor" href="#大概是-of-40-以前的版本"></a> 大概是 OF-4.0 以前的版本</h2><ul><li>运行时：<br>先在 <code>controlDict</code> 中添加 <code>functions</code>，然后直接运行算例即可。支持并行算例。</li><li>运行后：<br>先在 <code>controlDict</code> 中添加 <code>functions</code>，然后执行这个命令 <code>execFlowFunctionObjects -noFlow</code><br>支持并行，使用命令 <code>mpirun -np 2 execFlowFunctionObjects -noFlow -parallel</code></li></ul><h1 id="of-40-以后的版本"><a class="markdownIt-Anchor" href="#of-40-以后的版本"></a> OF-4.0 以后的版本</h1><ul><li><p>在 <code>controlDict</code> 中添加 <code>functions</code> 之后，直接运行求解器即可。支持并行算例。</p></li><li><p>运行后，在 controlDict 文件中添加 functions之后，运行 <code>postProcess -fields '(T p U)'</code>。<br><code>-fields</code> 一定要加，因为这相当于输入的场信息，和 <code>functions</code> 里 <code>fields</code> 的不一样，那个是操作的场。输入的场要包含操作的场才行。</p></li><li><p>运行后，还可以通过求解器来调用，这样可以载入更多的信息（如拉格朗日粒子）：<code>sprayFoam -postProcess -func writeCloudOldStyle</code>。<br>这个 <a href="https://github.com/blueCFD/lagrangianExtraFunctionObjects" target="_blank" rel="external nofollow noopener noreferrer">writeCloudOldStyle</a> 是将 positions 转换成 paraview 可以读取的格式。</p></li><li><p>特殊控制：运行后，可以只对某个（些）时间进行处理，如：<code>postProcess -fields '(T p)' -time '1.75e-05'</code>。<br>或者：<code>postProcess -fields '(T p)' -time ':1.75e-05'</code>，冒号表示从最开始到 1.75e-05 所有的时间。<br>另外还可以处理不连续的时间，如 <code>postProcess -fields '(T p)' -time '1.25e-05,1.75e-05'</code>，用逗号隔开即可。</p></li><li><p>支持并行，使用命令 <code>mpirun -np 2 postProcess -fields '(T p U)' -parallel</code></p></li></ul><blockquote><p><code>functionObjects</code> 分为两大类 <code>libfieldFunctionObjects</code> 和 <code>libutilityFunctionObjects</code></p><p>所有可选的 <code>type</code> 可以通过这个命令获取：<code>postProcess -list</code>。</p></blockquote><p>目前运行 <code>postProcess -list</code> 会获得下列功能，官方配置文件在这个位置：<a href="https://github.com/OpenFOAM/OpenFOAM-dev/tree/master/etc/caseDicts/postProcessing/fields" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/OpenFOAM/OpenFOAM-dev/tree/master/etc/caseDicts/postProcessing/fields</a><br>Available configured functionObjects:</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">67</span><br><span class="line">(</span><br><span class="line">CourantNo</span><br><span class="line">Lambda2</span><br><span class="line">MachNo</span><br><span class="line">PecletNo</span><br><span class="line">Q</span><br><span class="line">Qdot</span><br><span class="line">R</span><br><span class="line">XiReactionRate</span><br><span class="line">add</span><br><span class="line">age</span><br><span class="line">boundaryProbes</span><br><span class="line">cellMax</span><br><span class="line">cellMin</span><br><span class="line">components</span><br><span class="line">ddt</span><br><span class="line">div</span><br><span class="line">dsmcFields</span><br><span class="line">enstrophy</span><br><span class="line">faceMax</span><br><span class="line">faceMin</span><br><span class="line">flowRateFaceZone</span><br><span class="line">flowRatePatch</span><br><span class="line">flowType</span><br><span class="line">forceCoeffsCompressible</span><br><span class="line">forceCoeffsIncompressible</span><br><span class="line">forcesCompressible</span><br><span class="line">forcesIncompressible</span><br><span class="line">grad</span><br><span class="line">icoUncoupledKinematicCloud</span><br><span class="line">interfaceHeight</span><br><span class="line">internalProbes</span><br><span class="line">log</span><br><span class="line">mag</span><br><span class="line">magSqr</span><br><span class="line">minMaxComponents</span><br><span class="line">minMaxMagnitude</span><br><span class="line">patchAverage</span><br><span class="line">patchIntegrate</span><br><span class="line">phaseScalarTransport</span><br><span class="line">pressureDifferencePatch</span><br><span class="line">pressureDifferenceSurface</span><br><span class="line">probes</span><br><span class="line">randomise</span><br><span class="line">residuals</span><br><span class="line">scalarTransport</span><br><span class="line">scale</span><br><span class="line">singleGraph</span><br><span class="line">staticPressure</span><br><span class="line">streamFunction</span><br><span class="line">streamlines</span><br><span class="line">subtract</span><br><span class="line">surfaces</span><br><span class="line">time</span><br><span class="line">totalPressureCompressible</span><br><span class="line">totalPressureIncompressible</span><br><span class="line">turbulenceFields</span><br><span class="line">turbulenceIntensity</span><br><span class="line">volFlowRateSurface</span><br><span class="line">vorticity</span><br><span class="line">wallHeatFlux</span><br><span class="line">wallHeatTransferCoeff</span><br><span class="line">wallShearStress</span><br><span class="line">writeCellCentres</span><br><span class="line">writeCellVolumes</span><br><span class="line">writeObjects</span><br><span class="line">writeVTK</span><br><span class="line">yPlus</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>直接运行即可，比如：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">postProcess -func CourantNo</span><br></pre></td></tr></table></figure><h1 id="libfieldfunctionobjects"><a class="markdownIt-Anchor" href="#libfieldfunctionobjects"></a> libfieldFunctionObjects</h1><p>常用操作举例：</p><h2 id="vol-场操作"><a class="markdownIt-Anchor" href="#vol-场操作"></a> vol 场操作</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">   volFieldValue1</span><br><span class="line">   &#123;</span><br><span class="line">       type            volFieldValue;</span><br><span class="line">       libs            (<span class="string">"libfieldFunctionObjects.so"</span>);</span><br><span class="line"></span><br><span class="line">       <span class="built_in">log</span>             <span class="literal">true</span>;</span><br><span class="line">       writeControl    writeTime;</span><br><span class="line">       writeFields     <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">       regionType      cellZone;</span><br><span class="line">       name            c0;</span><br><span class="line">       operation       volAverage;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//A single weight field can be specified as before:</span></span><br><span class="line">       weightField     alpha1;</span><br><span class="line">       <span class="comment">//or a list specified by:</span></span><br><span class="line">       <span class="comment">//weightFields (alpha.water rho.water);</span></span><br><span class="line"></span><br><span class="line">       fields</span><br><span class="line">       (</span><br><span class="line">           p</span><br><span class="line">           U</span><br><span class="line">       );</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>operation 有：</p><table><thead><tr><th>operation</th><th>说明</th><th>代码</th></tr></thead><tbody><tr><td>CoV</td><td>Coefficient of variation: standard deviation/mean</td><td>略</td></tr><tr><td>average</td><td>Ensemble average</td><td><code>gSum(values)/nCells()</code></td></tr><tr><td>max</td><td>Maximum</td><td><code>gMax(values)</code></td></tr><tr><td>min</td><td>Minimum</td><td><code>gMin(values)</code></td></tr><tr><td>none</td><td>No operation</td><td></td></tr><tr><td>sum</td><td>Sum</td><td><code>gSum(values)</code></td></tr><tr><td>sumMag</td><td>Sum of component magnitudes</td><td><code>gSum(cmptMag(values))</code></td></tr><tr><td>volAverage</td><td>Volume weighted average</td><td><code>gSum(V*values)/V_total</code></td></tr><tr><td>volIntegrate</td><td>Volume integral</td><td><code>gSum(V*values)</code></td></tr><tr><td>weightedAverage</td><td>Weighted average</td><td><code>gSum(weightField*values)/gSum(weightField)</code></td></tr><tr><td>weightedSum</td><td>Weighted sum</td><td><code>gSum(weightField*values)</code></td></tr><tr><td>weightedVolAverage</td><td>Weighted volume average</td><td><code>gSum(weightField*V*values)/gSum(weightField*V)</code></td></tr><tr><td>weightedVolIntegrate</td><td>Weighted volume integral</td><td><code>gSum(weightField*V*values)</code></td></tr></tbody></table><h2 id="surface-场操作"><a class="markdownIt-Anchor" href="#surface-场操作"></a> Surface 场操作</h2><h3 id="operation"><a class="markdownIt-Anchor" href="#operation"></a> operation：</h3><table><thead><tr><th>operation</th><th>说明</th><th>代码</th></tr></thead><tbody><tr><td>CoV</td><td>Coefficient of variation: standard deviation/mean</td><td>略</td></tr><tr><td>average</td><td>ensemble average</td><td><code>sum(values)/values.size()</code></td></tr><tr><td>max</td><td>maximum</td><td><code>max(values)</code></td></tr><tr><td>min</td><td>minimum</td><td><code>min(values)</code></td></tr><tr><td>none</td><td>no operation</td><td></td></tr><tr><td>sum</td><td>sum</td><td><code>sum(values)</code></td></tr><tr><td>sumMag</td><td>sum of component magnitudes</td><td><code>sum(cmptMag(values))</code></td></tr><tr><td>areaAverage</td><td>area weighted average</td><td><code>sum(magSf*values)/sum(magSf)</code></td></tr><tr><td>areaIntegrate</td><td>area integral</td><td><code>sum(magSf*values)</code></td></tr><tr><td>areaNormalAverage</td><td>area weighted average in face normal direction</td><td><code>vector( sum(values &amp; Sf)/sum(mag(Sf)), 0.0, 0.0 )</code></td></tr><tr><td>areaNormalIntegrate</td><td>area weighted integral in face normal directon</td><td><code>vector( sum(values &amp; Sf), 0.0, 0.0 )</code></td></tr><tr><td>weightedAreaAverage</td><td>weighted area average</td><td><code>sum(weightField*magSf*values)/sum(magSf*weightField)</code></td></tr><tr><td>weightedAreaIntegrate</td><td>weighted area integral</td><td><code>sum(weightField*magSf*values)</code></td></tr><tr><td>weightedAverage</td><td>weighted average</td><td><code>sum(weightField*values)/sum(weightField)</code></td></tr><tr><td>weightedSum</td><td>weighted sum</td><td><code>sum(weightField*values)</code></td></tr><tr><td>sumDirection</td><td>sum values which are positive in given direction</td><td>略</td></tr><tr><td>sumDirectionBalance</td><td>sum of balance of values in given direction</td><td>略</td></tr></tbody></table><h3 id="surface-场操作举例1"><a class="markdownIt-Anchor" href="#surface-场操作举例1"></a> Surface 场操作举例1</h3><p>面平均，计算 <code>f0</code> 这个 <code>faceZone</code> 上 <code>zeta</code> 的平均值</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    poolHeight</span><br><span class="line">    &#123;</span><br><span class="line">        type            surfaceFieldValue;</span><br><span class="line">        libs            (<span class="string">"libfieldFunctionObjects.so"</span>);</span><br><span class="line">        writeControl    timeStep;</span><br><span class="line">        writeInterval   <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">log</span>             yes;</span><br><span class="line">        writeTotalArea  no;</span><br><span class="line">        writeFields     no;</span><br><span class="line">        regionType      faceZone;</span><br><span class="line">        name            f0;</span><br><span class="line">        operation       areaAverage;</span><br><span class="line">        fields</span><br><span class="line">        (</span><br><span class="line">            zeta</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="surface-场操作举例2"><a class="markdownIt-Anchor" href="#surface-场操作举例2"></a> Surface 场操作举例2</h3><p>面求和，计算 <code>inlet</code> 这个 <code>patch</code> 上 <code>rhoPhi</code> 的和</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    inletFlux</span><br><span class="line">    &#123;</span><br><span class="line">        type            surfaceFieldValue;</span><br><span class="line">        libs            (<span class="string">"libfieldFunctionObjects.so"</span>);</span><br><span class="line">        writeControl   timeStep;</span><br><span class="line">        <span class="built_in">log</span>             <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">// Output field values as well</span></span><br><span class="line">        writeFields     <span class="literal">false</span>;</span><br><span class="line">        regionType      patch;</span><br><span class="line">        name            inlet;</span><br><span class="line">        operation       sum;</span><br><span class="line">        fields</span><br><span class="line">        (</span><br><span class="line">            rhoPhi</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    outletFlux</span><br><span class="line">    &#123;</span><br><span class="line">        $inletFlux;</span><br><span class="line">        name            outlet;</span><br><span class="line">    &#125;</span><br><span class="line">    atmosphereFlux</span><br><span class="line">    &#123;</span><br><span class="line">        $inletFlux;</span><br><span class="line">        name            atmosphere;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="surfaceinterpolate"><a class="markdownIt-Anchor" href="#surfaceinterpolate"></a> surfaceInterpolate</h2><p>Description<br>Linearly interpolates volume fields to generate surface fields.<br>Fields are stored<br>- every time step the field is updated with new values<br>- at output it writes the fields<br>This functionObject can either be used<br>- to calculate a new field as a post-processing step or<br>- since the fields are registered, used in another functionObject<br>Example of function object specification:<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">surfaceInterpolate1</span><br><span class="line">&#123;</span><br><span class="line">    type        surfaceInterpolate;</span><br><span class="line">    libs        (&quot;libfieldFunctionObjects.so&quot;);</span><br><span class="line">    ...</span><br><span class="line">    fields      ((p pInterp)(U UInterp));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Usage<br>\table<p></p><table><thead><tr><th>Property</th><th>Description</th><th>Required</th><th>Default value</th></tr></thead><tbody><tr><td>type</td><td>type name: surfaceInterpolate</td><td>yes</td><td></td></tr><tr><td>fields</td><td>list of fields with corresponding output field names</td><td>yes</td><td></td></tr></tbody></table><p><a href="https://github.com/OpenFOAM/OpenFOAM-8/commit/84a12667063d919ab74d79fcac4c9b6d5f817997" target="_blank" rel="external nofollow noopener noreferrer">简便用法</a></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">e.g. given a vol pressure field p</span><br><span class="line"></span><br><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F; Interpolate the pressure field to the faces</span><br><span class="line">    surfacep</span><br><span class="line">    &#123;</span><br><span class="line">        type        surfaceInterpolate;</span><br><span class="line">        libs        (&quot;libfieldFunctionObjects.so&quot;);</span><br><span class="line">        fields      ((p surfacep));</span><br><span class="line">        writeControl none;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; Average the surface pressure field over the centre faceZone</span><br><span class="line">    #includeFunc faceZoneAverage(name&#x3D;centre, surfacep)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="时间平均"><a class="markdownIt-Anchor" href="#时间平均"></a> 时间平均</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    field_average</span><br><span class="line">    &#123;</span><br><span class="line">        type fieldAverage;  <span class="comment">// fieldAverage 是时间平均</span></span><br><span class="line">        functionObjectLibs (<span class="string">"libfieldFunctionObjects.so"</span>);</span><br><span class="line">        enabled <span class="literal">true</span>;</span><br><span class="line">        writeControl outputTime;</span><br><span class="line">        fields</span><br><span class="line">        (</span><br><span class="line">            U</span><br><span class="line">            &#123;</span><br><span class="line">                mean on;</span><br><span class="line">                prime2Mean on;</span><br><span class="line">                base time;</span><br><span class="line">            &#125;</span><br><span class="line">            k</span><br><span class="line">            &#123;</span><br><span class="line">                mean on;</span><br><span class="line">                prime2Mean off;</span><br><span class="line">                base time;</span><br><span class="line">            &#125;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://github.com/OpenFOAM/OpenFOAM-dev/commit/0177c7dd59b3a0be669d520d8652a3d60435a370" target="_blank" rel="external nofollow noopener noreferrer">简便用法</a></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#includeFunc fieldAverage(U, p, prime2Mean &#x3D; yes)</span><br><span class="line">#includeFunc fieldAverage(U, p)</span><br></pre></td></tr></table></figure><p><a href="http://xiaopingqiu.github.io/2015/04/12/fieldAverage/" target="_blank" rel="external nofollow noopener noreferrer">更多关于时间平均的细节请看这里</a></p><h2 id="极值"><a class="markdownIt-Anchor" href="#极值"></a> 极值</h2><p>这个好像前边的场操作 <code>volFieldValue</code> 也能实现。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    minMax</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Type of functionObject</span></span><br><span class="line">        type            fieldMinMax;</span><br><span class="line">        <span class="comment">// Where to load it from (if not already in solver)</span></span><br><span class="line">        functionObjectLibs (<span class="string">"libfieldFunctionObjects.so"</span>);</span><br><span class="line">        <span class="comment">// Function object enabled flag</span></span><br><span class="line">        enabled         <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">// Log to output (default: false)</span></span><br><span class="line">        <span class="built_in">log</span>             <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">// Write information to file (default: true)</span></span><br><span class="line">        <span class="built_in">write</span>           <span class="literal">true</span>;</span><br><span class="line">        location        no;</span><br><span class="line">        <span class="comment">// Fields to be monitored - runTime modifiable</span></span><br><span class="line">        fields (U p T);</span><br><span class="line">        <span class="comment">//fields (T);</span></span><br><span class="line">        writeControl    timeStep;</span><br><span class="line">        writeInterval   <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="shearstress"><a class="markdownIt-Anchor" href="#shearstress"></a> <a href="https://github.com/OpenFOAM/OpenFOAM-dev/blob/master/etc/caseDicts/postProcessing/fields/shearStress" target="_blank" rel="external nofollow noopener noreferrer">shearStress</a></h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    shearStress</span><br><span class="line">    &#123;</span><br><span class="line">        type            shearStress;</span><br><span class="line">        libs            (<span class="string">"libfieldFunctionObjects.so"</span>);</span><br><span class="line"></span><br><span class="line">        executeControl  writeTime;</span><br><span class="line">        writeControl    writeTime;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="streamline"><a class="markdownIt-Anchor" href="#streamline"></a> streamLine</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    streamLines</span><br><span class="line">    &#123;</span><br><span class="line">        type            streamLine;</span><br><span class="line">        <span class="comment">// Where to load it from (if not already in solver)</span></span><br><span class="line">        libs            (<span class="string">"libfieldFunctionObjects.so"</span>);</span><br><span class="line">        <span class="comment">// Output every</span></span><br><span class="line">        writeControl    writeTime;</span><br><span class="line">        <span class="comment">// writeInterval 10;</span></span><br><span class="line">        setFormat       vtk; <span class="comment">//gnuplot;//xmgr;//raw;//jplot;//csv;//ensight;</span></span><br><span class="line">        <span class="comment">// Tracked forwards (+U) or backwards (-U)</span></span><br><span class="line">        trackForward    <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">// Names of fields to sample. Should contain above velocity field!</span></span><br><span class="line">        fields (p k U);</span><br><span class="line">        <span class="comment">// Steps particles can travel before being removed</span></span><br><span class="line">        lifeTime        <span class="number">10000</span>;</span><br><span class="line">        <span class="comment">// Number of steps per cell (estimate). Set to 1 to disable subcycling.</span></span><br><span class="line">        nSubCycle <span class="number">5</span>;</span><br><span class="line">        <span class="comment">// Cloud name to use</span></span><br><span class="line">        cloudName       particleTracks;</span><br><span class="line">        <span class="comment">// Seeding method.</span></span><br><span class="line">        seedSampleSet</span><br><span class="line">        &#123;</span><br><span class="line">            type        uniform;</span><br><span class="line">            axis        x;  <span class="comment">//distance;</span></span><br><span class="line">            start       (<span class="number">-0.0205</span> <span class="number">0.001</span>  <span class="number">0.00001</span>);</span><br><span class="line">            <span class="built_in">end</span>         (<span class="number">-0.0205</span> <span class="number">0.0251</span> <span class="number">0.00001</span>);</span><br><span class="line">            nPoints     <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="machno"><a class="markdownIt-Anchor" href="#machno"></a> MachNo</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    libs            (<span class="string">"libfieldFunctionObjects.so"</span>);</span><br><span class="line">    Ma</span><br><span class="line">    &#123;</span><br><span class="line">        type            MachNo;</span><br><span class="line">        executeControl  writeTime;</span><br><span class="line">        writeControl    writeTime;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="probes"><a class="markdownIt-Anchor" href="#probes"></a> probes</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    my_name</span><br><span class="line">    &#123;</span><br><span class="line">        type    probes;</span><br><span class="line">        probeLocations</span><br><span class="line">        (</span><br><span class="line">            (<span class="number">0.0</span> <span class="number">0.05</span> <span class="number">0.0</span>)</span><br><span class="line">        );</span><br><span class="line">        functionObjectLibs    (<span class="string">"libfieldFunctionObjects.so"</span>);</span><br><span class="line">fields (T);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="libutilityfunctionobjects"><a class="markdownIt-Anchor" href="#libutilityfunctionobjects"></a> libutilityFunctionObjects</h1><h2 id="所有可选-type"><a class="markdownIt-Anchor" href="#所有可选-type"></a> 所有可选 type</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">abort</span></span><br><span class="line">coded<span class="comment">//使用代码</span></span><br><span class="line">patchProbes</span><br><span class="line">probes<span class="comment">//检测某些点的某些物理量,需要指定 probeLocations fields,和上边重复了。。。</span></span><br><span class="line">psiReactionThermoMoleFractions</span><br><span class="line">removeRegisteredObject</span><br><span class="line">residuals</span><br><span class="line">rhoReactionThermoMoleFractions</span><br><span class="line">setTimeStep<span class="comment">//设置时间步长，如：从表格中读取，sine函数等。</span></span><br><span class="line">sets</span><br><span class="line">surfaces</span><br><span class="line">systemCall</span><br><span class="line">time</span><br><span class="line">timeActivatedFileUpdate<span class="comment">//可以设置多套controlDict，运行到某一时刻自动切换</span></span><br><span class="line">writeDictionary</span><br><span class="line">writeObjects<span class="comment">//write一些计算过程中的对象，可以多输出一些信息</span></span><br></pre></td></tr></table></figure><h2 id="writeobjects"><a class="markdownIt-Anchor" href="#writeobjects"></a> writeObjects</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    writeFields <span class="comment">// name of the function object</span></span><br><span class="line">    &#123;</span><br><span class="line">        type writeObjects;</span><br><span class="line">        libs ( <span class="string">"libutilityFunctionObjects.so"</span> );</span><br><span class="line"></span><br><span class="line">        objects</span><br><span class="line">        (</span><br><span class="line">    T U rho <span class="comment">// list of fields/variables to be written</span></span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// E.g. write every 1e-5 seconds of simulation time only the specified fields</span></span><br><span class="line">        writeControl runTime;</span><br><span class="line">        writeInterval <span class="number">1e-5</span>; <span class="comment">// write every 1e-5 seconds</span></span><br><span class="line">        </span><br><span class="line">        writeOption autoWrite;<span class="comment">// noWrite anyWrite  </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>You can also define multiple function objects in order to write different subsets of fields at different times. You can also use wildcards in the list of fields- for example, in order to write out all fields starting with “RR_” you can add</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;RR_.*&quot;</span><br></pre></td></tr></table></figure><p>可以输出每个组分的反应速率？放热率呢？如何输出？Qdot[1 -1 -3 0 0 0 0] 是dQ[1 2 -3 0 0 0 0]除以体积，dQ的单位是J/s。那么我们需要对Qdot进行volumeIntegrate 操作。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">定义：fvc::volumeIntegrate(df)=df.mesh().V()*df.field()<span class="comment">//df是被操作的场</span></span><br><span class="line">使用：volScalarField dQ = fvc::volumeIntegrate(Qdot);<span class="comment">//dQ的量纲是多少？</span></span><br></pre></td></tr></table></figure><h2 id="settimestep"><a class="markdownIt-Anchor" href="#settimestep"></a> setTimeStep</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">timeStepping</span><br><span class="line">    &#123;</span><br><span class="line">        type            setTimeStep;</span><br><span class="line">        functionObjectLibs (<span class="string">"libutilityFunctionObjects.so"</span>);</span><br><span class="line">        enabled         yes;</span><br><span class="line">        deltaT          tableFile;</span><br><span class="line">        file            <span class="string">"system/deltaTvalues"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="timeactivatedfileupdate"><a class="markdownIt-Anchor" href="#timeactivatedfileupdate"></a> timeActivatedFileUpdate</h2><p>运行时更改某些文件</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Performs a file copy/replacement once a specified time has been reached.</span><br><span class="line"></span><br><span class="line">Example usage to update the fvSolution dictionary at various times throughout the calculation:</span><br><span class="line"></span><br><span class="line">\verbatim</span><br><span class="line">fileUpdate1</span><br><span class="line">&#123;</span><br><span class="line">    type              timeActivatedFileUpdate;</span><br><span class="line">    libs              (<span class="string">"libutilityFunctionObjects.so"</span>);</span><br><span class="line">    writeControl      timeStep;</span><br><span class="line">    writeInterval     <span class="number">1</span>;</span><br><span class="line">    fileToUpdate      <span class="string">"$FOAM_CASE/system/fvSolution"</span>;</span><br><span class="line">    timeVsFile</span><br><span class="line">    (</span><br><span class="line">        (<span class="number">-1</span> <span class="string">"$FOAM_CASE/system/fvSolution.0"</span>)</span><br><span class="line">        (<span class="number">0.10</span> <span class="string">"$FOAM_CASE/system/fvSolution.10"</span>)</span><br><span class="line">        (<span class="number">0.20</span> <span class="string">"$FOAM_CASE/system/fvSolution.20"</span>)</span><br><span class="line">        (<span class="number">0.35</span> <span class="string">"$FOAM_CASE/system/fvSolution.35"</span>)</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line">\endverbatim</span><br></pre></td></tr></table></figure><h2 id="coded"><a class="markdownIt-Anchor" href="#coded"></a> coded</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    timeStep</span><br><span class="line">    &#123;</span><br><span class="line">        type coded;</span><br><span class="line">        libs            (<span class="string">"libutilityFunctionObjects.so"</span>);</span><br><span class="line">        name setDeltaT;</span><br><span class="line">        code</span><br><span class="line">        #&#123;</span><br><span class="line">        #&#125;;</span><br><span class="line">        codeExecute</span><br><span class="line">        #&#123;</span><br><span class="line">            <span class="keyword">const</span> Time&amp; runTime = mesh().time();</span><br><span class="line">            <span class="keyword">if</span> (runTime.timeToUserTime(runTime.value()) &gt;= <span class="number">-15.0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">const_cast</span>&lt;Time&amp;&gt;(runTime).setDeltaT</span><br><span class="line">                (</span><br><span class="line">                    runTime.userTimeToTime(<span class="number">0.025</span>)</span><br><span class="line">                );</span><br><span class="line">            &#125;</span><br><span class="line">        #&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    error</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Load the library containing the 'coded' functionObject</span></span><br><span class="line">        libs            (<span class="string">"libutilityFunctionObjects.so"</span>);</span><br><span class="line">        type coded;</span><br><span class="line">        <span class="comment">// Name of on-the-fly generated functionObject</span></span><br><span class="line">        name error;</span><br><span class="line">        codeEnd</span><br><span class="line">        #&#123;</span><br><span class="line">            <span class="comment">// Lookup U</span></span><br><span class="line">            Info&lt;&lt; <span class="string">"Looking up field U\n"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">const</span> volVectorField&amp; U = mesh().lookupObject&lt;volVectorField&gt;(<span class="string">"U"</span>);</span><br><span class="line">            Info&lt;&lt; <span class="string">"Reading inlet velocity uInfX\n"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            scalar ULeft = <span class="number">0.0</span>;</span><br><span class="line">            label leftI = mesh().boundaryMesh().findPatchID(<span class="string">"left"</span>);</span><br><span class="line">            <span class="keyword">const</span> fvPatchVectorField&amp; fvp = U.boundaryField()[leftI];</span><br><span class="line">            <span class="keyword">if</span> (fvp.<span class="built_in">size</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                ULeft = fvp[<span class="number">0</span>].x();</span><br><span class="line">            &#125;</span><br><span class="line">            reduce(ULeft, maxOp&lt;scalar&gt;());</span><br><span class="line">            dimensionedScalar uInfX</span><br><span class="line">            (</span><br><span class="line">                <span class="string">"uInfx"</span>,</span><br><span class="line">                dimensionSet(<span class="number">0</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>),</span><br><span class="line">                ULeft</span><br><span class="line">            );</span><br><span class="line">            Info &lt;&lt; <span class="string">"U at inlet = "</span> &lt;&lt; uInfX.value() &lt;&lt; <span class="string">" m/s"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            scalar magCylinder = <span class="number">0.0</span>;</span><br><span class="line">            label cylI = mesh().boundaryMesh().findPatchID(<span class="string">"cylinder"</span>);</span><br><span class="line">            <span class="keyword">const</span> fvPatchVectorField&amp; cylFvp = mesh().C().boundaryField()[cylI];</span><br><span class="line">            <span class="keyword">if</span> (cylFvp.<span class="built_in">size</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                magCylinder = mag(cylFvp[<span class="number">0</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            reduce(magCylinder, maxOp&lt;scalar&gt;());</span><br><span class="line">            dimensionedScalar radius</span><br><span class="line">            (</span><br><span class="line">                <span class="string">"radius"</span>,</span><br><span class="line">                dimensionSet(<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>),</span><br><span class="line">                magCylinder</span><br><span class="line">            );</span><br><span class="line">            Info &lt;&lt; <span class="string">"Cylinder radius = "</span> &lt;&lt; radius.value() &lt;&lt; <span class="string">" m"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            volVectorField UA</span><br><span class="line">            (</span><br><span class="line">                IOobject</span><br><span class="line">                (</span><br><span class="line">                    <span class="string">"UA"</span>,</span><br><span class="line">                    mesh().time().timeName(),</span><br><span class="line">                    U.mesh(),</span><br><span class="line">                    IOobject::NO_READ,</span><br><span class="line">                    IOobject::AUTO_WRITE</span><br><span class="line">                ),</span><br><span class="line">                U</span><br><span class="line">            );</span><br><span class="line">            Info&lt;&lt; <span class="string">"\nEvaluating analytical solution"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">const</span> volVectorField&amp; centres = UA.mesh().C();</span><br><span class="line">            <span class="function">volScalarField <span class="title">magCentres</span><span class="params">(mag(centres))</span></span>;</span><br><span class="line">            <span class="function">volScalarField <span class="title">theta</span><span class="params">(<span class="built_in">acos</span>((centres &amp; <span class="built_in">vector</span>(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>))/magCentres))</span></span>;</span><br><span class="line">            volVectorField cs2theta</span><br><span class="line">            (</span><br><span class="line">                <span class="built_in">cos</span>(<span class="number">2</span>*theta)*<span class="built_in">vector</span>(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">              + <span class="built_in">sin</span>(<span class="number">2</span>*theta)*<span class="built_in">vector</span>(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>)</span><br><span class="line">            );</span><br><span class="line">            UA = uInfX*(dimensionedVector(<span class="built_in">vector</span>(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">              - <span class="built_in">pow</span>((radius/magCentres),<span class="number">2</span>)*cs2theta);</span><br><span class="line">            <span class="comment">// Force writing of UA (since time has not changed)</span></span><br><span class="line">            UA.<span class="built_in">write</span>();</span><br><span class="line">            <span class="function">volScalarField <span class="title">error</span><span class="params">(<span class="string">"error"</span>, mag(U-UA)/mag(UA))</span></span>;</span><br><span class="line">            Info&lt;&lt;<span class="string">"Writing relative error in U to "</span> &lt;&lt; error.objectPath()</span><br><span class="line">                &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            error.<span class="built_in">write</span>();</span><br><span class="line">        #&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h1><h2 id="probes-前面有另一种实现方法"><a class="markdownIt-Anchor" href="#probes-前面有另一种实现方法"></a> probes 前面有另一种实现方法</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    probes</span><br><span class="line">    &#123;</span><br><span class="line">        type            probes;</span><br><span class="line">        libs            (<span class="string">"libsampling.so"</span>);</span><br><span class="line">        writeControl   timeStep;</span><br><span class="line">        writeInterval  <span class="number">1</span>;</span><br><span class="line">        probeLocations</span><br><span class="line">        (</span><br><span class="line">            (<span class="number">0</span> <span class="number">9.95</span> <span class="number">19.77</span>)</span><br><span class="line">            (<span class="number">0</span> <span class="number">-9.95</span> <span class="number">19.77</span>)</span><br><span class="line">        );</span><br><span class="line">        fixedLocations  <span class="literal">false</span>;</span><br><span class="line">        fields</span><br><span class="line">        (</span><br><span class="line">            p</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="等值面"><a class="markdownIt-Anchor" href="#等值面"></a> 等值面</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    surfaces</span><br><span class="line">    &#123;</span><br><span class="line">        type            surfaces;</span><br><span class="line">        libs            (<span class="string">"libsampling.so"</span>);</span><br><span class="line">        writeControl    adjustableRunTime;</span><br><span class="line">        writeInterval   <span class="number">0.01</span>;</span><br><span class="line">        timeStart       <span class="number">10</span>;</span><br><span class="line">        surfaceFormat   vtk;</span><br><span class="line">        fields          (p_rgh U);</span><br><span class="line">        interpolationScheme cellPoint;</span><br><span class="line">        surfaces</span><br><span class="line">        (</span><br><span class="line">            interface</span><br><span class="line">            &#123;</span><br><span class="line">                type            isoSurface;</span><br><span class="line">                isoField        alpha.water;</span><br><span class="line">                isoValue        <span class="number">0.5</span>;</span><br><span class="line">                interpolate     <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="forces"><a class="markdownIt-Anchor" href="#forces"></a> forces</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    forces</span><br><span class="line">    &#123;</span><br><span class="line">        type            forces;</span><br><span class="line">        libs            (<span class="string">"libforces.so"</span>);</span><br><span class="line">        writeControl    writeTime;</span><br><span class="line">        patches         (floatingObject);</span><br><span class="line">        rho             rhoInf;</span><br><span class="line">        <span class="built_in">log</span>             yes;</span><br><span class="line">        rhoInf          <span class="number">1000</span>;</span><br><span class="line">        CofR            (<span class="number">0</span> <span class="number">0</span> <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1 id="输出控制"><a class="markdownIt-Anchor" href="#输出控制"></a> 输出控制</h1><p>这里分两种情况，分别是 solver 运行时和运行后。</p><ul><li>运行后，一定需要记住的是必须使用参数 <code>-fields</code> 指定此次后处理过程中涉及的所有场（作为输入信息）。可以使用前面提到的 <code>-time</code> 参数来控制需要处理的时间段。</li><li>运行时<br>在 solver 运行时可以手动控制输出时间间隔，通过这两个选项： writeControl writeInterval。<br><code>writeControl</code> 常用的可选项：</li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">outputTime<span class="comment">//同主程序输出间隔相同。</span></span><br><span class="line">writeTime<span class="comment">//每 writeInterval个输出步长写一次。这里的输出步长指主程序的write步长。即，如果主程序每秒write一次，这里的function就是每3秒写一次。</span></span><br><span class="line">adjustableRunTime<span class="comment">//每 writeInterval 秒物理时间写一次，但是对于可调节步长的话，会自动调节最后一次的时间步长，以便准确时间输出。</span></span><br></pre></td></tr></table></figure><p><code>writeControl</code> 所有的可选项：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">outputTime<span class="comment">//同主程序输出间隔相同。</span></span><br><span class="line">runTime<span class="comment">//每 writeInterval 秒物理时间写一次。</span></span><br><span class="line">adjustableRunTime<span class="comment">//每 writeInterval 秒物理时间写一次，但是对于可调节步长的话，会自动调节最后一次的时间步长，以便准确时间输出。</span></span><br><span class="line">clockTime<span class="comment">//每 writeInterval 秒实际时间写一次。</span></span><br><span class="line">cpuTime<span class="comment">//每 writeInteral 秒 cpu 时间写一次。</span></span><br><span class="line">none<span class="comment">//不输出。</span></span><br><span class="line">writeTime<span class="comment">//每 writeInterval个输出步长写一次。这里的输出步长指主程序的write步长。即，如果主程序每秒write一次，这里的function就是每3秒写一次。</span></span><br><span class="line">timeStep<span class="comment">//每 writeInterval 个时间步长写一次。</span></span><br></pre></td></tr></table></figure><h1 id="简便用法"><a class="markdownIt-Anchor" href="#简便用法"></a> 简便用法</h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    #includeFunc Qdot</span><br><span class="line">    #<span class="function">includeFunc <span class="title">writeObjects</span><span class="params">(RR.C7H16)</span></span></span><br><span class="line">    #includeFunc writeObjects(h)</span><br><span class="line">    #<span class="function">includeFunc <span class="title">fieldAverage</span><span class="params">(U, p)</span></span></span><br><span class="line">    #includeFunc fieldAverage(U, p, prime2Mean = yes)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> using </category>
          
      </categories>
      
      
        <tags>
            
            <tag> functionObject </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
