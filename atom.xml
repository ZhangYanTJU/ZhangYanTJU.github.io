<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>OpenFOAM 成长之路</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://openfoam.top/"/>
  <updated>2020-07-16T22:00:00.000Z</updated>
  <id>https://openfoam.top/</id>
  
  <author>
    <name>Yan Zhang</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>OpenFOAM 并行 reconstructPar</title>
    <link href="https://openfoam.top/parallellyReconstructPar/"/>
    <id>https://openfoam.top/parallellyReconstructPar/</id>
    <published>2020-07-16T22:00:00.000Z</published>
    <updated>2020-07-16T22:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>使用特殊技巧并行化 reconstructPar OpenFOAM 结果</p><a id="more"></a><p>通过参悟 OpenFOAM 中的并行编译方法：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wmake -j 8</span><br></pre></td></tr></table></figure><p>我们实现了并行化的 <code>reconstructPar</code>：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">timeList&#x3D;&#96;foamListTimes -processor&#96;</span><br><span class="line">for time in $timeList; do</span><br><span class="line">    nCores&#x3D;6</span><br><span class="line">    joblist&#x3D;($(jobs -p))</span><br><span class="line">    while (( $&#123;#joblist[*]&#125; &gt;&#x3D; &quot;$nCores&quot; ))</span><br><span class="line">    do</span><br><span class="line">        # When the job limit is reached wait for a job to finish</span><br><span class="line">        wait -n</span><br><span class="line">        joblist&#x3D;($(jobs -p))</span><br><span class="line">    done</span><br><span class="line">    reconstructPar -time $time &gt;log.$time&amp;</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>上述代码即可实现 6 个核同时 <code>reconstructPar</code>！</p><p>如果你使用了 <code>collated fileHandler</code>，那么你就得使用我编写的工具，才能获知并行计算的 time list。<br>我把它放在了 GitHub 上：<a href="https://github.com/ZhangYanTJU/ZYfoamListTimes" target="_blank" rel="external nofollow noopener noreferrer">ZYfoamListTimes</a>，可以自行下载编译，也欢迎点赞关注加收藏。<br>然后将上段代码中的 <code>foamListTimes -processor</code> 替换成 <code>ZYfoamListTimes -processors 21</code> 即可，其中 21 是你的算例使用的核数。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;使用特殊技巧并行化 reconstructPar OpenFOAM 结果&lt;/p&gt;
    
    </summary>
    
    
      <category term="using" scheme="https://openfoam.top/categories/using/"/>
    
    
      <category term="reconstructPar" scheme="https://openfoam.top/tags/reconstructPar/"/>
    
  </entry>
  
  <entry>
    <title>paraview 网格显示美化</title>
    <link href="https://openfoam.top/paraviewMesh/"/>
    <id>https://openfoam.top/paraviewMesh/</id>
    <published>2020-07-07T22:00:00.000Z</published>
    <updated>2020-07-07T22:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>paraview 的网格可以显示得很美观，只需要掌握以下技巧。</p><a id="more"></a><p>首先，使用 slice 可以获得更加好看的切片（相比于 clip）。</p><p>最开始，网格是这样：<br><img src="/album/paraviewMesh1.png" width="70%" height="70%"></p><p>一键美化：取消勾选 Triangulate the slice</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><img src="/album/paraviewMesh2.png"></td><td><img src="/album/paraviewMesh3.png"></td></tr></tbody></table><p>上边的网格，只需要一个按钮就可以变得更好看。</p><table><thead><tr><th>如果使用 paraview 打开的，点击 0412.foam，然后取消勾选 Decompose polyhedra</th><th>如果使用 paraFoam 打开的，点击 0412.foam，然后勾选 Use VTK Polyhedron</th></tr></thead><tbody><tr><td><img src="/album/paraviewMesh4.png"></td><td><img src="/album/paraviewMesh5.png"></td></tr></tbody></table><p>最后，还需要把 slice 的 X 方向（我这个截面的法向是 X 方向）偏移一下：1e-7</p><p>最终效果（左图是完整的网格，右图是局部放大）：<br><img src="/album/paraviewMesh6.png" width="100%" height="100%"></p><p>最终效果来自<a href="https://www.tandfonline.com/doi/full/10.1080/13647830.2019.1600722" target="_blank" rel="external nofollow noopener noreferrer">本人论文</a>，感兴趣的读者可以去看看。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;paraview 的网格可以显示得很美观，只需要掌握以下技巧。&lt;/p&gt;
    
    </summary>
    
    
      <category term="using" scheme="https://openfoam.top/categories/using/"/>
    
    
      <category term="paraview" scheme="https://openfoam.top/tags/paraview/"/>
    
  </entry>
  
  <entry>
    <title>OpenFOAM with boost</title>
    <link href="https://openfoam.top/boost/"/>
    <id>https://openfoam.top/boost/</id>
    <published>2020-06-01T22:00:00.000Z</published>
    <updated>2020-06-01T22:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>using boost in OpenFOAM</p><a id="more"></a><p>服务器上已经安装了 boost，在 /usr/include/boost</p><p>在 OpenFOAM 中，不需要修改 options ，直接</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;boost/lambda/lambda.hpp&gt;</span></span></span><br></pre></td></tr></table></figure><p>就可以用了：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt;<span class="string">"beta in boost ="</span>&lt;&lt;boost::math::beta(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)&lt;&lt;<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure><h1 id="boost-中的函数"><a class="markdownIt-Anchor" href="#boost-中的函数"></a> boost 中的函数</h1><p>beta(a,b)<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msup><mi>t</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mrow><mi>b</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>d</mi><mi>t</mi><mo>=</mo><mfrac><mrow><mi mathvariant="normal">Γ</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Γ</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">Γ</mi><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">=\int_0^1t^{a-1}(1-t)^{b-1}dt=\frac{\Gamma(a)\Gamma(b)}{\Gamma(a+b)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.3648280000000002em;vertical-align:-.35582em"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:.19445em;position:relative;top:-.0005599999999999772em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0090080000000001em"><span style="top:-2.34418em;margin-left:-.19445em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.2579000000000002em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35582em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.0991079999999998em;vertical-align:-.25em"></span><span class="mord mathdefault">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8491079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Γ</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">a</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">b</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Γ</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">a</span><span class="mclose mtight">)</span><span class="mord mtight">Γ</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">b</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><p>beta(a,b,x)<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mi>x</mi></msubsup><msup><mi>t</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mrow><mi>b</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">=\int_0^xt^{a-1}(1-t)^{b-1}dt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.215112em;vertical-align:-.35582em"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:.19445em;position:relative;top:-.0005599999999999772em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8592920000000001em"><span style="top:-2.34418em;margin-left:-.19445em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.2579000000000002em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35582em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.0991079999999998em;vertical-align:-.25em"></span><span class="mord mathdefault">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8491079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span></span></p><p>ibeta(a,b,x)<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><mfrac><mrow><msubsup><mo>∫</mo><mn>0</mn><mi>x</mi></msubsup><msup><mi>t</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mrow><mi>b</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>d</mi><mi>t</mi></mrow><mrow><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msup><mi>t</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mrow><mi>b</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">=\frac{\int_0^xt^{a-1}(1-t)^{b-1}dt}{\int_0^1t^{a-1}(1-t)^{b-1}dt}=\frac{beta(a,b,x)}{beta(a,b)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.936208em;vertical-align:-.713004em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.223204em"><span style="top:-2.55128em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="margin-right:.19445em;position:relative;top:-.0005599999999999772em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9124571428571429em"><span style="top:-2.1224514285714284em;margin-left:-.19445em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span><span style="top:-2.9521428571428574em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.37754857142857146em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7463142857142857em"><span style="top:-2.786em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">t</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7820285714285714em"><span style="top:-2.786em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.574284em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="margin-right:.19445em;position:relative;top:-.0005599999999999772em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7596857142857143em"><span style="top:-2.1224514285714284em;margin-left:-.19445em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span><span style="top:-2.9521428571428574em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.37754857142857146em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913142857142857em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">t</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9270285714285714em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.713004em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">a</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">b</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">a</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">b</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><h1 id="gsl-中的函数"><a class="markdownIt-Anchor" href="#gsl-中的函数"></a> GSL 中的函数</h1><p>gsl_sf_beta(a,b) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msup><mi>t</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mrow><mi>b</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>d</mi><mi>t</mi><mo>=</mo><mfrac><mrow><mi mathvariant="normal">Γ</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Γ</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">Γ</mi><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">=\int_0^1t^{a-1}(1-t)^{b-1}dt=\frac{\Gamma(a)\Gamma(b)}{\Gamma(a+b)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.3648280000000002em;vertical-align:-.35582em"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:.19445em;position:relative;top:-.0005599999999999772em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0090080000000001em"><span style="top:-2.34418em;margin-left:-.19445em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.2579000000000002em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35582em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.0991079999999998em;vertical-align:-.25em"></span><span class="mord mathdefault">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8491079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Γ</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">a</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">b</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Γ</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">a</span><span class="mclose mtight">)</span><span class="mord mtight">Γ</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">b</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><p>gsl_sf_beta_inc(a,b,x)<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><mfrac><mrow><msubsup><mo>∫</mo><mn>0</mn><mi>x</mi></msubsup><msup><mi>t</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mrow><mi>b</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>d</mi><mi>t</mi></mrow><mrow><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msup><mi>t</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>t</mi><msup><mo stretchy="false">)</mo><mrow><mi>b</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>d</mi><mi>t</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">=\frac{\int_0^xt^{a-1}(1-t)^{b-1}dt}{\int_0^1t^{a-1}(1-t)^{b-1}dt}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.936208em;vertical-align:-.713004em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.223204em"><span style="top:-2.55128em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="margin-right:.19445em;position:relative;top:-.0005599999999999772em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9124571428571429em"><span style="top:-2.1224514285714284em;margin-left:-.19445em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span><span style="top:-2.9521428571428574em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.37754857142857146em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7463142857142857em"><span style="top:-2.786em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">t</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7820285714285714em"><span style="top:-2.786em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.574284em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="margin-right:.19445em;position:relative;top:-.0005599999999999772em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7596857142857143em"><span style="top:-2.1224514285714284em;margin-left:-.19445em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span><span style="top:-2.9521428571428574em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.37754857142857146em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913142857142857em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">t</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9270285714285714em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.713004em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;using boost in OpenFOAM&lt;/p&gt;
    
    </summary>
    
    
      <category term="code" scheme="https://openfoam.top/categories/code/"/>
    
    
      <category term="boost" scheme="https://openfoam.top/tags/boost/"/>
    
  </entry>
  
  <entry>
    <title>OpenFOAM with GSL</title>
    <link href="https://openfoam.top/gsl/"/>
    <id>https://openfoam.top/gsl/</id>
    <published>2020-06-01T22:00:00.000Z</published>
    <updated>2020-06-01T22:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>using GSL (GNU Scientific Library) in OpenFOAM</p><a id="more"></a><h1 id="编译安装"><a class="markdownIt-Anchor" href="#编译安装"></a> 编译安装</h1><p>在源码目录下，执行下列命令：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./configure --prefix=/THL6/home/yzg/OpenFOAM/gsl-2.4/build 2&gt;&amp;1 | tee c.txt</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h1 id="系统环境变量"><a class="markdownIt-Anchor" href="#系统环境变量"></a> 系统环境变量</h1><p>在 <code>~/.bashrc</code> 文件中添加：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> GSL</span></span><br><span class="line">export LD_LIBRARY_PATH=/THL6/home/yzg/OpenFOAM/gsl-2.4/build/lib:$LD_LIBRARY_PATH</span><br></pre></td></tr></table></figure><h1 id="在-of-solver-中使用-gsl"><a class="markdownIt-Anchor" href="#在-of-solver-中使用-gsl"></a> 在 OF solver 中使用 GSL</h1><p>在 <code>options</code> 文件中添加：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">EXE_INC = \</span><br><span class="line">...</span><br><span class="line">-I/THL6/<span class="built_in">home</span>/yzg/OpenFOAM/gsl<span class="number">-2.4</span>/build/include \</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">EXE_LIBS = \</span><br><span class="line">...</span><br><span class="line">    -L/THL6/<span class="built_in">home</span>/yzg/OpenFOAM/gsl<span class="number">-2.4</span>/build/lib \</span><br><span class="line">    -lgsl \</span><br><span class="line">    -lgslcblas \</span><br></pre></td></tr></table></figure><p>然后按照需要包含其头文件：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gsl/gsl_spline2d.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gsl/gsl_spline.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gsl/gsl_interp2d.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gsl/gsl_interp.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gsl/gsl_sf_gamma.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gsl/gsl_matrix.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gsl/gsl_linalg.h&gt;</span></span></span><br></pre></td></tr></table></figure><h1 id="使用举例"><a class="markdownIt-Anchor" href="#使用举例"></a> 使用举例</h1><h2 id="一维数组插值"><a class="markdownIt-Anchor" href="#一维数组插值"></a> 一维数组插值</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">gsl_interp_accel *acc = gsl_interp_accel_alloc();</span><br><span class="line"><span class="keyword">const</span> gsl_interp_type *t = gsl_interp_linear;</span><br><span class="line">gsl_spline *ZY_spline</span><br><span class="line">    = gsl_spline_alloc (t, index_old.<span class="built_in">size</span>());</span><br><span class="line">gsl_spline_init</span><br><span class="line">    (ZY_spline, index_old, data_old, index_old.<span class="built_in">size</span>());</span><br><span class="line">forAll(index_new, i)</span><br><span class="line">&#123;</span><br><span class="line">    scalar getValue =</span><br><span class="line">        gsl_spline_eval (ZY_spline, index_new[i], acc);</span><br><span class="line">    data_new[i] = getValue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="beta-积分"><a class="markdownIt-Anchor" href="#beta-积分"></a> beta 积分</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">scalar beta_ab_gsl = gsl_sf_beta(a,b);</span><br><span class="line">scalar beta_inc_abz_gsl = gsl_sf_beta_inc(a,b,z)</span><br></pre></td></tr></table></figure><h2 id="矩阵求逆"><a class="markdownIt-Anchor" href="#矩阵求逆"></a> 矩阵求逆</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">gsl_matrix* Foam::ZYclass::GetInverse(gsl_matrix *A)</span><br><span class="line">&#123;</span><br><span class="line">label n = A-&gt;size1;label sign = <span class="number">0</span>;</span><br><span class="line">gsl_matrix *inverse;</span><br><span class="line"></span><br><span class="line">gsl_matrix *tmpA = gsl_matrix_alloc(n, n);</span><br><span class="line">gsl_matrix_memcpy(tmpA, A);</span><br><span class="line">gsl_permutation *p = gsl_permutation_alloc(n);</span><br><span class="line"></span><br><span class="line">gsl_linalg_LU_decomp(tmpA, p, &amp;sign);</span><br><span class="line">inverse = gsl_matrix_alloc(n, n);</span><br><span class="line">gsl_linalg_LU_invert(tmpA, p, inverse);</span><br><span class="line">gsl_permutation_free(p);</span><br><span class="line">gsl_matrix_free(tmpA);</span><br><span class="line"><span class="keyword">return</span> inverse;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="矩阵相乘"><a class="markdownIt-Anchor" href="#矩阵相乘"></a> 矩阵相乘</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">gsl_matrix* Foam::ZYclass::gsl_matrix_mul(gsl_matrix *a,gsl_matrix *b)</span><br><span class="line">&#123;</span><br><span class="line">    gsl_matrix *c=gsl_matrix_alloc(a-&gt;size1, b-&gt;size2);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;a-&gt;size1;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">size_t</span> j=<span class="number">0</span>;j&lt;b-&gt;size2;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">double</span> sum=<span class="number">0.0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">size_t</span> k=<span class="number">0</span>;k&lt;b-&gt;size1;k++)</span><br><span class="line">            &#123;</span><br><span class="line">                sum+=gsl_matrix_get(a,i,k)*gsl_matrix_get(b,k,j);</span><br><span class="line">            &#125;</span><br><span class="line">            gsl_matrix_set(c,i,j,sum);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;using GSL (GNU Scientific Library) in OpenFOAM&lt;/p&gt;
    
    </summary>
    
    
      <category term="code" scheme="https://openfoam.top/categories/code/"/>
    
    
      <category term="GSL" scheme="https://openfoam.top/tags/GSL/"/>
    
  </entry>
  
  <entry>
    <title>OpenFOAM with OpenMP</title>
    <link href="https://openfoam.top/openmp/"/>
    <id>https://openfoam.top/openmp/</id>
    <published>2020-04-07T22:00:00.000Z</published>
    <updated>2020-04-07T22:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>using OpenMP in OpenFOAM</p><a id="more"></a><p>有时候在 OpenFOAM 编写一些算法，用不到自带的 mpi 库。<br>此时可以使用 OpenMP 来对基于 OpenFOAM 编写的代码进行加速。<br>用法很简单，首先加入头文件：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;omp.h&gt;</span></span></span><br></pre></td></tr></table></figure><p>验证 OpenMP 并行是否生效，我们输出一下所使用的的核数：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> omp single</span></span><br><span class="line">&#123;</span><br><span class="line">    Info &lt;&lt; <span class="string">"Hello, omp_get_max_threads = "</span> &lt;&lt; omp_get_max_threads() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后就可以加入 OpenMP 的魔法了，例如对 for 循环进行加速：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> omp parallel for</span></span><br><span class="line"><span class="keyword">for</span> (label i=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++) <span class="comment">// 也支持 OpenFOAM 里的 forAll</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">do</span> something</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后在 Make/options 中，<code>EXE_INC = \</code> 的下面一行，插入：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">-fopenmp \</span><br></pre></td></tr></table></figure><p>使用前可以指定核数（否则使用机器的所有核）：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export OMP_NUM_THREADS=20</span><br></pre></td></tr></table></figure><p>或者在超算 slurm 脚本中指定：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export OMP_NUM_THREADS=$SLURM_NTASKS</span><br></pre></td></tr></table></figure><p>看完应该能够打造你自己的 OpenMP 并行应用了吧。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;using OpenMP in OpenFOAM&lt;/p&gt;
    
    </summary>
    
    
      <category term="code" scheme="https://openfoam.top/categories/code/"/>
    
    
      <category term="OpenMP" scheme="https://openfoam.top/tags/OpenMP/"/>
    
  </entry>
  
  <entry>
    <title>OpenFOAM中refineMesh的用法</title>
    <link href="https://openfoam.top/refineMesh/"/>
    <id>https://openfoam.top/refineMesh/</id>
    <published>2019-10-07T22:00:00.000Z</published>
    <updated>2020-04-10T22:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>本文移植自博主以前的新浪博客，<a href="http://blog.sina.com.cn/s/blog_a2a8de490102vbve.html" target="_blank" rel="external nofollow noopener noreferrer">原文</a>发表于 (2014-12-25 09:58:12)。</p><a id="more"></a><p>想要实现 refineMesh, system 文件夹下需要两个文件，topoSetDict 和 refineMeshDict。<br>如下：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;*--------------------------------*- C++ -*----------------------------------*\</span><br><span class="line">  &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;                 |</span><br><span class="line">  \\      &#x2F;  F ield         | OpenFOAM: The Open Source CFD Toolbox</span><br><span class="line">   \\    &#x2F;   O peration     | Website:  https:&#x2F;&#x2F;openfoam.org</span><br><span class="line">    \\  &#x2F;    A nd           | Version:  7</span><br><span class="line">     \\&#x2F;     M anipulation  |</span><br><span class="line">\*---------------------------------------------------------------------------*&#x2F;</span><br><span class="line">FoamFile</span><br><span class="line">&#123;</span><br><span class="line">    version     2.0;</span><br><span class="line">    format      ascii;</span><br><span class="line">    class       dictionary;</span><br><span class="line">    object      topoSetDict;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * &#x2F;&#x2F;</span><br><span class="line"></span><br><span class="line">actions</span><br><span class="line">(</span><br><span class="line">    &#123;</span><br><span class="line">        name    c0;</span><br><span class="line">        type    cellSet;</span><br><span class="line">        action  new;</span><br><span class="line">        source  boxToCell;</span><br><span class="line">        sourceInfo</span><br><span class="line">        &#123;</span><br><span class="line">            box (-1 -1 -1) (1 1 1); &#x2F;&#x2F; Edit box bounds as required</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ************************************************************************* &#x2F;&#x2F;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;*--------------------------------*- C++ -*----------------------------------*\</span><br><span class="line">  &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;                 |</span><br><span class="line">  \\      &#x2F;  F ield         | OpenFOAM: The Open Source CFD Toolbox</span><br><span class="line">   \\    &#x2F;   O peration     | Website:  https:&#x2F;&#x2F;openfoam.org</span><br><span class="line">    \\  &#x2F;    A nd           | Version:  7</span><br><span class="line">     \\&#x2F;     M anipulation  |</span><br><span class="line">\*---------------------------------------------------------------------------*&#x2F;</span><br><span class="line">FoamFile</span><br><span class="line">&#123;</span><br><span class="line">    version     2.0;</span><br><span class="line">    format      ascii;</span><br><span class="line">    class       dictionary;</span><br><span class="line">    object      refineMeshDict;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * &#x2F;&#x2F;</span><br><span class="line"></span><br><span class="line">set             c0;</span><br><span class="line"></span><br><span class="line">coordinateSystem global;</span><br><span class="line"></span><br><span class="line">globalCoeffs</span><br><span class="line">&#123;</span><br><span class="line">    tan1            (1 0 0);</span><br><span class="line">    tan2            (0 1 0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">directions &#x2F;&#x2F; comment out as required</span><br><span class="line">(</span><br><span class="line">    tan1</span><br><span class="line">    tan2</span><br><span class="line">    normal</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">useHexTopology  no;</span><br><span class="line"></span><br><span class="line">geometricCut    yes;</span><br><span class="line"></span><br><span class="line">writeMesh       no;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ************************************************************************* &#x2F;&#x2F;</span><br></pre></td></tr></table></figure><p>按如下指令操作：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">blockMesh</span><br><span class="line">topoSet</span><br><span class="line">refineMesh -dict .&#x2F;system&#x2F;refineMeshDict -overwrite</span><br><span class="line">checkMesh</span><br></pre></td></tr></table></figure><p>如果需要再次细化：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">topoSet</span><br><span class="line">refineMesh -dict .&#x2F;system&#x2F;refineMeshDict -overwrite</span><br><span class="line">checkMesh</span><br></pre></td></tr></table></figure><p>当年对 OF 了解不够，现在才发现 OF 早已提供了相关配置文件：<br><a href="https://github.com/OpenFOAM/OpenFOAM-dev/tree/master/etc/caseDicts/mesh/manipulation/refineRegion" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/OpenFOAM/OpenFOAM-dev/tree/master/etc/caseDicts/mesh/manipulation/refineRegion</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;本文移植自博主以前的新浪博客，&lt;a href=&quot;http://blog.sina.com.cn/s/blog_a2a8de490102vbve.html&quot; target=&quot;_blank&quot; rel=&quot;external nofollow noopener noreferrer&quot;&gt;原文&lt;/a&gt;发表于 (2014-12-25 09:58:12)。&lt;/p&gt;
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>OpenFOAM中圆柱体的二维画法</title>
    <link href="https://openfoam.top/axialMesh/"/>
    <id>https://openfoam.top/axialMesh/</id>
    <published>2019-10-07T22:00:00.000Z</published>
    <updated>2020-03-28T23:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>本文移植自博主以前的新浪博客，<a href="http://blog.sina.com.cn/s/blog_a2a8de490102vbvh.html" target="_blank" rel="external nofollow noopener noreferrer">原文</a>发表于 (2014-12-25 10:22:36)。</p><a id="more"></a><h1 id="简介"><a class="markdownIt-Anchor" href="#简介"></a> 简介</h1><p>使用的方法是 makeAxialMesh，最初来自于 <a href="http://openfoamwiki.net/index.php/Contrib_MakeAxialMesh" target="_blank" rel="external nofollow noopener noreferrer">openfoamwiki</a>。<br>我将其移植到了最新的 OpenFOAM-7：<a href="https://github.com/ZhangYanTJU/makeAxialMesh" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/ZhangYanTJU/makeAxialMesh</a> ，并且附有算例。</p><p>首先来张 UserGuide 上的插图<img src="https://cdn.cfd.direct/docs/user-guide-v6/img/user357x.png" alt="">。<br>在OpenFOAM（其他平台不知道）中，圆柱体的二维表现为一个夹角不超过5度的楔形。那么怎样把这个楔形画出来呢？</p><h1 id="操作步骤"><a class="markdownIt-Anchor" href="#操作步骤"></a> 操作步骤</h1><p>在 system 文件夹下，需要两个文件：rotationDict 和 collapseDict</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; ************************rotationDict************************************** &#x2F;&#x2F;</span><br><span class="line">&#x2F;&#x2F; Use the same parameters as from the command line</span><br><span class="line">&#x2F;&#x2F; makeAxialOldMode 1;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; used in old and in new mode</span><br><span class="line">makeAxialAxisPatch center;</span><br><span class="line">makeAxialWedgePatch frontAndBack;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; used only in old mode</span><br><span class="line">makeAxialOffset 0.01;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; used only in new mode</span><br><span class="line">rotationVector (0 1 0);</span><br><span class="line">originVector (0 0 0); &#x2F;&#x2F;offset</span><br><span class="line">&#x2F;&#x2F; originVector (0 0 0); &#x2F;&#x2F; origin</span><br><span class="line"></span><br><span class="line">wedgeAngle 5;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; revolve option</span><br><span class="line">&#x2F;&#x2F; 0 &#x3D; old and default mode, points are projected on wedges</span><br><span class="line">&#x2F;&#x2F; 1 &#x3D; points are revolved</span><br><span class="line">revolve 0;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ************************************************************************* &#x2F;&#x2F;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; * * * * * * * * * * * * *collapseDict* * * * * * * * * * * * * * * * * * &#x2F;&#x2F;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; If on, after collapsing check the quality of the mesh. If bad faces are</span><br><span class="line">&#x2F;&#x2F; generated then redo the collapsing with stricter filtering.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">collapseEdgesCoeffs</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F; Edges shorter than this absolute value will be merged</span><br><span class="line">    minimumEdgeLength   1e-6;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; The maximum angle between two edges that share a point attached to</span><br><span class="line">    &#x2F;&#x2F; no other edges</span><br><span class="line">    maximumMergeAngle   179;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ************************************************************************* &#x2F;&#x2F;</span><br></pre></td></tr></table></figure><p>在blockMeshDict文件中，网格照常定义。只是需要注意一下几点：</p><ul><li>把需要坍塌的那个面（此面合并成一条线，即圆柱体的轴线），定义为center ， type symmetryPlane（定义边界条件是也用此type）。</li><li>需要frontAndBack。</li><li>生成楔形网格后，frontAndBack会变成两个 frontAndBack_pos， frontAndBack_neg。定义边界条件时，用wedge类型。</li></ul><p><span id="Allrun"></span><br>然后，按如下指令操作：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">blockMesh</span><br><span class="line">makeAxialMesh -overwrite</span><br><span class="line">collapseEdges -overwrite</span><br><span class="line">checkMesh</span><br></pre></td></tr></table></figure><h1 id="注意事项"><a class="markdownIt-Anchor" href="#注意事项"></a> 注意事项</h1><ul><li><p>只有一个网格的那个维度，需要与 0 对称分布：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(0 0 -0.05)</span><br><span class="line">(1 0 -0.05)</span><br><span class="line">(1 1 -0.05)</span><br><span class="line">(0 1 -0.05)</span><br><span class="line">(0 0 0.05)</span><br><span class="line">(1 0 0.05)</span><br><span class="line">(1 1 0.05)</span><br><span class="line">(0 1 0.05)</span><br></pre></td></tr></table></figure></li><li><p>如果在执行 <code>collapseEdges -overwrite</code> 的时候遇到以下问题：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">--&gt; FOAM Warning :</span><br><span class="line">    From function void Foam::wedgePolyPatch::calcGeometry(Foam::PstreamBuffers &amp;)</span><br><span class="line">    in file meshes&#x2F;polyMesh&#x2F;polyPatches&#x2F;constraint&#x2F;wedge&#x2F;wedgePolyPatch.C at line 70</span><br><span class="line">    Wedge patch &#39;frontAndBack_neg&#39; is not planar.</span><br><span class="line">At local face at (0.0975 0.0925 -0.00250811) the normal (0 0.0435766 -0.99905) differs from the average normal (-4.23114e-19 0.043578 -0.99905) by 1.95256e-12</span><br><span class="line">Either correct the patch or split it into planar parts</span><br></pre></td></tr></table></figure><p>可以执行以下代码，然后 goto <a href="#Allrun">这里</a>重新操作一遍！</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">foamDictionary -entry writeFormat -set binary system&#x2F;controlDict</span><br></pre></td></tr></table></figure></li><li><p>如果使用 OF-2.1.x，需要使用： <code>collapseEdges -overwrite 1e-6 179</code></p></li></ul><h1 id="相关链接"><a class="markdownIt-Anchor" href="#相关链接"></a> 相关链接</h1><p><a href="https://www.cfd-online.com/Forums/openfoam-meshing/61473-converting-2dmesh-axisymmetric-11.html" target="_blank" rel="external nofollow noopener noreferrer">cfd-online</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;本文移植自博主以前的新浪博客，&lt;a href=&quot;http://blog.sina.com.cn/s/blog_a2a8de490102vbvh.html&quot; target=&quot;_blank&quot; rel=&quot;external nofollow noopener noreferrer&quot;&gt;原文&lt;/a&gt;发表于 (2014-12-25 10:22:36)。&lt;/p&gt;
    
    </summary>
    
    
      <category term="using" scheme="https://openfoam.top/categories/using/"/>
    
    
      <category term="wedge" scheme="https://openfoam.top/tags/wedge/"/>
    
  </entry>
  
  <entry>
    <title>OpenFOAM 中的喷雾子模型</title>
    <link href="https://openfoam.top/spraySubModels/"/>
    <id>https://openfoam.top/spraySubModels/</id>
    <published>2019-08-03T22:00:00.000Z</published>
    <updated>2019-08-03T22:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>从数学公式到 C++ 代码</p><a id="more"></a><p>本文下标 p 表示 parcel，g 表示 gas。</p><h1 id="dispersion"><a class="markdownIt-Anchor" href="#dispersion"></a> dispersion</h1><h2 id="传统-rans-框架下的公式"><a class="markdownIt-Anchor" href="#传统-rans-框架下的公式"></a> 传统 RANS 框架下的公式</h2><p>粒子速度方程：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">p</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="bold">u</mi><mi mathvariant="bold">p</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mi>d</mi><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><msub><mi mathvariant="bold">u</mi><mi mathvariant="bold">p</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><msub><mi>C</mi><mi>D</mi></msub><msub><mi>τ</mi><mi>p</mi></msub></mfrac><mfrac><mrow><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub></mrow><mn>24</mn></mfrac><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">u</mi><mi mathvariant="bold">g</mi></msub><mo>−</mo><msub><mi mathvariant="bold">u</mi><mi mathvariant="bold">p</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><msub><mi>C</mi><mi>D</mi></msub><msub><mi>τ</mi><mi>p</mi></msub></mfrac><mfrac><mrow><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub></mrow><mn>24</mn></mfrac><msub><mi mathvariant="bold">v</mi><mrow><mi mathvariant="bold">r</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">l</mi></mrow></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} \frac{d}{dt} \mathbf{x}_{\mathbf{p}} &amp;=\mathbf{u}_{\mathbf{p}} \\ \frac{d}{d t} \mathbf{u}_{\mathbf{p}} &amp;=\frac{C_{D}}{\tau_{p}} \frac{R e_{p}}{24}\left(\mathbf{u}_{\mathbf{g}}-\mathbf{u}_{\mathbf{p}}\right)=\frac{C_{D}}{\tau_{p}} \frac{R e_{p}}{24} \mathbf{v}_{\mathbf{r e l}} \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.0009879999999995em;vertical-align:-2.2504939999999993em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.750494em"><span style="top:-4.750494em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16110799999999997em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">p</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-2.3930540000000002em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16110799999999997em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">p</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.2504939999999993em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.750494em"><span style="top:-4.750494em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16110799999999997em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">p</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-2.3930540000000002em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span><span class="mord">4</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16110799999999997em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight" style="margin-right:.01597em">g</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16110799999999997em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">p</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">)</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span><span class="mord">4</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:.01597em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">r</span><span class="mord mathbf mtight">e</span><span class="mord mathbf mtight">l</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.2504939999999993em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>其中的未知量 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">C_D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">v</mi><mrow><mi mathvariant="bold">r</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbf{v}_{\mathbf{r e l}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.59444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:.01597em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">r</span><span class="mord mathbf mtight">e</span><span class="mord mathbf mtight">l</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>τ</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\tau_{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 计算如下：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>C</mi><mi>D</mi></msub><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>24</mn><mrow><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub></mrow></mfrac></mstyle><mrow><mo fence="true">(</mo><mn>1</mn><mo>+</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn><mn>6</mn></mfrac></mstyle><mi>R</mi><msubsup><mi>e</mi><mi>p</mi><mrow><mn>2</mn><mi mathvariant="normal">/</mi><mn>3</mn></mrow></msubsup><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub><mo>&lt;</mo><mn>1000</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>C</mi><mi>D</mi></msub><mo>=</mo><mn>0.424</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub><mo>⩾</mo><mn>1000</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{ll} C_D=\dfrac{24}{Re_p}\left(1+\dfrac{1}{6} Re_p^{2/3}\right) &amp; R e_{p}&lt;1000 \\ C_D=0.424 &amp; Re_p \geqslant 1000 \end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.6221079999999994em;vertical-align:-1.561054em"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0610539999999995em"><span style="top:-4.061054em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">6</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.5834080000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style="top:-3.2198em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">/</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2526999999999999em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:-2.248946em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span><span class="mord">2</span><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.561054em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0610539999999995em"><span style="top:-4.061054em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span><span style="top:-2.248946em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel amsrm">⩾</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.561054em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub><mo>=</mo><msub><mi>ρ</mi><mi>g</mi></msub><mrow><mo fence="true">∣</mo><msub><mi mathvariant="bold">v</mi><mrow><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow></msub><mo fence="true">∣</mo></mrow><msub><mi>d</mi><mi>p</mi></msub><mi mathvariant="normal">/</mi><msub><mi>μ</mi><mi>g</mi></msub></mrow><annotation encoding="application/x-tex">R e_{p}=\rho_{g}\left|\mathbf{v}_{\mathrm{rel}}\right| d_{p} / \mu_{g}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:.01597em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">r</span><span class="mord mathrm mtight">e</span><span class="mord mathrm mtight">l</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">∣</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">v</mi><mrow><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow></msub><mo>=</mo><mover accent="true"><mi mathvariant="bold">u</mi><mo>~</mo></mover><mo>+</mo><msup><mi mathvariant="bold">u</mi><mo mathvariant="normal">′</mo></msup><mo>−</mo><msub><mi mathvariant="bold">u</mi><mi mathvariant="normal">p</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{v}_{\mathrm{rel}}=\tilde{\mathbf{u}}+\mathbf{u}^{\prime}-\mathbf{u}_{\mathrm{p}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.59444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:.01597em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">r</span><span class="mord mathrm mtight">e</span><span class="mord mathrm mtight">l</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7646299999999999em;vertical-align:-.08333em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6812999999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span></span></span><span style="top:-3.36344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8852220000000001em;vertical-align:-.08333em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.730548em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">p</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>τ</mi><mi>p</mi></msub><mo>=</mo><msub><mi>ρ</mi><mi>l</mi></msub><msubsup><mi>d</mi><mi>p</mi><mn>2</mn></msubsup><mi mathvariant="normal">/</mi><mn>18</mn><msub><mi>ρ</mi><mi>g</mi></msub><msub><mi>v</mi><mi>g</mi></msub></mrow><annotation encoding="application/x-tex">\tau_{p}=\rho_{l} d_{p}^{2} / 18 \rho_{g} v_{g}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.2472159999999999em;vertical-align:-.383108em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.01968em">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.864108em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord">1</span><span class="mord">8</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi mathvariant="bold">u</mi><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{\mathbf{u}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6812999999999999em;vertical-align:0"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6812999999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span></span></span><span style="top:-3.36344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span></span></span></span> 是气相速度，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="bold">u</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">\mathbf{u}^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.751892em;vertical-align:0"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> is stochastic velocity vector accounting for turbulence dispersion of parcels via interaction with surrounding gases.<br><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="bold">u</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">\mathbf{u}^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.751892em;vertical-align:0"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 是高斯分布，均值等于 0，方差等于 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo>=</mo><mn>2</mn><mi>k</mi><mi mathvariant="normal">/</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">\sigma^2=2 k / 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mord">/</span><span class="mord">3</span></span></span></span>。</p><blockquote><p>若随机变量X服从一个数学期望为 μ、方差为 σ^2 的正态分布，记为 N(μ，σ^2)。<img src="https://gss3.bdstatic.com/7Po3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D205/sign=2abf505a42166d223c77129473220945/342ac65c1038534384b650b09213b07eca808822.jpg" alt=""></p></blockquote><p>In this way each component of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="bold">u</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">\mathbf{u}^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.751892em;vertical-align:0"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> is chosen randomly from the Gaussian distribution</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mrow><mo fence="true">(</mo><msubsup><mi mathvariant="bold">u</mi><mrow><mi mathvariant="bold">p</mi><mo separator="true">,</mo><mi mathvariant="bold">i</mi></mrow><mo mathvariant="normal">′</mo></msubsup><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mi>σ</mi><msqrt><mrow><mn>2</mn><mi>π</mi></mrow></msqrt></mrow></mfrac><mi>exp</mi><mo>⁡</mo><msup><mrow><mo fence="true">(</mo><mo>−</mo><mfrac><msubsup><mi mathvariant="bold">u</mi><mrow><mi mathvariant="bold">p</mi><mo separator="true">,</mo><mi mathvariant="bold">i</mi></mrow><mo mathvariant="normal">′</mo></msubsup><mrow><mn>2</mn><mi>σ</mi></mrow></mfrac><mo fence="true">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">G\left(\mathbf{u}_{\mathbf{p}, \mathbf{i}}^{\prime}\right)=\frac{1}{\sigma \sqrt{2 \pi}} \exp \left(-\frac{\mathbf{u}_{\mathbf{p}, \mathbf{i}}^{\prime}}{2 \sigma}\right)^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.233108em;vertical-align:-.383108em"></span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-2.4530000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">p</span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathbf mtight">i</span></span></span></span></span><span style="top:-3.1130000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.715146em;vertical-align:-.95003em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.2027799999999997em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.90722em"><span class="svg-align" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord" style="padding-left:.833em"><span class="mord">2</span><span class="mord mathdefault" style="margin-right:.03588em">π</span></span></span><span style="top:-2.86722em"><span class="pstrut" style="height:3em"></span><span class="hide-tail" style="min-width:.853em;height:1.08em"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z M834 80H400000v40H845z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.13278em"><span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.93em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop">exp</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.561108em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.809216em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-2.4168920000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">p</span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathbf mtight">i</span></span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4192159999999999em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.765116em"><span style="top:-4.0140080000000005em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>t</mi><mrow><mi>t</mi><mi>u</mi><mi>r</mi><mi>b</mi></mrow></msub><mo>=</mo><mi>min</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mfrac><mi>k</mi><mi>ε</mi></mfrac><mo separator="true">,</mo><msub><mi>C</mi><mrow><mi>p</mi><mi>s</mi></mrow></msub><mfrac><msup><mi>k</mi><mrow><mn>3</mn><mi mathvariant="normal">/</mi><mn>2</mn></mrow></msup><mi>ε</mi></mfrac><mfrac><mn>1</mn><mrow><mo fence="true">∣</mo><mover accent="true"><mi mathvariant="bold">u</mi><mo>~</mo></mover><mo>+</mo><msup><mi mathvariant="bold">u</mi><mo mathvariant="normal">′</mo></msup><mo>−</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo fence="true">∣</mo></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">t_{t u r b}=\min \left(\frac{k}{\varepsilon}, C_{p s} \frac{k^{3 / 2}}{\varepsilon} \frac{1}{\left|\tilde{\mathbf{u}}+\mathbf{u}^{\prime}-\mathbf{u}_{p}\right|}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.76508em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight" style="margin-right:.02778em">r</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.537108em;vertical-align:-.972108em"></span><span class="mop">min</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ε</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.565em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ε</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8879999999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6812999999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span></span></span><span style="top:-3.36344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6778919999999999em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">∣</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>p</mi><mi>s</mi></mrow></msub><mo>=</mo><mn>0.16432</mn></mrow><annotation encoding="application/x-tex">C_{ps}=0.16432</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">6</span><span class="mord">4</span><span class="mord">3</span><span class="mord">2</span></span></span></span></p><p>OF 中的 stochstic turbulence dispersion 模型代码</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:<span class="built_in">vector</span> Foam::StochasticDispersionRAS&lt;CloudType&gt;::update</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar dt,</span><br><span class="line">    <span class="keyword">const</span> label celli,</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">vector</span>&amp; U,</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">vector</span>&amp; Uc,</span><br><span class="line">    <span class="built_in">vector</span>&amp; UTurb,</span><br><span class="line">    scalar&amp; tTurb</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    Random&amp; rnd = <span class="keyword">this</span>-&gt;owner().rndGen();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar cps = <span class="number">0.16432</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar k = <span class="keyword">this</span>-&gt;kPtr_-&gt;primitiveField()[celli];</span><br><span class="line">    <span class="keyword">const</span> scalar epsilon =</span><br><span class="line">        <span class="keyword">this</span>-&gt;epsilonPtr_-&gt;primitiveField()[celli] + rootVSmall;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar UrelMag = mag(U - Uc - UTurb);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar tTurbLoc =</span><br><span class="line">        <span class="built_in">min</span>(k/epsilon, cps*<span class="built_in">pow</span>(k, <span class="number">1.5</span>)/epsilon/(UrelMag + small));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Parcel is perturbed by the turbulence</span></span><br><span class="line">    <span class="keyword">if</span> (dt &lt; tTurbLoc)</span><br><span class="line">    &#123;</span><br><span class="line">        tTurb += dt;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (tTurb &gt; tTurbLoc)</span><br><span class="line">        &#123;</span><br><span class="line">            tTurb = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> scalar sigma = <span class="built_in">sqrt</span>(<span class="number">2</span>*k/<span class="number">3.0</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Calculate a random direction dir distributed uniformly</span></span><br><span class="line">            <span class="comment">// in spherical coordinates</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> scalar theta = rnd.scalar01()*twoPi;</span><br><span class="line">            <span class="keyword">const</span> scalar u = <span class="number">2</span>*rnd.scalar01() - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> scalar a = <span class="built_in">sqrt</span>(<span class="number">1</span> - sqr(u));</span><br><span class="line">            <span class="function"><span class="keyword">const</span> <span class="built_in">vector</span> <span class="title">dir</span><span class="params">(a*<span class="built_in">cos</span>(theta), a*<span class="built_in">sin</span>(theta), u)</span></span>;</span><br><span class="line"></span><br><span class="line">            UTurb = sigma*mag(rnd.scalarNormal())*dir;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        tTurb = great;</span><br><span class="line">        UTurb = Zero;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Uc + UTurb;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个函数在哪里被调用？答：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ParcelType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">template</span>&lt;class TrackCloudType&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:KinematicParcel&lt;ParcelType&gt;::calcDispersion</span><br><span class="line">(</span><br><span class="line">    TrackCloudType&amp; cloud,</span><br><span class="line">    trackingData&amp; td,</span><br><span class="line">    <span class="keyword">const</span> scalar dt</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    td.Uc() = cloud.dispersion().update</span><br><span class="line">    (</span><br><span class="line">        dt,</span><br><span class="line">        <span class="keyword">this</span>-&gt;cell(),</span><br><span class="line">        U_,</span><br><span class="line">        td.Uc(),</span><br><span class="line">        UTurb_,</span><br><span class="line">        tTurb_</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个 <code>calcDispersion</code> 函数，把 <code>dispersion</code> 模型中计算出来的 <code>Uc + UTurb</code>，即 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi mathvariant="bold">u</mi><mo>~</mo></mover><mo>+</mo><msup><mi mathvariant="bold">u</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">\tilde{\mathbf{u}}+\mathbf{u}^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7646299999999999em;vertical-align:-.08333em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6812999999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span></span></span><span style="top:-3.36344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.751892em;vertical-align:0"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 赋值给了 <code>td.Uc()</code>，即当前 <code>parcel</code> 所在网格的气相速度，但是并没有真正的修改气相速度。<br>这里修改了传进去 <code>UTurb_</code>，但是在其它代码中并没有用到。<br>此函数最关键的用处就是更新了 <code>td.Uc()</code>，用于后续的 <code>KinematicParcel::calcVelocity</code>，见<a href="../sprayVelocity">这篇本站博文</a>。</p><p><code>KinematicParcel::move</code> 中调用了 <code>p.calcDispersion(cloud, ttd, dt);</code>。</p><p>另外还有 <code>SprayParcel::calcBreakup</code>， breakup 之后，<code>child-&gt;calcDispersion(cloud, td, dt);</code>。</p><p>其中的 <code>UTurb</code> 就是上边公式中的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="bold">u</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">\mathbf{u}^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.751892em;vertical-align:0"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，<code>Uc</code> 是公式中的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi mathvariant="bold">u</mi><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{\mathbf{u}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6812999999999999em;vertical-align:0"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6812999999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span></span></span><span style="top:-3.36344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span></span></span></span>，<code>U</code> 是公式中的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>u</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">u_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>。</p><hr><h2 id="针对-les-的-dispersion-模型"><a class="markdownIt-Anchor" href="#针对-les-的-dispersion-模型"></a> 针对 LES 的 dispersion 模型</h2><blockquote><p>Tsang C-W, Kuo C-W, Trujillo M, et al. Evaluation and validation of large-eddy simulation sub-grid spray dispersion models using high-fidelity volume-of-fluid simulation data and engine combustion network experimental data[J]. International Journal of Engine Research, 2019, 20(6):583–605.</p></blockquote><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>t</mi><mrow><mi>t</mi><mi>u</mi><mi>r</mi><mi>b</mi></mrow></msub><mo>=</mo><msub><mi>C</mi><mrow><mi>t</mi><mi>u</mi><mi>r</mi><mi>b</mi></mrow></msub><mfrac><mrow><mn>2</mn><mi mathvariant="normal">Δ</mi></mrow><mrow><mo fence="true">∣</mo><msub><mi mathvariant="bold">u</mi><mrow><mi>S</mi><mi>g</mi><mi>S</mi></mrow></msub><mo>−</mo><msub><mi mathvariant="bold">u</mi><mi>d</mi></msub><mo fence="true">∣</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">t_{turb}=C_{turb} \frac{2 \Delta}{\left|\mathbf{u}_{S g S}-\mathbf{u}_{d}\right|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.76508em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight" style="margin-right:.02778em">r</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-.972108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight" style="margin-right:.02778em">r</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.328331em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05764em">S</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span><span class="mord mathdefault mtight" style="margin-right:.05764em">S</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">∣</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span><span class="mord">Δ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="bold">u</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><msub><mi mathvariant="bold">u</mi><mrow><mi>s</mi><mi>g</mi><mi>s</mi></mrow></msub><mo>+</mo><msub><mi mathvariant="bold">u</mi><mrow><mi>s</mi><mi>t</mi><mi>o</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbf{u}^{\prime}=\mathbf{u}_{sgs}+\mathbf{u}_{s t o}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.801892em;vertical-align:0"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8694379999999999em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.59444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">o</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">u</mi><mrow><mi>s</mi><mi>g</mi><mi>s</mi></mrow></msub><mo>=</mo><msub><mi>C</mi><mrow><mi>s</mi><mi>g</mi><mi>s</mi></mrow></msub><mo stretchy="false">(</mo><mn>2</mn><mover accent="true"><mi mathvariant="bold">u</mi><mo>~</mo></mover><mo>−</mo><mn>3</mn><mover accent="true"><mover accent="true"><mi mathvariant="bold">u</mi><mo>~</mo></mover><mo stretchy="true">~</mo></mover><mo>+</mo><mover accent="true"><mover accent="true"><mi mathvariant="bold">u</mi><mo>~</mo></mover><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{u}_{s g s}=C_{s g s}(2 \tilde{\mathbf{u}}-3 \widetilde{\tilde{\mathbf{u}}}+\widetilde{\tilde{\mathbf{u}}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.730548em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">2</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6812999999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span></span></span><span style="top:-3.36344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.02463em;vertical-align:-.08333em"></span><span class="mord">3</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9412999999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6812999999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span></span></span><span style="top:-3.36344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6813em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1913em;vertical-align:-.25em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9412999999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6812999999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span></span></span><span style="top:-3.36344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6813em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">u</mi><mrow><mi>s</mi><mi>t</mi><mi>o</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbf{u}_{sto}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.59444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">o</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 是高斯分布，均值是0，方差是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>σ</mi><mrow><mi>s</mi><mi>g</mi><mi>s</mi></mrow><mn>2</mn></msubsup><mo>=</mo><msub><mi>C</mi><mrow><mi>s</mi><mi>i</mi><mi>g</mi></mrow></msub><mfrac><mn>2</mn><mn>3</mn></mfrac><msub><mi>k</mi><mrow><mi>s</mi><mi>g</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\sigma_{s g s}^{2}=C_{sig} \frac{2}{3} k_{s g s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.197216em;vertical-align:-.383108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.4530000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span><span class="mord mathdefault mtight">s</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-.345em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>s</mi><mi>i</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{sig}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 是模型参数。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">u</mi><mrow><mi>s</mi><mi>t</mi><mi>o</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><msqrt><mrow><mn>2</mn><msubsup><mi>σ</mi><mrow><mi>s</mi><mi>g</mi><mi>s</mi></mrow><mn>2</mn></msubsup><mi>π</mi></mrow></msqrt></mfrac><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mo>−</mo><mfrac><msubsup><mi mathvariant="bold">u</mi><mrow><mi>s</mi><mi>t</mi><mi>o</mi><mo separator="true">,</mo><mi>i</mi></mrow><mn>2</mn></msubsup><mrow><mn>2</mn><msubsup><mi>σ</mi><mrow><mi>s</mi><mi>g</mi><mi>s</mi></mrow><mn>2</mn></msubsup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">G\left(\mathbf{u}_{sto, i}\right)=\frac{1}{\sqrt{2 \sigma_{s g s}^{2} \pi}} \exp \left(-\frac{\mathbf{u}_{sto, i}^{2}}{2 \sigma_{s g s}^{2}}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">o</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">)</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.48em;vertical-align:-1.73em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.11em"><span class="pstrut" style="height:3.1635em"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1635000000000002em"><span class="svg-align" style="top:-3.8em"><span class="pstrut" style="height:3.8em"></span><span class="mord" style="padding-left:1em"><span class="mord">2</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7401079999999999em"><span style="top:-2.4530000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span><span class="mord mathdefault mtight">s</span></span></span></span><span style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.03588em">π</span></span></span><span style="top:-3.1235em"><span class="pstrut" style="height:3.8em"></span><span class="hide-tail" style="min-width:1.02em;height:1.8800000000000001em"><svg width="400em" height="1.8800000000000001em" viewbox="0 0 400000 1944" preserveaspectratio="xMinYMin slice"><path d="M1001,80H400000v40H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5c53.7,-170.3,84.5,-266.8,92.5,-289.5c4,-6.7,10,-10,18,-10zM1001 80H400000v40H1013z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.6764999999999999em"><span></span></span></span></span></span></span></span><span style="top:-3.3935em"><span class="pstrut" style="height:3.1635em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.8405em"><span class="pstrut" style="height:3.1635em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.73em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop">exp</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size4">(</span></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5988799999999999em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7401079999999999em"><span style="top:-2.4530000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span><span class="mord mathdefault mtight">s</span></span></span></span><span style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.7847720000000002em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.441336em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">o</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.394772em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.069108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size4">)</span></span></span></span></span></span></span></p><hr><h1 id="drag"><a class="markdownIt-Anchor" href="#drag"></a> drag</h1><p>CdRe：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:scalar Foam::SphereDragForce&lt;CloudType&gt;::CdRe(<span class="keyword">const</span> scalar Re)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (Re &gt; <span class="number">1000.0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0.424</span>*Re;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">24.0</span>*(<span class="number">1.0</span> + <span class="number">1.0</span>/<span class="number">6.0</span>*<span class="built_in">pow</span>(Re, <span class="number">2.0</span>/<span class="number">3.0</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>calcCoupled：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:forceSuSp Foam::SphereDragForce&lt;CloudType&gt;::calcCoupled</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">typename</span> CloudType::parcelType&amp; p,</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">typename</span> CloudType::parcelType::trackingData&amp; td,</span><br><span class="line">    <span class="keyword">const</span> scalar dt,</span><br><span class="line">    <span class="keyword">const</span> scalar mass,</span><br><span class="line">    <span class="keyword">const</span> scalar Re,</span><br><span class="line">    <span class="keyword">const</span> scalar muc</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> forceSuSp(Zero, mass*<span class="number">0.75</span>*muc*CdRe(Re)/(p.rho()*sqr(p.d())));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SphereDragForce::calcCoupled</code> 的返回值翻译成公式就是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mn>3</mn><msub><mi>m</mi><mi>p</mi></msub><msub><mi>μ</mi><mi>g</mi></msub><msub><mi>C</mi><mi>D</mi></msub><mi>R</mi><mi>e</mi></mrow><mrow><mn>4</mn><msub><mi>ρ</mi><mi>p</mi></msub><msup><mi>D</mi><mn>2</mn></msup></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\dfrac{3m_p\mu_g C_DRe}{4\rho_p D^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.740108em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord mathdefault">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>。<br>我们有：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mi>p</mi></msub><mo>=</mo><msub><mi>m</mi><mi>p</mi></msub><mfrac><mrow><mi>d</mi><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>3</mn><msub><mi>m</mi><mi>p</mi></msub><msub><mi>μ</mi><mi>g</mi></msub><msub><mi>C</mi><mi>D</mi></msub><mi>R</mi><mi>e</mi></mrow><mrow><mn>4</mn><msub><mi>ρ</mi><mi>p</mi></msub><msup><mi>D</mi><mn>2</mn></msup></mrow></mfrac><mo stretchy="false">(</mo><mi mathvariant="bold">u</mi><mo>−</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_p = m_p \dfrac{d \mathbf{u}_p}{d t} =\dfrac{3m_p\mu_gC_DRe}{4\rho_p D^2}(\mathbf{u}-\mathbf{u}_{p})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.740108em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord mathdefault">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">u</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><code>SphereDragForce::calcCoupled</code> 返回值即 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi mathvariant="bold">u</mi><mo>−</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\mathbf{u}-\mathbf{u}_{p})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">u</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 前边的部分。<br>该返回值用于 <code>KinematicParcel::calcVelocity</code> 计算新的粒子速度，详细过程见<a href="../sprayVelocity">这篇本站博文</a>。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;从数学公式到 C++ 代码&lt;/p&gt;
    
    </summary>
    
    
      <category term="code" scheme="https://openfoam.top/categories/code/"/>
    
    
      <category term="Lagrangian" scheme="https://openfoam.top/tags/Lagrangian/"/>
    
  </entry>
  
  <entry>
    <title>使用 Python 科学绘图</title>
    <link href="https://openfoam.top/matplotlib/"/>
    <id>https://openfoam.top/matplotlib/</id>
    <published>2019-08-02T22:00:00.000Z</published>
    <updated>2020-06-04T22:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>使用 matplotlib 绘图</p><a id="more"></a><h1 id="读取数据"><a class="markdownIt-Anchor" href="#读取数据"></a> 读取数据</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = pd.read_csv(<span class="string">"fileName"</span>, sep=<span class="string">'\t'</span>, skiprows=<span class="number">2</span>, names=[<span class="string">'x'</span>,<span class="string">'y'</span>,<span class="string">'z'</span>,<span class="string">'T'</span>])</span><br></pre></td></tr></table></figure><p>默认逗号为分隔符，也可以设为 <code>\t</code>等。<br>默认自动将第一行作为 index，可以这样调用：<code>data['x']</code>。<br>也可以手动设置 index：<code>names=['x','y','z','T']</code>。<br>通过 skiprows 设置需要忽略的行：</p><ul><li>数字指定：<code>skiprows = 2</code> 表示忽略前 2 行。</li><li>列表指定：<code>skiprows = [0]</code> 表示忽略第 0 行。</li><li>列表指定：<code>skiprows = range(1, 10))</code> 表示忽略第 1 到 9 行，保留第 0 行，和第 10 行及以后的行。</li></ul><h1 id="图型"><a class="markdownIt-Anchor" href="#图型"></a> 图型</h1><h2 id="点线图-plot"><a class="markdownIt-Anchor" href="#点线图-plot"></a> 点线图 plot</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plot(Z, Y, color=<span class="string">'green'</span>, linestyle=<span class="string">'dashed'</span>, linewidth=<span class="number">2</span>, marker=<span class="string">'o'</span>, markersize=<span class="number">12</span>)</span><br></pre></td></tr></table></figure><p>官方链接：<br><a href="https://matplotlib.org/gallery/color/named_colors.html#sphx-glr-gallery-color-named-colors-py" target="_blank" rel="external nofollow noopener noreferrer">colors</a><br><a href="https://matplotlib.org/api/markers_api.html?highlight=marker#module-matplotlib.markers" target="_blank" rel="external nofollow noopener noreferrer">markers</a><br><a href="https://matplotlib.org/gallery/lines_bars_and_markers/linestyles.html?highlight=linestyle" target="_blank" rel="external nofollow noopener noreferrer">Linestyles</a><br><a href="https://matplotlib.org/gallery/color/colormap_reference.html#sphx-glr-gallery-color-colormap-reference-py" target="_blank" rel="external nofollow noopener noreferrer">colormaps</a></p><p>Base Colors<br><img src="https://matplotlib.org/_images/sphx_glr_named_colors_001.png" alt=""></p><p>常见 linestyle<br><img src="https://matplotlib.org/_images/sphx_glr_linestyles_001.png" alt=""></p><p>unfilled markers<br><img src="https://matplotlib.org/_images/sphx_glr_marker_reference_001.png" alt="unfilled-markers"><br>filled markers<br><img src="https://matplotlib.org/_images/sphx_glr_marker_reference_002.png" alt=""><br>空心 markers</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">plt.plot(X, Y, &#39;o&#39;, markerfacecolor&#x3D;&#39;none&#39;)</span><br></pre></td></tr></table></figure><p>可以将 <code>plot</code> 中的线宽设为 0，这样只剩下 symbol：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plot(X, Y, marker=<span class="string">'.'</span>, linewidth=<span class="number">0</span>)</span><br></pre></td></tr></table></figure><h3 id="竖直线和水平线"><a class="markdownIt-Anchor" href="#竖直线和水平线"></a> 竖直线和水平线</h3><p><a href="https://matplotlib.org/3.1.0/api/_as_gen/matplotlib.axes.Axes.axhline.html" target="_blank" rel="external nofollow noopener noreferrer">水平线</a></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ax.axhline(y=<span class="number">0</span>, xmin=<span class="number">0</span>, xmax=<span class="number">1</span>, color=<span class="string">'black'</span>, linewidth=<span class="number">2</span>)</span><br><span class="line">ax.axhline(<span class="number">0</span>, color=<span class="string">'black'</span>, linewidth=<span class="number">2</span>) <span class="comment"># y=0</span></span><br></pre></td></tr></table></figure><p><a href="https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.axes.Axes.axvline.html" target="_blank" rel="external nofollow noopener noreferrer">竖直线</a></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ax.axvline(x=<span class="number">0</span>, ymin=<span class="number">0</span>, ymax=<span class="number">1</span>, color=<span class="string">"r"</span>)</span><br><span class="line">ax.axvline(<span class="number">0</span>, color=<span class="string">"r"</span>) <span class="comment"># x=0</span></span><br></pre></td></tr></table></figure><h2 id="散点图-scatter"><a class="markdownIt-Anchor" href="#散点图-scatter"></a> 散点图 scatter</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.scatter(X, Y, c=Z, s=<span class="number">1</span>, marker=<span class="string">'s'</span>, cmap=plt.cm.hot)</span><br></pre></td></tr></table></figure><p>散点用 X Y 表示，用 Z 着色，色带是 plt.cm.hot，size是 1。<br><a href="https://blog.csdn.net/u013634684/article/details/49646311" target="_blank" rel="external nofollow noopener noreferrer">更多设置参考网址</a></p><p>如果要对散点着色的话，建议先将所有点按照 Z 排序：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">idx &#x3D; Z.argsort()</span><br><span class="line">X, Y, Z &#x3D; X[idx], Y[idx], Z[idx]</span><br></pre></td></tr></table></figure><h3 id="绘制界限分明的-colorbar"><a class="markdownIt-Anchor" href="#绘制界限分明的-colorbar"></a> 绘制界限分明的 colorbar</h3><p><a href="https://matplotlib.org/3.2.0/api/_as_gen/matplotlib.colors.TwoSlopeNorm.html?highlight=twoslopenorm#matplotlib.colors.TwoSlopeNorm" target="_blank" rel="external nofollow noopener noreferrer">官方链接</a></p><p>记得选用 diverging 色条，比如官方的 <a href="https://matplotlib.org/examples/color/colormaps_reference.html" target="_blank" rel="external nofollow noopener noreferrer">seismic</a>。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">divnorm &#x3D; colors.TwoSlopeNorm(vcenter&#x3D;0)</span><br><span class="line">plt.scatter(X, Y, c&#x3D;Z, norm&#x3D;divnorm,cmap&#x3D;matplotlib.cm.seismic)</span><br></pre></td></tr></table></figure><h2 id="云图-contourf"><a class="markdownIt-Anchor" href="#云图-contourf"></a> 云图 contourf</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = pd.read_csv(<span class="string">"fileName"</span>, sep=<span class="string">'\t'</span>)</span><br><span class="line">X = data[<span class="string">'X'</span>]</span><br><span class="line">Y = data[<span class="string">'Y'</span>]</span><br><span class="line">Z = data[<span class="string">'Z'</span>]</span><br><span class="line"></span><br><span class="line">xi=np.linspace(min(X),max(X),<span class="number">1000</span>)</span><br><span class="line">yi=np.linspace(min(Y),max(Y),<span class="number">1000</span>)</span><br><span class="line">[XX,YY]=np.meshgrid(xi,yi)</span><br><span class="line">ZZ=griddata((X,Y), Z, (XX,YY), method=<span class="string">'cubic'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plt.contourf(XX, YY, ZZ, <span class="number">20</span>, cmap=plt.cm.hot) <span class="comment"># 20 表示 20 个 levels</span></span><br><span class="line">cbar = plt.colorbar()</span><br></pre></td></tr></table></figure><p>还有一种更简便的方法：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.tricontourf(X, Y, Z, <span class="number">20</span>, cmap=plt.cm.hot, extend=<span class="string">'both'</span>)</span><br></pre></td></tr></table></figure><p>越界时指定颜色，其中，<code>extend : {'neither', 'both', 'min', 'max'}</code></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">levels=np.arange(<span class="number">-10</span>,<span class="number">4200000</span>,<span class="number">1000</span>)</span><br><span class="line">cp=plt.contourf(XX, YY, ZZ, levels=levels, cmap=plt.cm.hot, extend=<span class="string">'both'</span>)</span><br><span class="line">cp.cmap.set_under(<span class="string">'yellow'</span>)</span><br><span class="line">cp.cmap.set_over(<span class="string">'cyan'</span>) <span class="comment">#注意顺序，此行须在 plt.colorbar 之前</span></span><br><span class="line">cbar = plt.colorbar(cp)</span><br><span class="line">cbar.ax.set_title(<span class="string">'T'</span>)</span><br></pre></td></tr></table></figure><p>小于某个数时颜色全部为空白：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">levels=np.arange(<span class="number">0.0015</span>,<span class="number">0.7515</span>,<span class="number">0.0015</span>)</span><br><span class="line">plt.contourf(XX, YY, ZZ,levels=levels)<span class="comment">#这里不能使用extend，如果使用的话，那么小于下限时，颜色直接是 min 的颜色。</span></span><br></pre></td></tr></table></figure><p>设置图中的数值上下限：</p><p>设置colorbar中的上下限：</p><h2 id="等值线"><a class="markdownIt-Anchor" href="#等值线"></a> 等值线</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.contourf(XX, YY, ZZ, <span class="number">20</span>, cmap=plt.cm.hot) <span class="comment">#这是云图，20 表示分为 20 道等值线</span></span><br><span class="line">plt.contour(XX, YY, ZZ, <span class="number">1</span>, levels=[<span class="number">1000</span>], linewidths=<span class="number">2</span>, colors=<span class="string">'y'</span>) <span class="comment">#这是等值线，1表示一条等值线，levels里边是这个值</span></span><br></pre></td></tr></table></figure><h1 id="配件"><a class="markdownIt-Anchor" href="#配件"></a> 配件</h1><h2 id="图片颜色"><a class="markdownIt-Anchor" href="#图片颜色"></a> 图片颜色</h2><h3 id="自带"><a class="markdownIt-Anchor" href="#自带"></a> <a href="https://matplotlib.org/examples/color/colormaps_reference.html" target="_blank" rel="external nofollow noopener noreferrer">自带</a> 调色</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">colorMap = plt.cm.get_cmap(<span class="string">'winter'</span>)</span><br><span class="line">colorMap=plt.get_cmap(<span class="string">"YlOrRd"</span>)</span><br><span class="line">colorMap=pyplot.cm.jet</span><br></pre></td></tr></table></figure><h3 id="palettable"><a class="markdownIt-Anchor" href="#palettable"></a> <a href="https://jiffyclub.github.io/palettable" target="_blank" rel="external nofollow noopener noreferrer">palettable</a> 调色</h3><p>源码：<a href="https://github.com/jiffyclub/palettable" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/jiffyclub/palettable</a></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> palettable.mycarta <span class="keyword">import</span> Cube1_20</span><br><span class="line"><span class="keyword">from</span> palettable.colorbrewer.sequential <span class="keyword">import</span> Greys_9</span><br><span class="line">colorMap=Cube1_20.mpl_colormap</span><br><span class="line">colorMap=Greys_9.mpl_colormap</span><br></pre></td></tr></table></figure><h3 id="colorcet"><a class="markdownIt-Anchor" href="#colorcet"></a> <a href="http://colorcet.pyviz.org" target="_blank" rel="external nofollow noopener noreferrer">colorcet</a> 调色</h3><p>源码：<a href="https://github.com/pyviz/colorcet" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/pyviz/colorcet</a></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> colorcet <span class="keyword">as</span> cc</span><br><span class="line">colorMap=cc.cm[<span class="string">"blues"</span>]</span><br><span class="line">colorMap=cc.cm[<span class="string">"fire"</span>]</span><br></pre></td></tr></table></figure><h3 id="cmasher"><a class="markdownIt-Anchor" href="#cmasher"></a> <a href="https://github.com/1313e/CMasher" target="_blank" rel="external nofollow noopener noreferrer">CMasher</a> 调色</h3><h3 id="反转颜色"><a class="markdownIt-Anchor" href="#反转颜色"></a> 反转颜色</h3><p>自带的反转就是在后边加一个 <code>_r</code>，比如：<code>colorMap=plt.cm.hot_r</code>。</p><p>反转非自带的颜色：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reverse_colourmap</span><span class="params">(cmap, name = <span class="string">'my_cmap_r'</span>)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    In:</span></span><br><span class="line"><span class="string">    cmap, name</span></span><br><span class="line"><span class="string">    Out:</span></span><br><span class="line"><span class="string">    my_cmap_r</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Explanation:</span></span><br><span class="line"><span class="string">    t[0] goes from 0 to 1</span></span><br><span class="line"><span class="string">    row i:   x  y0  y1 -&gt; t[0] t[1] t[2]</span></span><br><span class="line"><span class="string">                   /</span></span><br><span class="line"><span class="string">                  /</span></span><br><span class="line"><span class="string">    row i+1: x  y0  y1 -&gt; t[n] t[1] t[2]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    so the inverse should do the same:</span></span><br><span class="line"><span class="string">    row i+1: x  y1  y0 -&gt; 1-t[0] t[2] t[1]</span></span><br><span class="line"><span class="string">                   /</span></span><br><span class="line"><span class="string">                  /</span></span><br><span class="line"><span class="string">    row i:   x  y1  y0 -&gt; 1-t[n] t[2] t[1]</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    reverse = []</span><br><span class="line">    k = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> cmap._segmentdata:</span><br><span class="line">        k.append(key)</span><br><span class="line">        channel = cmap._segmentdata[key]</span><br><span class="line">        data = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> channel:</span><br><span class="line">            data.append((<span class="number">1</span>-t[<span class="number">0</span>],t[<span class="number">2</span>],t[<span class="number">1</span>]))</span><br><span class="line">        reverse.append(sorted(data))</span><br><span class="line"></span><br><span class="line">    LinearL = dict(zip(k,reverse))</span><br><span class="line">    my_cmap_r = mpl.colors.LinearSegmentedColormap(name, LinearL)</span><br><span class="line">    <span class="keyword">return</span> my_cmap_r</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cmap=cc.cm[<span class="string">"fire"</span>]</span><br><span class="line">cmap_r = reverse_colourmap(cmap)</span><br></pre></td></tr></table></figure><h2 id="colorbar"><a class="markdownIt-Anchor" href="#colorbar"></a> colorbar</h2><h3 id="官方-api"><a class="markdownIt-Anchor" href="#官方-api"></a> 官方 API</h3><p><a href="https://matplotlib.org/api/colorbar_api.html" target="_blank" rel="external nofollow noopener noreferrer">API</a><br><a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.colorbar.html" target="_blank" rel="external nofollow noopener noreferrer">API2</a></p><h3 id="简单使用"><a class="markdownIt-Anchor" href="#简单使用"></a> 简单使用</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sc = plt.scatter(X, Y, c=Z, s=<span class="number">1</span>, cmap=pyplot.cm.jet)</span><br><span class="line">plt.colorbar(sc)</span><br></pre></td></tr></table></figure><h3 id="位置"><a class="markdownIt-Anchor" href="#位置"></a> 位置</h3><p>偏移使用 pad，尺寸缩小使用 shrink</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.colorbar(sc, pad = <span class="number">0.07</span>, shrink=<span class="number">0.8</span>)</span><br></pre></td></tr></table></figure><h3 id="坐标控制的位置"><a class="markdownIt-Anchor" href="#坐标控制的位置"></a> 坐标控制的位置</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cbar_ax = fig.add_axes([<span class="number">0.19</span>, <span class="number">0.06</span>, <span class="number">0.7</span>, <span class="number">0.015</span>]) <span class="comment">#left,bottom,left_length,bottom_length</span></span><br><span class="line">cbar=plt.colorbar(sc, cax=cbar_ax, orientation=<span class="string">'horizontal'</span>)</span><br></pre></td></tr></table></figure><h3 id="set_ticks"><a class="markdownIt-Anchor" href="#set_ticks"></a> set_ticks</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cbar_ticks = np.linspace(<span class="number">0.</span>, <span class="number">5e-3</span>, num=<span class="number">3</span>, endpoint=<span class="literal">True</span>)</span><br><span class="line">cbar.set_ticks(cbar_ticks)</span><br></pre></td></tr></table></figure><h3 id="怎么才能在坐标上显示-max-min"><a class="markdownIt-Anchor" href="#怎么才能在坐标上显示-max-min"></a> 怎么才能在坐标上显示 max min？</h3><h3 id="科学计数法"><a class="markdownIt-Anchor" href="#科学计数法"></a> 科学计数法</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cbar.formatter.set_powerlimits((<span class="number">-1</span>, <span class="number">1</span>))</span><br><span class="line">cbar.update_ticks()</span><br></pre></td></tr></table></figure><p>这样小于 10^(-1)，或者大于 10^(1) 的值就会用科学计数法。</p><h3 id="ticks-朝向"><a class="markdownIt-Anchor" href="#ticks-朝向"></a> ticks 朝向</h3><p>如果 colorbar 竖直，ticks 默认是朝右的，如果 colorbar 水平，ticks 默认朝下的。</p><p>可以这样更改：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cbar.ax.xaxis.set_ticks_position(<span class="string">'top'</span>)<span class="comment">#colorbar水平，horizontal</span></span><br><span class="line">cbar.ax.yaxis.set_ticks_position(<span class="string">'left'</span>)<span class="comment">#colorbar竖直，vertical</span></span><br></pre></td></tr></table></figure><p>也可以这样：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cbar.ax.yaxis.tick_left()</span><br></pre></td></tr></table></figure><h3 id="添加变量名-set_title"><a class="markdownIt-Anchor" href="#添加变量名-set_title"></a> 添加变量名 set_title</h3><p><a href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.set_title.html" target="_blank" rel="external nofollow noopener noreferrer">set_title</a><br><code>set_title</code> 默认在最上方，不管 colorbar 是水平还是竖直。<br>有个参数 pad 表示向上偏移距离，但是 pad 等于负数时无效。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cbar.ax.set_title(<span class="string">'$\Omega\ [-]$'</span>, pad=<span class="number">10</span>)</span><br></pre></td></tr></table></figure><h3 id="添加变量名-set_label"><a class="markdownIt-Anchor" href="#添加变量名-set_label"></a> 添加变量名 set_label</h3><p>推荐使用 <a href="https://stackoverflow.com/questions/17475619/how-do-i-adjust-offset-colorbar-title-in-matplotlib" target="_blank" rel="external nofollow noopener noreferrer">set_label</a></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cbar.set_label(<span class="string">'$\Omega\ [-]$'</span>)</span><br><span class="line">cbar.set_label(<span class="string">r"$\Delta$"</span>+varName, va=<span class="string">'bottom'</span>, ha=<span class="string">'right'</span>, labelpad=<span class="number">10</span>)</span><br></pre></td></tr></table></figure><h3 id="变量名改变位置"><a class="markdownIt-Anchor" href="#变量名改变位置"></a> 变量名改变位置</h3><p>colorbar 是水平的，这里的 bottom 表示变量名放在水平 colorbar 的下边，labelpad 是向下的偏移距离。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cbar.set_label(<span class="string">'T'</span>,verticalalignment=<span class="string">'bottom'</span>, labelpad=<span class="number">-10</span>)</span><br></pre></td></tr></table></figure><p>Vertical alignment must be one of (‘top’, ‘bottom’, ‘center’, ‘baseline’)<br>Horizontal alignment must be one of (‘center’, ‘right’, ‘left’)</p><p>对于水平 colorbar，<code>horizontalalignment</code> 不管用？</p><h2 id="图例-legend"><a class="markdownIt-Anchor" href="#图例-legend"></a> 图例 legend</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.plot(X, Y, label=<span class="string">"sim"</span>) <span class="comment"># 这里的 label 即图例</span></span><br><span class="line">plt.legend(loc=<span class="string">'upper left'</span>) <span class="comment"># 图例位置</span></span><br><span class="line">plt.legend(loc=<span class="string">'best'</span>) <span class="comment"># 自动选择最合适的位置</span></span><br><span class="line">plt.plot(legend=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><p>上下左右：<code>upper lower left right</code></p><p>在循环里边画很多条线时，只想保留一个 legend，循环结束后：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">from collections import OrderedDict</span><br><span class="line">handles, labels &#x3D; plt.gca().get_legend_handles_labels()</span><br><span class="line">by_label &#x3D; OrderedDict(zip(labels, handles))</span><br><span class="line">plt.legend(by_label.values(), by_label.keys())</span><br></pre></td></tr></table></figure><p>缩放图例中的 marker 大小: markerscale<br>Default is None, which will take the value from rcParams[“legend.markerscale”] = 1.0.</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">plt.legend(loc&#x3D;&#39;upper right&#39;,markerscale&#x3D;3,fancybox&#x3D;True, framealpha&#x3D;0.1)</span><br></pre></td></tr></table></figure><p>缩放图例中的线宽</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">leg &#x3D; ax.legend()</span><br><span class="line"></span><br><span class="line">for line in leg.get_lines():</span><br><span class="line">    line.set_linewidth(4.0)</span><br></pre></td></tr></table></figure><p>关于位置的高级用法：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ax1.legend(loc=<span class="string">'upper right'</span>, bbox_to_anchor=(<span class="number">1.05</span>, <span class="number">4.3</span>), ncol=<span class="number">3</span>, fontsize=<span class="number">10</span>)</span><br></pre></td></tr></table></figure><p><code>bbox_to_anchor</code> 表示 right 和 upper 的位置。<br>upper right 和 loc 里的一致，不过顺序颠倒了，这里表示图例的 right 位于主图的 1.05，图例的 upper 位于主图的 4.3。<br>这个位置是0-1，超过1表示坐标轴以外。<br><code>ncol=3</code> 表示三栏</p><p>保存为图片后，如果图例超出了整个图片的范围，则可以这样操作：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">lgd =plt.legend(loc=<span class="string">'center left'</span>, bbox_to_anchor=(<span class="number">1</span>, <span class="number">0.5</span>))</span><br><span class="line">plt.savefig(<span class="string">"fig.png"</span>, bbox_extra_artists=(lgd,), bbox_inches=<span class="string">'tight'</span>)</span><br></pre></td></tr></table></figure><p>如果图例分了多列，<code>columnspacing=2.0</code> 控制列之间的间隔。<br><code>handletextpad=0.8</code> 可以控制 marker 和 label 之间的间隔。<br><a href="https://stackoverflow.com/questions/4700614/how-to-put-the-legend-out-of-the-plot" target="_blank" rel="external nofollow noopener noreferrer">参考资料</a><br><img src="https://i.stack.imgur.com/OIMyM.png" alt="参考图片"></p><h2 id="坐标轴"><a class="markdownIt-Anchor" href="#坐标轴"></a> 坐标轴</h2><h3 id="设置坐标轴-label"><a class="markdownIt-Anchor" href="#设置坐标轴-label"></a> 设置坐标轴 label</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.xlabel(<span class="string">'r [mm]'</span>,fontsize=<span class="number">12</span>)</span><br></pre></td></tr></table></figure><h3 id="调整坐标轴范围"><a class="markdownIt-Anchor" href="#调整坐标轴范围"></a> 调整坐标轴范围</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.axis([<span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">4</span>])   <span class="comment"># 改变取值范围，[xmin, xmax, ymin, ymax]</span></span><br><span class="line">plt.axis(xmin =<span class="number">0</span>, xmax = <span class="number">0.5</span>, ymin = <span class="number">0</span>, ymax = <span class="number">0.55</span>)</span><br><span class="line">plt.xlim(<span class="number">0</span>,<span class="number">0.35</span>)</span><br><span class="line">plt.ylim(<span class="number">0</span>,<span class="number">0.2</span>)</span><br></pre></td></tr></table></figure><h3 id="自定义刻度"><a class="markdownIt-Anchor" href="#自定义刻度"></a> 自定义刻度</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x_new=np.array([<span class="number">5</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">20</span>])</span><br><span class="line">plt.xticks(x_new)</span><br></pre></td></tr></table></figure><h3 id="刻度朝内"><a class="markdownIt-Anchor" href="#刻度朝内"></a> 刻度朝内</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.tick_params(direction=<span class="string">'in'</span>)</span><br></pre></td></tr></table></figure><h3 id="刻度小数点位数"><a class="markdownIt-Anchor" href="#刻度小数点位数"></a> 刻度小数点位数</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.ticker <span class="keyword">as</span> ticker</span><br><span class="line">plt.gca().xaxis.set_major_formatter(ticker.FormatStrFormatter(<span class="string">'%.6f'</span>))</span><br></pre></td></tr></table></figure><h3 id="隐藏坐标"><a class="markdownIt-Anchor" href="#隐藏坐标"></a> 隐藏坐标</h3><p>在包含几个子图的图标中，可能需要隐藏一些重复的坐标</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ax1 = plt.subplot(<span class="number">420</span>+i)</span><br><span class="line">plt.setp(ax1.get_xticklabels(), visible=<span class="literal">False</span>)</span><br><span class="line">plt.setp(ax1.get_yticklabels(), visible=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><h3 id="隐藏-ticks-和-label"><a class="markdownIt-Anchor" href="#隐藏-ticks-和-label"></a> 隐藏 ticks 和 label</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ax1.set_xticks([])</span><br></pre></td></tr></table></figure><h3 id="隐藏子刻度"><a class="markdownIt-Anchor" href="#隐藏子刻度"></a> 隐藏子刻度</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.minorticks_off()</span><br></pre></td></tr></table></figure><h3 id="科学计数"><a class="markdownIt-Anchor" href="#科学计数"></a> 科学计数</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.ticklabel_format(axis=<span class="string">"x"</span>, style=<span class="string">"sci"</span>, scilimits=(<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">ax.ticklabel_format(axis=<span class="string">"x"</span>, style=<span class="string">"sci"</span>, scilimits=(<span class="number">0</span>,<span class="number">0</span>))</span><br></pre></td></tr></table></figure><h2 id="x-y-坐标等比例"><a class="markdownIt-Anchor" href="#x-y-坐标等比例"></a> x y 坐标等比例</h2><p>这个用于CFD模拟场的云图，保证 x y 长度是等比例的。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ax=plt.gca()</span><br><span class="line">ax.set_aspect(<span class="number">1.0</span>) <span class="comment"># set uniform length of axis</span></span><br></pre></td></tr></table></figure><h2 id="使用-latex-公式"><a class="markdownIt-Anchor" href="#使用-latex-公式"></a> 使用 LaTeX 公式</h2><p>用 <code>$</code> 包围起来并在前边加上 <code>r</code> 即可，最好 <code>$</code> 和公式之间留一个空格。</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.xlabel(<span class="string">r'Scalar dissipation rate $ [s^&#123;-1&#125;] $'</span>,fontsize=<span class="number">12</span>)</span><br></pre></td></tr></table></figure><h2 id="任意位置添加文字"><a class="markdownIt-Anchor" href="#任意位置添加文字"></a> 任意位置添加文字</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.text(<span class="number">1</span>, <span class="number">17</span>, <span class="string">r"z=%s mm"</span>%(str(Z)))</span><br></pre></td></tr></table></figure><h2 id="子图-subplot"><a class="markdownIt-Anchor" href="#子图-subplot"></a> 子图 subplot</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.subplots_adjust(left=<span class="number">0.11</span>,bottom=<span class="number">0.1</span>,top=<span class="number">0.97</span>,right=<span class="number">0.9</span>,hspace=<span class="number">0.000001</span>,wspace=<span class="number">0.000001</span>)</span><br><span class="line"></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> Z <span class="keyword">in</span> [<span class="string">'2'</span>,<span class="string">'10'</span>,<span class="string">'30'</span>,<span class="string">'50'</span>]:</span><br><span class="line">    i=i+<span class="number">1</span></span><br><span class="line">    ax1 = plt.subplot(<span class="number">410</span>+i)</span><br><span class="line">    plt.plot(R_Mean,U_Mean,linestyle=<span class="string">'--'</span>,marker=<span class="string">'o'</span>, color=<span class="string">'r'</span>,label=<span class="string">"sim"</span>)</span><br></pre></td></tr></table></figure><p><code>subplot(410+i)</code> 表示子图 4x1 排列，即 4 行 1 列。此处的循环，令 <code>i</code> 分分别等于 1 2 3 4。</p><p>也可以用<code>subplot(4,1,i)</code>表示。</p><p>绘制着色的多个子图（云图或者上色=的散点图）需要注意他们的数据 min max可能不同。<br>可以设置 vmin vmax是他们保持一致：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">plt.scatter(x1, y1, c&#x3D;z1, s&#x3D;2, marker&#x3D;&#39;o&#39;, vmin&#x3D;minZ, vmax&#x3D;maxZ)</span><br><span class="line">plt.scatter(x2, y2, c&#x3D;z2, s&#x3D;2, marker&#x3D;&#39;s&#39;, vmin&#x3D;minZ, vmax&#x3D;maxZ)</span><br></pre></td></tr></table></figure><h2 id="图片标题"><a class="markdownIt-Anchor" href="#图片标题"></a> 图片标题</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.title(<span class="string">'source_Yc'</span>,fontsize=<span class="number">12</span>)</span><br></pre></td></tr></table></figure><h2 id="alpha-表示不透明度1表示完全不透明"><a class="markdownIt-Anchor" href="#alpha-表示不透明度1表示完全不透明"></a> alpha 表示不透明度，1表示完全不透明</h2><p>可以用于 plot scatter contour contourf 中。</p><h1 id="输出图片"><a class="markdownIt-Anchor" href="#输出图片"></a> 输出图片</h1><h2 id="紧凑布局"><a class="markdownIt-Anchor" href="#紧凑布局"></a> 紧凑布局</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt.savefig(<span class="string">"abc.png"</span>, dpi=<span class="number">500</span>, bbox_inches=<span class="string">'tight'</span>, pad_inches=<span class="number">0.01</span>)</span><br><span class="line">plt.savefig(<span class="string">"abc.pdf"</span>, bbox_inches=<span class="string">'tight'</span>, pad_inches=<span class="number">0.01</span>)</span><br><span class="line">plt.close()</span><br><span class="line"></span><br><span class="line">fig = plt.figure()</span><br><span class="line">fig.savefig(<span class="string">"abc.png"</span>, dpi=<span class="number">500</span>, bbox_inches=<span class="string">'tight'</span>, pad_inches=<span class="number">0.01</span>)</span><br><span class="line">fig.savefig(<span class="string">"abc.pdf"</span>, bbox_inches=<span class="string">'tight'</span>, pad_inches=<span class="number">0.01</span>)</span><br><span class="line">fig.close()</span><br></pre></td></tr></table></figure><h1 id="python-相关"><a class="markdownIt-Anchor" href="#python-相关"></a> python 相关</h1><h2 id="利用正则表达式获取当前目录下的某些文件"><a class="markdownIt-Anchor" href="#利用正则表达式获取当前目录下的某些文件"></a> 利用正则表达式获取当前目录下的某些文件</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> glob</span><br><span class="line">files = glob.iglob(<span class="string">r'0.*'</span>)</span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">    <span class="keyword">print</span> file</span><br></pre></td></tr></table></figure><p>普通版本：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">files = [<span class="string">'0.1'</span>, <span class="string">'0.2'</span>]</span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">    <span class="keyword">print</span> file</span><br></pre></td></tr></table></figure><h2 id="换行"><a class="markdownIt-Anchor" href="#换行"></a> 换行</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ylabel(<span class="string">'this is vertical\ntest'</span>, multialignment=<span class="string">'center'</span>)<span class="comment">#\n表示换行</span></span><br></pre></td></tr></table></figure><h2 id="灰色系列填充彩图"><a class="markdownIt-Anchor" href="#灰色系列填充彩图"></a> 灰色系列填充彩图</h2><h2 id="在图中使用其它字体"><a class="markdownIt-Anchor" href="#在图中使用其它字体"></a> 在图中使用其它字体</h2><p><a href="https://stackoverflow.com/a/53645383" target="_blank" rel="external nofollow noopener noreferrer">https://stackoverflow.com/a/53645383</a><br>我成功操作的经历：</p><blockquote><p>把字体拷贝到：<br>/public/home/yao1/packages_ZY/anaconda_ZY/anaconda3/lib/python3.6/site-packages/matplotlib/mpl-data/fonts/ttf<br>然后：<br>rm -rf ~/.cache/matplotlib/</p></blockquote><p>使用字体：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> rcParams</span><br><span class="line">rcParams.update(&#123;<span class="string">'font.size'</span>: <span class="number">12</span>, <span class="string">'font.family'</span>: <span class="string">'Times New Roman'</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> rcParams</span><br><span class="line">rcParams.update(&#123;<span class="string">'font.size'</span>: <span class="number">12</span>, <span class="string">'font.family'</span>: <span class="string">'simsun'</span>&#125;)</span><br><span class="line"></span><br><span class="line">ax1.legend(loc=<span class="string">'upper right'</span>, bbox_to_anchor=(<span class="number">0.92</span>, <span class="number">3.7</span>), ncol=<span class="number">3</span>,fontsize=<span class="number">10</span>,prop=&#123;<span class="string">'family'</span>:<span class="string">'simsun'</span>&#125;)</span><br><span class="line"></span><br><span class="line">plt.text(<span class="number">1.03</span>,<span class="number">5.4</span>,<span class="string">'平均值'</span>,fontname=<span class="string">'simsun'</span>)</span><br></pre></td></tr></table></figure><h1 id="疑难解答"><a class="markdownIt-Anchor" href="#疑难解答"></a> 疑难解答</h1><h2 id="服务器绘图"><a class="markdownIt-Anchor" href="#服务器绘图"></a> 服务器绘图</h2><p>报错 <code>QXcbConnection: Could not connect to display</code></p><p>solution：<br>在脚本的<strong>最前边</strong>加上</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib</span><br><span class="line">matplotlib.use(<span class="string">'Agg'</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;使用 matplotlib 绘图&lt;/p&gt;
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>OpenFOAM 官方代码发布通知栏</title>
    <link href="https://openfoam.top/release/"/>
    <id>https://openfoam.top/release/</id>
    <published>2019-06-27T22:00:00.000Z</published>
    <updated>2020-07-21T22:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<a id="more"></a><ul><li>17/02/2014, <a href="https://openfoam.org/release/2-3-0" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 2.3.0</a></li><li>10/12/2014, <a href="https://openfoam.org/release/2-3-1" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 2.3.1</a></li><li>22/05/2015, <a href="https://openfoam.org/release/2-4-0" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 2.4.0</a></li><li>03/11/2015, <a href="https://openfoam.org/release/3-0-0" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 3.0.0</a></li><li>15/12/2015, <a href="https://openfoam.org/release/3-0-1" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 3.0.1</a></li><li>28/06/2016, <a href="https://openfoam.org/release/4-0" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 4.0</a></li><li>13/10/2016, <a href="https://openfoam.org/release/4-1" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 4.1</a></li><li>26/07/2017, <a href="https://openfoam.org/release/5-0" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 5.0</a></li><li>10/07/2018, <a href="https://openfoam.org/release/6" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 6</a></li><li>27/06/2019, <a href="https://www.openfoam.com/releases/openfoam-v1906" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM® v1906</a></li><li>08/07/2019, <a href="https://openfoam.org/release/7" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 7</a></li><li>02/11/2019, <a href="https://sourceforge.net/projects/foam-extend/files/foam-extend-4.1" target="_blank" rel="external nofollow noopener noreferrer">foam-extend 4.1</a></li><li>23/12/2019, <a href="https://www.openfoam.com/releases/openfoam-v1912" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM® v1912</a></li><li>30/06/2006, <a href="https://openfoam.com/releases/openfoam-v2006" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM® v2006</a></li><li>22/07/2020, <a href="https://openfoam.org/release/8" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM 8</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;ul&gt;&lt;li&gt;17/02/2014, &lt;a href=&quot;https://openfoam.org/release/2-3-0&quot; target=&quot;_blank&quot; rel=&quot;external nofollow noopener noreferrer
      
    
    </summary>
    
    
      <category term="release" scheme="https://openfoam.top/categories/release/"/>
    
    
  </entry>
  
  <entry>
    <title>自适应输出间隔</title>
    <link href="https://openfoam.top/adjustableWrite/"/>
    <id>https://openfoam.top/adjustableWrite/</id>
    <published>2019-06-19T22:00:00.000Z</published>
    <updated>2020-03-22T23:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>自适应输出间隔</p><a id="more"></a><p>controlDict 中加入如下代码：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">functions</span><br><span class="line">&#123;</span><br><span class="line">    fileUpdate1</span><br><span class="line">    &#123;</span><br><span class="line">        type              timeActivatedFileUpdate;</span><br><span class="line">        libs              (&quot;libutilityFunctionObjects.so&quot;);</span><br><span class="line">        writeControl      timeStep;</span><br><span class="line">        writeInterval     1;</span><br><span class="line">        fileToUpdate      &quot;$FOAM_CASE&#x2F;system&#x2F;controlDict&quot;;</span><br><span class="line">        timeVsFile</span><br><span class="line">        (</span><br><span class="line">            (0.2 &quot;$FOAM_CASE&#x2F;system&#x2F;controlDict1&quot;)</span><br><span class="line">            (0.4 &quot;$FOAM_CASE&#x2F;system&#x2F;controlDict2&quot;)</span><br><span class="line">            (0.6 &quot;$FOAM_CASE&#x2F;system&#x2F;controlDict3&quot;)</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后复制几份 controlDict</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cp system&#x2F;controlDict system&#x2F;controlDict1</span><br><span class="line">cp system&#x2F;controlDict system&#x2F;controlDict2</span><br><span class="line">cp system&#x2F;controlDict system&#x2F;controlDict3</span><br></pre></td></tr></table></figure><p>从 0.2 开始，用的是 controlDict1 里的设置。<br>从 0.4 开始，用的是 controlDict2 里的设置。<br>从 0.6 开始，用的是 controlDict3 里的设置。<br>我们可以在这三个 controlDict 里设置不同的输出时间间隔。<br>这样就能随意操控输出间隔了。<br>当然了，还可以控制其它参数，请自行探索。<br>timeActivatedFileUpdate 这个功能还可以用于其他文件，请自行探索。</p><p>OpenFOAM 自带的 timeActivatedFileUpdate 不支持发动机算例。<br>因为在算例里边，发动机里边的 Time 是按照曲轴转角来计算的。<br>但是在代码中仍然是按照秒来计算的。<br>我修改了一下官方代码，现在已支持发动机算例！<br><a href="https://github.com/ZhangYanTJU/functionObjects" target="_blank" rel="external nofollow noopener noreferrer">代码地址</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;自适应输出间隔&lt;/p&gt;
    
    </summary>
    
    
      <category term="using" scheme="https://openfoam.top/categories/using/"/>
    
    
      <category term="functionObject" scheme="https://openfoam.top/tags/functionObject/"/>
    
  </entry>
  
  <entry>
    <title>OpenFOAM Learning Resources</title>
    <link href="https://openfoam.top/studyMaterials/"/>
    <id>https://openfoam.top/studyMaterials/</id>
    <published>2019-05-27T22:00:00.000Z</published>
    <updated>2020-04-06T22:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>I think this is the most comprehensive learning resources about OpenFOAM.</p><a id="more"></a><h1 id="official-websites"><a class="markdownIt-Anchor" href="#official-websites"></a> Official websites</h1><ol><li><a href="https://openfoam.org/" target="_blank" rel="external nofollow noopener noreferrer">https://openfoam.org/</a></li><li><a href="https://github.com/OpenFOAM/OpenFOAM-dev" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/OpenFOAM/OpenFOAM-dev</a></li><li><a href="https://www.openfoam.com/" target="_blank" rel="external nofollow noopener noreferrer">https://www.openfoam.com/</a></li><li><a href="https://develop.openfoam.com/Development/openfoam" target="_blank" rel="external nofollow noopener noreferrer">https://develop.openfoam.com/Development/openfoam</a></li><li><a href="https://sourceforge.net/projects/foam-extend/" target="_blank" rel="external nofollow noopener noreferrer">https://sourceforge.net/projects/foam-extend/</a></li><li><a href="http://openfoamworkshop.org/" target="_blank" rel="external nofollow noopener noreferrer">http://openfoamworkshop.org/</a></li></ol><h1 id="installation"><a class="markdownIt-Anchor" href="#installation"></a> Installation</h1><ol><li><a href="https://openfoam.org/download/" target="_blank" rel="external nofollow noopener noreferrer">online installation</a></li><li><a href="http://openfoamwiki.net/index.php/Installation" target="_blank" rel="external nofollow noopener noreferrer">compilation</a></li><li><a href="https://bitbucket.org/bgschaid/ansiblefoaminstallation" target="_blank" rel="external nofollow noopener noreferrer">ansibleFoamInstallation</a></li></ol><h1 id="best-of-the-best"><a class="markdownIt-Anchor" href="#best-of-the-best"></a> Best of the Best</h1><ol><li><a href="https://cfd.direct/openfoam/user-guide/" target="_blank" rel="external nofollow noopener noreferrer">User Guide</a></li><li><a href="https://www.cfd-online.com/Forums/openfoam/146697-getting-started-openfoam.html" target="_blank" rel="external nofollow noopener noreferrer">Getting Started with OpenFOAM-wyldckat</a></li><li><a href="http://www.wolfdynamics.com/our-services/training/openfoam-intro-training.html?id=50" target="_blank" rel="external nofollow noopener noreferrer">University of Genoa</a></li><li><a href="https://wiki.openfoam.com/" target="_blank" rel="external nofollow noopener noreferrer">wikiOpenFOAM</a> <a href="https://wiki.openfoam.com/%223_weeks%22_series" target="_blank" rel="external nofollow noopener noreferrer">“3 weeks” series</a></li><li><a href="https://github.com/ParticulateFlow/OSCCAR-doc" target="_blank" rel="external nofollow noopener noreferrer">A little User-Manual</a></li><li><a href="http://www.tfd.chalmers.se/~hani/kurser/OS_CFD/" target="_blank" rel="external nofollow noopener noreferrer">CFD with OpenSource Software-Chalmers</a></li><li><a href="http://openfoamwiki.net/index.php/Main_Page" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAMwiki</a></li><li><a href="https://github.com/psu-efd/PSU-OpenFOAM-Course-Notes" target="_blank" rel="external nofollow noopener noreferrer">PSU-OpenFOAM-Course-Notes</a></li><li><a href="https://github.com/UnnamedMoose/BasicOpenFOAMProgrammingTutorials" target="_blank" rel="external nofollow noopener noreferrer">BasicOpenFOAMProgrammingTutorials</a></li><li><a href="https://www.researchgate.net/project/OpenFOAM-Tutoring" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM-Tutoring</a></li><li><a href="https://www.researchgate.net/project/OpenFOAM-study" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM-study</a></li><li><a href="https://www.cypriensoulaine.com/openfoam" target="_blank" rel="external nofollow noopener noreferrer">Cyprien Soulaine-OPENFOAM® TRAINING</a></li><li><a href="https://eprints.soton.ac.uk/166633/" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM workshop</a></li></ol><h1 id="books"><a class="markdownIt-Anchor" href="#books"></a> Books</h1><ol><li>The finite volume method in computational fluid dynamics : an advanced introduction with OpenFOAM® and Matlab®——<a href="http://download.library1.org/main/1505000/2116544840216f17655dc061da311d9a/%28Fluid%20mechanics%20and%20its%20applications%20volume%20113%29%20Darwish%2C%20M._%20Mangani%2C%20L._%20Moukalled%2C%20F%20-%20The%20finite%20volume%20method%20in%20computational%20fluid%20dynamics%20_%20an%20advanced%20introduction%20with%20OpenFOAM%C2%AE%20and%20Matlab.pdf" target="_blank" rel="external nofollow noopener noreferrer">download</a></li><li>Mathematics, Numerics, Derivations and OpenFOAM®——<a href="https://www.researchgate.net/publication/307546712_Mathematics_Numerics_Derivations_and_OpenFOAMR" target="_blank" rel="external nofollow noopener noreferrer">download</a></li><li>The OpenFOAM Technology Primer——<a href="http://sourceflux.de/book/" target="_blank" rel="external nofollow noopener noreferrer">download</a></li><li>Getting Started with OpenFOAM® Technology: RAW——<a href="https://kupdf.net/download/getting-started-with-openfoam-reg-technology-raw-ebook_58ff2a83dc0d60ba43959ea9_pdf" target="_blank" rel="external nofollow noopener noreferrer">download</a></li><li>Jasak Phd thesis ——<a href="https://foam-extend.fsb.hr/wp-content/uploads/2016/12/Jasak_PhD_1996.pdf" target="_blank" rel="external nofollow noopener noreferrer">download</a></li><li>Algorithm on Solvers and Models in OpenFOAM——<a href="https://wenku.baidu.com/view/7b2fc1db8bd63186bdebbc0c" target="_blank" rel="external nofollow noopener noreferrer">download</a></li></ol><h1 id="blogs"><a class="markdownIt-Anchor" href="#blogs"></a> Blogs</h1><ol><li><a href="http://blog.sina.com.cn/s/articlelist_1608493030_0_1.html" target="_blank" rel="external nofollow noopener noreferrer">苏军伟</a></li><li><a href="../sources/OFblog_su.pdf">苏军伟博文集</a></li><li><a href="https://foam-extend.fsb.hr/openfoam/tutorials/" target="_blank" rel="external nofollow noopener noreferrer">Jasak</a></li><li><a href="http://cfdyna.com/Home/OpenFOAM.html" target="_blank" rel="external nofollow noopener noreferrer">cfdyna</a></li><li><a href="http://dyfluid.com" target="_blank" rel="external nofollow noopener noreferrer">东岳流体</a></li><li><a href="http://blog.sina.com.cn/s/blog_97cadb820102vxyk.html" target="_blank" rel="external nofollow noopener noreferrer">WayneWangY</a></li><li><a href="http://xiaopingqiu.github.io/categories/OpenFOAM/" target="_blank" rel="external nofollow noopener noreferrer">Giskard’s CFD Learning Tricks</a></li><li><a href="https://holzmann-cfd.de/" target="_blank" rel="external nofollow noopener noreferrer">Tobias Holzmann</a></li><li><a href="http://sourceflux.de/blog/" target="_blank" rel="external nofollow noopener noreferrer">sourceflux</a></li><li><a href="http://caefn.com" target="_blank" rel="external nofollow noopener noreferrer">Fumiya</a></li><li><a href="https://www.slideshare.net/fumiyanozaki96/presentations" target="_blank" rel="external nofollow noopener noreferrer">Fumiya Slides</a></li><li><a href="https://marinecfd.xyz" target="_blank" rel="external nofollow noopener noreferrer">Zhaoweiwen</a></li><li><a href="http://blog.sina.com.cn/s/articlelist_5593422497_10_1.html" target="_blank" rel="external nofollow noopener noreferrer">Cu2SO4</a></li><li><a href="http://penguinitis.g1.xrea.com/" target="_blank" rel="external nofollow noopener noreferrer">penguinitis</a></li><li><a href="https://jibranhaider.weebly.com/" target="_blank" rel="external nofollow noopener noreferrer">Jibran</a></li><li><a href="http://www.cfdnotes.com/" target="_blank" rel="external nofollow noopener noreferrer">Hiroaki</a></li><li><a href="http://blog.pfan.cn/bioexplore" target="_blank" rel="external nofollow noopener noreferrer">CFD——OpenFOAM</a></li><li><a href="https://www.cfdsupport.com/OpenFOAM-Training-by-CFD-Support/" target="_blank" rel="external nofollow noopener noreferrer">CFD SUPPORT</a></li><li><a href="https://snow-stone.github.io/" target="_blank" rel="external nofollow noopener noreferrer">snow-stone</a></li><li><a href="http://pavanakumar.github.io/compressibleFoam/index.html" target="_blank" rel="external nofollow noopener noreferrer">compressibleFoam</a></li><li><a href="http://cfd.at/tutorials" target="_blank" rel="external nofollow noopener noreferrer">TU Wien</a></li><li><a href="https://chengdi123000.github.io" target="_blank" rel="external nofollow noopener noreferrer">chengdi</a></li><li><a href="http://www.probabilisticmoney.com/?page_id=84" target="_blank" rel="external nofollow noopener noreferrer">probabilisticmoney</a></li><li><a href="https://zhulianhua.github.io" target="_blank" rel="external nofollow noopener noreferrer">zhulianhua</a></li><li><a href="https://www.thefoamhouse.es/" target="_blank" rel="external nofollow noopener noreferrer">thefoamhouse</a></li><li><a href="https://albertopassalacqua.com/" target="_blank" rel="external nofollow noopener noreferrer">Alberto</a></li><li><a href="https://openfoam.tech/" target="_blank" rel="external nofollow noopener noreferrer">openfoam.tech</a></li><li><a href="http://hassankassem.me/posts/" target="_blank" rel="external nofollow noopener noreferrer">Hassan</a></li><li><a href="https://ddai.me/" target="_blank" rel="external nofollow noopener noreferrer">Dezhi Dai</a></li><li><a href="https://foamscience.github.io/" target="_blank" rel="external nofollow noopener noreferrer">foamscience</a></li><li><a href="https://petebachant.me/posts/" target="_blank" rel="external nofollow noopener noreferrer">petebachant</a></li><li><a href="http://olesenm.github.io/" target="_blank" rel="external nofollow noopener noreferrer">Mark Olesen</a></li><li><a href="https://blog.csdn.net/xxyhjy" target="_blank" rel="external nofollow noopener noreferrer">xxyhjy</a></li><li><a href="http://blog.sina.com.cn/s/articlelist_1395915742_2_1.html" target="_blank" rel="external nofollow noopener noreferrer">Jay_见贤思齐</a></li><li><a href="http://blog.sina.com.cn/s/articlelist_1784149880_1_1.html" target="_blank" rel="external nofollow noopener noreferrer">蝇王</a></li><li><a href="https://chengpengzhao.com/categories/%E5%B7%A5%E4%BD%9C/OpenFOAM/" target="_blank" rel="external nofollow noopener noreferrer">Zcp</a></li><li><a href="http://myheutagogy.com/" target="_blank" rel="external nofollow noopener noreferrer">Andre Weiner</a></li><li><a href="http://www.probabilisticmoney.com/?page_id=84" target="_blank" rel="external nofollow noopener noreferrer">ProbabilisticMoney</a></li></ol><h1 id="youtube"><a class="markdownIt-Anchor" href="#youtube"></a> YouTube</h1><ol><li><a href="https://www.youtube.com/playlist?list=PLqxhJj6bcnY9RoIgzeF6xDh5L9bbeK3BL" target="_blank" rel="external nofollow noopener noreferrer">Jasak</a></li><li><a href="https://www.youtube.com/channel/UCqCLabkRddpbHj4wYNFYjAA" target="_blank" rel="external nofollow noopener noreferrer">Kenneth Hoste</a></li><li><a href="https://www.youtube.com/user/fifaman114" target="_blank" rel="external nofollow noopener noreferrer">Theo Ong</a></li></ol><h1 id="forums"><a class="markdownIt-Anchor" href="#forums"></a> Forums</h1><ol><li><a href="https://www.cfd-online.com/Forums/openfoam/" target="_blank" rel="external nofollow noopener noreferrer">cfd-online</a></li><li><a href="http://www.cfd-china.com/" target="_blank" rel="external nofollow noopener noreferrer">cfd-china</a></li></ol><h1 id="others"><a class="markdownIt-Anchor" href="#others"></a> Others</h1><ol><li><a href="https://openfoamwiki.net/index.php/Handy_links" target="_blank" rel="external nofollow noopener noreferrer">openfoamwiki</a></li><li><a href="http://www.sourceflux.de/blog/101-things-read-starting-openfoam/" target="_blank" rel="external nofollow noopener noreferrer">101-things-read-starting-openfoam</a></li><li><a href="http://openfoam-extend.sourceforge.net/OpenFOAM_Workshops/OFW11_2016_Guimaraes/courses.html" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM_Workshops courses</a></li><li><a href="https://sourceforge.net/projects/openfoam-extend/files/OpenFOAM_Workshops/" target="_blank" rel="external nofollow noopener noreferrer">OpenFOAM_Workshops courses resources</a></li><li><a href="https://cfd.direct/openfoam/productive-cfd/" target="_blank" rel="external nofollow noopener noreferrer">cfd.direct</a></li><li><a href="https://www.researchgate.net/post/Where_could_I_find_specific_material_to_learn_OpenFOAM" target="_blank" rel="external nofollow noopener noreferrer">researchgate Questions</a></li><li><a href="http://www.cloudpyme.eu/en/training/inclass/" target="_blank" rel="external nofollow noopener noreferrer">cloudpyme</a></li><li><a href="http://homepages.cae.wisc.edu/~hessel/openfoam/Resources/index_OpenFOAMResources.html" target="_blank" rel="external nofollow noopener noreferrer">cae.wisc.edu</a></li><li><a href="https://eprints.soton.ac.uk/200155/" target="_blank" rel="external nofollow noopener noreferrer">Programming session: from the C++ basics to the compilation of user libraries</a></li><li><a href="https://qmplus.qmul.ac.uk/pluginfile.php/624310/mod_resource/content/2/mohamed.pdf" target="_blank" rel="external nofollow noopener noreferrer">Getting started with CFD packages OpenFOAM and FLUENT</a></li></ol><iframe src="https://docs.google.com/spreadsheets/d/17JCGN5AthdLDKMrCLHMzWkcg8Dmn7q19Qc0aHIf7wgE/pubhtml" name="target" width="650" height="600" frameborder="0" scrolling="auto"></iframe><p><a href="https://docs.google.com/spreadsheets/export?format=pdf&amp;id=17JCGN5AthdLDKMrCLHMzWkcg8Dmn7q19Qc0aHIf7wgE" target="_blank" rel="external nofollow noopener noreferrer">download1</a></p><p><a href="../sources/OpenFOAM_google_sheets.pdf">download2</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;I think this is the most comprehensive learning resources about OpenFOAM.&lt;/p&gt;
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>OpenFOAM 中的字典</title>
    <link href="https://openfoam.top/dictionary/"/>
    <id>https://openfoam.top/dictionary/</id>
    <published>2019-04-25T22:00:00.000Z</published>
    <updated>2020-07-12T22:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>OpenFOAM 中的 dictionary 和 IOdictionary</p><a id="more"></a><h1 id="常见用法"><a class="markdownIt-Anchor" href="#常见用法"></a> 常见用法</h1><h2 id="创建-iodictionary"><a class="markdownIt-Anchor" href="#创建-iodictionary"></a> 创建 IOdictionary</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">IOdictionary transportProperties<span class="comment">//字典的变量名</span></span><br><span class="line">(</span><br><span class="line">    IOobject</span><br><span class="line">    (</span><br><span class="line">        <span class="string">"transportProperties"</span>,<span class="comment">//字典名字</span></span><br><span class="line">        runTime.constant(),   <span class="comment">//字典位于constant下</span></span><br><span class="line">        mesh,</span><br><span class="line">        IOobject::MUST_READ_IF_MODIFIED,</span><br><span class="line">        IOobject::NO_WRITE</span><br><span class="line">    )</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>创建字典并不是创建文件！<br>如果想自定义路径呢？<br>可以把 <code>runTime.constant()</code> 改成 <code>&quot;./Properties&quot;</code>。<br>这样的话，我们就需要在当前算例目录下新建一个文件夹 <code>Properties</code>，文件夹里需要有一个文件 <code>transportProperties</code>。<br>该文件还必须包含文件头（header）：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">FoamFile</span><br><span class="line">&#123;</span><br><span class="line">    version     <span class="number">2.0</span>;</span><br><span class="line">    format      ascii;</span><br><span class="line">    <span class="class"><span class="keyword">class</span>       <span class="title">dictionary</span>;</span></span><br><span class="line">    location    <span class="string">"constant"</span>;</span><br><span class="line">    object      thermophysicalProperties;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>里边的信息可以随意，比如 <code>location</code> 仍然写 <code>constant</code> 也没关系。</p><h2 id="使用已有-iodictionary"><a class="markdownIt-Anchor" href="#使用已有-iodictionary"></a> 使用已有 IOdictionary</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> dictionary&amp; subModelDict = parcels.subModelProperties();<span class="comment">//这里获取已有的字典</span></span><br><span class="line"><span class="built_in">vector</span> <span class="built_in">position</span> = subModelDict.subDict(<span class="string">"injectionModels"</span>).subDict(<span class="string">"model1"</span>).lookup(<span class="string">"position"</span>);</span><br><span class="line"><span class="comment">//subDict 是子字典</span></span><br></pre></td></tr></table></figure><p>这里的 <code>parcels.subModelProperties()</code> 是 <code>SprayCloudProperties</code> 中的 <code>subModels</code>。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">const</span> wordList <span class="title">fuelList</span><span class="params">(thermo.subDict(<span class="string">"liquids"</span>).keys())</span></span>;</span><br></pre></td></tr></table></figure><p>这里的 <code>thermo</code> 是 <code>thermophysicalProperties</code>。</p><h2 id="通过字典读取变量"><a class="markdownIt-Anchor" href="#通过字典读取变量"></a> 通过字典读取变量</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">word</span> <span class="title">fuel</span><span class="params">(dict.lookup(<span class="string">"fuel"</span>))</span></span>;</span><br><span class="line"><span class="function">dimensionedScalar <span class="title">DT</span><span class="params">(dict.lookup(<span class="string">"DT"</span>))</span></span>;</span><br><span class="line"><span class="function">scalarList <span class="title">Z_param</span><span class="params">(dict.lookup(<span class="string">"Z_param"</span>))</span></span>;</span><br><span class="line">scalar Sct = readScalar(dict.lookup(<span class="string">"Sct"</span>));</span><br><span class="line">label int_a=readLabel(dict.lookup(<span class="string">"int_a"</span>));</span><br><span class="line"><span class="function">Switch <span class="title">flagg</span><span class="params">(dict.lookup(<span class="string">"flagg"</span>))</span></span>;</span><br></pre></td></tr></table></figure><p>另外还可以给定默认值，即 <code>lookupOrdefault</code> 函数：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">word</span> <span class="title">fuel2</span><span class="params">(dict.lookupOrDefault(<span class="string">"fuel2"</span>,fuel))</span></span>;</span><br><span class="line"><span class="function">dimensionedScalar <span class="title">DT2</span><span class="params">(dict.lookupOrDefault(<span class="string">"DT2"</span>,DT))</span></span>;</span><br><span class="line"><span class="function">scalarList <span class="title">Z_param2</span><span class="params">(dict.lookupOrDefault(<span class="string">"Z_param2"</span>,Z_param))</span></span>;</span><br><span class="line">scalar Sct2 = dict.lookupOrDefault(<span class="string">"Sct2"</span>, <span class="number">9.</span>);</span><br><span class="line"><span class="function">label <span class="title">int_a2</span><span class="params">(dict.lookupOrDefault(<span class="string">"int_a2"</span>, <span class="number">25</span>))</span></span>;</span><br><span class="line"><span class="function">Switch <span class="title">flagg2</span><span class="params">(dict.lookupOrDefault(<span class="string">"flagg2"</span>,<span class="literal">false</span>))</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//或者：</span></span><br><span class="line"><span class="function"><span class="keyword">word</span> <span class="title">fuel3</span><span class="params">(dict.lookupOrDefault&lt;<span class="keyword">word</span>&gt;(<span class="string">"fuel3"</span>,fuel))</span></span>;</span><br><span class="line"><span class="function">dimensionedScalar <span class="title">DT3</span><span class="params">(dict.lookupOrDefault&lt;dimensionedScalar&gt;(<span class="string">"DT3"</span>,DT))</span></span>;</span><br><span class="line"><span class="function">scalarList <span class="title">Z_param3</span><span class="params">(dict.lookupOrDefault&lt;scalarList&gt;(<span class="string">"Z_param3"</span>,Z_param))</span></span>;</span><br><span class="line">scalar Sct3 = dict.lookupOrDefault&lt;scalar&gt;(<span class="string">"Sct3"</span>, <span class="number">9.</span>);</span><br><span class="line"><span class="function">Switch <span class="title">flagg3</span><span class="params">(dict.lookupOrDefault&lt;Switch&gt;(<span class="string">"flagg3"</span>,<span class="literal">false</span>))</span></span>;</span><br><span class="line"><span class="function">label <span class="title">int_a3</span><span class="params">(dict.lookupOrDefault&lt;label&gt;(<span class="string">"int_a3"</span>, <span class="number">35</span>))</span></span>;</span><br></pre></td></tr></table></figure><p>算例文件：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">fuel ZY<span class="number">.3</span>;<span class="comment">// word 中允许有 点 ？</span></span><br><span class="line">DT DT [<span class="number">0</span> <span class="number">2</span> <span class="number">-1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>] <span class="number">1e-05</span>;</span><br><span class="line"><span class="comment">//Z_param (0 0.2 1);  //OK</span></span><br><span class="line"><span class="comment">//Z_param 3(0 0.2 1); //OK too</span></span><br><span class="line">Z_param <span class="number">101</span>&#123;<span class="number">0</span>&#125;;       <span class="comment">//OK too</span></span><br><span class="line">Sct <span class="number">10.2</span>;</span><br><span class="line">flagg <span class="literal">true</span>; <span class="comment">//expected 'true/false', 'on/off' </span></span><br><span class="line"></span><br><span class="line">Sct2 <span class="number">10.8</span>;</span><br></pre></td></tr></table></figure><p>如果重复给定，那么最后边的那个会起作用。</p><p>给定一个全是 0 的多维数组：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">zeroList</span><br><span class="line"><span class="number">21</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">308</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="number">101</span>&#123;<span class="number">0</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">;</span><br></pre></td></tr></table></figure><p>看一下这两个函数的代码，发现 <code>lookup</code> 返回的是 <code>ITstream</code>，而 <code>lookupOrDefault</code> 返回的是它的模板类型。<br>疑问：</p><ul><li>为什么需要 <code>readScalar</code> 才能使用 <code>lookup</code> 读取标量？可能是因为 <code>ITstream</code> 无法隐式的转换成 <code>scalar</code>。</li><li>为什么 <code>lookupOrDefault</code> 不给定模板也可以呢？因为它的第二个参数的类型就是模板的类型啊。</li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">ITstream&amp; <span class="title">lookup</span><span class="params">(<span class="keyword">const</span> <span class="keyword">word</span>&amp;,<span class="keyword">bool</span> recursive=<span class="literal">false</span>,<span class="keyword">bool</span> patternMatch=<span class="literal">true</span>)</span> <span class="keyword">const</span></span>;</span><br><span class="line"></span><br><span class="line">Foam::ITstream&amp; Foam::dictionary::lookup</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; keyword,</span><br><span class="line">    <span class="keyword">bool</span> recursive,</span><br><span class="line">    <span class="keyword">bool</span> patternMatch</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> lookupEntry(keyword, recursive, patternMatch).stream();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Foam::entry&amp; Foam::dictionary::lookupEntry</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; keyword,</span><br><span class="line">    <span class="keyword">bool</span> recursive,</span><br><span class="line">    <span class="keyword">bool</span> patternMatch</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> entry* entryPtr = lookupEntryPtr(keyword, recursive, patternMatch);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (entryPtr == <span class="literal">nullptr</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        FatalIOErrorInFunction</span><br><span class="line">        (</span><br><span class="line">            *<span class="keyword">this</span></span><br><span class="line">        )   &lt;&lt; <span class="string">"keyword "</span> &lt;&lt; keyword &lt;&lt; <span class="string">" is undefined in dictionary "</span></span><br><span class="line">            &lt;&lt; name()</span><br><span class="line">            &lt;&lt; <span class="built_in">exit</span>(FatalIOError);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> *entryPtr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;<span class="title">T</span> <span class="title">lookupOrDefault</span>(<span class="title">const</span> <span class="title">word</span>&amp;,<span class="title">const</span> <span class="title">T</span>&amp;,<span class="title">bool</span> <span class="title">recursive</span>=<span class="title">false</span>,<span class="title">bool</span> <span class="title">patternMatch</span>=<span class="title">true</span>) <span class="title">const</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">T</span> <span class="title">Foam</span>:</span>:dictionary::lookupOrDefault</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; keyword,</span><br><span class="line">    <span class="keyword">const</span> T&amp; deflt,</span><br><span class="line">    <span class="keyword">bool</span> recursive,</span><br><span class="line">    <span class="keyword">bool</span> patternMatch</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> entry* entryPtr = lookupEntryPtr(keyword, recursive, patternMatch);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (entryPtr)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> pTraits&lt;T&gt;(entryPtr-&gt;stream());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (writeOptionalEntries)</span><br><span class="line">        &#123;</span><br><span class="line">            IOInfoInFunction(*<span class="keyword">this</span>)</span><br><span class="line">                &lt;&lt; <span class="string">"Optional entry '"</span> &lt;&lt; keyword &lt;&lt; <span class="string">"' is not present,"</span></span><br><span class="line">                &lt;&lt; <span class="string">" returning the default value '"</span> &lt;&lt; deflt &lt;&lt; <span class="string">"'"</span></span><br><span class="line">                &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> deflt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Foam::entry* Foam::dictionary::lookupEntryPtr</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; keyword,</span><br><span class="line">    <span class="keyword">bool</span> recursive,</span><br><span class="line">    <span class="keyword">bool</span> patternMatch</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    HashTable&lt;entry*&gt;::const_iterator iter = hashedEntries_.<span class="built_in">find</span>(keyword);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (iter == hashedEntries_.<span class="built_in">end</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (patternMatch &amp;&amp; patternEntries_.<span class="built_in">size</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            DLList&lt;entry*&gt;::const_iterator wcLink =</span><br><span class="line">                patternEntries_.<span class="built_in">begin</span>();</span><br><span class="line">            DLList&lt;autoPtr&lt;regExp&gt;&gt;::const_iterator reLink =</span><br><span class="line">                patternRegexps_.<span class="built_in">begin</span>();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Find in patterns using regular expressions only</span></span><br><span class="line">            <span class="keyword">if</span> (findInPatterns(patternMatch, keyword, wcLink, reLink))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> wcLink();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (recursive &amp;&amp; &amp;parent_ != &amp;dictionary::null)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> parent_.lookupEntryPtr(keyword, recursive, patternMatch);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> iter();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="无网格创建-iodictionary"><a class="markdownIt-Anchor" href="#无网格创建-iodictionary"></a> 无网格创建 IOdictionary</h2><p>这段代码来自与<a href="https://github.com/ZmengXu" target="_blank" rel="external nofollow noopener noreferrer">Zmeng</a>的私下交流。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt; &quot;Reading thommieDict\n&quot; &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">const fileName caseDirOrig &#x3D; getEnv(&quot;FOAM_CASE&quot;);</span><br><span class="line">const fileName rootDirSource &#x3D; caseDirOrig.path();</span><br><span class="line">const fileName caseDirSource &#x3D; caseDirOrig.name();</span><br><span class="line"></span><br><span class="line">Info&lt;&lt; &quot;Source: &quot; &lt;&lt; rootDirSource &lt;&lt; &quot; &quot; &lt;&lt; caseDirSource &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">Time runTimeSource</span><br><span class="line">(</span><br><span class="line">    Time::controlDictName,</span><br><span class="line">    rootDirSource,</span><br><span class="line">    caseDirSource</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">IOdictionary thommieDict</span><br><span class="line">(</span><br><span class="line">    IOobject</span><br><span class="line">    (</span><br><span class="line">        &quot;thommieDict&quot;,</span><br><span class="line">        runTimeSource.system(),</span><br><span class="line">        runTimeSource,</span><br><span class="line">        IOobject::MUST_READ_IF_MODIFIED,</span><br><span class="line">        IOobject::NO_WRITE</span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">const dictionary geometrys(thommieDict.subDict(&quot;geometrys&quot;));</span><br></pre></td></tr></table></figure><h1 id="代码解析"><a class="markdownIt-Anchor" href="#代码解析"></a> 代码解析</h1><img src="http://www.plantuml.com/plantuml/svg/jLZVRzew57xdh_0J2Ykjxkvh0MaQtOfkLwg1j4bNLvL93f3R44UsGulM_k-p7ISujWCPR7reKv_lVEUdJno72MOCHN78Ov9Ykhl76_ZHGUBdyH4zq7YBEQ08Sop-LykNopW1YKAf-FLOGZ-Ib76QXvnGLa8lwhH1A36erEygWbv9y0Ks2w1ecQTAPq_YqmfwI2qN25jcwZqJ6gdmxasrjqvenNquPiOnZqEq82H1ppJcCCsKNdAJSXe3Ar2tcAtdU9700CJoxjq8hSKAH1gakGg_zfQxACDKA6Zn-EukPhnYo33dGDCwXSRWd9C7JWSKLZSlsQW2VuKLl6JiqGv9f_YJdMBjKc4I9OGyvTai91b4itmXBU-4bM2VpsvV9O92c5CMRw7uLnl_WdcuDijpUNLrrR9B3dJ8CLI_AQrZiTAV2Ak0DrsNwxYaNyHI5Fy98Bi5705jSgl10-H8JoFulWGws4D69OtkqB8b30IwXsShpEFRpNMYlkLS52UPzBCEI_024YHye_mkJk4-bqPz44YZ9i3iziFxSRm2PK_-gOivUO9KRWUadbXDAWAT0QRX6k4qqfrTHQeAkYHv6XtexU4I9ypJuMY8H2E39ocrRNJsxhdu3NIETrsJxdJN9dFTLPhkX3GEdIHos6I9c5Q3OaBFHtFDFjzby6SjJEaObZXFUCrCyJp_8_O-HD5lCzbWJ5FWQB9yeC3aJZPDdH5NurlZ_APNqfYfWMAG71n1xn3B5rB3ibnJQW5l6d0QteBQZxLH4ZIbDvkCxsnittZZR7B6luhoYO6ZAdDa31DzC9aTyLQkwAaP1du98vH3DBVbwkZn13kv7qVYXRXZWLbCDdJS55Fu9efvdAxgirSaWF6Ovnp-WPqqQtehcUL3pwjGD5fBDHn5GT6cVPrJe2jGNQgTBS1R4aSAR8xANrBHQQdE34Kr2mQo1QhEZhz280QiIDjP5Ee5UvOF8KumFOd1wS_-eMGwi-k8O_CMUM70TUtjLRF8Vfbjppsy-JrkPfXtUzT6OrBO2DSzKq99mpLELzRMA0aHIShkxrkI59vBYJxXq12ctWpjYn4qHQW22XDnY0hC5KvnoiHHD70rx1CgUf6uwk2fPbbj3CYNq_w0UjqaENWE5yJVP7WLi_9IHHnCVGHwGZjljVtHU9e1nRKFbVrvXsZPl_yr3bZbG8aR7ivl2RjeYNjjYHiC6e4YpebEZ2VIfVZO50VcYHtlQ6IKmpMkrQQssc3W5C7dqEU4B73YSSTuQLQfydmjoUVt7WFg-UzU8zVh2LnldOw-GrXW1fDfovk42-ScOLmgbjS8JP_9jXtjz6HA5lz3oAlHSGJMFCoEQxR_Yjp6bEUYbjLbaNnum7nTdYN4SUOl-vx6TxTJ4bNpO2ooQN-rrq15LYMgxBbcmfNgECUdVMJ4wKNllhPJrpKRnDiStX8VBE_rSOoljgtKhEdRfhAU_FsWm7EQgW_ZwxUMZL0g5LIVIYcNNtkzdg0HYQpV8wB1w-Mb4IFgJ8eBCLT0OLL6MGZjGY63kmdXh2XS7TFv2G00"><h2 id="一些函数探秘"><a class="markdownIt-Anchor" href="#一些函数探秘"></a> 一些函数探秘</h2><p>算例里的文件片段：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">RanzMarshallCoeffs</span><br><span class="line">&#123;</span><br><span class="line">    BirdCorrection  <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>代码：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> dictionary&amp; subModelDict = parcels.subModelProperties().subDict(<span class="string">"RanzMarshallCoeffs"</span>);</span><br><span class="line">Info&lt;&lt;<span class="string">"RanzMarshallCoeffs.toc()==="</span>&lt;&lt;subModelDict.toc()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">Info&lt;&lt;<span class="string">"RanzMarshallCoeffs.keys()==="</span>&lt;&lt;subModelDict.keys()&lt;&lt;<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">RanzMarshallCoeffs.toc()===<span class="number">1</span>(BirdCorrection)</span><br><span class="line">RanzMarshallCoeffs.keys()===<span class="number">1</span>(BirdCorrection)</span><br></pre></td></tr></table></figure><p>算例里的文件片段：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">liquids</span><br><span class="line">&#123;</span><br><span class="line">C7H16</span><br><span class="line">    &#123;</span><br><span class="line">        defaultCoeffs   yes;</span><br><span class="line">    &#125;</span><br><span class="line">    IC8H18</span><br><span class="line">    &#123;</span><br><span class="line">        defaultCoeffs   yes;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>代码：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">const</span> wordList <span class="title">fuelList</span><span class="params">(thermo.subDict(<span class="string">"liquids"</span>).keys())</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">const</span> wordList <span class="title">fuelCoeff1</span><span class="params">(thermo.subDict(<span class="string">"liquids"</span>).subDict(<span class="string">"C7H16"</span>).keys())</span></span>;</span><br><span class="line">Info&lt;&lt;<span class="string">"fuelList==="</span>&lt;&lt;fuelList&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">Info&lt;&lt;<span class="string">"fuelCoeff1==="</span>&lt;&lt;fuelCoeff1&lt;&lt;<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">fuelList===</span><br><span class="line"><span class="number">2</span></span><br><span class="line">(</span><br><span class="line">C7H16</span><br><span class="line">IC8H18</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fuelCoeff1===<span class="number">1</span>(defaultCoeffs)</span><br></pre></td></tr></table></figure><p>算例里的文件片段：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Cd   constant <span class="number">0.88</span>;</span><br></pre></td></tr></table></figure><p>其实这里的 <code>Cd</code> 是读取给一个 <code>TimeFunction1&lt;scalar&gt;</code> 的类型。<br>这里我们强行读取后边的标量：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">scalar Cd_ = <span class="number">0.</span>;</span><br><span class="line"><span class="function">token <span class="title">firstToken</span><span class="params">(modelDict.lookup(<span class="string">"Cd"</span>)[<span class="number">1</span>])</span></span>;</span><br><span class="line"><span class="comment">//这里 lookup 得到一个list，我们取[1]，即后边的 0.88</span></span><br><span class="line"><span class="keyword">if</span> (firstToken.isScalar())</span><br><span class="line">&#123;</span><br><span class="line">    Cd_ = firstToken.scalarToken();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其实“更”正确的用法是：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">TimeFunction1&lt;scalar&gt; <span class="title">Cd2_</span><span class="params">(mesh.time(),<span class="string">"Cd"</span>)</span></span>;</span><br><span class="line">Cd2_.reset(modelDict);</span><br><span class="line">Info&lt;&lt;<span class="string">"Cd2_==="</span>&lt;&lt;Cd2_.value(<span class="number">0.</span>)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">scalar Cd_ = Cd2_.value(<span class="number">0.</span>);</span><br></pre></td></tr></table></figure><p>算例里的文件片段：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="number">37</span> liquids</span><br><span class="line"><span class="number">38</span> &#123;</span><br><span class="line"><span class="number">39</span>   C7H16</span><br><span class="line"><span class="number">40</span>    &#123;</span><br><span class="line"><span class="number">41</span>        defaultCoeffs   yes;</span><br><span class="line"><span class="number">42</span>    &#125;</span><br><span class="line"><span class="number">43</span>    IC8H18</span><br><span class="line"><span class="number">44</span>    &#123;</span><br><span class="line"><span class="number">45</span>        defaultCoeffs   yes;</span><br><span class="line"><span class="number">46</span>    &#125;</span><br><span class="line"><span class="number">47</span> &#125;</span><br></pre></td></tr></table></figure><p>代码：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt;<span class="string">"thermo.subDict(liquids).subDict(C7H16).parent()==="</span>&lt;&lt;thermo.subDict(<span class="string">"liquids"</span>).subDict(<span class="string">"C7H16"</span>).parent()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">Info&lt;&lt;<span class="string">"thermo.subDict(liquids).topDict()==="</span>&lt;&lt;thermo.subDict(<span class="string">"liquids"</span>).topDict()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">Info&lt;&lt;<span class="string">"thermo.subDict(liquids).startLineNumber()==="</span>&lt;&lt;thermo.subDict(<span class="string">"liquids"</span>).startLineNumber()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">Info&lt;&lt;<span class="string">"thermo.subDict(liquids).endLineNumber()==="</span>&lt;&lt;thermo.subDict(<span class="string">"liquids"</span>).endLineNumber()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">Info&lt;&lt;<span class="string">"thermo.subDict(liquids).tokens()==="</span>&lt;&lt;thermo.subDict(<span class="string">"liquids"</span>).tokens()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">Info&lt;&lt;<span class="string">"thermo.subDict(liquids).toc()==="</span>&lt;&lt;thermo.subDict(<span class="string">"liquids"</span>).toc()&lt;&lt;<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure><p>输出：<br><code>parent</code> 返回的是上一级字典。<br><code>topDict</code> 返回的是最顶层的字典。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">thermo.subDict(liquids).startLineNumber()===<span class="number">41</span></span><br><span class="line">thermo.subDict(liquids).endLineNumber()===<span class="number">45</span></span><br><span class="line">thermo.subDict(liquids).tokens()===</span><br><span class="line"><span class="number">12</span></span><br><span class="line">(</span><br><span class="line">C7H16</span><br><span class="line">&#123;</span><br><span class="line">defaultCoeffs</span><br><span class="line">yes</span><br><span class="line">;</span><br><span class="line">&#125;</span><br><span class="line">IC8H18</span><br><span class="line">&#123;</span><br><span class="line">defaultCoeffs</span><br><span class="line">yes</span><br><span class="line">;</span><br><span class="line">&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">thermo.subDict(liquids).toc()===</span><br><span class="line"><span class="number">2</span></span><br><span class="line">(</span><br><span class="line">C7H16</span><br><span class="line">IC8H18</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>tokens</code> 就是这个字典中的所有元素，这里有 12 个元素，包括字符串和标点符号。<br>而 <code>toc</code> 是 <code>keys</code> 一样的？他们的定义如下：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Foam::wordList Foam::dictionary::toc() <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">wordList <span class="title">keys</span><span class="params">(<span class="built_in">size</span>())</span></span>;</span><br><span class="line"></span><br><span class="line">    label nKeys = <span class="number">0</span>;</span><br><span class="line">    forAllConstIter(IDLList&lt;entry&gt;, *<span class="keyword">this</span>, iter)</span><br><span class="line">    &#123;</span><br><span class="line">        keys[nKeys++] = iter().keyword();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> keys;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Foam::List&lt;Foam::keyType&gt; Foam::dictionary::keys(<span class="keyword">bool</span> patterns=<span class="literal">false</span>) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">List&lt;keyType&gt; <span class="title">keys</span><span class="params">(<span class="built_in">size</span>())</span></span>;</span><br><span class="line"></span><br><span class="line">    label nKeys = <span class="number">0</span>;</span><br><span class="line">    forAllConstIter(IDLList&lt;entry&gt;, *<span class="keyword">this</span>, iter)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (iter().keyword().isPattern() ? patterns : !patterns)</span><br><span class="line">        &#123;</span><br><span class="line">            keys[nKeys++] = iter().keyword();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    keys.setSize(nKeys);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> keys;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="踩过的坑"><a class="markdownIt-Anchor" href="#踩过的坑"></a> 踩过的坑</h1><p>我想读取一个文件，但是并行时只想让 master 读取。</p><h2 id="初次尝试"><a class="markdownIt-Anchor" href="#初次尝试"></a> 初次尝试</h2><p>首先构造一个 <code>IOdictionary</code>，NO_READ。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">IOdictionary Dict</span><br><span class="line">(</span><br><span class="line">  IOobject</span><br><span class="line">  (</span><br><span class="line">     &quot;dummyName&quot;,&#x2F;&#x2F;tableName</span><br><span class="line">     path,</span><br><span class="line">     mesh,</span><br><span class="line">     IOobject::NO_READ,</span><br><span class="line">     IOobject::NO_WRITE</span><br><span class="line">  )</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>然后在 master 读取</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">if (onlyMasterRead&amp;&amp;Pstream::parRun())</span><br><span class="line">&#123;</span><br><span class="line">    if (Pstream::master())</span><br><span class="line">    &#123;</span><br><span class="line">        Dict.readOpt() &#x3D; IOobject::MUST_READ;</span><br><span class="line">        Dict.readData(this-&gt;readStream(typeName));</span><br><span class="line">        Dict.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    Dict.readOpt() &#x3D; IOobject::MUST_READ;</span><br><span class="line">    Dict.readData(this-&gt;readStream(typeName));</span><br><span class="line">    Dict.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这段代码在本地测试时没问题，但是提交到超算之后就报错了：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[1] --&gt; FOAM FATAL IO ERROR: </span><br><span class="line">[1] error in IOstream &quot;IOstream&quot; for operation operator&gt;&gt;(Istream&amp;, List&lt;T&gt;&amp;) : reading first token</span><br><span class="line">[1] </span><br><span class="line">[1] file: IOstream at line 0.</span><br><span class="line">[1] </span><br><span class="line">[1]     From function void Foam::IOstream::fatalCheck(const char*) const</span><br><span class="line">[1]     in file db&#x2F;IOstreams&#x2F;IOstreams&#x2F;IOstream.C at line 109.</span><br><span class="line">[1] FOAM parallel run exiting</span><br></pre></td></tr></table></figure><p>注意到这里master没有报这个错，其它核都报了。<br>因此猜测，IOdictionary必须每个核保持一直，不能有差异！</p><h2 id="再次尝试"><a class="markdownIt-Anchor" href="#再次尝试"></a> 再次尝试</h2><p>首先构造一个 <code>IOdictionary</code>，读取一个特别小的 dummyName。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">IOdictionary Dict</span><br><span class="line">(</span><br><span class="line">  IOobject</span><br><span class="line">  (</span><br><span class="line">     &quot;dummyName&quot;,&#x2F;&#x2F;tableName</span><br><span class="line">     path,</span><br><span class="line">     mesh,</span><br><span class="line">     IOobject::MUST_READ,</span><br><span class="line">     IOobject::NO_WRITE</span><br><span class="line">  )</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>然后在 master 读取真正的文件</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">if (onlyMasterRead&amp;&amp;Pstream::parRun())</span><br><span class="line">&#123;</span><br><span class="line">    if (Pstream::master())</span><br><span class="line">    &#123;</span><br><span class="line">        Dict.rename(tableName);</span><br><span class="line">        Dict.readData(this-&gt;readStream(typeName));</span><br><span class="line">        Dict.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    Dict.rename(tableName);</span><br><span class="line">    Dict.readData(this-&gt;readStream(typeName));</span><br><span class="line">    Dict.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>还是和上边一样的问题！</p><h2 id="解决方案"><a class="markdownIt-Anchor" href="#解决方案"></a> 解决方案</h2><p>不用 <code>IOdictionary</code>，而是用 <code>dictionary</code></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">if (onlyMasterRead&amp;&amp;Pstream::parRun())</span><br><span class="line">&#123;</span><br><span class="line">    if (Pstream::master())</span><br><span class="line">    &#123;</span><br><span class="line">        tableValues_ &#x3D; dictionary(IFstream(tablePath+&quot;&#x2F;&quot;+tableName)()).lookupOrDefault&lt;List&lt;scalar&gt;&gt;(tableName, defaultList);</span><br><span class="line">    &#125;</span><br><span class="line">    Pstream::scatter(tableValues_);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    tableValues_ &#x3D; dictionary(IFstream(tablePath+&quot;&#x2F;&quot;+tableName)()).lookupOrDefault&lt;List&lt;scalar&gt;&gt;(tableName, defaultList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;OpenFOAM 中的 dictionary 和 IOdictionary&lt;/p&gt;
    
    </summary>
    
    
      <category term="code" scheme="https://openfoam.top/categories/code/"/>
    
    
      <category term="dictionary" scheme="https://openfoam.top/tags/dictionary/"/>
    
      <category term="IOdictionary" scheme="https://openfoam.top/tags/IOdictionary/"/>
    
  </entry>
  
  <entry>
    <title>OpenFOAM 中的喷雾速度计算</title>
    <link href="https://openfoam.top/sprayVelocity/"/>
    <id>https://openfoam.top/sprayVelocity/</id>
    <published>2019-04-23T22:00:00.000Z</published>
    <updated>2019-11-26T23:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>从数学公式到 C++ 代码分析喷雾粒子速度计算，以及喷雾引起的气相速度源项</p><a id="more"></a><p>本文下标 p 表示 parcel，g 表示 gas，无下标的也是表示环境气体。</p><p><a href="https://research.chalmers.se/en/publication/724" target="_blank" rel="external nofollow noopener noreferrer">Niklas Nordin 博士论文</a>中的公式：</p><p>为了计算粒子的速度，构造速度方程：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>m</mi><mi>p</mi></msub><mfrac><mrow><mi>d</mi><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><msub><mi mathvariant="bold">F</mi><mi mathvariant="bold">p</mi></msub></mrow><annotation encoding="application/x-tex">m_p \dfrac{d \mathbf{u}_p}{d t}=\mathbf{F_p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.972218em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16110799999999997em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">F</mi><mi mathvariant="bold">p</mi></msub><mo>=</mo><mo>−</mo><mfrac><mrow><mi>π</mi><msup><mi>D</mi><mn>2</mn></msup></mrow><mn>8</mn></mfrac><mi>ρ</mi><msub><mi>C</mi><mi>D</mi></msub><mrow><mo fence="true">∣</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo fence="true">∣</mo></mrow><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{F_p}=-\dfrac{\pi D^{2}}{8} \rho C_D\left|\mathbf{u}_{p}-\mathbf{u}\right|\left(\mathbf{u}_{p}-\mathbf{u}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.972218em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16110799999999997em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.177108em;vertical-align:-.686em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">8</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose delimcenter" style="top:0">∣</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose delimcenter" style="top:0">)</span></span></span></span></span></span></p><p>其中：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mi>D</mi></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.15999999999999992em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>24</mn><mrow><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub></mrow></mfrac></mstyle><mrow><mo fence="true">(</mo><mn>1</mn><mo>+</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn><mn>6</mn></mfrac></mstyle><mi>R</mi><msubsup><mi>e</mi><mi>p</mi><mrow><mn>2</mn><mi mathvariant="normal">/</mi><mn>3</mn></mrow></msubsup><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub><mo>&lt;</mo><mn>1000</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.424</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub><mo>&gt;</mo><mn>1000</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">C_D=\left\{\begin{array}{ll}{\dfrac{24}{Re_{p}}\left(1+\dfrac{1}{6} R e_{p}^{2 / 3}\right)} &amp; {Re_p&lt;1000} \\ {0.424} &amp; {Re_p&gt;1000}\end{array}\right.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.6221079999999994em;vertical-align:-1.561054em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em"><span style="top:-2.49999em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-3.15001em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.30002em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0610539999999995em"><span style="top:-4.061054em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">6</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.5834080000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span style="top:-3.2198em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">/</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2526999999999999em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span></span></span></span><span style="top:-2.248946em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord"><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span><span class="mord">2</span><span class="mord">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.561054em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0610539999999995em"><span style="top:-4.061054em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span></span><span style="top:-2.248946em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.561054em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub><mo>=</mo><mfrac><mrow><mi>ρ</mi><mrow><mo fence="true">∣</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo fence="true">∣</mo></mrow><msub><mi>d</mi><mi>p</mi></msub></mrow><msub><mi>μ</mi><mi>g</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">Re_{p}=\dfrac{\rho\left|\mathbf{u}_{p}-\mathbf{u}\right| d_p}{\mu_g}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.399108em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose delimcenter" style="top:0">∣</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>可以推导出：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mi>p</mi></msub><mo>=</mo><mfrac><mrow><mi>d</mi><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mrow><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi></mrow><msub><mi>τ</mi><mi mathvariant="bold">u</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">a_p=\dfrac{d \mathbf{u}_{p}}{d t}=-\dfrac{\mathbf{u}_{p}-\mathbf{u}}{\tau_{\mathbf{u}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.09633em;vertical-align:-.8360000000000001em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.26033em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.161108em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">u</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>τ</mi><mi mathvariant="normal">u</mi></msub><mo>=</mo><mfrac><mrow><mn>8</mn><msub><mi>m</mi><mi>p</mi></msub></mrow><mrow><mi>π</mi><mi>ρ</mi><msub><mi>C</mi><mi>D</mi></msub><msubsup><mi>d</mi><mi>p</mi><mn>2</mn></msubsup><mrow><mo fence="true">∣</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo fence="true">∣</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mn>4</mn><mn>3</mn></mfrac><mfrac><mrow><msub><mi>ρ</mi><mi>p</mi></msub><msub><mi>d</mi><mi>p</mi></msub></mrow><mrow><mi>ρ</mi><msub><mi>C</mi><mi>p</mi></msub><mrow><mo fence="true">∣</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo fence="true">∣</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">\tau_{\mathrm{u}} =\dfrac{8 m_{p}}{\pi \rho C_D d_p^{2}\left|\mathbf{u}_{p}-\mathbf{u}\right|} =\dfrac{4}{3} \dfrac{\rho_{p} d_p}{\rho C_{p}\left|\mathbf{u}_{p}-\mathbf{u}\right|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">u</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.390548em;vertical-align:-1.069108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7401079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose delimcenter" style="top:0">∣</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">8</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.069108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose delimcenter" style="top:0">∣</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">a_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 是粒子的加速度，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">d_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 是粒子的直径。</p><p>可以变形为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi>d</mi><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi></mrow><msub><mi>τ</mi><mi>u</mi></msub></mfrac></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi></mrow><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>4</mn><mn>3</mn></mfrac></mstyle><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><msub><mi>ρ</mi><mi>p</mi></msub><msub><mi>d</mi><mi>p</mi></msub></mrow><mrow><mi>ρ</mi><msub><mi>C</mi><mi>p</mi></msub><mrow><mo fence="true">∣</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo fence="true">∣</mo></mrow></mrow></mfrac></mstyle></mrow></mfrac></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mn>3</mn><mo stretchy="false">(</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo stretchy="false">)</mo><mi>ρ</mi><msub><mi>C</mi><mi>D</mi></msub><mrow><mo fence="true">∣</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo fence="true">∣</mo></mrow></mrow><mrow><mn>4</mn><msub><mi>ρ</mi><mi>p</mi></msub><msub><mi>d</mi><mi>p</mi></msub></mrow></mfrac></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mn>3</mn><mo stretchy="false">(</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo stretchy="false">)</mo><msub><mi>μ</mi><mi>g</mi></msub><msub><mi>C</mi><mi>D</mi></msub></mrow><mrow><mn>4</mn><msub><mi>ρ</mi><mi>p</mi></msub><msup><mi>D</mi><mn>2</mn></msup></mrow></mfrac></mstyle><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi>ρ</mi><mrow><mo fence="true">∣</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo fence="true">∣</mo></mrow><msub><mi>d</mi><mi>p</mi></msub></mrow><msub><mi>μ</mi><mi>g</mi></msub></mfrac></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>3</mn><mn>4</mn></mfrac></mstyle><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><msub><mi>μ</mi><mi>g</mi></msub><msub><mi>C</mi><mi>D</mi></msub><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub></mrow><mrow><msub><mi>ρ</mi><mi>p</mi></msub><msubsup><mi>d</mi><mi>p</mi><mn>2</mn></msubsup></mrow></mfrac></mstyle><mo stretchy="false">(</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo>−</mo><mi mathvariant="bold">u</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{ll} \dfrac{d \mathbf{u}_{p}}{d t}\\ =-\dfrac{\mathbf{u}_p-\mathbf{u}}{\tau_u}\\ =-\dfrac{\mathbf{u}_p-\mathbf{u}}{\dfrac{4}{3} \dfrac{\rho_{p} d_p}{\rho C_{p}\left|\mathbf{u}_{p}-\mathbf{u}\right|}}\\ =-\dfrac{3(\mathbf{u}_p-\mathbf{u})\rho C_D \left|\mathbf{u}_{p}-\mathbf{u}\right|}{4 \rho_p d_p}\\ =-\dfrac{3(\mathbf{u}_p-\mathbf{u})\mu_g C_D}{4\rho_p D^2}\dfrac{\rho\left|\mathbf{u}_{p}-\mathbf{u}\right| d_p}{\mu_g}\\ =-\dfrac{3}{4}\dfrac{\mu_g C_D Re_p}{\rho_p d_p^2}(\mathbf{u}_{p}-\mathbf{u}) \end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:14.875302000000001em;vertical-align:-7.187651em"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.687651000000001em"><span style="top:-9.743211em"><span class="pstrut" style="height:3.427em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-7.796880999999999em"><span class="pstrut" style="height:3.427em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.26033em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-5.700550999999999em"><span class="pstrut" style="height:3.427em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.26033em"><span style="top:-2.11em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose delimcenter" style="top:0">∣</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.6014399999999998em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-4.048439999999999em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.233548em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.0400030000000005em"><span class="pstrut" style="height:3.427em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose">)</span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose delimcenter" style="top:0">∣</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:.35910499999999956em"><span class="pstrut" style="height:3.427em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.740108em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">∣</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose delimcenter" style="top:0">∣</span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:2.691543em"><span class="pstrut" style="height:3.427em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7401079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.069108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:7.187651em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span></span></span></span></span></span></span></p><p>还原到牛顿第二定律中：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mi>p</mi></msub><mo>=</mo><msub><mi>m</mi><mi>p</mi></msub><mfrac><mrow><mi>d</mi><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">F_p = m_p \dfrac{d \mathbf{u}_p}{d t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><msub><mi>m</mi><mi>p</mi></msub><mfrac><mn>3</mn><mn>4</mn></mfrac><mfrac><mrow><msub><mi>μ</mi><mi>g</mi></msub><msub><mi>C</mi><mi>D</mi></msub><mi>R</mi><msub><mi>e</mi><mi>p</mi></msub></mrow><mrow><msub><mi>ρ</mi><mi>p</mi></msub><msubsup><mi>d</mi><mi>p</mi><mn>2</mn></msubsup></mrow></mfrac><mo stretchy="false">(</mo><mi mathvariant="bold">u</mi><mo>−</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">=m_p \dfrac{3}{4}\dfrac{\mu_g C_D Re_p}{\rho_p d_p^2}(\mathbf{u}-\mathbf{u}_{p})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.429438em;vertical-align:-1.069108em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7401079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.069108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">u</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><mfrac><mrow><mn>3</mn><msub><mi>m</mi><mi>p</mi></msub><msub><mi>μ</mi><mi>g</mi></msub><msub><mi>C</mi><mi>D</mi></msub><mi>R</mi><mi>e</mi></mrow><mrow><mn>4</mn><msub><mi>ρ</mi><mi>p</mi></msub><msubsup><mi>d</mi><mi>p</mi><mn>2</mn></msubsup></mrow></mfrac><mo stretchy="false">(</mo><mi mathvariant="bold">u</mi><mo>−</mo><msub><mi mathvariant="bold">u</mi><mi>p</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">=\dfrac{3m_p\mu_gC_DRe}{4\rho_p d_p^2}(\mathbf{u}-\mathbf{u}_{p})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.429438em;vertical-align:-1.069108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7401079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord mathdefault">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.069108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">u</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>以下代码中的 <code>mass</code> 经常是指当前 parcel 中包含的一个 particle 的质量，需要乘以粒子数才等于当前 parcel 的总质量。<br><code>ReactingParcel::calc</code> 中调用：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Explicit momentum source for particle</span></span><br><span class="line"><span class="built_in">vector</span> Su = Zero;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Linearised momentum source coefficient</span></span><br><span class="line">scalar Spu = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Momentum transfer from the particle to the carrier phase</span></span><br><span class="line"><span class="built_in">vector</span> dUTrans = Zero;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Calculate new particle velocity</span></span><br><span class="line"><span class="keyword">this</span>-&gt;U_ =</span><br><span class="line">    <span class="keyword">this</span>-&gt;calcVelocity(cloud, td, dt, Res, mus, mass1, Su, dUTrans, Spu);</span><br></pre></td></tr></table></figure><p><code>KinematicParcel::calcVelocity</code></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ParcelType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">template</span>&lt;class TrackCloudType&gt;</span></span><br><span class="line"><span class="class"><span class="title">const</span> <span class="title">Foam</span>:</span>:<span class="built_in">vector</span> Foam::KinematicParcel&lt;ParcelType&gt;::calcVelocity</span><br><span class="line">(</span><br><span class="line">    TrackCloudType&amp; cloud,</span><br><span class="line">    trackingData&amp; td,</span><br><span class="line">    <span class="keyword">const</span> scalar dt,</span><br><span class="line">    <span class="keyword">const</span> scalar Re,</span><br><span class="line">    <span class="keyword">const</span> scalar mu,</span><br><span class="line">    <span class="keyword">const</span> scalar mass,</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">vector</span>&amp; Su,</span><br><span class="line">    <span class="built_in">vector</span>&amp; dUTrans,</span><br><span class="line">    scalar&amp; Spu</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">typename</span> TrackCloudType::parcelType&amp; p =</span><br><span class="line">        <span class="keyword">static_cast</span>&lt;<span class="keyword">const</span> <span class="keyword">typename</span> TrackCloudType::parcelType&amp;&gt;(*<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">typename</span> TrackCloudType::parcelType::trackingData&amp; ttd =</span><br><span class="line">        <span class="keyword">static_cast</span>&lt;<span class="keyword">typename</span> TrackCloudType::parcelType::trackingData&amp;&gt;(td);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">typename</span> TrackCloudType::forceType&amp; forces = cloud.forces();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Momentum source due to particle forces</span></span><br><span class="line">    <span class="keyword">const</span> forceSuSp Fcp = forces.calcCoupled(p, ttd, dt, mass, Re, mu);</span><br><span class="line">    <span class="keyword">const</span> forceSuSp Fncp = forces.calcNonCoupled(p, ttd, dt, mass, Re, mu);</span><br><span class="line">    <span class="keyword">const</span> scalar massEff = forces.massEff(p, ttd, mass);</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">// Shortcut splitting assuming no implicit non-coupled force ...</span></span><br><span class="line">    <span class="comment">// Calculate the integration coefficients</span></span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">vector</span> acp = (Fcp.Sp()*td.Uc() + Fcp.Su())/massEff;</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">vector</span> ancp = (Fncp.Su() + Su)/massEff;</span><br><span class="line">    <span class="keyword">const</span> scalar bcp = Fcp.Sp()/massEff;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Integrate to find the new parcel velocity</span></span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">vector</span> deltaU = cloud.UIntegrator().delta(U_, dt, acp + ancp, bcp);</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">vector</span> deltaUncp = ancp*dt;</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">vector</span> deltaUcp = deltaU - deltaUncp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate the new velocity and the momentum transfer terms</span></span><br><span class="line">    <span class="built_in">vector</span> Unew = U_ + deltaU;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    dUTrans -= massEff*deltaUcp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Spu = dt*Fcp.Sp();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Apply correction to velocity and dUTrans for reduced-D cases</span></span><br><span class="line">    <span class="keyword">const</span> polyMesh&amp; mesh = cloud.pMesh();</span><br><span class="line">    meshTools::constrainDirection(mesh, mesh.solutionD(), Unew);</span><br><span class="line">    meshTools::constrainDirection(mesh, mesh.solutionD(), dUTrans);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Unew;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>forces.calcCoupled</code> 和 <code>forces.calcNonCoupled</code> 都定义于 <code>ParticleForce</code> 中，但是返回值是 0，在其派生类中重新定义真正的函数，当我们选用 <code>SphereDragForce</code> 时，返回值是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mn>3</mn><msub><mi>m</mi><mi>p</mi></msub><mi>μ</mi><msub><mi>C</mi><mi>D</mi></msub><mi>R</mi><mi>e</mi></mrow><mrow><mn>4</mn><mi>ρ</mi><msubsup><mi>d</mi><mi>p</mi><mn>2</mn></msubsup></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\dfrac{3m_p\mu C_DRe}{4\rho d_p^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.429438em;vertical-align:-1.069108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span><span class="mord mathdefault">ρ</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7401079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">μ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord mathdefault">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.069108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>。</p><p>然后再回到 <code>KinematicParcel::calcVelocity</code>：</p><table><thead><tr><th>代码中的变量</th><th>数学公式</th></tr></thead><tbody><tr><td><code>Fcp</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mn>3</mn><msub><mi>m</mi><mi>p</mi></msub><mi>μ</mi><msub><mi>C</mi><mi>D</mi></msub><mi>R</mi><mi>e</mi></mrow><mrow><mn>4</mn><msub><mi>ρ</mi><mi>p</mi></msub><msubsup><mi>d</mi><mi>p</mi><mn>2</mn></msubsup></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\dfrac{3m_p\mu C_DRe}{4\rho_p d_p^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.429438em;vertical-align:-1.069108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7401079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">μ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord mathdefault">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.069108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></td></tr><tr><td><code>Fncp</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span></span></span></span></td></tr><tr><td><code>massEff</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>m</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">m_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>acp</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">u</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{u}_{c}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.59444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> <code>Fcp</code><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">/</mi><msub><mi>m</mi><mi>p</mi></msub><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mn>3</mn><msub><mi mathvariant="bold">u</mi><mi>c</mi></msub><mi>μ</mi><msub><mi>C</mi><mi>D</mi></msub><mi>R</mi><mi>e</mi></mrow><mrow><mn>4</mn><msub><mi>ρ</mi><mi>p</mi></msub><msubsup><mi>d</mi><mi>p</mi><mn>2</mn></msubsup></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">/m_p=\dfrac{3 \mathbf{u}_{c} \mu C_D Re}{4\rho_p d_p^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord">/</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.4294379999999998em;vertical-align:-1.069108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7401079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">μ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord mathdefault">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.069108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></td></tr><tr><td><code>ancp</code></td><td>0</td></tr><tr><td><code>bcp</code></td><td><code>Fcp</code><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">/</mi><msub><mi>m</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">/m_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord">/</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><code>deltaU</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mtext>Fcp</mtext><msub><mi>m</mi><mi>p</mi></msub></mfrac></mstyle><mo stretchy="false">(</mo><msub><mi mathvariant="bold">u</mi><mi mathvariant="bold">c</mi></msub><mo>−</mo><msub><mi mathvariant="bold">u</mi><mi mathvariant="bold">p</mi></msub><mo stretchy="false">)</mo><mi>d</mi><mi>t</mi><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mn>3</mn><mi>μ</mi><msub><mi>C</mi><mi>D</mi></msub><mi>R</mi><mi>e</mi></mrow><mrow><mn>4</mn><msub><mi>ρ</mi><mi>p</mi></msub><msubsup><mi>d</mi><mi>p</mi><mn>2</mn></msubsup></mrow></mfrac></mstyle><mo stretchy="false">(</mo><msub><mi mathvariant="bold">u</mi><mi mathvariant="bold">c</mi></msub><mo>−</mo><msub><mi mathvariant="bold">u</mi><mi mathvariant="bold">p</mi></msub><mo stretchy="false">)</mo><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\dfrac{\text{Fcp}}{m_p}(\mathbf{u_c}-\mathbf{u_p})dt=\dfrac{3\mu C_DRe}{4\rho_p d_p^2}(\mathbf{u_c}-\mathbf{u_p})dt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">Fcp</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.161108em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16110799999999997em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.4294379999999998em;vertical-align:-1.069108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7401079999999999em"><span style="top:-2.4530000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.383108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span><span class="mord mathdefault">μ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.00773em">R</span><span class="mord mathdefault">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.069108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.161108em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16110799999999997em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span></span></td></tr><tr><td><code>deltaUncp</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span></span></span></span></td></tr><tr><td><code>deltaUcp</code></td><td><code>deltaU</code></td></tr><tr><td><code>dUTrans</code></td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>−</mo><msub><mi>m</mi><mi>d</mi></msub><mo>∗</mo></mrow><annotation encoding="application/x-tex">-m_d*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.73333em;vertical-align:-.15em"></span><span class="mord">−</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">∗</span></span></span></span><code>deltaU</code></td></tr><tr><td><code>Spu</code></td><td><code>dt*Fcp</code></td></tr></tbody></table><p>其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">u</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{u}_{c}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.59444em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathbf">u</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 是粒子当前所在位置的插值气相速度。<br>可以发现这里的 <code>deltaU</code> 与上文提到的文献中的公式是一样的。这就是粒子速度方程了。</p><p>接下来讨论粒子对于气相速度的影响。首先看一下速度输运方程：<br>首先看一下速度输运方程：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">tmp&lt;fvVectorMatrix&gt; tUEqn</span><br><span class="line">(</span><br><span class="line">    fvm::ddt(rho, U) + fvm::div(phi, U)</span><br><span class="line">  + MRF.DDt(rho, U)</span><br><span class="line">  + turbulence-&gt;divDevRhoReff(U)</span><br><span class="line">==</span><br><span class="line">    rho()*g</span><br><span class="line">  + parcels.SU(U)</span><br><span class="line">  + fvOptions(rho, U)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (pimple.momentumPredictor())</span><br><span class="line">&#123;</span><br><span class="line">    solve(UEqn == -fvc::grad(p));</span><br><span class="line"></span><br><span class="line">    fvOptions.correct(U);</span><br><span class="line">    K = <span class="number">0.5</span>*magSqr(U);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>KinematicCloud::SU</code></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Foam</span>:</span>:tmp&lt;Foam::fvVectorMatrix&gt;</span><br><span class="line">Foam::KinematicCloud&lt;CloudType&gt;::SU(volVectorField&amp; U) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (debug)</span><br><span class="line">    &#123;</span><br><span class="line">        Info&lt;&lt; <span class="string">"UTrans min/max = "</span> &lt;&lt; <span class="built_in">min</span>(UTrans()).value() &lt;&lt; <span class="string">", "</span></span><br><span class="line">            &lt;&lt; <span class="built_in">max</span>(UTrans()).value() &lt;&lt; nl</span><br><span class="line">            &lt;&lt; <span class="string">"UCoeff min/max = "</span> &lt;&lt; <span class="built_in">min</span>(UCoeff()).value() &lt;&lt; <span class="string">", "</span></span><br><span class="line">            &lt;&lt; <span class="built_in">max</span>(UCoeff()).value() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (solution_.coupled())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (solution_.semiImplicit(<span class="string">"U"</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">const</span> volScalarField::Internal</span><br><span class="line">                Vdt(mesh_.V()*<span class="keyword">this</span>-&gt;db().time().deltaT());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> UTrans()/Vdt - fvm::Sp(UCoeff()/Vdt, U) + UCoeff()/Vdt*U;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            tmp&lt;fvVectorMatrix&gt; tfvm(<span class="keyword">new</span> fvVectorMatrix(U, dimForce));</span><br><span class="line">            fvVectorMatrix&amp; fvm = tfvm.ref();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            fvm.source() = -UTrans()/(<span class="keyword">this</span>-&gt;db().time().deltaT());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> tfvm;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> tmp&lt;fvVectorMatrix&gt;(<span class="keyword">new</span> fvVectorMatrix(U, dimForce));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ReactingParcel::calc</code> 中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Transfer mass lost to carrier mass, momentum and enthalpy sources</span></span><br><span class="line">forAll(dMass, i)</span><br><span class="line">&#123;</span><br><span class="line">    scalar dm = np0*dMass[i];</span><br><span class="line">    label gid = composition.localToCarrierId(<span class="number">0</span>, i);</span><br><span class="line">    scalar hs = composition.carrier().Hs(gid, td.pc(), T0);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    cloud.rhoTrans(gid)[<span class="keyword">this</span>-&gt;cell()] += dm;</span><br><span class="line">    cloud.UTrans()[<span class="keyword">this</span>-&gt;cell()] += dm*U0;</span><br><span class="line">    cloud.hsTrans()[<span class="keyword">this</span>-&gt;cell()] += dm*hs;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Update momentum transfer</span></span><br><span class="line">cloud.UTrans()[<span class="keyword">this</span>-&gt;cell()] += np0*dUTrans;</span><br><span class="line">cloud.UCoeff()[<span class="keyword">this</span>-&gt;cell()] += np0*Spu;</span><br><span class="line"><span class="comment">// np0 是当前 parcel 中的粒子数</span></span><br></pre></td></tr></table></figure><p>再看一下文献：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo stretchy="true">‾</mo></mover><msub><mover accent="true"><mi>u</mi><mo>~</mo></mover><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo stretchy="true">‾</mo></mover><msub><mover accent="true"><mi>u</mi><mo>~</mo></mover><mi>i</mi></msub><msub><mover accent="true"><mi>u</mi><mo>~</mo></mover><mi>j</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>p</mi><mo stretchy="true">‾</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mover accent="true"><mi>τ</mi><mo stretchy="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo stretchy="true">‾</mo></mover><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><msub><mover accent="true"><mover accent="true"><mi>S</mi><mo>˙</mo></mover><mo stretchy="true">‾</mo></mover><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\frac{\partial \overline{\rho} \tilde{u}_{i}}{\partial t}+\frac{\partial \overline{\rho} \tilde{u}_{i} \tilde{u}_{j}}{\partial x_{j}}=-\frac{\partial \overline{p}}{\partial x_{i}}+\frac{\partial \overline{\tau}_{i j}}{\partial x_{j}}-\frac{\partial \overline{\rho} \Gamma_{i j}}{\partial x_{j}}+\overline{\dot{S}}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6678599999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">u</span></span></span><span style="top:-3.35em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6678599999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">u</span></span></span><span style="top:-3.35em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6678599999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">u</span></span></span><span style="top:-3.35em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.22222em">~</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">p</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">ρ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.27019em;vertical-align:-.15em"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.12019em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9201900000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span></span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.055550000000000016em">˙</span></span></span></span></span></span></span></span><span style="top:-4.04019em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mover accent="true"><mi>S</mi><mo>˙</mo></mover><mo stretchy="true">‾</mo></mover><mi>i</mi></msub><mo>=</mo><mfrac><mn>1</mn><msub><mi>V</mi><mi>f</mi></msub></mfrac><munderover><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mi>p</mi></mrow></munderover><mrow><mo fence="true">(</mo><msub><mi>n</mi><mrow><mi>d</mi><mo separator="true">,</mo><mi>m</mi></mrow></msub><msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><mrow><mi>d</mi><mo separator="true">,</mo><mi>m</mi></mrow></msub><msub><mi>u</mi><mrow><mi>d</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mi>m</mi></mrow></msub><mo>−</mo><msub><mi>n</mi><mrow><mi>d</mi><mo separator="true">,</mo><mi>m</mi></mrow></msub><msub><mi>F</mi><mrow><mi>d</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mi>m</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\overline{\dot{S}}_{i}=\frac{1}{V_{f}} \sum_{m=1}^{n p} \left(n_{d, m} \dot{m}_{d, m} u_{d, i, m}-n_{d, m} F_{d, i, m}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.27019em;vertical-align:-.15em"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.12019em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9201900000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span></span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.055550000000000016em">˙</span></span></span></span></span></span></span></span><span style="top:-4.04019em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.965618em;vertical-align:-1.267113em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6985050000000004em"><span style="top:-1.882887em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.347113em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0">)</span></span></span></span></span></span></p><p>可以发现公式第一部分是液滴蒸发变成气相带来的速度，第二部分是液滴和气相之间的相互作用力。这两部分分别对应代码中的 <code>dm*U0</code> 和 <code>np0*dUTrans</code>。 其中的 <code>dUTrans</code> 在 <code>KinematicParcel::calcVelocity</code> 中计算：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>U</mi><mi>T</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo>=</mo><mo>−</mo><msub><mi>m</mi><mi>p</mi></msub><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>U</mi></mrow><annotation encoding="application/x-tex">dUTrans=-m_pdeltaU</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:.10903em">U</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord">−</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.10903em">U</span></span></span></span>。然后文献中的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mo>=</mo><msub><mi>m</mi><mi>d</mi></msub><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>U</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">F=m_d\dfrac{deltaU}{dt}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.13889em">F</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.10903em">U</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>。这是所有 parcel 的合力，即 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mi>i</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mi>p</mi></mrow></msubsup><msub><mi>F</mi><mrow><mi>d</mi><mo separator="true">,</mo><mi>i</mi><mo separator="true">,</mo><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">F_i=\sum_{m=1}^{n p} F_{d,i,m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-.29971000000000003em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.804292em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029000000000005em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>，这里的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65952em;vertical-align:0"></span><span class="mord mathdefault">i</span></span></span></span> 表示力的三个方向，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathdefault">m</span></span></span></span> 表示对所有 parcel 循环，np 是当前网格 parcel 的个数。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>n</mi><mrow><mi>d</mi><mo separator="true">,</mo><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">n_{d,m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 表示第 m 个 parcel 中 particle 的个数，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>cot</mi><mo>⁡</mo><msub><mi>m</mi><mrow><mi>d</mi><mo separator="true">,</mo><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\cot m_{d,m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9011879999999999em;vertical-align:-.286108em"></span><span class="mop">cot</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 表示第 m 个 parcel 的蒸发速率，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>u</mi><mrow><mi>d</mi><mo separator="true">,</mo><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">u_{d,m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 表示第 m 个 parcel 的速度。</p><p>事实上，代码中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">UTrans = dm*U0 + np0*dUTrans</span><br><span class="line"><span class="comment">//dm是蒸发出来的总质量（已经乘过np0了），np0是当前parcel所包含的particle个数</span></span><br><span class="line">SU.source() = - UTrans/deltaT = - (dm*U0 + np0*dUTrans)/deltaT </span><br><span class="line">= - (dm*U0 - np0*m*deltaU)/deltaT</span><br><span class="line">= - (dm/deltaT*U0 - np0*m*deltaU/deltaT)</span><br></pre></td></tr></table></figure><p><code>SU.source()</code><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><mo>−</mo><mo stretchy="false">(</mo><msub><mi>n</mi><mi>d</mi></msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><msub><mi>u</mi><mi>d</mi></msub><mo>−</mo><mi>F</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">=-(n_d\dot m u_d - F)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">−</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.13889em">F</span><span class="mclose">)</span></span></span></span></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;从数学公式到 C++ 代码分析喷雾粒子速度计算，以及喷雾引起的气相速度源项&lt;/p&gt;
    
    </summary>
    
    
      <category term="code" scheme="https://openfoam.top/categories/code/"/>
    
    
      <category term="Lagrangian" scheme="https://openfoam.top/tags/Lagrangian/"/>
    
  </entry>
  
  <entry>
    <title>OpenFOAM 速度输运方程中的应力张量项</title>
    <link href="https://openfoam.top/shearRateTensor/"/>
    <id>https://openfoam.top/shearRateTensor/</id>
    <published>2019-04-20T22:00:00.000Z</published>
    <updated>2019-04-21T22:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>无摘要</p><a id="more"></a><h2 id="速度输运方程"><a class="markdownIt-Anchor" href="#速度输运方程"></a> 速度输运方程</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">tmp&lt;fvVectorMatrix&gt; tUEqn</span><br><span class="line">(</span><br><span class="line">    fvm::ddt(rho, U) + fvm::div(phi, U)</span><br><span class="line">  + turbulence-&gt;divDevRhoReff(U)</span><br><span class="line"> ==</span><br><span class="line">  - fvc::grad(p)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>对应的公式：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo stretchy="false">(</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><mo>−</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><mrow><msubsup><mi>u</mi><mi>i</mi><mo mathvariant="normal">′</mo></msubsup><msubsup><mi>u</mi><mi>j</mi><mo mathvariant="normal">′</mo></msubsup></mrow><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{ \partial }{ \partial t }( \bar\rho\widetilde{u_i} ) + \frac{ \partial\bar\rho\widetilde{u_i}\widetilde{u_j} }{ \partial x_j } = \frac{ \partial \overline \sigma _{ij} }{ \partial x_j } + \frac{ \partial }{ \partial x_j}( -\bar\rho\widetilde{ u&#x27;_iu&#x27;_j } )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord">−</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.019692em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.27686399999999994em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.733692em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>其中公式中的粘性应力<br><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mover accent="true"><mi>τ</mi><mo stretchy="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mover accent="true"><mi>p</mi><mo stretchy="true">‾</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>2</mn><mi>μ</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>S</mi><mo stretchy="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><msub><mover accent="true"><mi>S</mi><mo stretchy="true">‾</mo></mover><mrow><mi>k</mi><mi>k</mi></mrow></msub><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo>−</mo><mover accent="true"><mi>p</mi><mo stretchy="true">‾</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\overline \sigma _{ij} = \overline\tau_{ij} - \overline p\delta_{ij} = 2\mu( \overline S_{ij} - \frac{1}{3}\overline S_{kk}\delta_{ij} ) - \overline p\delta_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.916668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.916668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.1132em">τ</span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">p</span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.169438em;vertical-align:-.286108em"></span><span class="mord">2</span><span class="mord mathdefault">μ</span><span class="mopen">(</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8833300000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em">S</span></span><span style="top:-3.80333em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.2283300000000001em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8833300000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em">S</span></span><span style="top:-3.80333em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">p</span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>。</p><p>雷诺应力<br><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo>−</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><mrow><msubsup><mi>u</mi><mi>i</mi><mo mathvariant="normal">′</mo></msubsup><msubsup><mi>u</mi><mi>j</mi><mo mathvariant="normal">′</mo></msubsup></mrow><mo stretchy="true">~</mo></mover></mrow><annotation encoding="application/x-tex">\Gamma_{ij}=-\bar\rho \widetilde {u&#x27;_iu_j&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.432664em;vertical-align:-.4129719999999999em"></span><span class="mord">−</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.019692em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.27686399999999994em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.733692em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span></span></span></span>，<br>根据 Boussinesq 假设：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><msub><mi mathvariant="normal">Γ</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>2</mn><msub><mi>μ</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mover accent="true"><msub><mi>S</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo stretchy="true">~</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Gamma_{ij}-\frac{1}{3}\Gamma_{kk}\delta_{ij}=2\mu_t(\widetilde{S_{ij}}-\frac{1}{3}\widetilde{S_{kk}}\delta_{ij})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.229438em;vertical-align:-.286108em"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.28833em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，这里简化成了不可压版本：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>2</mn><msub><mi>μ</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mover accent="true"><msub><mi>S</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo stretchy="true">~</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Gamma_{ij}=2\mu_t(\widetilde{S_{ij}}-\frac{1}{3}\widetilde{S_{kk}}\delta_{ij})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.229438em;vertical-align:-.286108em"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.28833em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>。</p><p>这个 <code>turbulence-&gt;divDevRhoReff(U)</code> 就是公式中的粘性应力和雷诺应力移到方程左边了。<br>下面详细解释了这个过程：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">BasicTurbulenceModel</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:tmp&lt;Foam::fvVectorMatrix&gt;</span><br><span class="line">Foam::linearViscousStress&lt;BasicTurbulenceModel&gt;::divDevRhoReff</span><br><span class="line">(</span><br><span class="line">    volVectorField&amp; U</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">    (</span><br><span class="line">      - fvc::div((<span class="keyword">this</span>-&gt;alpha_*<span class="keyword">this</span>-&gt;rho_*<span class="keyword">this</span>-&gt;nuEff())*dev2(T(fvc::grad(U))))</span><br><span class="line">      - fvm::laplacian(<span class="keyword">this</span>-&gt;alpha_*<span class="keyword">this</span>-&gt;rho_*<span class="keyword">this</span>-&gt;nuEff(), U)</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>代码中表示的公式是</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mrow><mo fence="true">(</mo><mi>ρ</mi><mo>∗</mo><msub><mi>ν</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><mrow><mo fence="true">(</mo><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>2</mn><mn>3</mn></mfrac></mstyle><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mo stretchy="false">(</mo><mi>ρ</mi><mo>∗</mo><msub><mi>ν</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mo>−</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mrow><mo fence="true">(</mo><mi>ρ</mi><mo>∗</mo><msub><mi>ν</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><mo>+</mo><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo stretchy="false">)</mo><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>2</mn><mn>3</mn></mfrac></mstyle><mi>ρ</mi><mo>∗</mo><msub><mi>ν</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mo>−</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mrow><mo fence="true">(</mo><mi>ρ</mi><mo>∗</mo><msub><mi>ν</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><mo>+</mo><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo stretchy="false">)</mo><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>2</mn><mn>3</mn></mfrac></mstyle><mi>ρ</mi><mo>∗</mo><msub><mi>ν</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi mathvariant="bold">u</mi><mo stretchy="false">)</mo><mi mathvariant="bold">I</mi><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mo>−</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mrow><mo fence="true">(</mo><mn>2</mn><mi>ρ</mi><mo>∗</mo><msub><mi>ν</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>2</mn><mn>3</mn></mfrac></mstyle><mi>ρ</mi><mo>∗</mo><msub><mi>ν</mi><mrow><mi>e</mi><mi>f</mi><mi>f</mi></mrow></msub><msub><mi>S</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mo>−</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mrow><mo fence="true">(</mo><mn>2</mn><mi>ρ</mi><mo>∗</mo><mo stretchy="false">(</mo><mi>ν</mi><mo>+</mo><msub><mi>ν</mi><mi>t</mi></msub><mo stretchy="false">)</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>2</mn><mn>3</mn></mfrac></mstyle><mi>ρ</mi><mo>∗</mo><mo stretchy="false">(</mo><mi>ν</mi><mo>+</mo><msub><mi>ν</mi><mi>t</mi></msub><mo stretchy="false">)</mo><msub><mi>S</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mo>−</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mo stretchy="false">(</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{ll} &amp;-\nabla\cdot\left(\rho*\nu_{eff}\left((\nabla\otimes\mathbf{u})^T-\dfrac{2}{3}tr(\nabla\otimes\mathbf{u})^T\right)\right)\\ &amp;-\nabla\cdot(\rho*\nu_{eff}\nabla\otimes\mathbf{u})\\ &amp;=-\nabla\cdot \left( \rho*\nu_{eff}(\nabla\otimes\mathbf{u}+(\nabla\otimes\mathbf{u})^T)-\dfrac{2}{3}\rho*\nu_{eff} tr(\nabla\otimes\mathbf{u})^T \right)\\ &amp;=-\nabla\cdot \left( \rho*\nu_{eff}(\nabla\otimes\mathbf{u}+(\nabla\otimes\mathbf{u})^T)-\dfrac{2}{3}\rho*\nu_{eff}(\nabla \cdot \mathbf{u})\mathbf{I} \right)\\ &amp;=-\nabla\cdot \left( 2\rho*\nu_{eff}S_{ij}-\dfrac{2}{3}\rho*\nu_{eff}S_{kk}\delta_{ij} \right)\\ &amp;=-\nabla\cdot \left( 2\rho*(\nu+\nu_t)S_{ij}-\dfrac{2}{3}\rho*(\nu+\nu_t)S_{kk}\delta_{ij} \right)\\ &amp;=-\nabla\cdot(\tau_{ij}+\Gamma_{ij}) \end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:14.40015em;vertical-align:-6.950075em"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.450074999999999em"><span style="top:-9.450075em"><span class="pstrut" style="height:3.45em"></span><span class="mord"></span></span><span style="top:-7.660044999999999em"><span class="pstrut" style="height:3.45em"></span><span class="mord"></span></span><span style="top:-5.850045em"><span class="pstrut" style="height:3.45em"></span><span class="mord"></span></span><span style="top:-3.4500149999999996em"><span class="pstrut" style="height:3.45em"></span><span class="mord"></span></span><span style="top:-1.0499849999999995em"><span class="pstrut" style="height:3.45em"></span><span class="mord"></span></span><span style="top:1.3500449999999997em"><span class="pstrut" style="height:3.45em"></span><span class="mord"></span></span><span style="top:3.140075em"><span class="pstrut" style="height:3.45em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.950075em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.450074999999999em"><span style="top:-9.450075em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord">−</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.06366em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:-7.660044999999999em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord">−</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mopen">(</span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.06366em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose">)</span></span></span><span style="top:-5.850045em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.06366em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.06366em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:-3.4500149999999996em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.06366em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.06366em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose">)</span><span class="mord"><span class="mord mathbf">I</span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:-1.0499849999999995em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord">2</span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.06366em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.06366em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span><span class="mord mathdefault mtight" style="margin-right:.10764em">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:1.3500449999999997em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord">2</span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-.06366em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.06366em">ν</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-.06366em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:3.140075em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord">−</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.950075em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><mo>=</mo><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac></mstyle></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\nabla\otimes\mathbf{u}= \left( \begin{matrix} \dfrac{\partial u}{\partial x}&amp;\dfrac{\partial u}{\partial y}&amp;\dfrac{\partial u}{\partial z}\\ \dfrac{\partial v}{\partial x}&amp;\dfrac{\partial v}{\partial y}&amp;\dfrac{\partial v}{\partial z}\\ \dfrac{\partial w}{\partial x}&amp;\dfrac{\partial w}{\partial y}&amp;\dfrac{\partial w}{\partial z} \end{matrix} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.76666em;vertical-align:-.08333em"></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.44444em;vertical-align:0"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:6.75564em;vertical-align:-3.12782em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.550045em"><span style="top:-.7499750000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎝</span></span></span><span style="top:-1.9049850000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-2.5049950000000005em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-3.1050050000000002em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-3.705015em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-4.305025em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-5.550045em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎛</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.050045em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.62782em"><span style="top:-5.62782em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.37594em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.12406em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.12782em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.62782em"><span style="top:-5.62782em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.37594em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.12406em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.12782em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.62782em"><span style="top:-5.62782em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.37594em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.12406em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.12782em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.550045em"><span style="top:-.7499750000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎠</span></span></span><span style="top:-1.9049850000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-2.5049950000000005em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-3.1050050000000002em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-3.705015em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-4.305025em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-5.550045em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.050045em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>=</mo><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac></mstyle></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">(\nabla\otimes\mathbf{u})^T= \left( \begin{matrix} \dfrac{\partial u}{\partial x}&amp;\dfrac{\partial v}{\partial x}&amp;\dfrac{\partial w}{\partial x}\\ \dfrac{\partial u}{\partial y}&amp;\dfrac{\partial v}{\partial y}&amp;\dfrac{\partial w}{\partial y}\\ \dfrac{\partial u}{\partial z}&amp;\dfrac{\partial v}{\partial z}&amp;\dfrac{\partial w}{\partial z} \end{matrix} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913309999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:6.36676em;vertical-align:-2.93338em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25004em"><span style="top:-1.0499800000000006em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎝</span></span></span><span style="top:-2.2049900000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-2.805em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-3.4050100000000003em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-4.00502em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-5.250039999999999em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎛</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75004em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.43338em"><span style="top:-5.43338em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.3759399999999995em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.1240599999999996em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.93338em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.43338em"><span style="top:-5.43338em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.3759399999999995em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.1240599999999996em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.93338em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.43338em"><span style="top:-5.43338em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.3759399999999995em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.1240599999999996em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.93338em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25004em"><span style="top:-1.0499800000000006em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎠</span></span></span><span style="top:-2.2049900000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-2.805em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-3.4050100000000003em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-4.00502em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-5.250039999999999em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75004em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><mo stretchy="false">)</mo><mo>=</mo><mi>t</mi><mi>r</mi><mrow><mo fence="true">(</mo><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>k</mi></msub></mrow></mfrac><mo>=</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi mathvariant="bold">u</mi><mo>=</mo><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">tr(\nabla\otimes\mathbf{u})=tr\left((\nabla\otimes\mathbf{u})^T\right)=\dfrac{\partial u_k}{\partial x_k}=\nabla \cdot \mathbf{u}=tr(S_{ij})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.2413409999999998em;vertical-align:-.35001em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">(</span></span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913309999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.44444em;vertical-align:0"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>strain rate <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">S_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> :</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>j</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo fence="true">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><mo>+</mo><mo stretchy="false">(</mo><mi mathvariant="normal">∇</mi><mo>⊗</mo><mi mathvariant="bold">u</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">S_{ij}=\frac{1}{2}( \frac{ \partial u_i }{ \partial x_j } + \frac {\partial u_j }{ \partial x_i } )=\dfrac{1}{2}\left(\nabla\otimes\mathbf{u}+(\nabla\otimes\mathbf{u})^T\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size1">(</span></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mopen">(</span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913309999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size1">)</span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo stretchy="false">(</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle><mo>+</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo stretchy="false">(</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>u</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac></mstyle><mo>+</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo stretchy="false">(</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>v</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac></mstyle><mo>+</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mn>31</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mn>32</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac></mstyle></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">S_{ij}= \left( \begin{matrix} \dfrac{\partial u}{\partial x}&amp;\dfrac{1}{2}(\dfrac{\partial u}{\partial y}+\dfrac{\partial v}{\partial x})&amp;\dfrac{1}{2}(\dfrac{\partial u}{\partial z}+\dfrac{\partial w}{\partial x})\\ S_{21}&amp;\dfrac{\partial v}{\partial y}&amp;\dfrac{1}{2}(\dfrac{\partial v}{\partial z}+\dfrac{\partial w}{\partial y})\\ S_{31}&amp;S_{32}&amp;\dfrac{\partial w}{\partial z} \end{matrix} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:6.60009em;vertical-align:-3.050045em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.550045em"><span style="top:-.7499750000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎝</span></span></span><span style="top:-1.9049850000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-2.5049950000000005em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-3.1050050000000002em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-3.705015em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-4.305025em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎜</span></span></span><span style="top:-5.550045em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎛</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.050045em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5305999999999997em"><span style="top:-5.5306em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.27872em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-1.02684em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.0305999999999997em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5305999999999997em"><span style="top:-5.5306em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span style="top:-3.27872em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.02684em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.0305999999999997em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5305999999999997em"><span style="top:-5.5306em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span style="top:-3.27872em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.03588em">y</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span style="top:-1.02684em"><span class="pstrut" style="height:3.3714399999999998em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault" style="margin-right:.02691em">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.0305999999999997em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.550045em"><span style="top:-.7499750000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎠</span></span></span><span style="top:-1.9049850000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-2.5049950000000005em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-3.1050050000000002em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-3.705015em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-4.305025em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎟</span></span></span><span style="top:-5.550045em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.050045em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">S_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 是对称矩阵，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mn>12</mn></msub><mo>=</mo><msub><mi>S</mi><mn>21</mn></msub><mo separator="true">,</mo><mtext> </mtext><msub><mi>S</mi><mn>13</mn></msub><mo>=</mo><msub><mi>S</mi><mn>31</mn></msub><mo separator="true">,</mo><mtext> </mtext><msub><mi>S</mi><mn>23</mn></msub><mo>=</mo><msub><mi>S</mi><mn>32</mn></msub></mrow><annotation encoding="application/x-tex">S_{12}=S_{21},\ S_{13}=S_{31},\ S_{23} = S_{32}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8777699999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace"> </span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8777699999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace"> </span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>。</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>S</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>k</mi></msub></mrow></mfrac></mstyle><mo>=</mo><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi mathvariant="bold">u</mi></mrow><annotation encoding="application/x-tex">tr(S_{ij})=S_{kk}=\dfrac{\partial u_k}{\partial x_k}=\nabla\cdot \mathbf{u}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.44444em;vertical-align:0"></span><span class="mord"><span class="mord mathbf">u</span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">S_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 在代码中是：<code>symm(fvc::grad(U))</code>，其中 <code>symm(tensor) = 1/2*(tensor + T(tensor))</code>。</p><p>deformation rate tensor <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>S</mi><mn>11</mn></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mo stretchy="false">(</mo><msub><mi>S</mi><mn>11</mn></msub><mo>+</mo><msub><mi>S</mi><mn>22</mn></msub><mo>+</mo><msub><mi>S</mi><mn>33</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mn>12</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mn>13</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>S</mi><mn>22</mn></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mo stretchy="false">(</mo><msub><mi>S</mi><mn>11</mn></msub><mo>+</mo><msub><mi>S</mi><mn>22</mn></msub><mo>+</mo><msub><mi>S</mi><mn>33</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mn>23</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mn>31</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>S</mi><mn>32</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>S</mi><mn>33</mn></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mo stretchy="false">(</mo><msub><mi>S</mi><mn>11</mn></msub><mo>+</mo><msub><mi>S</mi><mn>22</mn></msub><mo>+</mo><msub><mi>S</mi><mn>33</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>=</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mi mathvariant="normal">∇</mi><mo>⋅</mo><mi mathvariant="bold">u</mi><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{ll} &amp;D_{ij}= S_{ij}-\frac{1}{3}tr(S_{ij})\\ &amp;= \left( \begin{matrix} S_{11}-\frac{1}{3}(S_{11}+S_{22}+S_{33}) &amp; S_{12} &amp; S_{13} \\ S_{21} &amp; S_{22}-\frac{1}{3}(S_{11}+S_{22}+S_{33}) &amp; S_{23} \\ S_{31} &amp; S_{32} &amp; S_{33}-\frac{1}{3}(S_{11}+S_{22}+S_{33}) \end{matrix} \right) \\ &amp;=S_{ij}-\frac{1}{3}\nabla\cdot \mathbf{u} \delta_{ij} \end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.02554em;vertical-align:-2.76277em"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.26277em"><span style="top:-6.475324em"><span class="pstrut" style="height:4.057662em"></span><span class="mord"></span></span><span style="top:-4.0576620000000005em"><span class="pstrut" style="height:4.057662em"></span><span class="mord"></span></span><span style="top:-1.6548919999999996em"><span class="pstrut" style="height:4.057662em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.76277em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.26277em"><span style="top:-6.475324em"><span class="pstrut" style="height:4.057662em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-4.0576620000000005em"><span class="pstrut" style="height:4.057662em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em"><span style="top:-2.2500000000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎝</span></span></span><span style="top:-4.05002em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎛</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0576619999999997em"><span style="top:-4.212554em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.0074459999999994em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-1.8023379999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5576620000000005em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0576619999999997em"><span style="top:-4.212554em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.0074459999999994em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-1.8023379999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5576620000000005em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span><span class="arraycolsep" style="width:.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0576619999999997em"><span style="top:-4.212554em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.0074459999999994em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-1.8023379999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5576620000000005em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em"><span style="top:-2.2500000000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎠</span></span></span><span style="top:-4.05002em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em"><span></span></span></span></span></span></span></span></span></span><span style="top:-1.6548919999999996em"><span class="pstrut" style="height:4.057662em"></span><span class="mord"><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∇</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.76277em"><span></span></span></span></span></span><span class="arraycolsep" style="width:.5em"></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 在代码中是：<code>dev(symm(fvc::grad(U)))</code>，也就是 <code>dev(S_{ij})</code>。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">Cmpt</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Tensor</span> &lt;Cmpt&gt; <span class="title">dev</span>(<span class="title">const</span> <span class="title">Tensor</span> &lt;Cmpt &gt;&amp; <span class="title">t</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">return</span> t - SphericalTensor &lt;Cmpt &gt;::oneThirdsI*tr(t);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">Cmpt</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Tensor</span> &lt;Cmpt&gt; <span class="title">dev2</span>(<span class="title">const</span> <span class="title">Tensor</span> &lt;Cmpt &gt;&amp; <span class="title">t</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">return</span> t - SphericalTensor &lt;Cmpt &gt;::twoThirdsI*tr(t);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>参考文献：<br>Tobias Holzmann. Mathematics, Numerics, Derivations and OpenFOAM®, Holzmann CFD,<br>URL <a href="http://www.holzmann-cfd.de" target="_blank" rel="external nofollow noopener noreferrer">www.holzmann-cfd.de</a>, DOI: 10.13140/RG.2.2.27193.36960.</p><p>以下公式适用于可压缩流动：</p><p>Cauchy stress tensor <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>σ</mi><mo>=</mo><mi>σ</mi><mo>=</mo><mo>−</mo><mi>p</mi><mi mathvariant="bold">I</mi><mo>+</mo><mo stretchy="false">[</mo><mi>σ</mi><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">)</mo><mi mathvariant="bold">I</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbf{\sigma}=\mathbf{\sigma}=-p\mathbf{I}+[\mathbf{\sigma}-\frac{1}{3}tr(\mathbf{\sigma})\mathbf{I}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8805499999999999em;vertical-align:-.19444em"></span><span class="mord">−</span><span class="mord mathdefault">p</span><span class="mord"><span class="mord mathbf">I</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span class="mclose">)</span><span class="mord"><span class="mord mathbf">I</span></span><span class="mclose">]</span></span></span></span></p><p>shear−rate tensor <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>τ</mi><mo>=</mo><mi>σ</mi><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">)</mo><mi mathvariant="bold">I</mi><mo>=</mo><msup><mi>σ</mi><mrow><mi>d</mi><mi>e</mi><mi>v</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{\tau}=\mathbf{\sigma}-\frac{1}{3}tr(\mathbf{\sigma})\mathbf{I}=\mathbf{\sigma}^{dev}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span class="mclose">)</span><span class="mord"><span class="mord mathbf">I</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.849108em;vertical-align:0"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.849108em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:.03588em">v</span></span></span></span></span></span></span></span></span></span></span></span></p><p>即：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>σ</mi><mo>=</mo><mo>−</mo><mi>p</mi><mi mathvariant="bold">I</mi><mo>+</mo><mi>τ</mi></mrow><annotation encoding="application/x-tex">\mathbf{\sigma}=-p\mathbf{I}+\mathbf{\tau}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8805499999999999em;vertical-align:-.19444em"></span><span class="mord">−</span><span class="mord mathdefault">p</span><span class="mord"><span class="mord mathbf">I</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span></span></span></span></span></p><p>Reynolds-Stress tensor<br><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mi>t</mi></msub><mo>=</mo><mo>−</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><mrow><msubsup><mi>u</mi><mi>i</mi><mo mathvariant="normal">′</mo></msubsup><msubsup><mi>u</mi><mi>j</mi><mo mathvariant="normal">′</mo></msubsup></mrow><mo stretchy="true">~</mo></mover></mrow><annotation encoding="application/x-tex">\overline \mathbf{\sigma}_t=-\bar\rho \widetilde {u&#x27;_iu_j&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.78056em;vertical-align:-.15em"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.432664em;vertical-align:-.4129719999999999em"></span><span class="mord">−</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.019692em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.27686399999999994em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.733692em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span></span></span></span></p><p>Boussinesq 假设：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mi>t</mi></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><msub><mi>μ</mi><mi>t</mi></msub><mover accent="true"><mi mathvariant="bold">D</mi><mo>ˉ</mo></mover><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mover accent="true"><mi mathvariant="bold">D</mi><mo>ˉ</mo></mover><mo stretchy="false">)</mo><mi mathvariant="bold">I</mi></mrow><annotation encoding="application/x-tex">\overline \mathbf{\sigma}_t-\frac{1}{3}tr(\overline \mathbf{\sigma}_t)=2\mu_t \bar \mathbf{D}-\frac{2}{3}tr(\bar \mathbf{D})\mathbf{I}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.78056em;vertical-align:-.15em"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.0173299999999998em;vertical-align:-.19444em"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8228899999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">D</span></span></span><span style="top:-3.25511em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8228899999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">D</span></span></span><span style="top:-3.25511em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em">ˉ</span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathbf">I</span></span></span></span></span></span></p><p>这里的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi mathvariant="bold">D</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar \mathbf{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8228899999999999em;vertical-align:0"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8228899999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">D</span></span></span><span style="top:-3.25511em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em">ˉ</span></span></span></span></span></span></span></span></span> 是变形速率张量，deformation rate tensor，一般也称为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">S_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mo>−</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><mrow><msubsup><mi>u</mi><mi>i</mi><mo mathvariant="normal">′</mo></msubsup><msubsup><mi>u</mi><mi>j</mi><mo mathvariant="normal">′</mo></msubsup></mrow><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mo>−</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><mrow><msup><mi>u</mi><mo mathvariant="normal">′</mo></msup><msup><mi>u</mi><mo mathvariant="normal">′</mo></msup></mrow><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mo>−</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><mrow><msup><mi>v</mi><mo mathvariant="normal">′</mo></msup><msup><mi>v</mi><mo mathvariant="normal">′</mo></msup></mrow><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mo>−</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><mrow><msup><mi>w</mi><mo mathvariant="normal">′</mo></msup><msup><mi>w</mi><mo mathvariant="normal">′</mo></msup></mrow><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mn>2</mn><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mi mathvariant="bold">I</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">tr(\overline \mathbf{\sigma}_t)=tr(-\bar\rho \widetilde {u&#x27;_iu_j&#x27;}) =(-\bar\rho \widetilde {u&#x27;u&#x27;})+(-\bar\rho \widetilde {v&#x27;v&#x27;})+(-\bar\rho \widetilde {w&#x27;w&#x27;})=-2\bar\rho \mathbf{I}k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.432664em;vertical-align:-.4129719999999999em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord">−</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.019692em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.27686399999999994em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.733692em"><span style="top:-2.4231360000000004em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span><span style="top:-3.0448000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.733692em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.4129719999999999em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.213892em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.963892em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6778919999999999em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6778919999999999em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.677892em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.213892em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.963892em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6778919999999999em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6778919999999999em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.677892em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.213892em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.963892em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6778919999999999em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6778919999999999em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.677892em"><span class="pstrut" style="height:3em"></span><span style="height:.286em"><svg width="100%" height="0.286em" viewbox="0 0 1033 286" preserveaspectratio="none"><path d="M344 55.266c-142 0-300.638 81.316-311.5 86.418-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751 181.476 676 181.476c-149 0-189-126.21-332-126.21z"/></svg></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord">−</span><span class="mord">2</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">I</span></span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span></span></p><p>故雷诺应力可以写为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mi>t</mi></msub><mo>=</mo><mn>2</mn><msub><mi>μ</mi><mi>t</mi></msub><mover accent="true"><mi mathvariant="bold">D</mi><mo>ˉ</mo></mover><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mover accent="true"><mi mathvariant="bold">D</mi><mo>ˉ</mo></mover><mo stretchy="false">)</mo><mi mathvariant="bold">I</mi><mo>+</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><msub><mi>μ</mi><mi>t</mi></msub><mover accent="true"><mi mathvariant="bold">D</mi><mo>ˉ</mo></mover><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mover accent="true"><mi mathvariant="bold">D</mi><mo>ˉ</mo></mover><mo stretchy="false">)</mo><mi mathvariant="bold">I</mi><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mi mathvariant="bold">I</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">\overline \mathbf{\sigma}_t=2\mu_t \bar \mathbf{D}-\frac{2}{3}tr(\bar \mathbf{D})\mathbf{I}+\frac{1}{3}tr(\overline \mathbf{\sigma}_t) =2\mu_t \bar \mathbf{D}-\frac{2}{3}tr(\bar \mathbf{D})\mathbf{I}-\frac{2}{3}\bar\rho \mathbf{I}k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.78056em;vertical-align:-.15em"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.0173299999999998em;vertical-align:-.19444em"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8228899999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">D</span></span></span><span style="top:-3.25511em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8228899999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">D</span></span></span><span style="top:-3.25511em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em">ˉ</span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathbf">I</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.0173299999999998em;vertical-align:-.19444em"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8228899999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">D</span></span></span><span style="top:-3.25511em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8228899999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">D</span></span></span><span style="top:-3.25511em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em">ˉ</span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathbf">I</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">I</span></span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>τ</mi><mo stretchy="true">‾</mo></mover><mi>t</mi></msub><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mi mathvariant="bold">I</mi><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mn>2</mn><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mi mathvariant="bold">I</mi><mi>k</mi><mspace linebreak="newline"></mspace><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mn>2</mn><msub><mi>μ</mi><mi>t</mi></msub><mover accent="true"><mi mathvariant="bold">D</mi><mo>ˉ</mo></mover><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><msub><mi>μ</mi><mi>t</mi></msub><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mi mathvariant="bold">D</mi><mo stretchy="false">)</mo><mi mathvariant="bold">I</mi><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mi mathvariant="bold">I</mi><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mn>2</mn><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mi mathvariant="bold">I</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">tr(\overline \mathbf{\sigma}_t)=tr(\overline \mathbf{\tau}_t-\frac{2}{3}\bar\rho \mathbf{I}k)=-2\bar\rho \mathbf{I}k\\ tr(\overline \mathbf{\sigma}_t)=tr(2\mu_t\bar \mathbf{D}-\frac{2}{3}\mu_ttr(\mathbf{D})\mathbf{I}-\frac{2}{3}\bar\rho \mathbf{I}k)=-2\bar\rho \mathbf{I}k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">I</span></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord">−</span><span class="mord">2</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">I</span></span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.07289em;vertical-align:-.25em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8228899999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathbf">D</span></span></span><span style="top:-3.25511em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em">ˉ</span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">D</span></span><span class="mclose">)</span><span class="mord"><span class="mord mathbf">I</span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">I</span></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord">−</span><span class="mord">2</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">I</span></span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span></span></p><h2 id="对于-rans"><a class="markdownIt-Anchor" href="#对于-rans"></a> 对于 RANS</h2><p>速度输运方程：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo stretchy="false">(</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{ \partial }{ \partial t }( \bar\rho\widetilde{u_i} ) + \frac{ \partial\bar\rho\widetilde{u_i}\widetilde{u_j} }{ \partial x_j } = \frac{ \partial \overline \sigma _{ij} }{ \partial x_j } + \frac{ \partial }{ \partial x_j}( \Gamma_{ij} )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>这里的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\Gamma_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 对应上文中的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>σ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\sigma_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>。</p><p>最后变形为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo stretchy="false">(</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>p</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>−</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mrow><mo fence="true">(</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>k</mi><mo fence="true">)</mo></mrow><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mrow><mo fence="true">[</mo><mn>2</mn><mo stretchy="false">(</mo><mi>μ</mi><mo>+</mo><msub><mi>μ</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>k</mi></msub></mrow></mfrac><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{ \partial }{ \partial t }( \bar\rho\widetilde{u_i} ) + \frac{ \partial\bar\rho\widetilde{u_i}\widetilde{u_j} }{ \partial x_j } = -\frac{\partial p}{\partial x_i} -\frac{\partial}{\partial x_j}\left(\frac{2}{3}\bar\rho \delta_{ij}k\right) +\frac{\partial}{\partial x_j}\left[2(\mu+\mu_t)(S_{ij}-\frac{\partial u_k}{\partial x_k}\delta_{ij})\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.4221079999999997em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.4221079999999997em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">[</span></span><span class="mord">2</span><span class="mopen">(</span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p><p>OF 速度输运方程代码里边并没有包含 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span> 这一项，因此代码里的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault">p</span></span></span></span> 并不是真正的压力，而是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>+</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mi>ρ</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">p+\frac{2}{3}\rho k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">ρ</span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span>。Page 76 in the book of Tobias.</p><h2 id="对于-les"><a class="markdownIt-Anchor" href="#对于-les"></a> 对于 LES</h2><p>速度输运方程：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo stretchy="false">(</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mover accent="true"><mi>σ</mi><mo stretchy="true">‾</mo></mover><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>−</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{ \partial }{ \partial t }( \bar\rho\widetilde{u_i} ) + \frac{ \partial\bar\rho\widetilde{u_i}\widetilde{u_j} }{ \partial x_j } = \frac{ \partial \overline \sigma _{ij} }{ \partial x_j } - \frac{ \partial }{ \partial x_j}( \Gamma_{ij} )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.63056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.03588em">σ</span></span><span style="top:-3.55056em"><span class="pstrut" style="height:3em"></span><span class="overline-line" style="border-bottom-width:.04em"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>Boussinesq 假设：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><msub><mi mathvariant="normal">Γ</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo>−</mo><mn>2</mn><msub><mi>μ</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mover accent="true"><msub><mi>S</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo stretchy="true">~</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Gamma_{ij}-\frac{1}{3}\Gamma_{kk}\delta_{ij}=-2\mu_t(\widetilde{S_{ij}}-\frac{1}{3}\widetilde{S_{kk}}\delta_{ij})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.229438em;vertical-align:-.286108em"></span><span class="mord">−</span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>LES 中有 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi mathvariant="normal">Γ</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo>=</mo><mn>2</mn><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mi>k</mi></mrow><annotation encoding="application/x-tex">tr(\Gamma_{ij})=\Gamma_{kk}=2\bar\rho k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord">2</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span></p><p>因此：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Γ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mo>−</mo><mn>2</mn><msub><mi>μ</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mover accent="true"><msub><mi>S</mi><mrow><mi>k</mi><mi>k</mi></mrow></msub><mo stretchy="true">~</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mi>k</mi><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\Gamma_{ij}=-2\mu_t(\widetilde{S_{ij}}-\frac{1}{3}\widetilde{S_{kk}}\delta_{ij})-\frac{2}{3}\bar\rho k \delta_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord">Γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.229438em;vertical-align:-.286108em"></span><span class="mord">−</span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></span></p><p>速度输运方程可以变形为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo stretchy="false">(</mo><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><mover accent="true"><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="true">~</mo></mover></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>p</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mrow><mo fence="true">(</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mover accent="true"><mi>ρ</mi><mo>ˉ</mo></mover><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>k</mi><mo fence="true">)</mo></mrow><mo>+</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac><mrow><mo fence="true">[</mo><mn>2</mn><mo stretchy="false">(</mo><mi>μ</mi><mo>+</mo><msub><mi>μ</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>u</mi><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>k</mi></msub></mrow></mfrac><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{ \partial }{ \partial t }( \bar\rho\widetilde{u_i} ) + \frac{ \partial\bar\rho\widetilde{u_i}\widetilde{u_j} }{ \partial x_j } = -\frac{\partial p}{\partial x_i} +\frac{\partial}{\partial x_j}\left(\frac{2}{3}\bar\rho \delta_{ij}k\right) +\frac{\partial}{\partial x_j}\left[2(\mu+\mu_t)(S_{ij}-\frac{\partial u_k}{\partial x_k}\delta_{ij})\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.69056em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6905600000000001em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.43056em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-.8360000000000001em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.4221079999999997em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.56778em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">ρ</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">ˉ</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.03148em">k</span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.4221079999999997em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">[</span></span><span class="mord">2</span><span class="mopen">(</span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:.05556em">∂</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03785em">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.03785em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p><p>那么按照 Tobias 的说法，OF 速度输运方程代码里边并没有包含 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span> 这一项，因此代码里的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault">p</span></span></span></span> 并不是真正的压力，而是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>−</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mi>ρ</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">p-\frac{2}{3}\rho k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">ρ</span><span class="mord mathdefault" style="margin-right:.03148em">k</span></span></span></span>？</p><p>按照上边的观点，OF代码中的 p 其实并不是真实的压力，那么它怎么能用于气体状态方程呢？这个问题是论坛里网友提出来的：<a href="https://www.cfd-online.com/Forums/openfoam-solving/193246-favre-reynolds-average-openfoam.html#3" target="_blank" rel="external nofollow noopener noreferrer">cfd-online</a>。</p><p>其实最简单的就是把缺失的那个 k 补上，为什么大家不这么做呢？看看网上的讨论。<br><a href="https://www.cfd-online.com/Forums/openfoam-solving/58214-calculating-divdevreff.html" target="_blank" rel="external nofollow noopener noreferrer">https://www.cfd-online.com/Forums/openfoam-solving/58214-calculating-divdevreff.html</a></p><h2 id="一些矢量和张量的操作"><a class="markdownIt-Anchor" href="#一些矢量和张量的操作"></a> 一些矢量和张量的操作</h2><p>LES 中经常出现的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><mover accent="true"><mi>S</mi><mo>~</mo></mover><mi mathvariant="normal">∣</mi><mo>=</mo><msqrt><mrow><mn>2</mn><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover><mover accent="true"><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true">~</mo></mover></mrow></msqrt></mrow><annotation encoding="application/x-tex">|\tilde S|=\sqrt{2\widetilde{S_{ij}}\widetilde{S_{ij}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1701899999999998em;vertical-align:-.25em"></span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9201899999999998em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault" style="margin-right:.05764em">S</span></span><span style="top:-3.6023300000000003em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.16666em">~</span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.84em;vertical-align:-.526389em"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.313611em"><span class="svg-align" style="top:-3.8em"><span class="pstrut" style="height:3.8em"></span><span class="mord" style="padding-left:1em"><span class="mord">2</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.94333em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em"><span class="pstrut" style="height:3em"></span><span style="height:.26em"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span style="top:-3.273611em"><span class="pstrut" style="height:3.8em"></span><span class="hide-tail" style="min-width:1.02em;height:1.8800000000000001em"><svg width="400em" height="1.8800000000000001em" viewbox="0 0 400000 1944" preserveaspectratio="xMinYMin slice"><path d="M1001,80H400000v40H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5c53.7,-170.3,84.5,-266.8,92.5,-289.5c4,-6.7,10,-10,18,-10zM1001 80H400000v40H1013z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.526389em"><span></span></span></span></span></span></span></span></span>，用代码表示是：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">volSymmTensorField Sij = symm(fvc::grad(U));</span><br><span class="line">volScalarField magSij = <span class="built_in">sqrt</span>(<span class="number">2</span>*(Sij &amp;&amp; Sij));</span><br></pre></td></tr></table></figure><p>这里的 <code>&amp;&amp;</code> 的操作是缩并，也叫双内积，两个二阶张量的缩并是一个标量。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//- Double-dot-product between a symmetric tensor and a symmetric tensor</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Cmpt</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Cmpt</span></span></span><br><span class="line"><span class="class"><span class="title">operator</span>&amp;&amp;(<span class="title">const</span> <span class="title">SymmTensor</span>&lt;Cmpt&gt;&amp; <span class="title">st1</span>, <span class="title">const</span> <span class="title">SymmTensor</span>&lt;Cmpt&gt;&amp; <span class="title">st2</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">    (</span><br><span class="line">        st1.xx()*st2.xx() + <span class="number">2</span>*st1.xy()*st2.xy() + <span class="number">2</span>*st1.xz()*st2.xz()</span><br><span class="line">                          +   st1.yy()*st2.yy() + <span class="number">2</span>*st1.yz()*st2.yz()</span><br><span class="line">                                                +   st1.zz()*st2.zz()</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>&amp;</code> 是内积，也叫数量积，也叫点乘，两个矢量的内积是一个标量。<br><code>^</code> 是叉乘，两个矢量的叉乘，仍旧是一个矢量。在三维几何中，向量a和向量b的叉乘结果是一个向量，更为熟知的叫法是法向量，该向量垂直于a和b向量构成的平面。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Cmpt</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Vector</span>&lt;Cmpt&gt; <span class="title">operator</span>^(<span class="title">const</span> <span class="title">Vector</span>&lt;Cmpt&gt;&amp; <span class="title">v1</span>, <span class="title">const</span> <span class="title">Vector</span>&lt;Cmpt&gt;&amp; <span class="title">v2</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">return</span> Vector&lt;Cmpt&gt;</span><br><span class="line">    (</span><br><span class="line">        (v1.y()*v2.z() - v1.z()*v2.y()),</span><br><span class="line">        (v1.z()*v2.x() - v1.x()*v2.z()),</span><br><span class="line">        (v1.x()*v2.y() - v1.y()*v2.x())</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>外积 <code>a*b</code>，也叫量积（tensor-product），两个矢量可以形成一个二阶张量。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Cmpt</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">typename</span> <span class="title">outerProduct</span>&lt;Vector&lt;Cmpt&gt;, Vector&lt;Cmpt&gt;&gt;:</span>:type</span><br><span class="line"><span class="keyword">operator</span>*(<span class="keyword">const</span> Vector&lt;Cmpt&gt;&amp; v1, <span class="keyword">const</span> Vector&lt;Cmpt&gt;&amp; v2)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> Tensor&lt;Cmpt&gt;</span><br><span class="line">    (</span><br><span class="line">        v1.x()*v2.x(), v1.x()*v2.y(), v1.x()*v2.z(),</span><br><span class="line">        v1.y()*v2.x(), v1.y()*v2.y(), v1.y()*v2.z(),</span><br><span class="line">        v1.z()*v2.x(), v1.z()*v2.y(), v1.z()*v2.z()</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>q</mi><mi>r</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>u</mi><mi>i</mi></msub><msub><mi>u</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">sqr(U)=u_iu_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:.03588em">q</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.10903em">U</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></span></p><p>这个全局函数没看懂什么意思：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Cmpt</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Vector</span>&lt;Cmpt&gt; <span class="title">perpendicular</span>(<span class="title">const</span> <span class="title">Vector</span>&lt;Cmpt&gt;&amp; <span class="title">v</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function">Vector&lt;Cmpt&gt; <span class="title">u</span><span class="params">(Zero)</span></span>;</span><br><span class="line">    u[findMin(cmptMag(v))] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> u ^ v;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;无摘要&lt;/p&gt;
    
    </summary>
    
    
      <category term="code" scheme="https://openfoam.top/categories/code/"/>
    
    
      <category term="TurbulenceModels" scheme="https://openfoam.top/tags/TurbulenceModels/"/>
    
  </entry>
  
  <entry>
    <title>fvMesh 简单分析（待补充）</title>
    <link href="https://openfoam.top/fvMesh/"/>
    <id>https://openfoam.top/fvMesh/</id>
    <published>2019-04-13T22:00:00.000Z</published>
    <updated>2019-04-15T22:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>无摘要</p><a id="more"></a> <img src="http://www.plantuml.com/plantuml/svg/jLXRRzis57xFh-1U0dlpslIrwGeuJhCPQ1DZJZ9WBmKZ7Kj4AL8bAQVPiF--Gqgs9PcIc3ZEInBnE_SBp-59nAdM95SiOuQjuGlezDyJWZzVlnBx3z7i7o0vLJG30qhZTtVy2nES2I2SFW0dOY6PC7eq9f4Ksfpx89_Y1FeHSu4I1ELND1f03YDcm7cOj03LDz2pS1lUXKCzI7J-OXCIajamnDJGhU_NJ9c2yfA2vDQ0AmOyFYt_tZ8Zlv6pSn_92lttcMbpwluQnZkDTmGtZmBKSuckWINfWoo62Ui6IHulEcn29rs2GW_57XULs0YpO9dIl39s-syxC2KQC10b4BmX-HDCeKGf34y4H1WVPfvQGhTsxuJwij4BjeA3mSvFtMWhUAT2i7XVRNMB3qPR7NmruGNRV0a6EpsUX_RMVAVQFZIcm-yWiISg5fMPDrBqyQTnAnVMc2DILRbSPe8mgaFJ1jYwe0-i8yffdVEzv4KModcgWEwWfD7nCscO55j3J9P_g0dxYEThg5pYQK0JVmsFpmbfrP5H1H2s8WcMi71QLPsHQSAgtaYC92QjUY2IjduQRVL1IajRlqL6jPWw2NCHmuzs86zbBhbCM6GxK0hHDxtNQHrlTtQNvw1k5QCYAT0dbGHthY2NoZQe5UKQ9axg7rIdIp0_4mrcOHGUYeBptAXccFRbkBh-c-Lt-T54M0_TWpBCbl2nX3GovJWsb3teLIGqodem5sPSQeWlP25YgfwwDHWFXDgnAHlvIwre7QTurqvrZcM_R0DB2VUk8tnmL1zFYSRcOQl-4e6De_VlfO2G89GTvPZLi6bmnqob6sLIcKXi7tYl7rNIuWb7QXRtcLDlz2HZ0adG1tZygyuevw-WnF8Ru2YdZ-lJgKWuXDj9VooPmBDtPnFBzErRCXSaXaG1w5Ve5PmQlyLDDHwf4Xlin6dnLugt55v7J4IyYF7c4bQ1DpwLWdhYDQ2804tARvSuZIo_gmF3OQUapo0Iamv9nNH3uE4IPr94T0s7DRTsY-vfoTLTtjUC1pIk-ly17EmK5Kgj3SNxT-DrDBoy36vJdFjI79n6zQYCkuZALlzCecifRBjx9fLj6Rqa69yx3Qk2Oz6MsnaJAxaDcVE8cmxdRac_kAXFaNQ0BASrEzAoIIKNEM0julrqfMZafbFS0fkERFDjSoKrjatAQZfa8hOb2ThiatCPEV5TX84Kw9ebNgqqmO6M2loLuO2_IsR9OliI8yoKEtA8_Uy7pjIKwbdNEjl2zJn5r5drF9dKEGN05bsBgKTgWCIUrvw6n03Sh6CBRS6kElPFdzHGNDyxKrszK9n_EVGO4WISTMwG7ewjxN6xYEsz--pUFkgBM5dQbqy21w380ZTZQEy-tiijWBAnY1okI1Ux0TBQcqsTr7r-YIgz_49eFNOSfamdmm7YtPjFUsb_YIezt0OeTszWTKhxTVu2FNgu1L3k1_OGFJgu1IJxlYSFAPqERgsnojw64SSRsGvae_7UvsaSOrVJJ2IUmvl2sA__dVmF"> <img src="http://www.plantuml.com/plantuml/svg/jHhBRjiwTk-lu6o4D7MBp68siMiWTPBMG18RiPiBpCQW9ThML185adAQc-RVxo4fIYH5EqwAwS8nUHuy3vuNtP9cJxU4Rz7mzwTFQBsJttjPKlbxgCShjiOncHI2i99cMAIqS37Mktcy9JdXdMsQLLtq10lixg1Ud67Ew_Lp3y6_vHBDMBh3WY15i5ogxK_htLTQ5GbcMlnLlLWED3Yl15vbf6PrarGNIS88vscnEKMWtqmm7pN3AvAXk6ABD0Sr4_BBnzZHD3b53m7QIo0fEAX8akkKPCcGnpZ3h0yacHHW16HdxwKB4V8iZKaorpvv8B6WJ34uHVDr25qZpXNt6Z77cp2kOlr0CuVj-4r2Z8yLejocBQRbwrkIhmX3rrKHovl36xzB7w0u8vXz8pI_esAQILbFFWmiU5N2NI4741e6WUtsffp4SBA0kqKpb7BfZn-ACVg2rZZZnA7be3sfpz9ql5KqSb1p_9FCroSVaCBp8RVIB_k0uxq0ZqJQibg1Wv1uAab2req9FzOR9kpany27EC5bBnhk5t4CLcgOQfLbw4H8mAUHvfaHKR42bNMYEJ_NqC6BfjkbJ5GuqyY8hlu7r-YUR58ks1DmsgRySdM0Lmqtt3INHygI21Nua1GQwjAvQaTDKd4jwucSsRabCiiz901L2LJ60TnxVWDwejJiS5_SLe3FDf9lkpfpqJpVhw-6klegkXzIXWZHnu8mdxnHvdD67mdJt_VpA4YwsOBC1_XKPHdcysecZD23PzJZ2S_UJ-cJYhmSlaeuGWyyVZTXM5hUIRCHylE4YsebsaXd-wEn8Iq7SNTELOZG-6XH_VoaxD557A64P0Bxk2GleUCWGzqVB21DZMIkaa6CoWN3gU13jNj-hYwa_8vsE4kJCSrBi7SXU2S_NYMfQF9Nc_-dbJ1LeOamgwf8FzK9FiVbh0umC72P-rHAnTQi8vJJ7PdHL0gZEPHouLG8zqWuGK7vQoTAP4Oa_-icYJLQX3pCYPX99zSeHyG2KCX0Qipt5qkX53RsgyLMnV9HWgOgbvzCff3A2SxFp_NVQyfo3Bas5_qMj2DC7dvNgQeFAmi6cQjKwPKMogrnNlQjmgoy7CwshImdFW6KSC4gub-9kksOGfB2S2NRygOeQRtzhoydfc0eJxYdEwXVzg2YtaklrtFBdMw6JShkbIpDKv7kIDkBDx2wKJRhPw_agqvP1aYh02cg76u8JdGBCnVmyVpZRlpzukxRrML_DftSBURBs-a3B1RJsNIf8Vhxx68n_bxll0miXZ79iaiYFKHvAXkrv-kByTLoTdDnTpNlg-_Zgxl5_TLoSJ-fDoud5z_qSdnrSxDSN2tcBrRxftL6kLJQwVXLh4ocwdhgmE6cmvItMmOwZW51rLHLAGrOfOGQeEfS2D0KBmDKVbGPWIIDNDnlQgKB3auYQlsL_j80LoPLitsEEXiE5S88RQ199OAbyULXF5xFM1qqN0aAhSRGqdM4115VCOSMPC83ZReXIUKGH99f3958XlBZ4Xmo1fz3ePAkNy2Mqxx_bnRG1K57irPHBcS-ntq0rzUvMJa-RC1cqK3bQGtKBBWrDs26immiAezkplGLscHqXLK-aug0SPsreuawAATA1KPayKdSwwYk1oHSqDUvCOAMTBp5nSO2T4RCMyLuxw1fv6tBmmZHBD6buntpKbgaGjKjPmnfTgKzTGSNk-CGpkBBb17DCZHvI0nv7-PRN18V8tZpP0fQjBVlpKEBINcXiQKJYy71fM798GV2KN9QWAvZZQjCfM9Q3BfmcOxcrGgiqV2HLsO5QdHAO9tmqupSOJaE9PBCwsWCL37kWdqMEjrDO1CNCNa5MUM-FRXwL2MY0Nl47_RDTwvoLjzIotPoe0HNvOA2jTpMXv7DPAeBO8HI6YOtulvmEHn5Msi6nj1tsvcmmgESlAWjyjGUYOuXkFFddy5hjck2EkXI_pwt4waEvl2mk7G7ArD_QkBmZCaz8gUsH5OHykJK2QtujWyUvDQKgZ2p-HwmPNATJ2AxZ0MH3nImg2bWUqnlLQl8AbVT2RijPEvZWbNFehQW-VHMfNF8xO8NjHNF9xTAeKFkLhQeNillGQFRRmSs8AeXZcsEUwGvbTk3br0z3SuCoHDCSsdSjK_6YT7Dgha-dgd40Kohzyy_FEk_Pp0069BwhzmP66vd3YExfli7k_L-BvKbH5mB4KiXN79d1T3O21Ix0iLxX36s-VtR5Tb_CNhVPAg7J4Z7kdtfrEu5d9dHJHhZMiAsDXw8fmEHj3U63aJFlhZP7p5ABvmaCopYBJ46a1bcA3EmsZuTHPsXqwHcCqiEN7RwN8TPhI0mG-NVVGjaz92GjGCnuaf8_BV_IE0DTDRwJvymsWS5_pa173s7T8x1kpaku4zEYj0xYlsy_l4FdjVtFSqqk-rm5W0wlMO7EcvgGE0X1NeYxlT7K59qumGzMw2piYdzw6YA9CG6YN_oS1fKi6lPVJ2nfHjQm4qJJxQf62af4yP8VPMdlsDeJuauLSywWW6mgBAi5En0LzQSDFz9eDFX_Fzso5Mo8HTPkYdaJUcUqWzs2KapU0HFV-tCiNgP48JbQO63fxw7gxoaTVBhDdC5UTGfjB_Va1Oa8GB3HKdk7OnZ7FQNx3Ft6r8dTWIAQqHWVVRvx3z_wCG7cjtBYVw8OnMUFlNVRpbLZd_rEn8WOXPlqTeVQ7MShQ6panw-Lh-ZsBw0pDethGiWf6O1hQ94jjSpaGP2MB9UQEI6SzqaANxXiuvXhqocNx4AANnGREUKplCQ6AvvD0lrSSOkFkkti7inhulrVmDuzXv7hxikUSDlUE_u3KtUfFVzZXQYxFIx5fB_EqCVwIzV8OUmfsavgfDyKi7al8ZG0yug4zC6HyvPfQlif5ZJ6QE_deQrIKVgcUfGn_nnpL9I9AX-1O-Q1-NXyCJizMlvk-nbo_RI-mS0"><p>primitiveMesh没有更顶层的类了。常用的方法：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> label <span class="title">nCells</span><span class="params">()</span> <span class="keyword">const</span></span>; <span class="comment">//返回网格个数</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> cellList&amp; <span class="title">cells</span><span class="params">()</span> <span class="keyword">const</span></span>; <span class="comment">//返回所有的 cell，cell 是由 faces 构成的</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> labelList&amp; <span class="title">cellCells</span><span class="params">(<span class="keyword">const</span> label celli)</span> <span class="keyword">const</span></span>; <span class="comment">//返回 celli 的 邻居们</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> labelList&amp; <span class="title">edgeCells</span><span class="params">(<span class="keyword">const</span> label edgeI)</span> <span class="keyword">const</span></span>; <span class="comment">//返回共用这条边的所有网格</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> labelList&amp; <span class="title">pointCells</span><span class="params">(<span class="keyword">const</span> label pointi)</span> <span class="keyword">const</span></span>; <span class="comment">//返回共用这个点的所有网格</span></span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt;<span class="string">"mesh.cells()[0]==="</span>&lt;&lt;mesh.cells()[<span class="number">0</span>]&lt;&lt;<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure><p>返回包围第0个cell的所有面的index：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">mesh.cells()[<span class="number">0</span>]===<span class="number">6</span>(<span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">4379997</span> <span class="number">4382913</span> <span class="number">4391661</span>)</span><br></pre></td></tr></table></figure><p>surfaceInterpolation没有更顶层的类了。</p><p>lduMesh没有更顶层的类了。</p><p>fvMesh 常用的方法：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//- Return cell volumes</span></span><br><span class="line">const DimensionedField&lt;scalar, volMesh&gt;&amp; V() const;</span><br><span class="line"><span class="comment">//- Return old-time cell volumes</span></span><br><span class="line">const DimensionedField&lt;scalar, volMesh&gt;&amp; V0() const;</span><br><span class="line"><span class="comment">//- Return old-old-time cell volumes</span></span><br><span class="line">const DimensionedField&lt;scalar, volMesh&gt;&amp; V00() const;</span><br><span class="line"><span class="comment">//- Return sub-cycle cell volumes</span></span><br><span class="line">tmp&lt;DimensionedField&lt;scalar, volMesh&gt;&gt; Vsc() const;</span><br><span class="line"><span class="comment">//- Return sub-cycl old-time cell volumes</span></span><br><span class="line">tmp&lt;DimensionedField&lt;scalar, volMesh&gt;&gt; Vsc0() const;</span><br><span class="line"><span class="comment">//- Return cell face area vectors</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> surfaceVectorField&amp; <span class="title">Sf</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line"><span class="comment">//- Return cell face area magnitudes</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> surfaceScalarField&amp; <span class="title">magSf</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line"><span class="comment">//- Return cell face motion fluxes</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> surfaceScalarField&amp; <span class="title">phi</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line"><span class="comment">//- Return cell centres as volVectorField</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> volVectorField&amp; <span class="title">C</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line"><span class="comment">//- Return face centres as surfaceVectorField</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> surfaceVectorField&amp; <span class="title">Cf</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//- Internal face owner</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> labelUList&amp; <span class="title">owner</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> lduAddr().lowerAddr();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//- Internal face neighbour</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> labelUList&amp; <span class="title">neighbour</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> lduAddr().upperAddr();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>画了一个<code>2*2*1</code>的网格：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Mesh Information</span><br><span class="line">----------------</span><br><span class="line">  nPoints: 18</span><br><span class="line">  nCells: 4</span><br><span class="line">  nFaces: 20</span><br><span class="line">  nInternalFaces: 4</span><br></pre></td></tr></table></figure><p>以下三张图为李建治绘制：<br><img src="/album/mesh1.gif" alt=""><br><img src="/album/mesh2.gif" alt=""><br><img src="/album/mesh3.gif" alt=""></p><p>下面这段代码来自 <em><a href="http://www.cfd-china.com/topic/1228" target="_blank" rel="external nofollow noopener noreferrer">CFD中文网</a></em></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> labelUList&amp; owner = mesh.owner();</span><br><span class="line"><span class="comment">//这里的owner只考虑了内部面？</span></span><br><span class="line">Info&lt;&lt;<span class="string">"owner==="</span>&lt;&lt;owner&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">const</span> labelUList&amp; neighbour = mesh.neighbour();</span><br><span class="line">Info&lt;&lt;<span class="string">"neighbour==="</span>&lt;&lt;neighbour&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">forAll(T,cellI)</span><br><span class="line">&#123;    </span><br><span class="line">Info&lt;&lt;<span class="string">"cellI==="</span>&lt;&lt;cellI&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    forAll(mesh.cells()[cellI], faceI)</span><br><span class="line">    <span class="comment">//遍历当前 cellI 的所有面</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (mesh.isInternalFace(mesh.cells()[cellI][faceI])) </span><br><span class="line">        <span class="comment">//如果这个cellI由6个面包围，则faceI从0到5遍历</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">const</span> label faceIndex = mesh.cells()[cellI][faceI];</span><br><span class="line">            <span class="comment">//faceIndex 是当前 faceI 真实 index</span></span><br><span class="line">            Info&lt;&lt; <span class="string">" one of faceIndex is "</span> &lt;&lt; faceIndex;</span><br><span class="line">            Info&lt;&lt; <span class="string">", and this face's owner is "</span></span><br><span class="line">                &lt;&lt; owner[faceIndex] &lt;&lt; <span class="string">", its neighbour is "</span></span><br><span class="line">                &lt;&lt; neighbour[faceIndex] &lt;&lt; nl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">owner&#x3D;&#x3D;&#x3D;4(0 0 1 2)</span><br><span class="line">这里内部面只有 0 1 2 3，对应的owner是 0 0 1 2</span><br><span class="line">neighbour&#x3D;&#x3D;&#x3D;4(1 2 3 3)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cellI&#x3D;&#x3D;&#x3D;0</span><br><span class="line"> one of faceIndex is 0, and this face&#39;s owner is 0, its neighbour is 1</span><br><span class="line"> one of faceIndex is 1, and this face&#39;s owner is 0, its neighbour is 2</span><br><span class="line">cellI&#x3D;&#x3D;&#x3D;1</span><br><span class="line"> one of faceIndex is 2, and this face&#39;s owner is 1, its neighbour is 3</span><br><span class="line"> one of faceIndex is 0, and this face&#39;s owner is 0, its neighbour is 1</span><br><span class="line">cellI&#x3D;&#x3D;&#x3D;2</span><br><span class="line"> one of faceIndex is 3, and this face&#39;s owner is 2, its neighbour is 3</span><br><span class="line"> one of faceIndex is 1, and this face&#39;s owner is 0, its neighbour is 2</span><br><span class="line">cellI&#x3D;&#x3D;&#x3D;3</span><br><span class="line"> one of faceIndex is 2, and this face&#39;s owner is 1, its neighbour is 3</span><br><span class="line"> one of faceIndex is 3, and this face&#39;s owner is 2, its neighbour is 3</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//- Internal face owner</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> labelUList&amp; <span class="title">owner</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> lduAddr().lowerAddr();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">fvMesh::lduAddr()&#123;<span class="keyword">return</span> *lduPtr_;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">mutable</span> fvMeshLduAddressing* lduPtr_;</span><br></pre></td></tr></table></figure><img src="http://www.plantuml.com/plantuml/svg/ZLBBQiCm4BpxA_OKaZI6qcDUK2Y5WjC6qfvACRAbDWB5DdeufS7_NlaHIrMLnytUcLdDpYx3wXvZJeIWsHVCmn0-onKHsyYk1ob3GdYHGn37iEQqH980HX9170SXGmbX4HLoEXKggJ-0vNl2Qs4y2y8qp-hIaJK0LHG6hKjpY_9M5yPBA91CjquBh3Rfbc35oA35Zx-Qevsjo2uX71vLbagg5RMx6xVrm9WRZg113vn8nJFRTUKJzhvTeJMGLzZFChGme4wNiHdvdNvOdKwExVfmCgc2AkYsoQxT8mZwqyNvG7Oemo7MF98Psav9b31Y5ZhMmOcSoxLiTkN1ytr6-4QYSvosXqMoBFeM6vOvnP3hu97C-MBOPsNc78nc7Ir5B8sQ1uwHsSXBRy-7HiQOWKzTcydGtKsRgrvgIRbKYC4LXmaBk9sTK_oxo8iA_oasrUVyR9EBLzZ9V7FL2TeslJHp9HUfrh4ut7OUoUbJXidtdo7HnCu34YDwLGKZT_EcFW6Xjuxu4X9z_QPp5Vm2">]]></content>
    
    <summary type="html">
    
      &lt;p&gt;无摘要&lt;/p&gt;
    
    </summary>
    
    
      <category term="code" scheme="https://openfoam.top/categories/code/"/>
    
    
      <category term="fvMesh" scheme="https://openfoam.top/tags/fvMesh/"/>
    
  </entry>
  
  <entry>
    <title>OpenFOAM 场（field）的操作和运算</title>
    <link href="https://openfoam.top/fields/"/>
    <id>https://openfoam.top/fields/</id>
    <published>2019-03-31T22:00:00.000Z</published>
    <updated>2019-03-31T22:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>F</strong>ield <strong>O</strong>peration <strong>A</strong>nd <strong>M</strong>anipulation</p><a id="more"></a><h1 id="field-相关类的结构"><a class="markdownIt-Anchor" href="#field-相关类的结构"></a> field 相关类的结构</h1><p>几个常见的类：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">volScalarField</span><br><span class="line">volVectorField</span><br><span class="line">surfaceScalarField</span><br><span class="line">surfaceVectorField</span><br></pre></td></tr></table></figure><p>其实它们都是别名，定义如下：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> GeometricField&lt;scalar, fvPatchField, volMesh&gt; volScalarField;<span class="comment">//src\finiteVolume\fields\volFields\volFieldsFwd.H</span></span><br><span class="line"><span class="keyword">typedef</span> GeometricField&lt;<span class="built_in">vector</span>, fvPatchField, volMesh&gt; volVectorField;</span><br><span class="line"><span class="keyword">typedef</span> GeometricField&lt;scalar, fvsPatchField, surfaceMesh&gt; surfaceScalarField;<span class="comment">//src\finiteVolume\fields\surfaceFields\surfaceFieldsFwd.H</span></span><br><span class="line"><span class="keyword">typedef</span> GeometricField&lt;<span class="built_in">vector</span>, fvsPatchField, surfaceMesh&gt; surfaceVectorField;</span><br></pre></td></tr></table></figure><p>发现，它们实际上都是 <code>GeometricField</code>，不过是提供的模板不同。<br>下面给出 <code>GeometricField</code> 类的 UML 类图。首先我们看到它需要三个模板：<code>&lt;Type,PatchField,GeoMesh&gt;</code>。<br>结合 <code>volScalarField</code> 和 <code>surfaceScalarField</code> 的定义，我们不难发现：第一个 <code>Type</code> 可以是 <code>scalar</code> <code>vector</code> 等，第二个 <code>PatchField</code> 可以是 <code>fvPatchField</code> <code>fvsPatchField</code>（这里的 s 表示 surface） 等，第三个 <code>GeoMesh</code> 可以是 <code>volMesh</code> <code>surfaceMesh</code> 等。</p><img src="http://www.plantuml.com/plantuml/svg/pLfBRoEv4RxhLn1x4DJhDdO3v2G_0Azb3mIi7x0zkqU1wgRiplGBR4eUH_4f0N99W3qaG91Va4kGFUQIVvFPpSz8yTLDijbI-pN97COjibui5ejVLVSaoKXU9KLEujE4f37Q_yrkNDpdk-WTAJB2Q1A9yK6Kugfo1lTl7aeINc8MtOdV8KoVaUhkS3r0y6ysGvSqMM56q1d9veIYqsKUCL1MmPmWsPqNHOeemV5qSKb9HN8s2foPYpI-0IjT0YvzEK-J236m8YQBMkYE6X0JESu8KdQDn_n_nF_RHlXDiSnZJ1y4W_d3PfmuxfCUqM8EqJHdXEOujRaQZmdwGpdGOP91Dnv7MSdu8z8FhgDZp73jt6p9y3mbACLpaYB6dPZ7vACpwzjJmyHcDL-Y1H_u-fBH5ug0dLnDmJED9ErYD5SFWd7MEuvMHHABQ15yrIY2IORYH921k67WfwjZgKloZjx28R0j5FrEagT93hiWj3GKYNeImaU1dD_8iRAfwbtN5EEnaCKzEaGbJRA49IiYnguwp7cA35kxteIXlGjTYZh8lUjsGh2RPcWIoMcnPnKhA56feBBPM_Fsj5IT-tdbIdh7xn0LFXNFuNTjrsVYXVQLNZ52JLHGIYAcj-suoED4nBesHgJSd12-uuIIF7AMoR9otp55vo6_EOV0dPMG7I5hwnF9JG2bbc2X-9ucZ4mWVuqkAWP7D1jkKxv9yOt70PIa-ACof8fmYYd2QNc7WnQD6halAEmEIS7aaR1naS1vQWiMffyb-HcmQkDHKVaiA5CS4JH2ZZj2vDtfpUuTek0fikFcige5EpAosZyciIIqw9Ay7nt-26unJ7A9kQG92pVCuuyJvjfO2-n_C3QeS1RsTi9vp94NY7z26dXDjPshWclpc5FGPGGPhBaoRHKgKAONnVnN4933KFxcElHphU6QrFFyx44wgmtZcWzSv0I82AVHCWLi80X6GR3toZPycrHiYEunNAQnKC_rL2q27B4bJXi2T51FlePHjUl_rzxn6VBPNLJZ9_KRS2INikyw09BHQuQ38VajDB_0rWRcRfBH_-Y3cCV1mAP7ExkxXpNe6uWnfsQi9sMrg7_shnEjyiL6cMB1Q0u8xcxcWFP52xJRC7_aecvHXBIT9vxDpBaimI1oN935eh8G6rdXT0bJ9b3WSI30T-L7rJLAddPN2T_6Ip6xW8jSJ4DyLIB0PA6Ow4b7Hzh5ft3Ej8ElGIydEQCF8pEvV20F_2547aG3mJ60SkWOLiJuzk-Y9Xm6waoqncLGD0FxAkh4qjPR2p4E0DlCDP3fYpLDh3JgG4eRr0o3_c8qa-Rnhq1Ptm1MxbpktbjzvgKdtLx3e3vydZdfwotjYVMhDrBCfaPzBxr-OyD8WQX92BjcpcuIUFMCBaBJR39FX4WR4yWHuh30zVK5JmFaY-rD16y-CZDFBJhihz2knXjlR6WyMBUQuI8lIpUnHx9vDqgxlJ9zPCtXQCLhK_zuIifsfOEUKN7rqFd4EgllIcgnNWPtsKv1sm9a2Ay8nRTa6zazIMxl0AWTIV9w6Iq3vCrXUU5vahtBSwMxuZjQ0jh7llFnb9O2JxAU2spWN5pcdRLltrF7THZoZDQTCiiRYXDMRKrq4mAwA97IYWMgbdEPu5t9rsf2ULtJRSL465M49W2xGNY6o_OWhKT5dECbAyvmEJBED_mi2UL5UQdob70pZAOFfsbIGeQ2Of2urzt-crpIxmKkUjR5xBFiHHSxoKfUPUtBSFdk-hIWsQ7wY-Pf4NrGecGpicAOibPtoomVlFshPm8r4oWiLWqCLy5j3ZanxhjyLKjISQaQr9hgI6Mh8bLvn6gJpuppAl6sDPJXF2bb2Nk6eHPHRozaQwxKjUJsYW1SpW3Yc7vpYsDLEgqIokjKf1f-7qdr7RzqzNwiAM5BcgC5JYkoz-ZX0QScjpb_CUBoyCFXPOcAPPcIU9CEMDnH102-SZP2GiGhSWkdGTGmSorbhtk_N4Lo4xLf_RRH-x932xIts1PiOG3_-uW-OemMYDm_pv94R6Ys5aCtgHcDhc0Tf1PjAqnThdOSD_lAqsgIt_hgM1KadeHi7bkLbmCF4q_g7WwxYo6oacZIr53sH5Qu75HrczNAMbN-Zc87-MqZDllnOXvYcAGCox9Rk_6yO5D8iWHY4boufxpw9RjBAlT4TPVkROBl5MPHX1vR9AgfWYsB4J6qeRAtT7k8pLtfvpuXv9nRDo-Mr3u-J_LMaYViHFSqL6TBNYQ0M8eigsJ3hdv41vxfyLZST139mTgdXBoYWYs-4MMITh3SMmkEcXZKW9veZHpF8SjrwB6FtkO5ssVJUmi7AG5EUycZjnLVhwphxBxwycpFZjvM_9ijJxt5qlU1kYyMA_dGlFZYluBdiuQzara3Bbjr4k17kmjbjAKKVZH6rgAkaiFDcDra4bXIj4dhwuJaoqpXc6k0QMJzxk9Y4dvpD7aqviMdG2M_XzPdxwzlPbSdHvEmVffDJsTd5vFfwVHa4kg1owkJwvFpc_3yGj2OqiHgbRYZzpSNi--lfZSdKBzypQdrZr-OB8ia9STt9FeWSj6QVwO0rcPbM3-TuGhEHvZa1KiM3_gl77tqmD1pg0_Z4v2zRyiEqIyF7NMSjDhO4nE0c5USvkyxS1gXntn3pfifs6CEDy0yFSALSGAu2C32F6gDGzx5gTLzQ-DEDTri5ABmLvlJE1pTDyFgAoykXD0B8TASkKsBEKwjSIDEk0tYORRnTQIEHAjeufvI9qGlSbYlFlGlaQgdq5pYWOgkq5hXWOwYqBF20wD8VhPnpOJOcyzXSjZQ4pWZeaRnBwOn4R3AtV-3XH0YxqXEA2GzR1LJqZR-POxy0Ca2RziABOEesJ-t0117Ku4lazOveYwRUuALX0xUBLnsPI3wKtRSaNjE7go5iU0wDG3iTLvlzVtMTdlAd5T0nnox5aDxJqfb6_lwkm8k2k0rszkO1mmhp5M7ljwu7kJ2WwUnkn_2jFdabtWi68irZiRZqu83NR4TB0X2OuaZU4uXJeDGhX3cDROsvKxrjRt5rBvqNe-yYBdZWqpOgsjv9MPREZVjVdDQ51-MvGMTa0LUfbO6RR_R3JjUWF2l49IFGtDtOYbKj7w0nEdY_fhG8lZgg__y-DkV__Itd__wkv_-yez6rx__-NSO-lJ37pxzyCTFl__NJt_-yGqMqjlAdhgFulYcuAtq6lQgtJHLenvEH4-p3xs5WVsLx_MDmgxqRixsUxjcchWoEuljzofrT_eLs-R-hm23hfSw_kyeSTprXVMEvuj-3-dZuBy0"><p><code>GeometricField</code> 类定义于 <code>src\OpenFOAM\fields\GeometricFields\GeometricField</code>。</p><ul><li><code>GeometricField</code>–场+网格，包含内部场及其边界场，边界场是场的场（FieldField）</li><li><code>DimensionedField</code>–带单位的场，只有内部场，没有边界场</li><li><code>Field</code>–数组（即 List）+代数操作</li></ul><h1 id="field-相关类的用法"><a class="markdownIt-Anchor" href="#field-相关类的用法"></a> field 相关类的用法</h1><h2 id="构造"><a class="markdownIt-Anchor" href="#构造"></a> 构造</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">volScalarField A_</span><br><span class="line">(</span><br><span class="line">    IOobject</span><br><span class="line">    (</span><br><span class="line">        <span class="string">"A"</span>,</span><br><span class="line">        mesh.time().timeName(),</span><br><span class="line">        mesh, <span class="comment">//字典注册对象</span></span><br><span class="line">        IOobject::MUST_READ, <span class="comment">// MUST_READ_IF_MODIFIED  NO_READ READ_IF_PRESENT</span></span><br><span class="line">        IOobject::AUTO_WRITE, <span class="comment">// NO_WRITE</span></span><br><span class="line">        <span class="literal">true</span> <span class="comment">//默认是注册</span></span><br><span class="line">    ),</span><br><span class="line">    mesh</span><br><span class="line">)</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">volScalarField B_</span><br><span class="line">(</span><br><span class="line">    IOobject</span><br><span class="line">    (</span><br><span class="line">        <span class="string">"B"</span>,</span><br><span class="line">        mesh.time().timeName(),</span><br><span class="line">        mesh,</span><br><span class="line">        IOobject::NO_READ,</span><br><span class="line">        IOobject::NO_WRITE</span><br><span class="line">    ),</span><br><span class="line">    mesh,</span><br><span class="line">    dimensionedScalar(dimensionSet(<span class="number">1</span>, <span class="number">-3</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), <span class="number">0.</span>)</span><br><span class="line">    <span class="comment">// 量纲还可以：dimless，或者 dimMass/dimVolume</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>上述两种构造函数对应 <code>GeometricField</code> 源代码中的：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">GeometricField(<span class="keyword">const</span> IOobject&amp;,<span class="keyword">const</span> Mesh&amp;);</span><br><span class="line">GeometricField(<span class="keyword">const</span> IOobject&amp;,<span class="keyword">const</span> Mesh&amp;,<span class="keyword">const</span> dimensioned&lt;Type&gt;&amp;,<span class="keyword">const</span> <span class="keyword">word</span>&amp; patchFieldType=PatchField&lt;Type&gt;::calculatedType());</span><br></pre></td></tr></table></figure><p>第一种是从文件中读取，内部场和边界场的初始值都由文件给定，边界条件也由文件给定。<br>第二种不需要从文件中读取，内部场和边界场的初始值都是这里给定的 0，边界条件默认是 calculated。也可以指定边界条件类型，如：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">volScalarField C_</span><br><span class="line">(</span><br><span class="line">    IOobject</span><br><span class="line">    (</span><br><span class="line">        <span class="string">"C"</span>,</span><br><span class="line">        mesh.time().timeName(),</span><br><span class="line">        mesh,</span><br><span class="line">        IOobject::NO_READ,</span><br><span class="line">        IOobject::NO_WRITE</span><br><span class="line">    ),</span><br><span class="line">    mesh,</span><br><span class="line">    dimensionedScalar(dimensionSet(<span class="number">1</span>, <span class="number">-3</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), <span class="number">0.</span>),</span><br><span class="line">    zeroGradientFvPatchScalarField::typeName</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>除了常规的 <code>IOobject</code> 构造，还有复制构造：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">tmp&lt;volScalarField&gt; tmagGradP = mag(fvc::grad(p));</span><br><span class="line">volScalarField normalisedGradP</span><br><span class="line">(</span><br><span class="line">    <span class="string">"normalisedGradP"</span>,<span class="comment">//如果不指定名字，默认是什么？</span></span><br><span class="line">    tmagGradP()/<span class="built_in">max</span>(tmagGradP())</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2 id="获取"><a class="markdownIt-Anchor" href="#获取"></a> 获取</h2><ul><li>const<ul><li><code>Internal&amp; internalField()</code>, 有量纲的内部场</li><li><code>Internal::FieldType&amp; primitiveField()</code>, 无量纲的内部场</li><li><code>Boundary&amp; boundaryField()</code>, 无量纲的边界场</li></ul></li></ul><p>-non-const<br>* <code>ref()</code>, 有量纲的内部场<br>* <code>primitiveFieldRef()</code>, 无量纲的内部场<br>* <code>boundaryFieldRef()</code>, 无量纲的边界场</p><p>用 <code>forAll</code> 来遍历的时候，遍历的其实就是那个 <code>field&lt;Type&gt;</code>。<br>所以总体是有量纲的，用 <code>forAll</code> 对每个 cell 或 face 遍历的时候，就失去量纲了。</p><p>使用举例：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt;<span class="string">"T============"</span>&lt;&lt;thermo.T()&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 有量纲的 内部+边界</span></span><br><span class="line">Info&lt;&lt;<span class="string">"T.internalField()============"</span>&lt;&lt;thermo.T().internalField()&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 有量纲的 内部+边界</span></span><br><span class="line">Info&lt;&lt;<span class="string">"T.primitiveField()============"</span>&lt;&lt;thermo.T().primitiveField()&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 无量纲的 内部</span></span><br><span class="line">Info&lt;&lt;<span class="string">"T.boundaryField()============"</span>&lt;&lt;thermo.T().boundaryField()&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 无量纲的 边界</span></span><br><span class="line">Info&lt;&lt;<span class="string">"T.ref()============"</span>&lt;&lt;thermo.T().ref()&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 有量纲的 内部+边界</span></span><br><span class="line">Info&lt;&lt;<span class="string">"T.primitiveFieldRef()============"</span>&lt;&lt;thermo.T().primitiveFieldRef()&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 无量纲的 内部</span></span><br><span class="line">Info&lt;&lt;<span class="string">"T.boundaryFieldRef()============"</span>&lt;&lt;thermo.T().boundaryFieldRef()&lt;&lt;<span class="built_in">endl</span>; <span class="comment">//无量纲的 边界</span></span><br></pre></td></tr></table></figure><p>T文件：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">dimensions [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">internalField uniform <span class="number">900</span>;</span><br><span class="line"></span><br><span class="line">boundaryField</span><br><span class="line">&#123;</span><br><span class="line">    walls</span><br><span class="line">    &#123;</span><br><span class="line">        type fixedValue;</span><br><span class="line">        value uniform <span class="number">1800</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">T============dimensions      [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">internalField   uniform <span class="number">900</span>;</span><br><span class="line"></span><br><span class="line">boundaryField</span><br><span class="line">&#123;</span><br><span class="line">    walls</span><br><span class="line">    &#123;</span><br><span class="line">        type            fixedValue;</span><br><span class="line">        value           uniform <span class="number">1800</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">T.internalField()============dimensions      [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">internalField   uniform <span class="number">900</span>;</span><br><span class="line"></span><br><span class="line">boundaryField</span><br><span class="line">&#123;</span><br><span class="line">    walls</span><br><span class="line">    &#123;</span><br><span class="line">        type            fixedValue;</span><br><span class="line">        value           uniform <span class="number">1800</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">T.primitiveField()============<span class="number">8</span>&#123;<span class="number">900</span>&#125;</span><br><span class="line">T.boundaryField()============</span><br><span class="line"><span class="number">1</span></span><br><span class="line">(</span><br><span class="line">    type            fixedValue;</span><br><span class="line">    value           uniform <span class="number">1800</span>;</span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">T.ref()============dimensions      [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">internalField   uniform <span class="number">900</span>;</span><br><span class="line"></span><br><span class="line">boundaryField</span><br><span class="line">&#123;</span><br><span class="line">    walls</span><br><span class="line">    &#123;</span><br><span class="line">        type            fixedValue;</span><br><span class="line">        value           uniform <span class="number">1800</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">T.primitiveFieldRef()============<span class="number">8</span>&#123;<span class="number">900</span>&#125;</span><br><span class="line">T.boundaryFieldRef()============</span><br><span class="line"><span class="number">1</span></span><br><span class="line">(</span><br><span class="line">    type            fixedValue;</span><br><span class="line">    value           uniform <span class="number">1800</span>;</span><br><span class="line"></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>这里有一个奇怪的现象，即 ref 指的是内部场，但这里输出的确实内部+边界。不要被这里迷惑了，其它地方仍指的是内部场：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">dimensionedScalar <span class="title">A</span><span class="params">(dimTemperature, <span class="number">100.</span>)</span></span>;</span><br><span class="line">thermo.T().ref() = A;</span><br><span class="line">Info&lt;&lt;<span class="string">"T============"</span>&lt;&lt;thermo.T()&lt;&lt;<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">T============dimensions      [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">internalField   uniform <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">boundaryField</span><br><span class="line">&#123;</span><br><span class="line">    walls</span><br><span class="line">    &#123;</span><br><span class="line">        type            fixedValue;</span><br><span class="line">        value           uniform <span class="number">1800</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="场的操作和运算-field-operation-and-manipulation"><a class="markdownIt-Anchor" href="#场的操作和运算-field-operation-and-manipulation"></a> 场的操作和运算( Field Operation And Manipulation)</h1><h2 id="ioobject-中定义的函数"><a class="markdownIt-Anchor" href="#ioobject-中定义的函数"></a> IOobject 中定义的函数</h2><ul><li>writeOpt<br>使用举例：</li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">mu_.writeOpt() = IOobject::AUTO_WRITE;</span><br></pre></td></tr></table></figure><h2 id="dimensionedfield-中定义的函数"><a class="markdownIt-Anchor" href="#dimensionedfield-中定义的函数"></a> DimensionedField 中定义的函数</h2><ul><li>平均</li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">p.average() = gAverage(p)</span><br></pre></td></tr></table></figure><ul><li>加权平均</li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">p.weightedAverage(weightField) = gSum(weightField*p)/gSum(weightField)</span><br></pre></td></tr></table></figure><p>使用举例：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt;<span class="string">"average p is "</span>&lt;&lt;p.weightedAverage(mesh.V()).value()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="comment">//全场压力的体积加权平均值</span></span><br></pre></td></tr></table></figure><ul><li>dimensions<br>使用举例：</li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Z_.dimensions().reset(dimless);</span><br></pre></td></tr></table></figure><h2 id="geometricfield-中定义的函数"><a class="markdownIt-Anchor" href="#geometricfield-中定义的函数"></a> GeometricField 中定义的函数</h2><ul><li>max, min<br>取最大值，包括内部场和边界场。并行计算时，Info输出的是master的还是全局的？未测试<br>使用举例：</li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt;<span class="string">"T=== "</span>&lt;&lt;<span class="built_in">max</span>(thermo.T())&lt;&lt;<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure><ul><li>writeMinMax<br>输出最小最大值，只包括内部场。</li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Type</span>, <span class="title">template</span>&lt;class&gt; <span class="title">class</span> <span class="title">PatchField</span>, <span class="title">class</span> <span class="title">GeoMesh</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:GeometricField&lt;Type, PatchField, GeoMesh&gt;::writeMinMax</span><br><span class="line">(</span><br><span class="line">    Ostream&amp; os</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    os  &lt;&lt; <span class="string">"min/max("</span> &lt;&lt; <span class="keyword">this</span>-&gt;name() &lt;&lt; <span class="string">") = "</span></span><br><span class="line">        &lt;&lt; Foam::<span class="built_in">min</span>(*<span class="keyword">this</span>).value() &lt;&lt; <span class="string">", "</span></span><br><span class="line">        &lt;&lt; Foam::<span class="built_in">max</span>(*<span class="keyword">this</span>).value()</span><br><span class="line">        &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用举例：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Z_.writeMinMax(Info);</span><br></pre></td></tr></table></figure><p>下面是详细的测试：<br>T文件：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">dimensions [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">internalField uniform <span class="number">900</span>;</span><br><span class="line"></span><br><span class="line">boundaryField</span><br><span class="line">&#123;</span><br><span class="line">    walls</span><br><span class="line">    &#123;</span><br><span class="line">        type fixedValue;</span><br><span class="line">        value uniform <span class="number">1800</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用举例：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Info&lt;&lt;<span class="string">"max(T)=== "</span>&lt;&lt;<span class="built_in">max</span>(thermo.T())&lt;&lt;<span class="built_in">endl</span>; <span class="comment">//内部+边界</span></span><br><span class="line">Info&lt;&lt;<span class="string">"min(T)=== "</span>&lt;&lt;<span class="built_in">min</span>(thermo.T())&lt;&lt;<span class="built_in">endl</span>; <span class="comment">//内部+边界</span></span><br><span class="line">Info&lt;&lt;<span class="string">"max(T.internalField)=== "</span>&lt;&lt;<span class="built_in">max</span>(thermo.T().internalField())&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 内部</span></span><br><span class="line">Info&lt;&lt;<span class="string">"min(T.internalField)=== "</span>&lt;&lt;<span class="built_in">min</span>(thermo.T().internalField())&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 内部</span></span><br><span class="line">Info&lt;&lt;<span class="string">"max(T.ref)=== "</span>&lt;&lt;<span class="built_in">max</span>(thermo.T().ref())&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 内部</span></span><br><span class="line">Info&lt;&lt;<span class="string">"min(T.ref)=== "</span>&lt;&lt;<span class="built_in">min</span>(thermo.T().ref())&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 内部</span></span><br><span class="line">Info&lt;&lt;<span class="string">"max(T.boundaryField)=== "</span>&lt;&lt;<span class="built_in">max</span>(thermo.T().boundaryField())&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 边界</span></span><br><span class="line">Info&lt;&lt;<span class="string">"min(T.boundaryField)=== "</span>&lt;&lt;<span class="built_in">min</span>(thermo.T().boundaryField())&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// 边界</span></span><br><span class="line">thermo.T().writeMinMax(Info); <span class="comment">// 内部</span></span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">max</span>(T)=== <span class="built_in">max</span>(T) [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>] <span class="number">1800</span></span><br><span class="line"><span class="built_in">min</span>(T)=== <span class="built_in">min</span>(T) [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>] <span class="number">900</span></span><br><span class="line"><span class="built_in">max</span>(T.internalField)=== <span class="built_in">max</span>(T) [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>] <span class="number">900</span></span><br><span class="line"><span class="built_in">min</span>(T.internalField)=== <span class="built_in">min</span>(T) [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>] <span class="number">900</span></span><br><span class="line"><span class="built_in">max</span>(T.ref)=== <span class="built_in">max</span>(T) [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>] <span class="number">900</span></span><br><span class="line"><span class="built_in">min</span>(T.ref)=== <span class="built_in">min</span>(T) [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>] <span class="number">900</span></span><br><span class="line"><span class="built_in">max</span>(T.boundaryField)=== <span class="number">1800</span></span><br><span class="line"><span class="built_in">min</span>(T.boundaryField)=== <span class="number">1800</span></span><br><span class="line"><span class="built_in">min</span>/<span class="built_in">max</span>(T) = <span class="number">900</span>, <span class="number">900</span></span><br></pre></td></tr></table></figure><ul><li>gMax<br>max的并行版，但是返回的是无量纲的值？</li></ul><h2 id="fieldfunctions"><a class="markdownIt-Anchor" href="#fieldfunctions"></a> FieldFunctions</h2><p>一些底层的函数，一般用不到</p><h2 id="dimensionedfieldfunctions"><a class="markdownIt-Anchor" href="#dimensionedfieldfunctions"></a> DimensionedFieldFunctions</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">pow</span></span><br><span class="line">sqr</span><br><span class="line">magSqr</span><br><span class="line">mag</span><br><span class="line">cmptAv</span><br><span class="line">gMax</span><br><span class="line">gMin</span><br><span class="line">gSum</span><br><span class="line">gSumMag</span><br><span class="line">gAverage</span><br><span class="line">+</span><br><span class="line">-</span><br><span class="line">*外积</span><br><span class="line">/</span><br><span class="line">^叉乘</span><br><span class="line">&amp;点乘，内积</span><br><span class="line">&amp;&amp; 双内积</span><br></pre></td></tr></table></figure><h2 id="geometricfieldfunctions"><a class="markdownIt-Anchor" href="#geometricfieldfunctions"></a> GeometricFieldFunctions</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">pow</span></span><br><span class="line">sqr</span><br><span class="line">magSqr</span><br><span class="line">mag</span><br><span class="line">cmptAv</span><br><span class="line">gMax返回的是无量纲的？</span><br><span class="line">gMin</span><br><span class="line">gSum</span><br><span class="line">gSumMag</span><br><span class="line">gAverage</span><br><span class="line">+</span><br><span class="line">-</span><br><span class="line">*外积</span><br><span class="line">/</span><br><span class="line">^叉乘</span><br><span class="line">&amp;点乘，内积</span><br><span class="line">&amp;&amp; 双内积</span><br></pre></td></tr></table></figure><h2 id="fvc-中的操作"><a class="markdownIt-Anchor" href="#fvc-中的操作"></a> fvc 中的操作</h2><h3 id="volumeintegrate"><a class="markdownIt-Anchor" href="#volumeintegrate"></a> volumeIntegrate</h3><p>volumeIntegrate 的功能是对每个网格的某个物理量，乘以其网格体积，然后形成一个新的场。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">volumeIntegrate(df) = df.mesh().V()*df.field();</span><br></pre></td></tr></table></figure><h3 id="domainintegrate"><a class="markdownIt-Anchor" href="#domainintegrate"></a> domainIntegrate</h3><p>domainIntegrate 的功能是对某个物理量，乘以其网格体积，然后对所有网格求和。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">domainIntegrate(df) = gSum(fvc::volumeIntegrate(df));</span><br></pre></td></tr></table></figure><p>这里的 gSum 是对全场求和。</p><p>其它 fvc 中的操作</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">surfaceIntegrate</span><br><span class="line">surfaceSum</span><br><span class="line">Su</span><br><span class="line">Sp</span><br><span class="line">SuSp</span><br><span class="line">snGrad</span><br><span class="line">reconstruct</span><br><span class="line">laplacian</span><br><span class="line">grad</span><br><span class="line">flux</span><br><span class="line">div</span><br><span class="line">DDt</span><br><span class="line">curl</span><br><span class="line">average</span><br><span class="line">cellReduce</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;F&lt;/strong&gt;ield &lt;strong&gt;O&lt;/strong&gt;peration &lt;strong&gt;A&lt;/strong&gt;nd &lt;strong&gt;M&lt;/strong&gt;anipulation&lt;/p&gt;
    
    </summary>
    
    
      <category term="code" scheme="https://openfoam.top/categories/code/"/>
    
    
      <category term="field" scheme="https://openfoam.top/tags/field/"/>
    
  </entry>
  
  <entry>
    <title>OpenFOAM 拉格朗日库深度解析</title>
    <link href="https://openfoam.top/lagrangian/"/>
    <id>https://openfoam.top/lagrangian/</id>
    <published>2019-03-31T22:00:00.000Z</published>
    <updated>2020-03-16T23:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>拉格朗日库类解析</p><a id="more"></a><h1 id="类的结构"><a class="markdownIt-Anchor" href="#类的结构"></a> 类的结构</h1><details><summary>点开查看 UML</summary><img src="http://www.plantuml.com/plantuml/svg/nLhTRziu4d_FNq6WWE1WdIBFJIx0hfDsWzrSWrffhqy18z4sMtqTHQNrzVg_7pyb3aN9aZTtruV6uipyD1mEvuDKNJ6yNsLbawBBVv-TeNNxVFA1u8JJOXkala7gJxolo0dhCmBPatX7M5uEaLqexdCweYT_q8BacDCaJ7TnlWPOeVZ98CN5IJecBQKiS8zPGZ9d-0qIGq8-8qhAJi_bSmGLj_YhUFK4N4ue3PXRHLr-5m5mLqOdRv81JZ5FNDUe5VXnWiI_iwGiQewgCjlVaNeNeLpy_wX9JvZj4r9mHXEKb2LBQO4vgGqrmqz2Eu6UKJ322N-B4z8RlETmQECmrGdEC4Cr9zLR9YrJ5e2tP7HxpygaDtYRcg7dagQ8aKr64huuTSTABfHUw6a-bMM6Kig8UeNBbknmiIKnuGkXQipeRPyePpLCNGb3B0A8vHqMqsBtc2SxGtzyHEeHqK9Gz7HhCQg8hvIEEygrH2peNrjVZPQ8om7XETUOuqZZ_QBjiINyx-IRTTBRwyKfKhFMFA5r3d4uYnwvgmvvkyKFZHiN623Tyn1XqnC8E4M88V8uN53hDu4NHWxH5xbD1mKaIG_UOyekjGfNG8LrXOEAegHXJ5WsfZa9JqWOvxP8QKBgbhSTWPpEAiMag4lc20YNAUfDoN8eyYoSNl0LWe2zLLCkLnRzDJE4M-cd1Su66Nuhco8LAWsjUgMzFw1ELTOK6EAd5wVUl74ztaGj_Txw6nMmSWb9BKpWKBuIKjcD8107iCuoik5dxPlCY_tugz_uognXOM4VmN3gFSQOYUre1irK7o0FsvLm06yzK1utxCd3w8PQzszLifvf2MblGAjbXpLcX1vyFg6QFoIKyuUKUZqiP_2LZYX6TI6LV2HPcL2-jwkDp3-mJNAn2YgQQXOGy11FGpjBYWItN5xcObEytzmMHDW81tcUowp9_TZ3fGSWo9420o0iQgBxCJ7D491Q7v9Q-r8Vo2Hh020X8nOoMJui7v9bkioR169-6i9SrdIRun7aJn1PimFic_9OR26vNGhqfNa3X5UPjIPS-iT7d3KYBdeP4gboRjatb0CWNV6QrXLXjGmzOOIUvYa765Q3TTc8EB4gcQagZeGJAisMLB4kBv_9L4ar8FEF2p1KQqonf9IryVUlW7p2MNQKF6MymHbIEDmcFg5I9VUxy0xZXIf7HYYUAbOJaHMmBX9_XXD3C36TuOQNzvnTgj9EL5iAmvO9LpAogcHQFOwnwuWfs1ycCBVOUGEukpHZosQRGnB88GB3eziBc52kXzGSPO9HQVBHhHI3QaJT54FLPN2UaPtdOOdsBNQomOWkvnmk5JN5Ira9p6pI865fHG32Mw-00zOQe4M6EEnOIWeNl7D8MuLecuY2K5f355pgfrczL80KwJMZpwIu4QNX_b8LNrVoTQO9RDkbFg-jP8M5xcWnXUty85DE2pqbqGFLm7Uw6KJgTxXexDGUMcQXwX3fF5mGk2evHUVuvZQLeiTqCcNX1aJroeE30LXenh0MN9bj_KecYjy9DbK-OOlNhrz3zus34r-5jyhEgvjUAC6-V79SDqosY4OdEUcUsdDpwC_0AenilX57Zm_lXNZAhehlyFU3JAlgyDj8LTEiB0upRiuVeVE4jqqyjD6anc4FKXJvtwddX-4tM8s3nCrvhp-4YnPAnIQRbTbQWRob94lRVHIcViLLXQTbstXEQbvLSxYL5dC4teKIV-ob-LMLW10Cfnxr0aIOI-as8q_7ipExjTKC4STWCwJUZLGGyK054FkrWh1gc5CHXBUE-Ab93Ix7oS5O51BIEy8xaORfH7R8vo2bQ8__RCyNR02zt-6QhDJPPPTQB4fJfPWJcJhR0om5lDI6hbrFIINR4Wnz3bTL4W6QrV8lJl-VMGaTIaiQ06QcYVad3fbiPUsb2jNk8M-wt_Ui-wtylfxOHgBH7EXTI1oL1Qkn52TRpIjaOJ-g4nMOUgfUZb7jAHJfvG5VyIEQiYeKFhreEH13gk4O8eWw0engQBOpv3cPi1fXGMqJzmBB79XouGafsI3vjy0vSMw6F8tSXmjugdaE3oFjsIsCAqYTry2Xl87F6VrdGrEn0RqJppz-fqLAliF1lVTuNNBld3JntbR3PrfyKGfxKdTb3aUQcZ3eakdvwA5rk5XHymyt7qrmkBD6a6oC4gJjmwF2H442Jy9wXGzFhTt2KC9yGOAqud-bfn2XxLTUvlHV-A_4R87o6oFuQrCTY_2_o29TKtTSM0VNJZiwMJQGbFxH9GdtVlke3A6sneHpWyRhIhJSm9voUuD36fgewR2PgNaV4_nm3oBCYK6xIT3Vq7dl-k6sMEzhJl8-amaQcNW3PdVgGgB9ts-6sDkW8DdbiO5GwgOWRBi_A7DDlope4dqPfETTizOHpH5fNbt2OlyAFOiuilv6I3L7YEy8ntC4S5RjPWc8skXcim4IlQCqTnaV7qMQt1162dcpoakfejXIZ572q1RNQ2DnknluSEVJtTUrz8zgPGtzOLIwpO3s_4kuWRny8Eb7SmovXSce-ZL_ei9LpEYjYiL2uAvCIVOdhVabdEjbkxj5HMCZjqs4jW3gBZqKp0Z4bL0Hy7f8wh3-jlj-uJ1U5PBmKDUyJ4J_8G7ABAFJ5Aq7X7ni7M3VqYoVWEanUrYo6jpg-u5riYCvCKVrSgojCompT9GtR-njkf1HXtXzTiTp0Fkg99kDsx29fAhKg-sDgnujisU25cWewDiIi1ee0MKcG2xWKqEpL6RlzqdILBX8zk1zkYiSffDdgP3UaI-ebQZ2-8s21czJU1-8CCrYS8N5Mq_7JZdK1NZmC0Hk-Iad9dxHDnm0WldDne615gEbkk2pWaNK1WluYgD1N4sc1voeYpTGZoCXN2tc1gl8ZrLGenU0SxKx8kX5WPW7TNmnKA3fz10QEH7Kq-nO4ByT1m4uSWEmttw4uszauk_YT7YFEzoMsOCEnkh8nEh5I9HneGqpk2uKXS_cMQjoXpcZtw_G-c7H2q61YpE_NZrOgyweK-VMgF1MJdwBAQ_zikaoNaqxMC_EhcLdrR6pQjXvzIliaSsnZ3xTxVgMXPCM8_DxYJ8i_BtOKbnSSmJwnHrHTys2QnR84ZdVoMwQBDjVapfXz8ca05z42aRMwiDQTvYHOGBXkb-EnSngZvZXxoXyfISNcWpGb9m6jTzvZ2Ly-VjzbZfVltHli2WkeM84L1U_EBKC6CfBwTClKzcOLyjyeGxZ5cP1mCBPLP8VywfS9CR4eFsUGN_XsJq_LAXlF7EIhpu23dmJ8ulHErmPi-QukhSV3dUd0Uvt_3yWHiZhRm9Tv1W_diclpWYgO5SOzpGrRTZwptUQ5fdPZFPmyIYrykfuzv9U9pf73T1jx7pEmzr6tEisrkfZMCHmId7t_Vo4hc9Np-j2ThNJXlmoOCSfXN4yXIaOhYURDd9DEtGrwDKHyKWTCP3iZGadPlkMUohud5AYvUxN4bgWhILs2z_MkxedDRo9Xtdm11wuMU7LQo-fjmJ_VcWyQIu2sSvDTgSNXpBc8OJbOBO4s6vIl1XCbnUZ-V9YFF65_T_BUXU3QUyYdFSkGedFltW3OTM6ZrMPsqiIlK41DuX-YSVg7pHrzz67a2gFrI095DMz3eSqKP0vCT1iiUbJY9mfM0Uz0Ftdv3b4pXoyflD8Z0FXnKvzGM77VCXcdI3KSeRSI6pwJ4NDxuUdp_H0M75UivOdE3FuqRftv1DKJ7853elwKOcqMmXSdhYRnTuqusV2y9RuNqgsEy2vzD8hto41zySUdmTZRhr68T2JmmIlO7fQUfvkZwk8QEnqGbrip757Q4jCd5JaJ0ekprG0111S5IOO93BsWA-U8eXQoG6d-0y0"></details><h1 id="喷雾子模型"><a class="markdownIt-Anchor" href="#喷雾子模型"></a> 喷雾子模型</h1><h2 id="kinematicparcel"><a class="markdownIt-Anchor" href="#kinematicparcel"></a> KinematicParcel</h2><p>Kinematic parcel class with rotational motion (as spherical particles only) and one/two-way coupling with the continuous phase.</p><ul><li>InjectionModel<ul><li>CellZoneInjection</li><li>ConeInjection</li><li>ConeNozzleInjection</li><li>…</li></ul></li></ul><img src="http://www.plantuml.com/plantuml/svg/jLPFJ-iu4B_pAIojX5eH4EmHkaXikvLwA8sMBbVanbFgVOuTsKvumFBTTn8d9avDjtfwsqkTcV7y_SsCfqALxA7SB1K3yJirG2R_d9-JXVmRCikLREWduQSJcIe9z-hjJO3ddcI26ZEuF9dM9jQl1To-dn3ydLayCzYI-b_I78YNkBukgCv0r6VoURnnzq2MUKj5JxbvBpRtPRu1dHIR9Hh6lpd_3kp3oJyzaLGhYwu08unQYfI6yOl9gA2QFAmMJpS1fLAYp66jB1K3Jexw0_gQvp0lPHFdrSH9tJPYSw5U_gGM8XfSPe1rB44tc4xf4sP2XelLt346B33UIq8_8GEBCgNQyan0avK1qwB_bn7QWuMYemSPN4ATQjB5R7msAwvjIGNPA2L8HGLdFfvHXeAMzADPZCblvF8cShNGW28mL_eUljjrwqkhekTXqgWx9H9UKfUWn74RqcDJmhccZGFZcA4jbsmAGjpPL1dU-DcgH6M2T_ejs3dDeF-TMfvK69f2MqLxDsbqWjPAh-IzidDLIeOnMbt2q7mRXG7hWBlQTYKoaLIP98Yz2Y8BUOnZ7rdiX82gTsheGQKugrsthaRJ7MJVOgORp8NQQW0tvB57nrUOE0lCbGLs7op1x4RjrJCk1PT00jnX9aPZqfYCIlMQyw2SRzN_bEhQSI0ug5RjtH_I2tt2rmi6cLihftOVk9V97kbg754tYFSdgQCLQFeChcNgSJainjumYkVlYz4q4BQG5mAhFd4hOOse_VQv21fOS1TNoC8Uh8_9uTrmVMthMrm-pt2kOsjsc0o1XttMTVYTQ_dOG4hwD9d6MgyPEtkDtniQgnU9pNTmSCHAuxtKgW0S1D4nSBI3d_avRQ_6RBeHM0hnEWEJQRw1Gz1kAxLLevMn6cX-IfJ1P7-SjCi-yWpOt_ZDvkR-MG1sfzWxprF5fKruFkCc--Wl-IskqFh--zPEQyUej8yWLCRjQxB5R84nfOQPvXN87gFRl5ZiMkMEwcVeFmPuXSpWAN0-S6hePBi8ppk7l6ST8wY2Ad44pzfH79NWKkvBT3EyrBIst94TtZpSEhA3WVDJwHhK8QT3tnuLCJXGpRXsmOQ-1XsUWdu0fBDG9lxysRO5G3nlkO1ZhjWTMBgeqtAqzAhSIoyjhKgjdZ2EAEMRqhy-RudXRp3haGSvG6mzGdOLfVuwe4gbS_y8wyhsrv8-TwIuqrDsc9zYCRsbTY8iGXnsizhpvoqEHpzX6SVtt8_kE1BPIZ-wu8xGzTMWlxYu6F-lq_RmXl8J-FZf6vCyuZcDi_XV"><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">InjectionModelList</span></span></span><br><span class="line"><span class="class">:</span></span><br><span class="line">    <span class="keyword">public</span> PtrList&lt;InjectionModel&lt;CloudType&gt;&gt;</span><br></pre></td></tr></table></figure><img src="http://www.plantuml.com/plantuml/svg/RKzDImCn4BtxA-QqRB47lTOYY7eGN1IwzsMOZ3LjabcIsGKf_dVJhAwMcjFZVUJD8uSfmLFOCQcLq8XXzsoJhk-T3ARzwFdsS07vTHtS4N4sTrqXBXEXmmXgFMyKezOB80b9Ryxans3-5qTnW-TMflwwEE1Fy6e9PzprulGF73dYbbyn4hichwb_3ADO0qDlKBdXz3xpohvtcLnJ6Tz6fFtlt9Aoqq6dKWLqX4lDEA1dc9NLgY_r4zPZoeRj0ofMe6Q-nqOTqC5tmvlKBqaZewz0KZPzVW40"><p><code>ConeNozzleInjection</code> 构造函数：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">tanVec1_ = normalised(perpendicular(direction_));</span><br><span class="line">tanVec2_ = normalised(direction_ ^ tanVec1_);</span><br></pre></td></tr></table></figure><p><code>ConeNozzleInjection::setPositionAndCell</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">scalar beta = mathematical::twoPi*rndGen.globalScalar01();</span><br><span class="line">normal_ = tanVec1_*<span class="built_in">cos</span>(beta) + tanVec2_*<span class="built_in">sin</span>(beta);</span><br></pre></td></tr></table></figure><p><code>ConeNozzleInjection::setProperties</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">scalar alpha = <span class="built_in">sin</span>(coneAngle);</span><br><span class="line">scalar dcorr = <span class="built_in">cos</span>(coneAngle);</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span> normal = alpha*normal_;</span><br><span class="line"><span class="built_in">vector</span> dirVec = dcorr*direction_;</span><br><span class="line">dirVec += normal;</span><br><span class="line">dirVec /= mag(dirVec);<span class="comment">//dirVec是速度方向向量</span></span><br></pre></td></tr></table></figure><p><code>ConeNozzleInjection::setProperties</code> 函数的作用是设置出射粒子的速度和直径：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">parcel.d() = sizeDistribution_-&gt;sample();</span><br></pre></td></tr></table></figure><p><code>ConeNozzleInjection::setProperties</code> 函数在 <code>InjectionModel::inject</code> 中被调用。<br>粒子直径在这里给定，然后在哪里更新呢？我知道的有破碎模型里边。在 <code>SprayParcel::calc</code> 中调用了破碎模型的 <code>update</code>，<code>this-&gt;d()</code> 作为引用参数传入 <code>update</code> 函数，被破碎模型修改。</p><p><code>InjectionModel::prepareForNextTimeStep</code></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Number of parcels to inject</span></span><br><span class="line">newParcels = <span class="keyword">this</span>-&gt;parcelsToInject(t0, t1);</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:label Foam::ConeNozzleInjection&lt;CloudType&gt;::parcelsToInject</span><br><span class="line"><span class="comment">//计算该时间步长内喷射的 parcels 数</span></span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar time0,</span><br><span class="line">    <span class="keyword">const</span> scalar time1</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ((time0 &gt;= <span class="number">0.0</span>) &amp;&amp; (time0 &lt; duration_))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">floor</span>((time1 - time0)*parcelsPerSecond_);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>KinematicCloud</code> 中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//- Injector models</span></span><br><span class="line">InjectionModelList&lt;KinematicCloud&lt;CloudType&gt;&gt; injectors_;</span><br><span class="line"></span><br><span class="line"><span class="comment">//- construct</span></span><br><span class="line">injectors_</span><br><span class="line">(</span><br><span class="line">    subModelProperties_.subOrEmptyDict(<span class="string">"injectionModels"</span>),</span><br><span class="line">    *<span class="keyword">this</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">const</span> <span class="title">Foam</span>:</span>:InjectionModelList&lt;Foam::KinematicCloud&lt;CloudType&gt;&gt;&amp;</span><br><span class="line">Foam::KinematicCloud&lt;CloudType&gt;::injectors() <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> injectors_;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">injectors_.inject(cloud, td);</span><br><span class="line"></span><br><span class="line">injectors_.updateMesh();</span><br><span class="line"></span><br><span class="line">injectors_.info(Info);</span><br></pre></td></tr></table></figure><p>最重要的 <code>inject</code> 函数在 <code>KinematicCloud::evolveCloud</code> 函数被调用。</p><h3 id="distributionmodel"><a class="markdownIt-Anchor" href="#distributionmodel"></a> distributionModel</h3><img src="http://www.plantuml.com/plantuml/svg/ZOq_2y8m44VtVeg3WYWkxiLDT2f81zTmpHqOp1z9BaKHlxjDeLC5NU_UUpzjCIKWaoIQFei9lWt4zbKf1USOXBKm0Q4WA5NLElWa8wuBYV6vD0_ZJpLLtQ6du5OGFPtObyjWecIqC0H3eA-iR-iDJC6chBNiUevmp7wAfxAtdPsaqMA4XEvkUTPW3xjcmJZZBsZpBmeV_r2CtsBl3m00"><p>哪里被用到？<br>答：<code>InjectionModel</code> 的派生类中，比如 <code>ConeNozzleInjection.H</code> 中：<br>类外申明：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Forward declaration of classes</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">distributionModel</span>;</span></span><br></pre></td></tr></table></figure><p>类内申明：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> autoPtr&lt;distributionModel&gt; sizeDistribution_;</span><br></pre></td></tr></table></figure><p><code>ConeNozzleInjection.C</code> 中，先 <code>#include &quot;distributionModel.H&quot;</code>，然后在构造函数中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">sizeDistribution_</span><br><span class="line">(</span><br><span class="line">    distributionModel::New</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">this</span>-&gt;coeffDict().subDict(<span class="string">"sizeDistribution"</span>),</span><br><span class="line">        owner.rndGen()</span><br><span class="line">    )</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>这其实是很好的一个 RTS 的简单使用典范，可以参考这个，制作自己的 RTS。</p><ul><li>particleForces<ul><li>SphereDrag</li><li>…</li></ul></li><li>patchInteractionModel<ul><li>localInteraction</li><li>rebound</li><li>standardWallInteraction</li><li>none</li></ul></li></ul><h2 id="thermoparcel"><a class="markdownIt-Anchor" href="#thermoparcel"></a> ThermoParcel</h2><p>Thermodynamic parcel class with one/two-way coupling with the continuous phase. Includes Kinematic parcel sub-models, plus:</p><ul><li>heatTransferModel<ul><li>RanzMarshall</li></ul></li><li>surfaceFilmModel<ul><li>thermoSurfaceFilm</li></ul></li></ul><h2 id="reactingparcel"><a class="markdownIt-Anchor" href="#reactingparcel"></a> ReactingParcel</h2><p>Reacting parcel class with one/two-way coupling with the continuous phase.</p><ul><li>compositionModel<ul><li>SinglePhaseMixture<br>算例文件 sprayCloudProperties：</li></ul></li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">compositionModel SinglePhaseMixture;</span><br><span class="line"></span><br><span class="line">singlePhaseMixtureCoeffs</span><br><span class="line">&#123;</span><br><span class="line">    phases</span><br><span class="line">    (</span><br><span class="line">        liquid</span><br><span class="line">        &#123;</span><br><span class="line">            C7H16               <span class="number">0.39</span>;</span><br><span class="line">            C8H18               <span class="number">0.61</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意这里给定的混合燃料的质量分数。</p><p><code>CompositionModel</code> 中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">phasePropertiesList phaseProps_;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:CompositionModel&lt;CloudType&gt;::CompositionModel</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> dictionary&amp; dict,</span><br><span class="line">    CloudType&amp; owner,</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; type</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    CloudSubModelBase&lt;CloudType&gt;(owner, dict, typeName, type),</span><br><span class="line">    thermo_(owner.thermo()),</span><br><span class="line">    phaseProps_</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">this</span>-&gt;coeffDict().lookup(<span class="string">"phases"</span>),</span><br><span class="line">        thermo_.carrier().species(),</span><br><span class="line">        thermo_.liquids().components(),</span><br><span class="line">        thermo_.solids().components()</span><br><span class="line">    )</span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure><p><code>phasePropertiesList</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">List&lt;phaseProperties&gt; props_;</span><br><span class="line"></span><br><span class="line">Foam::phasePropertiesList::phasePropertiesList</span><br><span class="line">(</span><br><span class="line">    Istream&amp; is,</span><br><span class="line">    <span class="keyword">const</span> wordList&amp; gasNames,</span><br><span class="line">    <span class="keyword">const</span> wordList&amp; liquidNames,</span><br><span class="line">    <span class="keyword">const</span> wordList&amp; solidNames</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    props_(is),</span><br><span class="line">    phaseTypeNames_(),</span><br><span class="line">    stateLabels_()</span><br><span class="line">&#123;</span><br><span class="line">    forAll(props_, i)</span><br><span class="line">    &#123;</span><br><span class="line">        props_[i].reorder(gasNames, liquidNames, solidNames);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    phaseTypeNames_.setSize(props_.<span class="built_in">size</span>());</span><br><span class="line">    stateLabels_.setSize(props_.<span class="built_in">size</span>());</span><br><span class="line">    forAll(props_, i)</span><br><span class="line">    &#123;</span><br><span class="line">        phaseTypeNames_[i] = props_[i].phaseTypeName();</span><br><span class="line">        stateLabels_[i] = props_[i].stateLabel();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>phaseProperties</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Foam::phaseProperties::phaseProperties(Istream&amp; is)</span><br><span class="line">:</span><br><span class="line">    phase_(UNKNOWN),</span><br><span class="line">    stateLabel_(<span class="string">"(unknown)"</span>),</span><br><span class="line">    names_(<span class="number">0</span>),</span><br><span class="line">    Y_(<span class="number">0</span>),</span><br><span class="line">    carrierIds_(<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">    is.check(<span class="string">"Foam::phaseProperties::phaseProperties(Istream&amp; is)"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function">dictionaryEntry <span class="title">phaseInfo</span><span class="params">(dictionary::null, is)</span></span>;</span><br><span class="line"></span><br><span class="line">    phase_ = phaseTypeNames[phaseInfo.keyword()];</span><br><span class="line">    stateLabel_ = phaseToStateLabel(phase_);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (phaseInfo.<span class="built_in">size</span>() &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        label nComponents = phaseInfo.<span class="built_in">size</span>();</span><br><span class="line">        names_.setSize(nComponents, <span class="string">"unknownSpecie"</span>);</span><br><span class="line">        Y_.setSize(nComponents, <span class="number">0.0</span>);</span><br><span class="line">        carrierIds_.setSize(nComponents, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">        label cmptI = <span class="number">0</span>;</span><br><span class="line">        forAllConstIter(IDLList&lt;entry&gt;, phaseInfo, iter)</span><br><span class="line">        &#123;</span><br><span class="line">            names_[cmptI] = iter().keyword();</span><br><span class="line">            Y_[cmptI] = readScalar(phaseInfo.lookup(names_[cmptI]));</span><br><span class="line">            cmptI++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        checkTotalMassFraction();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个 <code>CompositionModel</code> 在哪里使用呢？<br>首先 <code>compositionModel_</code> 在 <code>ReactingCloud</code> 中定义，并提供了一个接口函数 <code>composition()</code>。<br>在 <code>ReactingParcel</code> 的 <code>calcPhaseChange</code> 函数中，如下片段中被用到：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> CompositionModel&lt;reactingCloudType&gt;&amp; composition =</span><br><span class="line">        cloud.composition();</span><br><span class="line"></span><br><span class="line"><span class="function">scalarField <span class="title">X</span><span class="params">(composition.liquids().X(Y))</span></span>;</span><br><span class="line"></span><br><span class="line">forAll(dMassPC, i)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> label cid = composition.localToCarrierId(idPhase, i);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar dh = phaseChange.dh(cid, i, td.pc(), Tdash);</span><br><span class="line">    Sh -= dMassPC[i]*dh/dt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">forAll(dMassPC, i)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> label cid = composition.localToCarrierId(idPhase, i);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar Cp = composition.carrier().Cp(cid, td.pc(), Tsdash);</span><br><span class="line">    <span class="keyword">const</span> scalar W = composition.carrier().W(cid);</span><br><span class="line">    <span class="keyword">const</span> scalar Ni = dMassPC[i]/(<span class="keyword">this</span>-&gt;areaS(d)*dt*W);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar Dab =</span><br><span class="line">        composition.liquids().properties()[i].D(td.pc(), Tsdash, Wc);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Molar flux of species coming from the particle (kmol/m^2/s)</span></span><br><span class="line">    N += Ni;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sum of Ni*Cpi*Wi of emission species</span></span><br><span class="line">    NCpW += Ni*Cp*W;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Concentrations of emission species</span></span><br><span class="line">    Cs[cid] += Ni*d/(<span class="number">2.0</span>*Dab);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在 <code>SprayParcel</code> 的 <code>calc</code> 函数中，如下片段中被用到：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> CompositionModel&lt;reactingCloudType&gt;&amp; composition =</span><br><span class="line">        cloud.composition();</span><br><span class="line">        </span><br><span class="line">                                                       </span><br><span class="line"></span><br><span class="line"><span class="function">scalarField <span class="title">X0</span><span class="params">(composition.liquids().X(<span class="keyword">this</span>-&gt;Y()))</span></span>;</span><br><span class="line"></span><br><span class="line">scalar TMax = composition.liquids().Tc(X0);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (composition.liquids().pv(pc0, T0, X0) &gt;= pc0*<span class="number">0.999</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Set TMax to boiling temperature</span></span><br><span class="line">    TMax = composition.liquids().pvInvert(pc0, X0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>在 <code>SprayParcel</code> 的 <code>calcAtomization</code> 函数中，如下片段中被用到：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">scalar chi = <span class="number">0.0</span>;</span><br><span class="line"><span class="keyword">if</span> (atomization.calcChi())</span><br><span class="line">&#123;</span><br><span class="line">    chi = <span class="keyword">this</span>-&gt;chi(cloud, td, composition.liquids().X(<span class="keyword">this</span>-&gt;Y()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="http://www.plantuml.com/plantuml/svg/jLPRRzem67tdL_WfeYeW7lO6G-fOwT02xHIghQggoZXUQyt4cUtGTLt_-tp9nGc6K6dZeHJxVEUx7N_sbB8iZhBrWiMOVe02W_6VVXzCsIPbWaZ24hFJQIvOM4II1ugl7fNTWloI6SUT3g9GY1s2yLGxMZsdUFBI0UfpVm-kEDb2YK4C9LI_pN8ViKH848KNgqVCDom0qdpVZ-nsgdrTSPPYBWaM8L7WSataACLzXX1MOUIiftjOkoV0x8nSr1eAWg8K8r8a5G04EIUOU_6K_Cn8d4Ehq89yGtYDF7a4JY8D6mhNgkI9ARINxednsE7GTHOjG25LxKDDt8P4kfS9JkGIRXHjdhK9oNYR-uBDApQFknMTejgaXgMNbven2Y2bx6d9v8nbIGpUW--G2koZf0n1MXAw0VJ-hOyLcpQYzpYpIoH-enkB5ieBv3E2gGhuPjXQKmSFllbY0ZxUEiUMS9b1waNcwXqMIb2n3njcHRuNK1o12etsZm16ZFfmwWYVRo7De9uWvJ4kZ6tmuDF-xjJJgos2jFvpvIzJuKDq1uF1OGXgXKpJLaXOGxmMWtHtn1uzIfsE5UEptfxcgkd5tXdw9lsySAmM4ZLdYUXFtC5sExmRt7HFHg-jyZfAMiV8oYcdP-uUBg96Z1jM4v0wjqs_c9JLx3M3ScVRcRXLaHTuiyOSpB84QQathool-y3w__ytWQsc8B_nCPTO0FH_K39-U-UUpDOkL1t8rfIWMWDESP9jgbnUBiwYNZZ_SZt_s8ikG_NtUlbvUVbr-LfCIfMCeh3kTH_YSqKmBWbwuDsaqQZHGG6KM6lbTjMfNB5i-gNt9Y1nHU0Ey9lQkJFIA6zBHnb5DFiKqjyo4WEEbJFrCjbfgdd0cFnEHWvUO5bURcB7AezZrmmzOlHZnIIa2zN06OScbhegR4rilLXKbgRhYCNMKTRCghxlFGi7Cts0miJRQsxOzvT_J-ZvuAPvskZptZFZdfS6oCa_rvQNfT98O4Lom9VUhzrojg-a_L7HzRqWzBgFhVwWBMGPEBhqJWPIVzrLcgkE_5y0"><ul><li>phaseChangeModel<ul><li>liquidEvaporationBoil</li><li>liquidEvaporation</li></ul></li></ul><h2 id="spray"><a class="markdownIt-Anchor" href="#spray"></a> spray</h2><ul><li>atomizationModel<ul><li>BlobsSheetAtomization</li><li>LISAAtomization</li></ul></li><li>breakupModel<ul><li>ETAB</li><li>PilchErdman</li><li>ReitzDiwakar</li><li>ReitzKHRT</li><li>SHF</li><li>TAB</li></ul></li><li>stochasticCollisionModel<ul><li>ORourke</li><li>trajectory</li><li>none</li></ul></li></ul><h2 id="turbulence"><a class="markdownIt-Anchor" href="#turbulence"></a> turbulence</h2><ul><li>dispersionModel<ul><li>stochasticDispersionRAS</li><li>GradientDispersionRAS</li></ul></li></ul><h1 id="从求解器到库的调用过程"><a class="markdownIt-Anchor" href="#从求解器到库的调用过程"></a> 从求解器到库的调用过程</h1><p>solver 中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">basicSprayCloud parcels</span><br><span class="line">(</span><br><span class="line">    <span class="string">"sprayCloud"</span>,</span><br><span class="line">    rho,</span><br><span class="line">    U,</span><br><span class="line">    g,</span><br><span class="line">    slgThermo</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">parcels.evolve();</span><br></pre></td></tr></table></figure><p>其中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> SprayCloud</span><br><span class="line">&lt;</span><br><span class="line">    ReactingCloud</span><br><span class="line">    &lt;</span><br><span class="line">        ThermoCloud</span><br><span class="line">        &lt;</span><br><span class="line">            KinematicCloud</span><br><span class="line">            &lt;</span><br><span class="line">                Cloud</span><br><span class="line">                &lt;</span><br><span class="line">                    basicSprayParcel</span><br><span class="line">                &gt;</span><br><span class="line">            &gt;</span><br><span class="line">        &gt;</span><br><span class="line">    &gt;</span><br><span class="line">&gt; basicSprayCloud;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> SprayParcel</span><br><span class="line">&lt;</span><br><span class="line">    ReactingParcel</span><br><span class="line">    &lt;</span><br><span class="line">        ThermoParcel</span><br><span class="line">        &lt;</span><br><span class="line">            KinematicParcel</span><br><span class="line">            &lt;</span><br><span class="line">                particle</span><br><span class="line">            &gt;</span><br><span class="line">        &gt;</span><br><span class="line">    &gt;</span><br><span class="line">&gt; basicSprayParcel;</span><br></pre></td></tr></table></figure><p>构造函数：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:SprayCloud&lt;CloudType&gt;::SprayCloud</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; cloudName,</span><br><span class="line">    <span class="keyword">const</span> volScalarField&amp; rho,</span><br><span class="line">    <span class="keyword">const</span> volVectorField&amp; U,</span><br><span class="line">    <span class="keyword">const</span> dimensionedVector&amp; g,</span><br><span class="line">    <span class="keyword">const</span> SLGThermo&amp; thermo,</span><br><span class="line">    <span class="keyword">bool</span> readFields</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    CloudType(cloudName, rho, U, g, thermo, <span class="literal">false</span>),</span><br><span class="line">    sprayCloud(),</span><br><span class="line">    cloudCopyPtr_(<span class="literal">nullptr</span>),</span><br><span class="line">    averageParcelMass_(<span class="number">0.0</span>),</span><br><span class="line">    atomizationModel_(<span class="literal">nullptr</span>),</span><br><span class="line">    breakupModel_(<span class="literal">nullptr</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;solution().active())</span><br><span class="line">    &#123;</span><br><span class="line">        setModels();</span><br><span class="line"></span><br><span class="line">        averageParcelMass_ = <span class="keyword">this</span>-&gt;injectors().averageParcelMass();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (readFields)</span><br><span class="line">        &#123;</span><br><span class="line">            parcelType::readFields(*<span class="keyword">this</span>, <span class="keyword">this</span>-&gt;composition());</span><br><span class="line">            <span class="keyword">this</span>-&gt;deleteLostParticles();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Info &lt;&lt; <span class="string">"Average parcel mass: "</span> &lt;&lt; averageParcelMass_ &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;solution().resetSourcesOnStartup())</span><br><span class="line">    &#123;</span><br><span class="line">        CloudType::resetSourceTerms();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SprayCloud&lt;CloudType&gt;</code> 中的 <code>CloudType</code> 是 <code>ReactingCloud</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:ReactingCloud&lt;CloudType&gt;::ReactingCloud</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; cloudName,</span><br><span class="line">    <span class="keyword">const</span> volScalarField&amp; rho,</span><br><span class="line">    <span class="keyword">const</span> volVectorField&amp; U,</span><br><span class="line">    <span class="keyword">const</span> dimensionedVector&amp; g,</span><br><span class="line">    <span class="keyword">const</span> SLGThermo&amp; thermo,</span><br><span class="line">    <span class="keyword">bool</span> readFields</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    CloudType(cloudName, rho, U, g, thermo, <span class="literal">false</span>),</span><br><span class="line">    reactingCloud(),</span><br><span class="line">    cloudCopyPtr_(<span class="literal">nullptr</span>),</span><br><span class="line">    constProps_(<span class="keyword">this</span>-&gt;particleProperties()),</span><br><span class="line">    compositionModel_(<span class="literal">nullptr</span>),</span><br><span class="line">    phaseChangeModel_(<span class="literal">nullptr</span>),</span><br><span class="line">    rhoTrans_(thermo.carrier().species().<span class="built_in">size</span>())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;solution().active())</span><br><span class="line">    &#123;</span><br><span class="line">        setModels();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (readFields)</span><br><span class="line">        &#123;</span><br><span class="line">            parcelType::readFields(*<span class="keyword">this</span>, <span class="keyword">this</span>-&gt;composition());</span><br><span class="line">            <span class="keyword">this</span>-&gt;deleteLostParticles();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Set storage for mass source fields and initialise to zero</span></span><br><span class="line">    forAll(rhoTrans_, i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">word</span>&amp; specieName = thermo.carrier().species()[i];</span><br><span class="line">        rhoTrans_.<span class="built_in">set</span></span><br><span class="line">        (</span><br><span class="line">            i,</span><br><span class="line">            <span class="keyword">new</span> volScalarField::Internal</span><br><span class="line">            (</span><br><span class="line">                IOobject</span><br><span class="line">                (</span><br><span class="line">                    <span class="keyword">this</span>-&gt;name() + <span class="string">":rhoTrans_"</span> + specieName,</span><br><span class="line">                    <span class="keyword">this</span>-&gt;db().time().timeName(),</span><br><span class="line">                    <span class="keyword">this</span>-&gt;db(),</span><br><span class="line">                    IOobject::READ_IF_PRESENT,</span><br><span class="line">                    IOobject::AUTO_WRITE</span><br><span class="line">                ),</span><br><span class="line">                <span class="keyword">this</span>-&gt;mesh(),</span><br><span class="line">                dimensionedScalar(dimMass, <span class="number">0</span>)</span><br><span class="line">            )</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;solution().resetSourcesOnStartup())</span><br><span class="line">    &#123;</span><br><span class="line">        resetSourceTerms();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ReactingCloud&lt;CloudType&gt;</code> 中的 <code>CloudType</code> 是 <code>ThermoCloud</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:ThermoCloud&lt;CloudType&gt;::ThermoCloud</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; cloudName,</span><br><span class="line">    <span class="keyword">const</span> volScalarField&amp; rho,</span><br><span class="line">    <span class="keyword">const</span> volVectorField&amp; U,</span><br><span class="line">    <span class="keyword">const</span> dimensionedVector&amp; g,</span><br><span class="line">    <span class="keyword">const</span> SLGThermo&amp; thermo,</span><br><span class="line">    <span class="keyword">bool</span> readFields</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    CloudType</span><br><span class="line">    (</span><br><span class="line">        cloudName,</span><br><span class="line">        rho,</span><br><span class="line">        U,</span><br><span class="line">        thermo.thermo().mu(),</span><br><span class="line">        g,</span><br><span class="line">        <span class="literal">false</span></span><br><span class="line">    ),</span><br><span class="line">    thermoCloud(),</span><br><span class="line">    cloudCopyPtr_(<span class="literal">nullptr</span>),</span><br><span class="line">    constProps_(<span class="keyword">this</span>-&gt;particleProperties()),</span><br><span class="line">    thermo_(thermo),</span><br><span class="line">    T_(thermo.thermo().T()),</span><br><span class="line">    p_(thermo.thermo().p()),</span><br><span class="line">    heatTransferModel_(<span class="literal">nullptr</span>),</span><br><span class="line">    TIntegrator_(<span class="literal">nullptr</span>),</span><br><span class="line">    radiation_(<span class="literal">false</span>),</span><br><span class="line">    radAreaP_(<span class="literal">nullptr</span>),</span><br><span class="line">    radT4_(<span class="literal">nullptr</span>),</span><br><span class="line">    radAreaPT4_(<span class="literal">nullptr</span>),</span><br><span class="line">    hsTrans_</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">new</span> volScalarField::Internal</span><br><span class="line">        (</span><br><span class="line">            IOobject</span><br><span class="line">            (</span><br><span class="line">                <span class="keyword">this</span>-&gt;name() + <span class="string">":hsTrans"</span>,</span><br><span class="line">                <span class="keyword">this</span>-&gt;db().time().timeName(),</span><br><span class="line">                <span class="keyword">this</span>-&gt;db(),</span><br><span class="line">                IOobject::READ_IF_PRESENT,</span><br><span class="line">                IOobject::AUTO_WRITE</span><br><span class="line">            ),</span><br><span class="line">            <span class="keyword">this</span>-&gt;mesh(),</span><br><span class="line">            dimensionedScalar(dimEnergy, <span class="number">0</span>)</span><br><span class="line">        )</span><br><span class="line">    ),</span><br><span class="line">    hsCoeff_</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">new</span> volScalarField::Internal</span><br><span class="line">        (</span><br><span class="line">            IOobject</span><br><span class="line">            (</span><br><span class="line">                <span class="keyword">this</span>-&gt;name() + <span class="string">":hsCoeff"</span>,</span><br><span class="line">                <span class="keyword">this</span>-&gt;db().time().timeName(),</span><br><span class="line">                <span class="keyword">this</span>-&gt;db(),</span><br><span class="line">                IOobject::READ_IF_PRESENT,</span><br><span class="line">                IOobject::AUTO_WRITE</span><br><span class="line">            ),</span><br><span class="line">            <span class="keyword">this</span>-&gt;mesh(),</span><br><span class="line">            dimensionedScalar(dimEnergy/dimTemperature, <span class="number">0</span>)</span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;solution().active())</span><br><span class="line">    &#123;</span><br><span class="line">        setModels();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (readFields)</span><br><span class="line">        &#123;</span><br><span class="line">            parcelType::readFields(*<span class="keyword">this</span>);</span><br><span class="line">            <span class="keyword">this</span>-&gt;deleteLostParticles();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;solution().resetSourcesOnStartup())</span><br><span class="line">    &#123;</span><br><span class="line">        resetSourceTerms();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ThermoCloud&lt;CloudType&gt;</code> 中的 <code>CloudType</code> 是 <code>KinematicCloud</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:KinematicCloud&lt;CloudType&gt;::KinematicCloud</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; cloudName,</span><br><span class="line">    <span class="keyword">const</span> volScalarField&amp; rho,</span><br><span class="line">    <span class="keyword">const</span> volVectorField&amp; U,</span><br><span class="line">    <span class="keyword">const</span> volScalarField&amp; mu,</span><br><span class="line">    <span class="keyword">const</span> dimensionedVector&amp; g,</span><br><span class="line">    <span class="keyword">bool</span> readFields</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    CloudType(rho.mesh(), cloudName, <span class="literal">false</span>),</span><br><span class="line">    kinematicCloud(),</span><br><span class="line">    cloudCopyPtr_(<span class="literal">nullptr</span>),</span><br><span class="line">    mesh_(rho.mesh()),</span><br><span class="line">    particleProperties_</span><br><span class="line">    (</span><br><span class="line">        IOobject</span><br><span class="line">        (</span><br><span class="line">            cloudName + <span class="string">"Properties"</span>,</span><br><span class="line">            rho.mesh().time().constant(),</span><br><span class="line">            rho.mesh(),</span><br><span class="line">            IOobject::MUST_READ_IF_MODIFIED,</span><br><span class="line">            IOobject::NO_WRITE</span><br><span class="line">        )</span><br><span class="line">    ),</span><br><span class="line">    outputProperties_</span><br><span class="line">    (</span><br><span class="line">        IOobject</span><br><span class="line">        (</span><br><span class="line">            cloudName + <span class="string">"OutputProperties"</span>,</span><br><span class="line">            mesh_.time().timeName(),</span><br><span class="line">            <span class="string">"uniform"</span>/cloud::prefix/cloudName,</span><br><span class="line">            mesh_,</span><br><span class="line">            IOobject::READ_IF_PRESENT,</span><br><span class="line">            IOobject::NO_WRITE</span><br><span class="line">        )</span><br><span class="line">    ),</span><br><span class="line">    solution_(mesh_, particleProperties_.subDict(<span class="string">"solution"</span>)),</span><br><span class="line">    constProps_(particleProperties_),</span><br><span class="line">    subModelProperties_</span><br><span class="line">    (</span><br><span class="line">        particleProperties_.subOrEmptyDict(<span class="string">"subModels"</span>, solution_.active())</span><br><span class="line">    ),</span><br><span class="line">    rndGen_(<span class="number">0</span>),</span><br><span class="line">    cellOccupancyPtr_(),</span><br><span class="line">    cellLengthScale_(mag(cbrt(mesh_.V()))),</span><br><span class="line">    rho_(rho),</span><br><span class="line">    U_(U),</span><br><span class="line">    mu_(mu),</span><br><span class="line">    g_(g),</span><br><span class="line">    pAmbient_(<span class="number">0.0</span>),</span><br><span class="line">    forces_</span><br><span class="line">    (</span><br><span class="line">        *<span class="keyword">this</span>,</span><br><span class="line">        mesh_,</span><br><span class="line">        subModelProperties_.subOrEmptyDict</span><br><span class="line">        (</span><br><span class="line">            <span class="string">"particleForces"</span>,</span><br><span class="line">            solution_.active()</span><br><span class="line">        ),</span><br><span class="line">        solution_.active()</span><br><span class="line">    ),</span><br><span class="line">    functions_</span><br><span class="line">    (</span><br><span class="line">        *<span class="keyword">this</span>,</span><br><span class="line">        particleProperties_.subOrEmptyDict(<span class="string">"cloudFunctions"</span>),</span><br><span class="line">        solution_.active()</span><br><span class="line">    ),</span><br><span class="line">    injectors_</span><br><span class="line">    (</span><br><span class="line">        subModelProperties_.subOrEmptyDict(<span class="string">"injectionModels"</span>),</span><br><span class="line">        *<span class="keyword">this</span></span><br><span class="line">    ),</span><br><span class="line">    dispersionModel_(<span class="literal">nullptr</span>),</span><br><span class="line">    patchInteractionModel_(<span class="literal">nullptr</span>),</span><br><span class="line">    stochasticCollisionModel_(<span class="literal">nullptr</span>),</span><br><span class="line">    surfaceFilmModel_(<span class="literal">nullptr</span>),</span><br><span class="line">    UIntegrator_(<span class="literal">nullptr</span>),</span><br><span class="line">    UTrans_</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">new</span> volVectorField::Internal</span><br><span class="line">        (</span><br><span class="line">            IOobject</span><br><span class="line">            (</span><br><span class="line">                <span class="keyword">this</span>-&gt;name() + <span class="string">":UTrans"</span>,</span><br><span class="line">                <span class="keyword">this</span>-&gt;db().time().timeName(),</span><br><span class="line">                <span class="keyword">this</span>-&gt;db(),</span><br><span class="line">                IOobject::READ_IF_PRESENT,</span><br><span class="line">                IOobject::AUTO_WRITE</span><br><span class="line">            ),</span><br><span class="line">            mesh_,</span><br><span class="line">            dimensionedVector(dimMass*dimVelocity, Zero)</span><br><span class="line">        )</span><br><span class="line">    ),</span><br><span class="line">    UCoeff_</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">new</span> volScalarField::Internal</span><br><span class="line">        (</span><br><span class="line">            IOobject</span><br><span class="line">            (</span><br><span class="line">                <span class="keyword">this</span>-&gt;name() + <span class="string">":UCoeff"</span>,</span><br><span class="line">                <span class="keyword">this</span>-&gt;db().time().timeName(),</span><br><span class="line">                <span class="keyword">this</span>-&gt;db(),</span><br><span class="line">                IOobject::READ_IF_PRESENT,</span><br><span class="line">                IOobject::AUTO_WRITE</span><br><span class="line">            ),</span><br><span class="line">            mesh_,</span><br><span class="line">            dimensionedScalar( dimMass, <span class="number">0</span>)</span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (solution_.active())</span><br><span class="line">    &#123;</span><br><span class="line">        setModels();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (readFields)</span><br><span class="line">        &#123;</span><br><span class="line">            parcelType::readFields(*<span class="keyword">this</span>);</span><br><span class="line">            <span class="keyword">this</span>-&gt;deleteLostParticles();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (solution_.resetSourcesOnStartup())</span><br><span class="line">    &#123;</span><br><span class="line">        resetSourceTerms();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>KinematicCloud&lt;CloudType&gt;</code> 中的 <code>CloudType</code> 是 <code>Cloud</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ParticleType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:Cloud&lt;ParticleType&gt;::Cloud</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> polyMesh&amp; pMesh,</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">word</span>&amp; cloudName,</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">bool</span> checkClass</span><br><span class="line">)</span><br><span class="line">:</span><br><span class="line">    cloud(pMesh, cloudName),</span><br><span class="line">    polyMesh_(pMesh),</span><br><span class="line">    globalPositionsPtr_()</span><br><span class="line">&#123;</span><br><span class="line">    checkPatches();</span><br><span class="line"></span><br><span class="line">    polyMesh_.tetBasePtIs();</span><br><span class="line">    polyMesh_.oldCellCentres();</span><br><span class="line"></span><br><span class="line">    initCloud(checkClass);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SprayCloud&lt;class CloudType&gt;</code> 的构造函数中：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">parcelType::readFields(*this, this-&gt;composition());</span><br></pre></td></tr></table></figure><p><code>parcelType</code> 是 <code>typedef typename CloudType::particleType parcelType;</code></p><p><code>SprayCloud</code> 的模板 <code>CloudType</code> 是 <code>ReactingCloud</code>，但是这里没有 <code>particleType</code></p><p><code>ReactingCloud</code> 的模板 <code>CloudType</code> 是 <code>ThermoCloud</code>，但是这里没有 <code>particleType</code></p><p><code>ThermoCloud</code> 的模板 <code>CloudType</code> 是 <code>KinematicCloud</code>，但是这里没有 <code>particleType</code></p><p><code>KinematicCloud</code> 的模板 <code>CloudType</code> 是 <code>Cloud</code></p><p><code>Cloud</code> 有个模板 <code>&lt;class ParticleType&gt;</code>，然后重命名了： <code>typedef ParticleType particleType;</code></p><p><code>Cloud</code> 的模板 <code>ParticleType</code> 是 <code>basicSprayParcel</code>，它是 <code>SprayParcel&lt;...&gt;</code> 的别名</p><p><code>SprayParcelIO.C</code> 中定义了<a href="https://github.com/OpenFOAM/OpenFOAM-7/blob/master/src/lagrangian/spray/parcels/Templates/SprayParcel/SprayParcelIO.C#L110" target="_blank" rel="external nofollow noopener noreferrer">readFields</a></p><p>其中又调用了 <code>ParcelType::readFields(c, compModel);</code>，即 <code>SprayParcel</code> 的模板兼基类 <code>ReactingParcel::readFields</code>。<br>定义于 <a href="https://github.com/OpenFOAM/OpenFOAM-7/blob/master/src/lagrangian/intermediate/parcels/Templates/ReactingParcel/ReactingParcelIO.C#L96" target="_blank" rel="external nofollow noopener noreferrer">ReactingParcelIO.C</a></p><p>其中又调用了 <code>ParcelType::readFields(c);</code>，即 <code>ReactingParcel</code> 的模板兼基类 <code>ThermoParcel::readFields</code>。<br>定义于 <a href="https://github.com/OpenFOAM/OpenFOAM-7/blob/master/src/lagrangian/intermediate/parcels/Templates/ThermoParcel/ThermoParcelIO.C#L80" target="_blank" rel="external nofollow noopener noreferrer">ThermoParcelIO.C</a></p><p>其中又调用了 <code>ParcelType::readFields(c);</code>，即 <code>ThermoParcel</code> 的模板兼基类 <code>KinematicParcel::readFields</code>。<br>定义于 <a href="https://github.com/OpenFOAM/OpenFOAM-7/blob/master/src/lagrangian/intermediate/parcels/Templates/KinematicParcel/KinematicParcelIO.C#L99" target="_blank" rel="external nofollow noopener noreferrer">KinematicParcelIO.C</a></p><p>其中又调用了 <code>ParcelType::readFields(c);</code>，即 <code>KinematicParcel</code> 的模板兼基类 <code>particle::readFields</code>。<br>定义于 <a href="https://github.com/OpenFOAM/OpenFOAM-7/blob/109ba3c8d53a8fa1e97854b168a16970aaeea951/src/lagrangian/basic/particle/particleTemplates.C#L42" target="_blank" rel="external nofollow noopener noreferrer">particleTemplates.C</a></p><p><code>initCloud</code> 定义：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ParticleType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:Cloud&lt;ParticleType&gt;::initCloud(<span class="keyword">const</span> <span class="keyword">bool</span> checkClass)</span><br><span class="line">&#123;</span><br><span class="line">    readCloudUniformProperties();</span><br><span class="line"></span><br><span class="line">    <span class="function">IOPosition&lt;Cloud&lt;ParticleType&gt;&gt; <span class="title">ioP</span><span class="params">(*<span class="keyword">this</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> valid = ioP.headerOk();</span><br><span class="line">    Istream&amp; is = ioP.readStream(checkClass ? typeName : <span class="string">""</span>, valid);</span><br><span class="line">    <span class="keyword">if</span> (valid)</span><br><span class="line">    &#123;</span><br><span class="line">        ioP.readData(is, *<span class="keyword">this</span>);</span><br><span class="line">        ioP.<span class="built_in">close</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!valid &amp;&amp; debug)</span><br><span class="line">    &#123;</span><br><span class="line">        Pout&lt;&lt; <span class="string">"Cannot read particle positions file:"</span> &lt;&lt; nl</span><br><span class="line">            &lt;&lt; <span class="string">"    "</span> &lt;&lt; ioP.objectPath() &lt;&lt; nl</span><br><span class="line">            &lt;&lt; <span class="string">"Assuming the initial cloud contains 0 particles."</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Ask for the tetBasePtIs to trigger all processors to build</span></span><br><span class="line">    <span class="comment">// them, otherwise, if some processors have no particles then</span></span><br><span class="line">    <span class="comment">// there is a comms mismatch.</span></span><br><span class="line">    polyMesh_.tetBasePtIs();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>函数调用过程：</p><img src="http://www.plantuml.com/plantuml/svg/xPPFKy8m4CNl_HGzmb6FuOIee-E8Z33SOzZII9hjR596_FIcDXsQ_iEZ1pZHtLzU-ZPl26oT4pyj51Oxnk28wWYpYBr83HctKlY6yVLD2fIXB-O43qCB6ZsPn9Dskzhezs4QsnHqFBcPHh7xi6Vz2S9ArA-u0yMO_7sUzJVTDZadU4HQmfVTo0pM5l81s81TeP5bPQvt2r3AWyqHb10d0QgokYBCWQm4uzbtu4vJx_-81mEx17UcVe7lCzXccjv42k9GALxoDOO6diR0jfynjiVBiiW-WDuIjy9fg1eDybIfCPRX4Lf9gitNY5CiptpBLL5BDNoFK_u0HfdEE_LWe0p4azlfu1h1bRYNnit6k5dKsfNfm4q9TWptEYh9MHC8pPJjTK495n0Q6XHRfTp08kLw3-Ci4hap7HRlliWJSBiXhaq25A2zWzg2GY7jwKosvjiDGRbiRZ6Jtzm60-u3xmZueSWRydeda-ZyBGhsw-Gzm_CUrzHUK_jFKkkp6rmDKYVehl7MBU2hmG--hxMpFb3EqLZ_H-07"><p><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayCloud.html#a9e3bb886209d951167cd385c1ffe0b00" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayCloud::evolve</code></a> 里边调用了 <a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicCloud.html#afa1e21a16cc62ccc11ccc7f665c5a144" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicCloud::solve</code></a>。<br><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicCloud.html#afa1e21a16cc62ccc11ccc7f665c5a144" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicCloud::solve</code></a> 里边调用了：</p><ul><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ThermoCloud.html#acc0c9e165d2cf19698ab1a7672a29ab6" target="_blank" rel="external nofollow noopener noreferrer"><code>ThermoCloud::preEvolve</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicCloud.html#aa8127553bbd9a6fb2451bf9252f4d0ec" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicCloud::evolveCloud</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayCloud.html#ac1b66fe77173de9e5e8542b2823d6071" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayCloud::info</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicCloud.html#a0bf23f36eb3424966e359419a566eb0a" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicCloud::postEvolve</code></a></li></ul><p><a href="https://cpp.openfoam.org/v6/classFoam_1_1ThermoCloud.html#acc0c9e165d2cf19698ab1a7672a29ab6" target="_blank" rel="external nofollow noopener noreferrer"><code>ThermoCloud::preEvolve</code></a> 里边调用了 <a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicCloud.html#acc0c9e165d2cf19698ab1a7672a29ab6" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicCloud::preEvolve</code></a>。<br><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicCloud.html#aa8127553bbd9a6fb2451bf9252f4d0ec" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicCloud::evolveCloud</code></a> 里边调用了：</p><ul><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ReactingCloud.html#acf214ed9b415b06b398e6fff63b72de0" target="_blank" rel="external nofollow noopener noreferrer"><code>ReactingCloud::resetSourceTerms</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1InjectionModel.html#a1efd0f4865994975c398a06e939ca132" target="_blank" rel="external nofollow noopener noreferrer"><code>InjectionModel::inject</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicCloud.html#a1edcf781ffdd6fb958953cdeddf71a33" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicCloud::motion</code></a></li><li><a href=""><code>StochasticCollisionModel::update</code></a></li></ul><p><a href="https://cpp.openfoam.org/v6/classFoam_1_1ReactingCloud.html#acf214ed9b415b06b398e6fff63b72de0" target="_blank" rel="external nofollow noopener noreferrer"><code>ReactingCloud::resetSourceTerms</code></a> 里边调用了：</p><ul><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ThermoCloud.html#acf214ed9b415b06b398e6fff63b72de0" target="_blank" rel="external nofollow noopener noreferrer"><code>ThermoCloud::resetSourceTerms</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicCloud.html#acf214ed9b415b06b398e6fff63b72de0" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicCloud::resetSourceTerms</code></a></li></ul><p><a href="https://cpp.openfoam.org/v6/classFoam_1_1InjectionModel.html#a1efd0f4865994975c398a06e939ca132" target="_blank" rel="external nofollow noopener noreferrer"><code>InjectionModel::inject</code></a> 里边调用了：</p><ul><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1InjectionModel.html#a0726459c9d46022422d21dffbeab6fe4" target="_blank" rel="external nofollow noopener noreferrer"><code>InjectionModel::prepareForNextTimeStep</code></a></li><li><a href=""><code>ConeNozzleInjection::setPositionAndCell</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayCloud.html#a3b7f36d51838109c584a2ae57c525d57" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayCloud::setParcelThermoProperties</code></a></li><li><a href=""><code>ConeNozzleInjection::setProperties</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayCloud.html#a4810c2551eb5f79b13085844cbbdbf89" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayCloud::checkParcelProperties</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1InjectionModel.html#a50d527210ab32e5c250fd6d77804d2f4" target="_blank" rel="external nofollow noopener noreferrer"><code>InjectionModel::setNumberOfParticles</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicParcel.html#ac2c0edbd947f1f38ebd3fcde0db7cd6a" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicParcel::move</code></a></li></ul><p><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicCloud.html#a1edcf781ffdd6fb958953cdeddf71a33" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicCloud::motion</code></a>里边调用了 <a href="https://cpp.openfoam.org/v6/classFoam_1_1Cloud.html#a927440a07e7ac9cd352f1c6fa795fd72" target="_blank" rel="external nofollow noopener noreferrer"><code>Cloud::move</code></a>。<br><a href="https://cpp.openfoam.org/v6/classFoam_1_1Cloud.html#a927440a07e7ac9cd352f1c6fa795fd72" target="_blank" rel="external nofollow noopener noreferrer"><code>Cloud::move</code></a> 又调用了 <a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicParcel.html#ac2c0edbd947f1f38ebd3fcde0db7cd6a" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicParcel::move</code></a>。</p><p><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicParcel.html#ac2c0edbd947f1f38ebd3fcde0db7cd6a" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicParcel::move</code></a> 里边调用了：</p><ul><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayParcel.html#ab9947c318454c7c84f1d08de15d3b6a4" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayParcel::setCellValues</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicParcel.html#a1bc117321c28afadf842ad099038e6e3" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicParcel::calcDispersion</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayParcel.html#afb56ef4d31b0047419b9a94d9d07e337" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayParcel::calc</code></a></li></ul><p><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayParcel.html#ab9947c318454c7c84f1d08de15d3b6a4" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayParcel::setCellValues</code></a> 里边调用了：</p><ul><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ReactingParcel.html#ab9947c318454c7c84f1d08de15d3b6a4" target="_blank" rel="external nofollow noopener noreferrer"><code>ReactingParcel::setCellValues</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ThermoParcel.html#ab9947c318454c7c84f1d08de15d3b6a4" target="_blank" rel="external nofollow noopener noreferrer"><code>ThermoParcel::setCellValues</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicParcel.html#ab9947c318454c7c84f1d08de15d3b6a4" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicParcel::setCellValues</code></a></li></ul><p><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayParcel.html#afb56ef4d31b0047419b9a94d9d07e337" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayParcel::calc</code></a> 里边调用了：</p><ul><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ReactingParcel.html#afb56ef4d31b0047419b9a94d9d07e337" target="_blank" rel="external nofollow noopener noreferrer"><code>ReactingParcel::calc</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayParcel.html#a5d5a39332fd9601bd70ac84d88d07ca1" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayParcel::calcAtomization</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayParcel.html#ac4be6f5656ddaff54ac59367ad4cb7e6" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayParcel::calcBreakup</code></a></li></ul><p><a href="https://cpp.openfoam.org/v6/classFoam_1_1ReactingParcel.html#afb56ef4d31b0047419b9a94d9d07e337" target="_blank" rel="external nofollow noopener noreferrer"><code>ReactingParcel::calc</code></a> 里边调用了：</p><ul><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ThermoParcel.html#aa693ff3229c8055efb30de7e7b5d4cd4" target="_blank" rel="external nofollow noopener noreferrer"><code>ThermoParcel::calcSurfaceValues</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ReactingParcel.html#a5448b022ac7f36caaf13cbc2a1d7ad55" target="_blank" rel="external nofollow noopener noreferrer"><code>ReactingParcel::calcPhaseChange</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ReactingParcel.html#a76ae2d53800c1eabf2b4f8d64b9a74fd" target="_blank" rel="external nofollow noopener noreferrer"><code>ReactingParcel::correctSurfaceValues</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ThermoParcel.html#a07a39662807bbdfccfc4fbf057b8ce48" target="_blank" rel="external nofollow noopener noreferrer"><code>ThermoParcel::calcHeatTransfer</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicParcel.html#a5fb95697e23fac02d5105e791201797d" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicParcel::calcVelocity</code></a></li></ul><p><a href="https://cpp.openfoam.org/v6/classFoam_1_1SprayCloud.html#ac1b66fe77173de9e5e8542b2823d6071" target="_blank" rel="external nofollow noopener noreferrer"><code>SprayCloud::info</code></a> 里边调用了：</p><ul><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ReactingCloud.html#ac1b66fe77173de9e5e8542b2823d6071" target="_blank" rel="external nofollow noopener noreferrer"><code>ReactingCloud::info</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1ThermoCloud.html#ac1b66fe77173de9e5e8542b2823d6071" target="_blank" rel="external nofollow noopener noreferrer"><code>ThermoCloud::info</code></a></li><li><a href="https://cpp.openfoam.org/v6/classFoam_1_1KinematicCloud.html#ac1b66fe77173de9e5e8542b2823d6071" target="_blank" rel="external nofollow noopener noreferrer"><code>KinematicCloud::info</code></a></li></ul><p>经过验证，<code>ThermoParcel::calc</code> 函数从来没有被调用！<br><code>KinematicParcel::calc</code> 函数也从来没有被调用！</p><p><code>move</code> 定义于 <code>KinematicParcel</code> 和 <code>Cloud</code> 中。<br><code>Cloud</code> 中的 <code>move</code> 一个时间步长内只调用一次。</p><p><code>Added 10 new parcels</code>，对应 <code>KinematicParcel::move</code> 就调用 10 次，这里是在 <code>InjectionModel::inject</code> 中被调用的。后来如果破碎了，parcels 数变成 20 了，那么 move 函数又调用 20 次，这里是在 <code>KinematicCloud::motion</code> 中被调用的。</p><p><code>KinematicParcel::move</code> 调用了 <code>SprayParcel::calc</code>，并且每个 <code>move</code> 函数内，<code>calc</code> 调用不止一次。<br><code>SprayParcel::calc</code>中调用了喷雾的 <code>calcAtomization</code> 和 <code>calcBreakup</code>，因此这个里边，粒子直径被修改了，粒子个数也可能被修改。</p><p>以下 UML 图来自 <a href="https://openfoamwiki.net/index.php/OpenFOAM_guide/UML/lagrangian" target="_blank" rel="external nofollow noopener noreferrer">openfoamwiki</a>，基于OF2.3.X，可供参考。</p><details><summary>Click to expand!</summary><p><img src="https://openfoamwiki.net/images/d/df/UML_lagrangian_solver2Cloud.png" alt=""><br><img src="https://openfoamwiki.net/images/0/05/UML_lagrangian_cloud2Particle.png" alt=""><br><img src="https://openfoamwiki.net/images/5/51/UML_lagrangian_particleType.png" alt=""><br><img src="https://openfoamwiki.net/images/a/a7/UML_lagrangian_CFO_readRTST.png" alt=""><br><img src="https://openfoamwiki.net/images/1/1a/UML_lagrangian_CFO_defRTST.png" alt=""></p></details><p>喷雾信息输出到info:</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Solving <span class="number">3</span>-D cloud sprayCloud</span><br><span class="line"></span><br><span class="line">Cloud: sprayCloud injector: model1</span><br><span class="line">    Added <span class="number">18</span> <span class="keyword">new</span> parcels</span><br><span class="line"></span><br><span class="line">Cloud: sprayCloud</span><br><span class="line">    Current number of parcels       = <span class="number">18</span></span><br><span class="line">    Current mass in system          = <span class="number">1.19539e-11</span></span><br><span class="line">    Linear momentum                 = (<span class="number">-1.22046e-12</span> <span class="number">2.17761e-13</span> <span class="number">-1.86459e-11</span>)</span><br><span class="line">   |Linear momentum|                = <span class="number">1.86871e-11</span></span><br><span class="line">    Linear kinetic energy           = <span class="number">2.07355e-11</span></span><br><span class="line">    model1:</span><br><span class="line">        number of parcels added     = <span class="number">18</span></span><br><span class="line">        mass introduced             = <span class="number">1.19539e-11</span></span><br><span class="line">    Parcel fate (number, mass)</span><br><span class="line">      - escape                      = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">      - stick                       = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    Temperature <span class="built_in">min</span>/<span class="built_in">max</span>             = <span class="number">358.01</span>, <span class="number">358.026</span></span><br><span class="line">    Mass <span class="built_in">transfer</span> phase change      = <span class="number">5.38154e-18</span></span><br><span class="line">    D10, D32, Dmax (mu)             = <span class="number">178.438</span>, <span class="number">274.262</span>, <span class="number">337.897</span></span><br><span class="line">    Liquid penetration <span class="number">95</span>% mass (m) = <span class="number">1.59326e-06</span></span><br></pre></td></tr></table></figure><p>代码中的调用顺序：<br>在 <code>KinematicCloud::solve</code> 中：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">cloud.info();</span><br></pre></td></tr></table></figure><p>这里的 <code>cloud</code> 类型是模板 <code>TrackCloudType</code>。为了搞清楚它的真实面目，我们修改一下这里的代码，然后编译（这里必须执行 Lagrangian 库下的 Allwmake，然后编译求解器）。<br>后来发现好像只需要编译求解器就行了，因为那些是模板，在求解器中才实例化？<br>添加下面的代码到任意位置：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">cloud.abc();</span><br></pre></td></tr></table></figure><p>编译库是并不会报错，编译求解器时报错如下：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">src/lagrangian/intermediate/lnInclude/KinematicCloud.C(<span class="number">97</span>): error: <span class="class"><span class="keyword">class</span> "<span class="title">Foam</span>:</span>:SprayCloud&lt;Foam::ReactingCloud&lt;Foam::ThermoCloud&lt;Foam::KinematicCloud&lt;Foam::Cloud&lt;Foam::basicSprayParcel&gt;&gt;&gt;&gt;&gt;<span class="string">" has no member "</span>abc<span class="string">"</span></span><br><span class="line"><span class="string">      cloud.abc();</span></span><br></pre></td></tr></table></figure><p>所以这里的 <code>cloud</code> 是 <code>SprayCloud</code>，它的 <code>info</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:SprayCloud&lt;CloudType&gt;::info()</span><br><span class="line">&#123;</span><br><span class="line">    CloudType::info();</span><br><span class="line">    scalar d32 = <span class="number">1.0e+6</span>*<span class="keyword">this</span>-&gt;Dij(<span class="number">3</span>, <span class="number">2</span>);</span><br><span class="line">    scalar d10 = <span class="number">1.0e+6</span>*<span class="keyword">this</span>-&gt;Dij(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    scalar dMax = <span class="number">1.0e+6</span>*<span class="keyword">this</span>-&gt;Dmax();</span><br><span class="line">    scalar pen = <span class="keyword">this</span>-&gt;penetration(<span class="number">0.95</span>);</span><br><span class="line"></span><br><span class="line">    Info &lt;&lt; <span class="string">"    D10, D32, Dmax (mu)             = "</span> &lt;&lt; d10 &lt;&lt; <span class="string">", "</span> &lt;&lt; d32</span><br><span class="line">         &lt;&lt; <span class="string">", "</span> &lt;&lt; dMax &lt;&lt; nl</span><br><span class="line">         &lt;&lt; <span class="string">"    Liquid penetration 95% mass (m) = "</span> &lt;&lt; pen &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Foam</span>:</span>:scalar Foam::KinematicCloud&lt;CloudType&gt;::Dmax() <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    scalar d = -great;</span><br><span class="line">    forAllConstIter(<span class="keyword">typename</span> KinematicCloud&lt;CloudType&gt;, *<span class="keyword">this</span>, iter)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> parcelType&amp; p = iter();</span><br><span class="line">        d = <span class="built_in">max</span>(d, p.d());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    reduce(d, maxOp&lt;scalar&gt;());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">max</span>(<span class="number">0.0</span>, d);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SprayCloud</code> 的 <code>CloudType</code> 是 <code>ReactingCloud</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:ReactingCloud&lt;CloudType&gt;::info()</span><br><span class="line">&#123;</span><br><span class="line">    CloudType::info();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>-&gt;phaseChange().info(Info);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ReactingCloud</code> 的 <code>CloudType</code> 是 <code>ThermoCloud</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:ThermoCloud&lt;CloudType&gt;::info()</span><br><span class="line">&#123;</span><br><span class="line">    CloudType::info();</span><br><span class="line"></span><br><span class="line">    Info&lt;&lt; <span class="string">"    Temperature min/max             = "</span> &lt;&lt; Tmin() &lt;&lt; <span class="string">", "</span> &lt;&lt; Tmax()</span><br><span class="line">        &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ThermoCloud</code> 的 <code>CloudType</code> 是 <code>KinematicCloud</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:KinematicCloud&lt;CloudType&gt;::info()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">vector</span> linearMomentum = linearMomentumOfSystem();</span><br><span class="line">    reduce(linearMomentum, sumOp&lt;<span class="built_in">vector</span>&gt;());</span><br><span class="line"></span><br><span class="line">    scalar linearKineticEnergy = linearKineticEnergyOfSystem();</span><br><span class="line">    reduce(linearKineticEnergy, sumOp&lt;scalar&gt;());</span><br><span class="line"></span><br><span class="line">    Info&lt;&lt; <span class="string">"Cloud: "</span> &lt;&lt; <span class="keyword">this</span>-&gt;name() &lt;&lt; nl</span><br><span class="line">        &lt;&lt; <span class="string">"    Current number of parcels       = "</span></span><br><span class="line">        &lt;&lt; returnReduce(<span class="keyword">this</span>-&gt;<span class="built_in">size</span>(), sumOp&lt;label&gt;()) &lt;&lt; nl</span><br><span class="line">        &lt;&lt; <span class="string">"    Current mass in system          = "</span></span><br><span class="line">        &lt;&lt; returnReduce(massInSystem(), sumOp&lt;scalar&gt;()) &lt;&lt; nl</span><br><span class="line">        &lt;&lt; <span class="string">"    Linear momentum                 = "</span></span><br><span class="line">        &lt;&lt; linearMomentum &lt;&lt; nl</span><br><span class="line">        &lt;&lt; <span class="string">"   |Linear momentum|                = "</span></span><br><span class="line">        &lt;&lt; mag(linearMomentum) &lt;&lt; nl</span><br><span class="line">        &lt;&lt; <span class="string">"    Linear kinetic energy           = "</span></span><br><span class="line">        &lt;&lt; linearKineticEnergy &lt;&lt; nl;</span><br><span class="line"></span><br><span class="line">    injectors_.info(Info);</span><br><span class="line">    <span class="keyword">this</span>-&gt;surfaceFilm().info(Info);</span><br><span class="line">    <span class="keyword">this</span>-&gt;patchInteraction().info(Info);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;拉格朗日库类解析&lt;/p&gt;
    
    </summary>
    
    
      <category term="code" scheme="https://openfoam.top/categories/code/"/>
    
    
      <category term="Lagrangian" scheme="https://openfoam.top/tags/Lagrangian/"/>
    
  </entry>
  
  <entry>
    <title>OpenFOAM 中的喷雾传热传质</title>
    <link href="https://openfoam.top/sprayHeatMass/"/>
    <id>https://openfoam.top/sprayHeatMass/</id>
    <published>2019-03-24T23:00:00.000Z</published>
    <updated>2019-04-05T22:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>从数学公式到C++代码全面解析喷雾传热传质过程原理</p><a id="more"></a><h1 id="传热传质计算公式"><a class="markdownIt-Anchor" href="#传热传质计算公式"></a> 传热传质计算公式</h1><p>首先是能量传递，气相通过温差热传导传热给液相，液相接受能量，使自己升温并蒸发。蒸发出来的热量重新回到气相。这里有一个潜热的关系，即蒸发出来的那部分液相的能量+潜热=蒸发出来的气相所包含的能量。所以说，由喷雾引起的气相能量源项是：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mn>1</mn><msub><mi>V</mi><mi>c</mi></msub></mfrac><msub><mo>∑</mo><mi>p</mi></msub><msub><mi>N</mi><mi>p</mi></msub><mo stretchy="false">(</mo><msub><mi>T</mi><mi>p</mi></msub><mo>−</mo><msub><mi>T</mi><mi>c</mi></msub><mo stretchy="false">)</mo><mi>π</mi><msub><mi>D</mi><mi>p</mi></msub><msub><mi>λ</mi><mi>m</mi></msub><mi>N</mi><msub><mi>u</mi><mi>m</mi></msub><mo>−</mo><mfrac><mn>1</mn><msub><mi>V</mi><mi>c</mi></msub></mfrac><msub><mo>∑</mo><mi>p</mi></msub><msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><mi>p</mi></msub><msub><mi>N</mi><mi>p</mi></msub><mi>h</mi><mo stretchy="false">(</mo><msub><mi>T</mi><mi>p</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{ 1 }{ V_{c} } \sum\nolimits_p N_p( T_p - T_{c} )\pi {D_p}\lambda_m Nu_m - \frac{ 1 }{ V_{c} }\sum\nolimits_p \dot m_p N_p h(T_p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.1574400000000002em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop"><span class="mop op-symbol large-op" style="position:relative;top:-.000004999999999977245em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-.29831799999999997em"><span style="top:-2.10029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.735818em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.1574400000000002em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop"><span class="mop op-symbol large-op" style="position:relative;top:-.000004999999999977245em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-.29831799999999997em"><span style="top:-2.10029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.735818em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><msub><mi>T</mi><mi>p</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h(T_p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord mathdefault">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 是蒸发出来的气相处于液滴温度下的焓。如果气相求解的是显焓的输运方程，则这里是显焓。如果是绝对焓的输运方程，则这里是绝对焓。</p><p>另一方面，对于液相，<br>文献中液滴温度计算公式：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><mi>p</mi></msub><mo>=</mo><mfrac><mrow><mi>d</mi><msub><mi>m</mi><mi>p</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mi>π</mi><msub><mi>D</mi><mi>p</mi></msub><mi mathvariant="script">D</mi><mi>S</mi><mi>h</mi><msub><mi>ρ</mi><mi>m</mi></msub><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msub><mi>B</mi><mi>M</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\dot m_p = \frac{dm_p}{dt}=-\pi D_p\mathcal{D}Sh \rho_m \ln(1+B_M)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9539679999999999em;vertical-align:-.286108em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord">−</span><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathcal" style="margin-right:.02778em">D</span></span><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.10903em">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>m</mi><mi>p</mi></msub><mfrac><mrow><mi>d</mi><msub><mi>h</mi><mi>p</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><mi>p</mi></msub><msub><mi>h</mi><mi>v</mi></msub><mo stretchy="false">(</mo><msub><mi>T</mi><mi>p</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mi>π</mi><mi>D</mi><mi>κ</mi><mi>N</mi><mi>u</mi><mo stretchy="false">(</mo><mi>T</mi><mo>−</mo><msub><mi>T</mi><mi>p</mi></msub><mo stretchy="false">)</mo><mi>f</mi></mrow><annotation encoding="application/x-tex">m_p\frac{dh_p}{dt}= \dot m_p h_v(T_p)+\pi D\kappa Nu(T-T_p)f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">κ</span><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord mathdefault">u</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:.10764em">f</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>=</mo><mfrac><mi>z</mi><mrow><msup><mi>e</mi><mi>z</mi></msup><mo>−</mo><mn>1</mn></mrow></mfrac><mo separator="true">,</mo><mi>z</mi><mo>=</mo><mo>−</mo><mfrac><mrow><msub><mi>c</mi><mrow><mi>p</mi><mo separator="true">,</mo><mi>v</mi></mrow></msub><msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><mi>p</mi></msub></mrow><mrow><mi>π</mi><mi>D</mi><mi>κ</mi><mi>N</mi><mi>u</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">f=\frac{z}{e^z-1}, z=-\frac{c_{p,v}\dot m_p}{\pi D\kappa Nu}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.8768900000000002em;vertical-align:-.7693300000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.590392em"><span style="top:-2.9890000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.04398em">z</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord">1</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.04398em">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.7693300000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault" style="margin-right:.04398em">z</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.03086em;vertical-align:-.686em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.34486em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">κ</span><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord mathdefault">u</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:.03588em">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>d</mi><msub><mi>T</mi><mi>p</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>T</mi><mo>−</mo><msub><mi>T</mi><mi>p</mi></msub></mrow><msub><mi>τ</mi><mi>h</mi></msub></mfrac><mi>f</mi><mo>−</mo><mfrac><mn>1</mn><msub><mi>c</mi><mrow><mi>l</mi><mo separator="true">,</mo><mi>p</mi></mrow></msub></mfrac><mfrac><mrow><msub><mi>h</mi><mi>v</mi></msub><mo stretchy="false">(</mo><msub><mi>T</mi><mi>p</mi></msub><mo stretchy="false">)</mo></mrow><msub><mi>τ</mi><mi>e</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\frac{dT_p}{dt}=\frac{T-T_p}{\tau_h}f-\frac{1}{c_{l,p}}\frac{h_v(T_p)}{\tau_e}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.19633em;vertical-align:-.8360000000000001em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.399108em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.01968em">l</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.3139999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>τ</mi><mi>e</mi></msub><mo>=</mo><mfrac><msub><mi>m</mi><mi>p</mi></msub><mrow><mi>π</mi><mi>D</mi><mi mathvariant="script">D</mi><mi>S</mi><mi>h</mi><msub><mi>ρ</mi><mi>v</mi></msub><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>B</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\tau_e=\frac{m_p}{\pi D\mathcal{D}Sh\rho_v\ln(1+B)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.04356em;vertical-align:-.936em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord"><span class="mord mathcal" style="margin-right:.02778em">D</span></span><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">h</span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord mathdefault" style="margin-right:.05017em">B</span><span class="mclose">)</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>τ</mi><mi>h</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>m</mi><mi>p</mi></msub><msub><mi>C</mi><mrow><mi>l</mi><mo separator="true">,</mo><mi>p</mi></mrow></msub></mrow><mrow><mi>π</mi><mi>D</mi><mi>κ</mi><mi>N</mi><mi>u</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\tau_h=\frac{m_pC_{l,p}}{\pi D\kappa Nu}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.1132em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault">κ</span><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord mathdefault">u</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.01968em">l</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h1 id="代码解析"><a class="markdownIt-Anchor" href="#代码解析"></a> 代码解析</h1><p>首先从求解器代码中可以获知气相能量输运方程中的源项是 <code>parcels.Sh(he)</code>。</p><p><code>Sh</code> 函数定义于 ThermoCloudI.H：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">CloudType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Foam</span>:</span>:tmp&lt;Foam::fvScalarMatrix&gt;</span><br><span class="line">Foam::ThermoCloud&lt;CloudType&gt;::Sh(volScalarField&amp; hs) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;solution().coupled())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>-&gt;solution().semiImplicit(<span class="string">"h"</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="function"><span class="keyword">const</span> volScalarField <span class="title">Cp</span><span class="params">(thermo_.thermo().Cp())</span></span>;</span><br><span class="line">            <span class="keyword">const</span> volScalarField::Internal</span><br><span class="line">                Vdt(<span class="keyword">this</span>-&gt;mesh().V()*<span class="keyword">this</span>-&gt;db().time().deltaT());</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">                hsTrans()/Vdt</span><br><span class="line">              - fvm::SuSp(hsCoeff()/(Cp*Vdt), hs)</span><br><span class="line">              + hsCoeff()/(Cp*Vdt)*hs;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            tmp&lt;fvScalarMatrix&gt; tfvm(<span class="keyword">new</span> fvScalarMatrix(hs, dimEnergy/dimTime));</span><br><span class="line">            fvScalarMatrix&amp; fvm = tfvm.ref();</span><br><span class="line"></span><br><span class="line">            fvm.source() = -hsTrans()/(<span class="keyword">this</span>-&gt;db().time().deltaT());</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> tfvm;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> tmp&lt;fvScalarMatrix&gt;(<span class="keyword">new</span> fvScalarMatrix(hs, dimEnergy/dimTime));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中的 <code>hsTrans()</code> 定义于 <code>ThermoCloudI.H</code>：<code>return hsTrans_();</code>。<br>其中 <code>hsTrans_</code> 的类型是 <code>autoPtr&lt;volScalarField::Internal&gt;</code>。<br>在 <code>ReactingParcel</code> 的 <code>calc</code> 函数中计算它：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">hsTrans()[cellI] += dm*hs 正数！</span><br><span class="line">hsTrans()[cellI] += np0*dhsTrans 负数！</span><br></pre></td></tr></table></figure><p><code>dm</code> 是蒸发质量，<code>hs</code> 是蒸发出来的气相的显焓（按照液滴温度计算的），<code>dhsTrans</code> 在 <code>calcHeatTransfer</code>中计算。<br><code>calcHeatTransfer</code> 定义于 <code>ThermalParcel</code>，调用于 <code>ReactingParcel</code> 中的 <code>calc</code> 函数，返回新的粒子温度。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ParcelType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">template</span>&lt;class TrackCloudType&gt;</span></span><br><span class="line"><span class="class"><span class="title">Foam</span>:</span>:scalar Foam::ThermoParcel&lt;ParcelType&gt;::calcHeatTransfer</span><br><span class="line">(</span><br><span class="line">    TrackCloudType&amp; cloud,</span><br><span class="line">    trackingData&amp; td,</span><br><span class="line">    <span class="keyword">const</span> scalar dt,</span><br><span class="line">    <span class="keyword">const</span> scalar Re,</span><br><span class="line">    <span class="keyword">const</span> scalar Pr,</span><br><span class="line">    <span class="keyword">const</span> scalar kappa,</span><br><span class="line">    <span class="keyword">const</span> scalar NCpW,</span><br><span class="line">    <span class="keyword">const</span> scalar Sh,</span><br><span class="line">    scalar&amp; dhsTrans,</span><br><span class="line">    scalar&amp; Sph</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!cloud.heatTransfer().active())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> T_;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar d = <span class="keyword">this</span>-&gt;d();</span><br><span class="line">    <span class="keyword">const</span> scalar rho = <span class="keyword">this</span>-&gt;rho();</span><br><span class="line">    <span class="keyword">const</span> scalar As = <span class="keyword">this</span>-&gt;areaS(d);</span><br><span class="line">    <span class="keyword">const</span> scalar V = <span class="keyword">this</span>-&gt;volume(d);</span><br><span class="line">    <span class="keyword">const</span> scalar m = rho*V;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calc heat transfer coefficient</span></span><br><span class="line">    scalar htc = cloud.heatTransfer().htc(d, Re, Pr, kappa, NCpW);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate the integration coefficients</span></span><br><span class="line">    <span class="keyword">const</span> scalar bcp = htc*As/(m*Cp_);</span><br><span class="line">    <span class="keyword">const</span> scalar acp = bcp*td.Tc();</span><br><span class="line">    scalar ancp = Sh;</span><br><span class="line">    <span class="keyword">if</span> (cloud.radiation())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> tetIndices tetIs = <span class="keyword">this</span>-&gt;currentTetIndices();</span><br><span class="line">        <span class="keyword">const</span> scalar Gc = td.GInterp().interpolate(<span class="keyword">this</span>-&gt;coordinates(), tetIs);</span><br><span class="line">        <span class="keyword">const</span> scalar sigma = physicoChemical::sigma.value();</span><br><span class="line">        <span class="keyword">const</span> scalar epsilon = cloud.constProps().epsilon0();</span><br><span class="line"></span><br><span class="line">        ancp += As*epsilon*(Gc/<span class="number">4.0</span> - sigma*pow4(T_));</span><br><span class="line">    &#125;</span><br><span class="line">    ancp /= m*Cp_;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Integrate to find the new parcel temperature</span></span><br><span class="line">    <span class="keyword">const</span> scalar deltaT = cloud.TIntegrator().delta(T_, dt, acp + ancp, bcp);</span><br><span class="line">    <span class="keyword">const</span> scalar deltaTncp = ancp*dt;</span><br><span class="line">    <span class="keyword">const</span> scalar deltaTcp = deltaT - deltaTncp;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate the new temperature and the enthalpy transfer terms</span></span><br><span class="line">    scalar Tnew = T_ + deltaT;</span><br><span class="line">    Tnew = <span class="built_in">min</span>(<span class="built_in">max</span>(Tnew, cloud.constProps().TMin()), cloud.constProps().TMax());</span><br><span class="line"></span><br><span class="line">    dhsTrans -= m*Cp_*deltaTcp;</span><br><span class="line"></span><br><span class="line">    Sph = dt*m*Cp_*bcp;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Tnew;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中用到的其它函数定义：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Type</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Type</span> <span class="title">Foam</span>:</span>:integrationScheme::explicitDelta</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> Type&amp; phi,</span><br><span class="line">    <span class="keyword">const</span> scalar dtEff,</span><br><span class="line">    <span class="keyword">const</span> Type&amp; Alpha,</span><br><span class="line">    <span class="keyword">const</span> scalar Beta</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> (Alpha - Beta*phi)*dtEff;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Type</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">inline</span> <span class="title">Type</span> <span class="title">Foam</span>:</span>:integrationScheme::delta</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> Type&amp; phi,</span><br><span class="line">    <span class="keyword">const</span> scalar dt,</span><br><span class="line">    <span class="keyword">const</span> Type&amp; Alpha,</span><br><span class="line">    <span class="keyword">const</span> scalar Beta</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> explicitDelta(phi, dtEff(dt, Beta), Alpha, Beta);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Foam::scalar Foam::integrationSchemes::Euler::dtEff</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar dt,</span><br><span class="line">    <span class="keyword">const</span> scalar Beta</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> dt/(<span class="number">1</span> + Beta*dt);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Foam::scalar Foam::integrationSchemes::analytical::dtEff</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">const</span> scalar dt,</span><br><span class="line">    <span class="keyword">const</span> scalar Beta</span><br><span class="line">) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">        mag(Beta*dt) &gt; small</span><br><span class="line">      ? (<span class="number">1</span> - <span class="built_in">exp</span>(- Beta*dt))/Beta</span><br><span class="line">      : dt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>calcHeatTransfer</code> 函数中的数学原理：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>s</mi><mo>=</mo><mi>π</mi><mi>d</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">As=\pi dd</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault">A</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord mathdefault">d</span><span class="mord mathdefault">d</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mi>t</mi><mi>c</mi><mo>=</mo><mi>N</mi><mi>u</mi><mfrac><mi>κ</mi><msub><mi>D</mi><mi>p</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">htc=Nu\frac{\kappa}{D_p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">h</span><span class="mord mathdefault">t</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.079668em;vertical-align:-.972108em"></span><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord mathdefault">u</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">κ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mi>c</mi><mi>p</mi><mo>=</mo><mfrac><mrow><mi>h</mi><mi>t</mi><mi>c</mi><mo>∗</mo><mi>A</mi><mi>s</mi></mrow><mrow><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>N</mi><mi>u</mi><mi>κ</mi><mi>π</mi><msub><mi>D</mi><mi>p</mi></msub></mrow><mrow><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">bcp=\frac{htc*As}{mC_p}=\frac{Nu\kappa\pi D_p}{mC_p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="mord mathdefault">t</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord mathdefault">A</span><span class="mord mathdefault">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord mathdefault">u</span><span class="mord mathdefault">κ</span><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>c</mi><mi>p</mi><mo>=</mo><mi>b</mi><mi>c</mi><mi>p</mi><mo>∗</mo><mi>T</mi><mi>c</mi><mi>e</mi><mi>l</mi><mi>l</mi><mo>=</mo><mfrac><mrow><mi>N</mi><mi>u</mi><mi>κ</mi><mi>π</mi><msub><mi>D</mi><mi>p</mi></msub><msub><mi>T</mi><mrow><mi>c</mi><mi>e</mi><mi>l</mi><mi>l</mi></mrow></msub></mrow><mrow><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">acp=bcp*Tcell=\frac{Nu\kappa\pi D_p T_{cell}}{mC_p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord mathdefault">u</span><span class="mord mathdefault">κ</span><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:.01968em">l</span><span class="mord mathdefault mtight" style="margin-right:.01968em">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>n</mi><mi>c</mi><mi>p</mi><mo>=</mo><mfrac><mrow><mi>S</mi><mi>h</mi></mrow><mrow><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><mi>p</mi></msub><msub><mi>h</mi><mi>v</mi></msub></mrow><mrow><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">ancp=\frac{Sh}{mC_p}=\frac{\dot m_p h_v}{mC_p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mo stretchy="false">(</mo><mi>p</mi><mi>h</mi><mi>i</mi><mo separator="true">,</mo><mi>d</mi><mi>t</mi><mo separator="true">,</mo><mi>A</mi><mi>l</mi><mi>p</mi><mi>h</mi><mi>a</mi><mo separator="true">,</mo><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mi>l</mi><mi>p</mi><mi>h</mi><mi>a</mi><mo>−</mo><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo>∗</mo><mi>p</mi><mi>h</mi><mi>i</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>d</mi><mi>t</mi><mi>E</mi><mi>f</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">delta(phi, dt, Alpha, Beta)=(Alpha-Beta*phi)*dtEff</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault" style="margin-right:.05017em">B</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.05017em">B</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mord mathdefault" style="margin-right:.10764em">f</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>l</mi><mi>p</mi><mi>h</mi><mi>a</mi><mo>=</mo><mi>a</mi><mi>c</mi><mi>p</mi><mo>+</mo><mi>a</mi><mi>n</mi><mi>c</mi><mi>p</mi><mo>=</mo><mfrac><mrow><msub><mi>N</mi><mi>u</mi></msub><mi>κ</mi><mi>π</mi><mi>D</mi><mi>T</mi><mi>c</mi></mrow><mrow><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi>S</mi><mi>h</mi></mrow><mrow><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">Alpha=acp+ancp=\frac{N_u\kappa\pi DTc}{mC_p}+\frac{Sh}{mC_p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">κ</span><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mord mathdefault">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.343548em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo>=</mo><mi>b</mi><mi>c</mi><mi>p</mi><mo>=</mo><mfrac><mrow><msub><mi>N</mi><mi>u</mi></msub><mi>κ</mi><mi>π</mi><mi>D</mi></mrow><mrow><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">Beta=bcp=\frac{N_u\kappa\pi D}{mC_p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.05017em">B</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">κ</span><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord mathdefault" style="margin-right:.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mi>h</mi><mi>i</mi><mo>=</mo><msub><mi>T</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">phi=T_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>T</mi><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mi>l</mi><mi>p</mi><mi>h</mi><mi>a</mi><mo>−</mo><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo>∗</mo><msub><mi>T</mi><mi>p</mi></msub><mo stretchy="false">)</mo><mo>∗</mo><mi>d</mi><mi>t</mi><mi>E</mi><mi>f</mi><mi>f</mi><mo>=</mo><mo stretchy="false">(</mo><mfrac><mrow><mi>N</mi><mi>u</mi><mi>κ</mi><mi>π</mi><msub><mi>D</mi><mi>p</mi></msub><msub><mi>T</mi><mi>c</mi></msub></mrow><mrow><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><mi>p</mi></msub><msub><mi>h</mi><mi>v</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>−</mo><mfrac><mrow><mi>N</mi><mi>u</mi><mi>κ</mi><msub><mi>D</mi><mi>p</mi></msub><msub><mi>T</mi><mi>p</mi></msub></mrow><mrow><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac><mo stretchy="false">)</mo><mi>d</mi><mi>t</mi><mi>E</mi><mi>f</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">deltaT=(Alpha-Beta*T_p)*dtEff=(\frac{Nu\kappa\pi D_pT_c}{mC_p}+\frac{\dot m_ph_v}{dt}-\frac{Nu\kappa D_pT_p}{mC_p})dtEff</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathdefault" style="margin-right:.05017em">B</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-.972108em"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord mathdefault">u</span><span class="mord mathdefault">κ</span><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.332438em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord mathdefault">u</span><span class="mord mathdefault">κ</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mord mathdefault" style="margin-right:.10764em">f</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>t</mi><mi>E</mi><mi>f</mi><mi>f</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mo>−</mo><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo>∗</mo><mi>d</mi><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">dtEff=(1 - exp(- Beta*dt))/Beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:.05764em">E</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mord mathdefault" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathdefault" style="margin-right:.05017em">B</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:.05017em">B</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>T</mi><mi>c</mi><mi>p</mi><mo>=</mo><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>T</mi><mo>−</mo><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>T</mi><mi>n</mi><mi>c</mi><mi>p</mi><mo>=</mo><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>T</mi><mo>−</mo><mi>a</mi><mi>n</mi><mi>c</mi><mi>p</mi><mo>∗</mo><mi>d</mi><mi>t</mi><mo>=</mo><mo stretchy="false">?</mo></mrow><annotation encoding="application/x-tex">deltaTcp=deltaT-deltaTncp=deltaT-ancp*dt=?</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.77777em;vertical-align:-.08333em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.77777em;vertical-align:-.08333em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.6597200000000001em;vertical-align:-.19444em"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mclose">?</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>h</mi><mi>s</mi><mi>T</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo>=</mo><mo>−</mo><mi>m</mi><mo>∗</mo><msub><mi>C</mi><mi>p</mi></msub><mo>∗</mo><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>T</mi><mi>c</mi><mi>p</mi><mo>=</mo><mi>a</mi><mi>n</mi><mi>c</mi><mi>p</mi><mo>∗</mo><mi>d</mi><mi>t</mi><mo>∗</mo><mi>m</mi><mo>∗</mo><msub><mi>C</mi><mi>p</mi></msub><mo>−</mo><mi>m</mi><mo>∗</mo><mi>C</mi><msub><mi>p</mi><mo>∗</mo></msub><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">dhsTrans = -m*C_p*deltaTcp=ancp*dt*m*C_p -m*Cp_*deltaT</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">h</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord">−</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.6597200000000001em;vertical-align:-.19444em"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.46528em;vertical-align:0"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.46528em;vertical-align:0"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.175696em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>h</mi><mi>s</mi><mi>T</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo>=</mo><msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><mi>p</mi></msub><msub><mi>h</mi><mi>v</mi></msub><mi>d</mi><mi>t</mi><mo>−</mo><mi>m</mi><msub><mi>C</mi><mi>p</mi></msub><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">dhsTrans =\dot m_p h_v dt-m C_p deltaT</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">h</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="mord mathdefault" style="margin-right:.02778em">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:.01968em">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.13889em">T</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>p</mi><mi>h</mi><mo>=</mo><mi>N</mi><mi>u</mi><mi>κ</mi><mi>π</mi><msub><mi>D</mi><mi>p</mi></msub><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">Sph=Nu\kappa\pi D_pdt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">p</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="mord mathdefault">u</span><span class="mord mathdefault">κ</span><span class="mord mathdefault" style="margin-right:.03588em">π</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span></span></span></p><p>上述公式中的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">C_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 是液滴的比热容，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">D_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 是液滴直径，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">D</mi></mrow><annotation encoding="application/x-tex">\mathcal{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord"><span class="mord mathcal" style="margin-right:.02778em">D</span></span></span></span></span>是vapour diffusivity，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">h_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>是汽化潜热，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">T_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>是液滴温度。</p><p><code>calcPhaseChange</code> 定义于 <code>ReactingParcel</code>，调用于 <code>ReactingParcel</code> 中的 <code>calc</code> 函数。</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ParcelType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">template</span>&lt;class TrackCloudType&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:ReactingParcel&lt;ParcelType&gt;::calcPhaseChange</span><br><span class="line">(</span><br><span class="line">    TrackCloudType&amp; cloud,</span><br><span class="line">    trackingData&amp; td,</span><br><span class="line">    <span class="keyword">const</span> scalar dt,</span><br><span class="line">    <span class="keyword">const</span> scalar Re,</span><br><span class="line">    <span class="keyword">const</span> scalar Pr,</span><br><span class="line">    <span class="keyword">const</span> scalar Ts,</span><br><span class="line">    <span class="keyword">const</span> scalar nus,</span><br><span class="line">    <span class="keyword">const</span> scalar d,</span><br><span class="line">    <span class="keyword">const</span> scalar T,</span><br><span class="line">    <span class="keyword">const</span> scalar mass,</span><br><span class="line">    <span class="keyword">const</span> label idPhase,</span><br><span class="line">    <span class="keyword">const</span> scalar YPhase,</span><br><span class="line">    <span class="keyword">const</span> scalarField&amp; Y,</span><br><span class="line">    scalarField&amp; dMassPC,</span><br><span class="line">    scalar&amp; Sh,</span><br><span class="line">    scalar&amp; N,</span><br><span class="line">    scalar&amp; NCpW,</span><br><span class="line">    scalarField&amp; Cs</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">typename</span> TrackCloudType::reactingCloudType reactingCloudType;</span><br><span class="line">    <span class="keyword">const</span> CompositionModel&lt;reactingCloudType&gt;&amp; composition =</span><br><span class="line">        cloud.composition();</span><br><span class="line">    PhaseChangeModel&lt;reactingCloudType&gt;&amp; phaseChange = cloud.phaseChange();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!phaseChange.active() || (YPhase &lt; small))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">scalarField <span class="title">X</span><span class="params">(composition.liquids().X(Y))</span></span>;</span><br><span class="line"></span><br><span class="line">    scalar Tvap = phaseChange.Tvap(X);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (T &lt; Tvap)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar TMax = phaseChange.TMax(td.pc(), X);</span><br><span class="line">    <span class="keyword">const</span> scalar Tdash = <span class="built_in">min</span>(T, TMax);</span><br><span class="line">    <span class="keyword">const</span> scalar Tsdash = <span class="built_in">min</span>(Ts, TMax);</span><br><span class="line"></span><br><span class="line">    <span class="function">scalarField <span class="title">hmm</span><span class="params">(dMassPC)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate mass transfer due to phase change</span></span><br><span class="line">    phaseChange.calculate</span><br><span class="line">    (</span><br><span class="line">        dt,</span><br><span class="line">        <span class="keyword">this</span>-&gt;cell(),</span><br><span class="line">        Re,</span><br><span class="line">        Pr,</span><br><span class="line">        d,</span><br><span class="line">        nus,</span><br><span class="line">        Tdash,</span><br><span class="line">        Tsdash,</span><br><span class="line">        td.pc(),</span><br><span class="line">        td.Tc(),</span><br><span class="line">        X,</span><br><span class="line">        dMassPC</span><br><span class="line">    );</span><br><span class="line">    <span class="comment">//此函数的作用就是计算 scalarField&amp; dMassPC，size=液相组分个数，其它全是输入参数</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Limit phase change mass by availability of each specie</span></span><br><span class="line">    dMassPC = <span class="built_in">min</span>(mass*YPhase*Y, dMassPC);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar dMassTot = sum(dMassPC);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Add to cumulative phase change mass</span></span><br><span class="line">    phaseChange.addToPhaseChangeMass(<span class="keyword">this</span>-&gt;nParticle_*dMassTot);</span><br><span class="line"></span><br><span class="line">    forAll(dMassPC, i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const</span> label cid = composition.localToCarrierId(idPhase, i);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> scalar dh = phaseChange.dh(cid, i, td.pc(), Tdash);</span><br><span class="line">        Sh -= dMassPC[i]*dh/dt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Update molar emissions</span></span><br><span class="line">    <span class="keyword">if</span> (cloud.heatTransfer().BirdCorrection())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Average molecular weight of carrier mix - assumes perfect gas</span></span><br><span class="line">        <span class="keyword">const</span> scalar Wc = td.rhoc()*RR*td.Tc()/td.pc();</span><br><span class="line"></span><br><span class="line">        forAll(dMassPC, i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">const</span> label cid = composition.localToCarrierId(idPhase, i);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> scalar Cp = composition.carrier().Cp(cid, td.pc(), Tsdash);</span><br><span class="line">            <span class="keyword">const</span> scalar W = composition.carrier().W(cid);</span><br><span class="line">            <span class="keyword">const</span> scalar Ni = dMassPC[i]/(<span class="keyword">this</span>-&gt;areaS(d)*dt*W);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> scalar Dab =</span><br><span class="line">                composition.liquids().properties()[i].D(td.pc(), Tsdash, Wc);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Molar flux of species coming from the particle (kmol/m^2/s)</span></span><br><span class="line">            N += Ni;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Sum of Ni*Cpi*Wi of emission species</span></span><br><span class="line">            NCpW += Ni*Cp*W;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Concentrations of emission species</span></span><br><span class="line">            Cs[cid] += Ni*d/(<span class="number">2.0</span>*Dab);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>另外还有一个 <code>Sh</code> 的临时 <code>scalar</code>，申明并初始化为 0 于 <code>ReactingParcel</code> 中的 <code>calc</code> 函数。<br>注释说明它是：Explicit enthalpy source for particle。<br>随后通过 <code>calcPhaseChange</code>计算 <code>Sh</code>：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">forAll(dMassPC, i)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> label cid = composition.localToCarrierId(idPhase, i);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar dh = phaseChange.dh(cid, i, td.pc(), Tdash);<span class="comment">//汽化潜热</span></span><br><span class="line">    Sh -= dMassPC[i]*dh/dt;<span class="comment">//dMassPC是蒸发传质，正数。</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里的 <code>dMassPC</code> 是文献传质公式中的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>−</mo><msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><mi>p</mi></msub><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">-\dot m_p dt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord">−</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span></span></span></span>，因为蒸发模型得到的 <code>dMassPC</code> 是正数，但是液滴传质是损失质量，所以传质公式中的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>m</mi><mo>˙</mo></mover><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\dot m_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9539679999999999em;vertical-align:-.286108em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.66786em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathdefault">m</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em">˙</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 是负数。<br>最后在 <code>calc</code> 中通过 <code>calcHeatTransfer</code> 使用 <code>Sh</code>。</p><p>前面已经多次提到这个 <code>ReactingParcel</code> 中的 <code>calc</code> 函数，这里给出它的代码：</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">ParcelType</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">template</span>&lt;class TrackCloudType&gt;</span></span><br><span class="line"><span class="class"><span class="title">void</span> <span class="title">Foam</span>:</span>:ReactingParcel&lt;ParcelType&gt;::calc</span><br><span class="line">(</span><br><span class="line">    TrackCloudType&amp; cloud,</span><br><span class="line">    trackingData&amp; td,</span><br><span class="line">    <span class="keyword">const</span> scalar dt</span><br><span class="line">)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">typename</span> TrackCloudType::reactingCloudType reactingCloudType;</span><br><span class="line">    <span class="keyword">const</span> CompositionModel&lt;reactingCloudType&gt;&amp; composition =</span><br><span class="line">        cloud.composition();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Define local properties at beginning of time step</span></span><br><span class="line">    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scalar np0 = <span class="keyword">this</span>-&gt;nParticle_;</span><br><span class="line">    <span class="keyword">const</span> scalar d0 = <span class="keyword">this</span>-&gt;d_;</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">vector</span>&amp; U0 = <span class="keyword">this</span>-&gt;U_;</span><br><span class="line">    <span class="keyword">const</span> scalar T0 = <span class="keyword">this</span>-&gt;T_;</span><br><span class="line">    <span class="keyword">const</span> scalar mass0 = <span class="keyword">this</span>-&gt;mass();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calc surface values</span></span><br><span class="line">    scalar Ts, rhos, mus, Prs, kappas;</span><br><span class="line">    <span class="keyword">this</span>-&gt;calcSurfaceValues(cloud, td, T0, Ts, rhos, mus, Prs, kappas);</span><br><span class="line">    scalar Res = <span class="keyword">this</span>-&gt;Re(rhos, U0, td.Uc(), d0, mus);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sources</span></span><br><span class="line">    <span class="comment">// ~~~~~~~</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Explicit momentum source for particle</span></span><br><span class="line">    <span class="built_in">vector</span> Su = Zero;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Linearised momentum source coefficient</span></span><br><span class="line">    scalar Spu = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Momentum transfer from the particle to the carrier phase</span></span><br><span class="line">    <span class="built_in">vector</span> dUTrans = Zero;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Explicit enthalpy source for particle</span></span><br><span class="line">    scalar Sh = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Linearised enthalpy source coefficient</span></span><br><span class="line">    scalar Sph = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sensible enthalpy transfer from the particle to the carrier phase</span></span><br><span class="line">    scalar dhsTrans = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. Compute models that contribute to mass transfer - U, T held constant</span></span><br><span class="line">    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Phase change</span></span><br><span class="line">    <span class="comment">// ~~~~~~~~~~~~</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Mass transfer due to phase change</span></span><br><span class="line">    <span class="function">scalarField <span class="title">dMassPC</span><span class="params">(Y_.<span class="built_in">size</span>(), <span class="number">0.0</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Molar flux of species emitted from the particle (kmol/m^2/s)</span></span><br><span class="line">    scalar Ne = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sum Ni*Cpi*Wi of emission species</span></span><br><span class="line">    scalar NCpW = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Surface concentrations of emitted species</span></span><br><span class="line">    <span class="function">scalarField <span class="title">Cs</span><span class="params">(composition.carrier().species().<span class="built_in">size</span>(), <span class="number">0.0</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calc mass and enthalpy transfer due to phase change</span></span><br><span class="line">    calcPhaseChange</span><br><span class="line">    (</span><br><span class="line">        cloud,</span><br><span class="line">        td,</span><br><span class="line">        dt,</span><br><span class="line">        Res,</span><br><span class="line">        Prs,</span><br><span class="line">        Ts,</span><br><span class="line">        mus/rhos,</span><br><span class="line">        d0,</span><br><span class="line">        T0,</span><br><span class="line">        mass0,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">1.0</span>,</span><br><span class="line">        Y_,</span><br><span class="line">        dMassPC,</span><br><span class="line">        Sh,</span><br><span class="line">        Ne,</span><br><span class="line">        NCpW,</span><br><span class="line">        Cs</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. Update the parcel properties due to change in mass</span></span><br><span class="line">    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"></span><br><span class="line">    <span class="function">scalarField <span class="title">dMass</span><span class="params">(dMassPC)</span></span>;</span><br><span class="line">    scalar mass1 = updateMassFraction(mass0, dMass, Y_);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>-&gt;Cp_ = composition.Cp(<span class="number">0</span>, Y_, td.pc(), T0);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Update particle density or diameter</span></span><br><span class="line">    <span class="keyword">if</span> (cloud.constProps().constantVolume())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;rho_ = mass1/<span class="keyword">this</span>-&gt;volume();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;d_ = cbrt(mass1/<span class="keyword">this</span>-&gt;rho_*<span class="number">6.0</span>/pi);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Remove the particle when mass falls below minimum threshold</span></span><br><span class="line">    <span class="keyword">if</span> (np0*mass1 &lt; cloud.constProps().minParcelMass())</span><br><span class="line">    &#123;</span><br><span class="line">        td.keepParticle = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (cloud.solution().coupled())</span><br><span class="line">        &#123;</span><br><span class="line">            scalar dm = np0*mass0;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Absorb parcel into carrier phase</span></span><br><span class="line">            forAll(Y_, i)</span><br><span class="line">            &#123;</span><br><span class="line">                scalar dmi = dm*Y_[i];</span><br><span class="line">                label gid = composition.localToCarrierId(<span class="number">0</span>, i);</span><br><span class="line">                scalar hs = composition.carrier().Hs(gid, td.pc(), T0);</span><br><span class="line"></span><br><span class="line">                cloud.rhoTrans(gid)[<span class="keyword">this</span>-&gt;cell()] += dmi;</span><br><span class="line">                cloud.hsTrans()[<span class="keyword">this</span>-&gt;cell()] += dmi*hs;</span><br><span class="line">            &#125;</span><br><span class="line">            cloud.UTrans()[<span class="keyword">this</span>-&gt;cell()] += dm*U0;</span><br><span class="line"></span><br><span class="line">            cloud.phaseChange().addToPhaseChangeMass(np0*mass1);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Correct surface values due to emitted species</span></span><br><span class="line">    correctSurfaceValues(cloud, td, Ts, Cs, rhos, mus, Prs, kappas);</span><br><span class="line">    Res = <span class="keyword">this</span>-&gt;Re(rhos, U0, td.Uc(), <span class="keyword">this</span>-&gt;d(), mus);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. Compute heat- and momentum transfers</span></span><br><span class="line">    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Heat transfer</span></span><br><span class="line">    <span class="comment">// ~~~~~~~~~~~~~</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate new particle temperature</span></span><br><span class="line">    <span class="keyword">this</span>-&gt;T_ =</span><br><span class="line">        <span class="keyword">this</span>-&gt;calcHeatTransfer</span><br><span class="line">        (</span><br><span class="line">            cloud,</span><br><span class="line">            td,</span><br><span class="line">            dt,</span><br><span class="line">            Res,</span><br><span class="line">            Prs,</span><br><span class="line">            kappas,</span><br><span class="line">            NCpW,</span><br><span class="line">            Sh,</span><br><span class="line">            dhsTrans,</span><br><span class="line">            Sph</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>-&gt;Cp_ = composition.Cp(<span class="number">0</span>, Y_, td.pc(), T0);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Motion</span></span><br><span class="line">    <span class="comment">// ~~~~~~</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate new particle velocity</span></span><br><span class="line">    <span class="keyword">this</span>-&gt;U_ =</span><br><span class="line">        <span class="keyword">this</span>-&gt;calcVelocity(cloud, td, dt, Res, mus, mass1, Su, dUTrans, Spu);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. Accumulate carrier phase source terms</span></span><br><span class="line">    <span class="comment">// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (cloud.solution().coupled())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Transfer mass lost to carrier mass, momentum and enthalpy sources</span></span><br><span class="line">        forAll(dMass, i)</span><br><span class="line">        &#123;</span><br><span class="line">            scalar dm = np0*dMass[i];</span><br><span class="line">            label gid = composition.localToCarrierId(<span class="number">0</span>, i);</span><br><span class="line">            scalar hs = composition.carrier().Hs(gid, td.pc(), T0);</span><br><span class="line"></span><br><span class="line">            cloud.rhoTrans(gid)[<span class="keyword">this</span>-&gt;cell()] += dm;</span><br><span class="line">            cloud.UTrans()[<span class="keyword">this</span>-&gt;cell()] += dm*U0;</span><br><span class="line">            cloud.hsTrans()[<span class="keyword">this</span>-&gt;cell()] += dm*hs;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Update momentum transfer</span></span><br><span class="line">        cloud.UTrans()[<span class="keyword">this</span>-&gt;cell()] += np0*dUTrans;</span><br><span class="line">        cloud.UCoeff()[<span class="keyword">this</span>-&gt;cell()] += np0*Spu;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Update sensible enthalpy transfer</span></span><br><span class="line">        cloud.hsTrans()[<span class="keyword">this</span>-&gt;cell()] += np0*dhsTrans;</span><br><span class="line">        cloud.hsCoeff()[<span class="keyword">this</span>-&gt;cell()] += np0*Sph;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Update radiation fields</span></span><br><span class="line">        <span class="keyword">if</span> (cloud.radiation())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">const</span> scalar ap = <span class="keyword">this</span>-&gt;areaP();</span><br><span class="line">            <span class="keyword">const</span> scalar T4 = pow4(T0);</span><br><span class="line">            cloud.radAreaP()[<span class="keyword">this</span>-&gt;cell()] += dt*np0*ap;</span><br><span class="line">            cloud.radT4()[<span class="keyword">this</span>-&gt;cell()] += dt*np0*T4;</span><br><span class="line">            cloud.radAreaPT4()[<span class="keyword">this</span>-&gt;cell()] += dt*np0*ap*T4;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;从数学公式到C++代码全面解析喷雾传热传质过程原理&lt;/p&gt;
    
    </summary>
    
    
      <category term="code" scheme="https://openfoam.top/categories/code/"/>
    
    
      <category term="Lagrangian" scheme="https://openfoam.top/tags/Lagrangian/"/>
    
  </entry>
  
  <entry>
    <title>找对象的正确姿势</title>
    <link href="https://openfoam.top/lookupObject/"/>
    <id>https://openfoam.top/lookupObject/</id>
    <published>2019-03-23T23:00:00.000Z</published>
    <updated>2019-03-23T23:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>foundObject，返回是否找到该对象的 Bool 值<br>lookupObject，返回对象，只能使用const成员函数，<br>lookupObjectRef，返回的对象可以使用非const成员函数</p><a id="more"></a><h2 id="最简单的场量"><a class="markdownIt-Anchor" href="#最简单的场量"></a> 最简单的场量：</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>-&gt;mesh().objectRegistry::lookupObject&lt;volScalarField&gt;(<span class="string">"rho"</span>)</span><br><span class="line"><span class="keyword">this</span>-&gt;mesh().objectRegistry::lookupObject&lt;volVectorField&gt;(<span class="string">"U"</span>)</span><br><span class="line"><span class="keyword">this</span>-&gt;mesh().objectRegistry::lookupObject&lt;PtrList&lt;scalarField&gt;&gt;(<span class="string">"this-&gt;thermo().composition().Y()"</span>)</span><br></pre></td></tr></table></figure><h2 id="模型"><a class="markdownIt-Anchor" href="#模型"></a> 模型</h2><h3 id="湍流模型"><a class="markdownIt-Anchor" href="#湍流模型"></a> 湍流模型</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> compressible::turbulenceModel&amp; turbModel =</span><br><span class="line">    <span class="keyword">this</span>-&gt;db().objectRegistry::lookupObject&lt;compressible::turbulenceModel&gt;</span><br><span class="line">    (<span class="string">"turbulence"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> compressible::turbulenceModel&amp; turbModel =</span><br><span class="line">lookupObject&lt;compressible::turbulenceModel&gt;</span><br><span class="line">(</span><br><span class="line">    turbulenceModel::propertiesName</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> compressible::turbulenceModel&amp; turbModel =</span><br><span class="line"><span class="keyword">this</span>-&gt;db().lookupObject&lt;compressible::turbulenceModel&gt;</span><br><span class="line">(</span><br><span class="line">    turbulenceModel::propertiesName</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> compressible::turbulenceModel&amp; turbModel =</span><br><span class="line">db().lookupObject&lt;compressible::turbulenceModel&gt;</span><br><span class="line">(</span><br><span class="line">    IOobject::groupName</span><br><span class="line">    (</span><br><span class="line">        compressible::turbulenceModel::propertiesName,</span><br><span class="line">        internalField().group()</span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line">    </span><br><span class="line"><span class="keyword">const</span> compressible::LESModel&amp; lesModel =</span><br><span class="line">YO2.db().lookupObject&lt;compressible::LESModel&gt;</span><br><span class="line">(</span><br><span class="line">    turbulenceModel::propertiesName</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="喷雾模型"><a class="markdownIt-Anchor" href="#喷雾模型"></a> 喷雾模型</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>-&gt;mesh().objectRegistry::foundObject&lt;sprayCloud&gt;(Foam::sprayCloud::typeName))</span><br><span class="line"><span class="keyword">const</span> basicSprayCloud&amp; spray_ = <span class="keyword">dynamic_cast</span>&lt;<span class="keyword">const</span> basicSprayCloud&amp;&gt;(<span class="keyword">this</span>-&gt;mesh().objectRegistry::lookupObject&lt;sprayCloud&gt;(Foam::sprayCloud::typeName));</span><br><span class="line">basicSprayCloud&amp; spray_ = <span class="keyword">dynamic_cast</span>&lt;basicSprayCloud&amp;&gt;(<span class="keyword">this</span>-&gt;mesh().objectRegistry::lookupObjectRef&lt;sprayCloud&gt;(Foam::sprayCloud::typeName));</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;foundObject，返回是否找到该对象的 Bool 值&lt;br&gt;lookupObject，返回对象，只能使用const成员函数，&lt;br&gt;lookupObjectRef，返回的对象可以使用非const成员函数&lt;/p&gt;
    
    </summary>
    
    
      <category term="code" scheme="https://openfoam.top/categories/code/"/>
    
    
      <category term="lookupObject" scheme="https://openfoam.top/tags/lookupObject/"/>
    
  </entry>
  
</feed>
